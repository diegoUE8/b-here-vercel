/**
 * @license beta-bhere-development v1.0.23
 * (c) 2022 Luca Zampetti <lzampetti@gmail.com>
 * License: MIT
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("rxcomp"),require("rxcomp-form"),require("rxjs"),require("rxjs/operators"),require("three"),require("html2canvas")):"function"==typeof define&&define.amd?define(["rxcomp","rxcomp-form","rxjs","rxjs/operators","three","html2canvas"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).rxcomp,t.rxcomp.form,t.rxjs,t.rxjs.operators,t.THREE,t.html2canvas)}(this,(function(t,e,s,i,n,o){"use strict";function a(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var r=a(o);const l='\n\x3c!-- service --\x3e\n<div class="group--service">\n\t<button type="button" class="btn--back" [title]="\'title_back\' | label" (click)="onBack($event)" *if="isBackButtonVisible">\n\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#arrow-prev"></use></svg>\n\t</button>\n\t<button type="button" class="btn--view-mode" [title]="\'title_view_mode\' | label" (click)="toggleMode($event)" *if="state.mode != \'embed\'">\n\t\t<svg width="24" height="24" viewBox="0 0 24 24" *if="state.mode == \'virtual-tour\'"><use xlink:href="#live-meeting"></use></svg>\n\t\t<svg width="24" height="24" viewBox="0 0 24 24" *if="state.mode == \'live-meeting\'"><use xlink:href="#virtual-tour"></use></svg>\n\t</button>\n\t<button type="button" class="btn--volume" [title]="\'title_volume\' | label" [class]="{ muted: state.volumeMuted }" (click)="toggleVolume($event)">\n\t\t<svg width="24" height="24" viewBox="0 0 24 24" *if="!state.volumeMuted"><use xlink:href="#volume-on"></use></svg>\n\t\t<svg width="24" height="24" viewBox="0 0 24 24" *if="state.volumeMuted"><use xlink:href="#volume-off"></use></svg>\n\t</button>\n\t<button type="button" class="btn--fullscreen" [title]="\'title_fullscreen\' | label" [class]="{ muted: state.fullScreen }" (click)="toggleFullScreen($event)">\n\t\t<svg width="24" height="24" viewBox="0 0 24 24" *if="!state.fullScreen"><use xlink:href="#fullscreen-on"></use></svg>\n\t\t<svg width="24" height="24" viewBox="0 0 24 24" *if="state.fullScreen"><use xlink:href="#fullscreen-off"></use></svg>\n\t</button>\n\t<button type="button" class="btn--navmap" [title]="\'title_navmap\' | label" [class]="{ active: state.showNavmap }" (click)="toggleNavmap($event)" *if="navmap && state.mode != \'live-meeting\'">\n\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#navmap"></use></svg>\n\t</button>\n</div>\n',c='\n\x3c!-- controls --\x3e\n<div class="group--controls" *if="state.live">\n\t<div class="group--actions">\n\t\t<button type="button" class="btn--call" [title]="\'title_disconnect\' | label" (click)="disconnect()">\n\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#call"></use></svg>\n\t\t</button>\n\t\t<button type="button" class="btn--cam" [title]="\'title_mute_camera\' | label" [class]="{ muted: state.cameraMuted, disabled: !local }" (click)="toggleCamera()">\n\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#cam"></use></svg>\n\t\t</button>\n\t\t<button type="button" class="btn--mic" [title]="\'title_mute_mic\' | label" [class]="{ muted: state.audioMuted, disabled: !local || silenced }" (click)="toggleAudio()">\n\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#mic"></use></svg>\n\t\t</button>\n\t\t<button type="button" class="btn--screen" [title]="\'title_share_screen\' | label" [class]="{ active: screen }" (click)="toggleScreen()" *if="(\'screenShare\' | flag) && (state.role == \'publisher\' || state.role == \'attendee\' || controlling)">\n\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#screen"></use></svg>\n\t\t</button>\n\t\t<button type="button" class="btn--chat" [title]="\'title_chat\' | label" [class]="{ active: state.chatDirty }" (click)="toggleChat()" *if="(\'chat\' | flag)">\n\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#chat"></use></svg>\n\t\t</button>\n\t\t<button type="button" class="btn--navinfo" [title]="\'title_navinfo\' | label" [class]="{ active: state.showNavInfo }" (click)="toggleNavInfo()" *if="showNavInfoToggler">\n\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#navinfo"></use></svg>\n\t\t</button>\n\t</div>\n</div>\n',d='\n\x3c!-- media --\x3e\n<div class="group--media" media-player>\n\t<button type="button" class="btn--play" [title]="\'title_play\' | label" (click)="onPlay()" *if="!playing">\n\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#play"></use></svg>\n\t</button>\n\t<button type="button" class="btn--pause" [title]="\'title_pause\' | label" (click)="onPause()" *if="playing">\n\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#pause"></use></svg>\n\t</button>\n\t<div class="track" (click)="onTrack($event)">\n\t\t<div class="track__progress" [style]="{ transform: \'scale(\' + this.progress + \', 1)\'}"></div>\n\t</div>\n</div>\n',h='\n\x3c!-- ar-vr --\x3e\n<div class="group--ar-vr">\n\t<button type="button" class="btn--ar" [title]="\'title_ar\' | label" [href]="view?.ar" (click)="tryInAr()" *if="view?.ar">\n\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#ar"></use></svg> <span>Try in AR</span>\n\t</button>\n\t<button type="button" class="btn--vr" [title]="\'title_vr\' | label" [class]="{ disabled: vrService.isDisabled() }" (click)="vrService.toggleVR()">\n\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#vr"></use></svg> <span [innerHTML]="vrService.getLabel()"></span>\n\t</button>\n</div>\n',u='\n\x3c!-- like --\x3e\n<div class="group--heart" *if="view && (\'like\' | flag)">\n\t<svg class="love" [class]="{ active: view.showLove }" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#heart"></use></svg>\n\t<button type="button" class="btn--heart" [class]="{ active: view.showLove }" (click)="addLike($event)">\n\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#heart"></use></svg>\n\t\t<span class="badge" [innerHTML]="view.likes" *if="view.likes"></span>\n\t</button>\n</div>\n<div class="group--spacer" *if="!view || !(\'like\' | flag)"></div>\n',p='\n\x3c!-- chat --\x3e\n<div class="group--chat" *if="state.chat" agora-chat (close)="onChatClose()"></div>\n',m='\n\x3c!-- lock --\x3e\n<div class="ui__lock" [class]="{ spying: spying }" *if="locked || controlling"></div>\n',v='\n\x3c!-- navmap --\x3e\n<div class="group--navmap" *if="navmap && state.showNavmap && state.mode != \'live-meeting\'">\n\t<img draggable="false" [src]="navmap.asset | asset" *if="navmap.asset" />\n\t<div class="navmap__item" [style]="{ left: item.position[0] * 100 + \'%\', top: item.position[1] * 100 + \'%\' }" (click)="onNavmapItem(item)" *for="let item of navmap.items">\n\t\t<img draggable="false" [src]="\'textures/ui/nav-point.png\' | asset" />\n\t\t<div class="title" [innerHTML]="item.title" *if="item.title"></div>\n\t</div>\n</div>\n',g="\n\x3c!-- background --\x3e\n<div class=\"background\" [class]=\"{ 'background--image': ('background.image' | env), 'background--video': ('background.video' | env) }\" *if=\"state.status != 'connected'\">\n\t<img [src]=\"'background.image' | env | asset\" *if=\"'background.image' | env\" />\n\t<video [src]=\"'background.video' | env | asset\" *if=\"'background.video' | env\" oncanplay=\"this.muted = true; this.classList.add('ready');\" playsinline autoplay muted loop></video>\n</div>\n",f='\n\x3c!-- logo --\x3e\n<a class="btn--logo" [routerLink]="\':lang.access\' | route" *if="state.status != \'connected\'">\n\t<img [src]="\'logo\' | env" *if="\'logo\' | env" />\n\t<svg viewBox="0 0 270 98" *if="!(\'logo\' | env)"><use xlink:href="#b-here"></use></svg>\n</a>\n',b='\n\x3c!-- credits --\x3e\n<a class="btn--credits" href="https://www.websolute.com/" target="_blank" rel="noopener" *if="state.status != \'connected\'">\n\t<svg viewBox="0 0 270 98"><use xlink:href="#b-here"></use></svg>\n</a>\n',w='\n\x3c!-- copyright --\x3e\n<span *if="\'gdprRoutes\' | flag"> <span [innerHTML]="\'copyright\' | label"></span> <span *if="\'privacy_policy\' | label">-</span> <a [routerLink]="\':lang.privacy\' | route" class="btn--colophon" [innerHTML]="\'privacy_policy\' | label"></a> <span *if="\'terms_of_service\' | label">-</span> <a [routerLink]="\':lang.terms\' | route" class="btn--colophon" [innerHTML]="\'terms_of_service\' | label"></a></span>\n',y='\n\x3c!-- language --\x3e\n<div class="group--language" language *if="state.status != \'connected\'"></div>\n',x=`\n\x3c!-- Virtual Tour --\x3e\n<div class="ui virtual-tour" [class]="uiClass" *if="state.status == 'connected' && isVirtualTourUser">\n\t\x3c!-- world --\x3e\n\t<div class="ui__body">\n\t\t<div class="world" world [view]="view" [views]="pathViews" (navTo)="onNavTo($event)" (navLink)="onNavLink($event)"></div>\n\t</div>\n\t\n\x3c!-- remote sidebar --\x3e\n<div class="group--remote" [class]="remoteClass" *if="state.live">\n\t<div class="agora-stream" (toggleControl)="onToggleControl($event)" (toggleSpy)="onToggleSpy($event)" agora-stream [stream]="remote" type="remote" *for="let remote of remotes">\n\t\t<div class="agora-stream__player"></div>\n\t\t<div class="agora-stream__info" [class]="{ spyed: state.spying == streamId, controlling: state.controlling == streamId }">\n\t\t\t<svg class="cam-muted" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#cam-muted"></use></svg>\n\t\t\t<svg class="mic-muted" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#mic-muted"></use></svg>\n\t\t\t<div class="id" [innerHTML]="stream.clientInfo.name || streamId" *if="stream.clientInfo"></div>\n\t\t\t<button type="button" class="btn--control" [title]="'title_control' | label" (click)="onToggleControl(streamId)" *if="state.role === 'publisher'">\n\t\t\t\t<svg class="control" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#control"></use></svg>\n\t\t\t</button>\n\t\t\t<button type="button" class="btn--spy" [title]="'title_spy' | label" (click)="onToggleSpy(streamId)" *if="state.role === 'publisher'">\n\t\t\t\t<svg class="spy" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#spy"></use></svg>\n\t\t\t</button>\n\t\t</div>\n\t</div>\n\t<div class="group--members" *if="state.mode == 'virtual-tour'">\n\t\t<div class="members">\n\t\t\t<svg class="spy" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#users"></use></svg>\n\t\t\t<span class="members__count" [innerHTML]="state.membersCount"></span>\n\t\t</div>\n\t\t<div class="credits">\n\t\t\t<a class="btn--credits" href="https://www.websolute.com/" target="_blank" rel="noopener">\n\t\t\t\t<svg viewBox="0 0 270 98"><use xlink:href="#b-here"></use></svg>\n\t\t\t</a>\n\t\t</div>\n\t</div>\n</div>\n\x3c!-- remote screen --\x3e\n<div class="group--remote-screen" *if="remoteScreen">\n\t<div class="agora-stream" agora-stream [stream]="remoteScreen" type="remote">\n\t\t<div class="agora-stream__player"></div>\n\t\t<div class="agora-stream__info">\n\t\t\t<div class="id" [innerHTML]="stream.clientInfo.name || streamId" *if="stream.clientInfo"></div>\n\t\t</div>\n\t</div>\n</div>\n\n\t<div class="group--header">\n\t\t${l}\n\t\t\n\x3c!-- local streams --\x3e\n<div class="group--local" [class]="{ publisher: state.role == 'publisher', viewer: state.role == 'viewer' }" *if="state.live">\n\t<button type="button" class="btn--silence" [title]="'title_silence' | label" [class]="{ active: state.silencing }" (click)="onToggleSilence()" *if="state.role === 'publisher'">\n\t\t<svg class="mic-muted" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#mic-muted"></use></svg>\n\t</button>\n\t<button type="button" class="btn--control" [title]="'title_control' | label" [class]="{ active: state.controlling == state.uid }" (click)="onToggleControl(state.uid)" *if="state.role == 'publisher'">\n\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#control"></use></svg>\n\t</button>\n\t<div class="agora-stream" *if="!local"></div>\n\t<div class="agora-stream" agora-stream [stream]="local" type="local" *if="local">\n\t\t<div class="agora-stream__player"></div>\n\t\t<div class="agora-stream__info">\n\t\t\t<svg class="cam-muted" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#cam-muted"></use></svg>\n\t\t\t<svg class="mic-muted" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#mic-muted"></use></svg>\n\t\t</div>\n\t</div>\n\t<div class="agora-stream agora-stream--screen" agora-stream [stream]="screen" type="local" *if="screen && hasScreenViewItem">\n\t\t<div class="agora-stream__player"></div>\n\t</div>\n</div>\n\n\t</div>\n\t<div class="group--footer">\n\t\t${c}\n\t\t${d}\n\t\t${h}\n\t\t${u}\n\t</div>\n\t\n\x3c!-- members --\x3e\n<div class="group--members" *if="state.mode == 'live-meeting'">\n\t<div class="members">\n\t\t<svg class="spy" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#users"></use></svg>\n\t\t<span class="members__count" [innerHTML]="state.membersCount"></span>\n\t</div>\n\t<div class="credits">\n\t\t<a class="btn--credits" href="https://www.websolute.com/" target="_blank" rel="noopener">\n\t\t\t<svg viewBox="0 0 270 98"><use xlink:href="#b-here"></use></svg>\n\t\t</a>\n\t</div>\n</div>\n\n\t${p}\n\t${m}\n\t${v}\n</div>\n`,C=`\n\x3c!-- Self Service Tour --\x3e\n<div class="ui" [class]="uiClass" *if="state.status == 'connected' && state.mode == 'self-service-tour'">\n\t\x3c!-- world --\x3e\n\t<div class="ui__body">\n\t\t<div class="world" world [view]="view" [views]="pathViews" (navTo)="onNavTo($event)" (navLink)="onNavLink($event)"></div>\n\t</div>\n\t<div class="group--header">\n\t\t${l}\n\t</div>\n\t<div class="group--footer">\n\t\t<div class="group--spacer"></div>\n\t\t${d}\n\t\t${h}\n\t\t${u}\n\t</div>\n\t${v}\n</div>\n`,M=`\n\x3c!-- Embed --\x3e\n<div class="ui" [class]="uiClass" *if="state.status == 'connected' && state.mode == 'embed'">\n\t\x3c!-- world --\x3e\n\t<div class="ui__body">\n\t\t<div class="world" world [view]="view" [views]="pathViews" (navTo)="onNavTo($event)" (navLink)="onNavLink($event)"></div>\n\t</div>\n\t<div class="group--header">\n\t\t${l}\n\t</div>\n\t<div class="group--footer">\n\t\t<div class="group--spacer"></div>\n\t\t${d}\n\t\t${h}\n\t\t${u}\n\t</div>\n</div>\n`,k={appKey:"8b0cae93d47a44e48e97e7fd0404be4e",channelName:"BHere",flags:{production:!1,useProxy:!0,useToken:!1,useExtendedUserInfo:!0,useEncryptedUrl:!0,gdprRoutes:!0,selfService:!0,guidedTourRequest:!0,guidedTourAccess:!0,ssoLogin:!1,ssoRegister:!1,editor:!0,editorAssetScreen:!0,menu:!0,menuEmbed:!0,navmaps:!0,screenShare:!0,chat:!0,ar:!0,like:!0,hideNavInfo:!0,useIframe:!0,attendee:!0,streamer:!0,viewer:!0,smartDevice:!0,selfServiceProposition:!1,navInfoAnimated:!1,navInfoImportantAnimated:!1,navMoveAnimated:!0,navMoveImportantAnimated:!0,navPointAnimated:!1,navPointImportantAnimated:!1,navTitleAnimated:!1,navTitleImportantAnimated:!1,navTransparentAnimated:!0,navTransparentImportantAnimated:!0,useTextureEnvironment:!0,usePaths:!0,antialias:!0,alpha:!1,premultipliedAlpha:!1},sso:{issuer:"bhere-sso",origin:"http://localhost:3010",loginUrl:"http://localhost:3010/sso/login?redirectUrl={redirectUrl}",logoutUrl:"http://localhost:3010/sso/logout?redirectUrl={redirectUrl}",registerUrl:"http://localhost:3010/sso/register?redirectUrl={redirectUrl}",verifyTokenUrl:"http://localhost:3010/sso/verifytoken?verifyToken={verifytoken}"},navs:{iconMinScale:1,iconMaxScale:1.4},profiles:{streamer:"480p_2",publisher:"1080p_2",screen:"1080p_2"},logo:null,selfServiceAudio:null,colors:{menuBackground:"#000000",menuForeground:"#ffffff",menuOverBackground:"#0099ff",menuOverForeground:"#ffffff",menuBackBackground:"#0099ff",menuBackForeground:"#000000",menuBackOverBackground:"#0099ff",menuBackOverForeground:"#ffffff"},editor:{disabledViewTypes:["waiting-room"],disabledViewItemTypes:["texture"]},assets:"/docs/",dist:"/dist/",workers:{image:"./js/workers/image.service.worker.js",prefetch:"./js/workers/prefetch.service.worker.js"},textures:{envMap:"textures/envMap/studio_small_03_2k.hdr",grid:"textures/grid/grid.jpg"},toneMappingExposure:1,githubDocs:"https://raw.githubusercontent.com/actarian/b-here/beta-bhere-sso/docs/",template:{email:{supportRequest:"/email/support-request.html"}}};class S{static merge(t,e){return null===e?e:t?(e&&"object"==typeof e&&Object.keys(e).forEach((s=>{const i=e[s];"object"!=typeof i||Array.isArray(i)?t[s]=i:t[s]=this.merge(t[s],i)})),t):e&&"object"==typeof e?Object.assign({},e):e}}const T="undefined"!=typeof module&&module.exports,E=null!=(T?{get:()=>{}}:new URLSearchParams(window.location.search)).get("debug");!T&&document.querySelector("base").getAttribute("href");const L=!T&&(window&&-1!==window.location.host.indexOf("herokuapp")),_=!T&&(window&&-1!==window.location.host.indexOf("vercel.app")),I=L||_,R=!T&&(I||window&&("41789"===window.location.port||"5000"===window.location.port||"6443"===window.location.port||"actarian.github.io"===window.location.host)),$=!T&&(window&&-1!==["localhost","127.0.0.1","0.0.0.0"].indexOf(window.location.host.split(":")[0])),A={STATIC:R,DEVELOPMENT:$,PRODUCTION:!$};const P={channelName:"BHere",flags:{heroku:L,vercel:_,deployed:I},navs:{iconMinScale:1,iconMaxScale:1.4},url:{},languages:["it","en"],defaultLanguage:"it",labels:{},data:{},fields:[]},H=window.STATIC?k:{appKey:"8b0cae93d47a44e48e97e7fd0404be4e",channelName:"BHere",flags:{production:!0,useProxy:!1,useToken:!1,useExtendedUserInfo:!1,useEncryptedUrl:!1,gdprRoutes:!1,selfService:!0,guidedTourRequest:!0,guidedTourAccess:!0,ssoLogin:!1,ssoRegister:!1,editor:!1,editorAssetScreen:!1,menu:!0,menuEmbed:!1,navmaps:!1,screenShare:!1,chat:!1,ar:!0,like:!0,hideNavInfo:!0,useIframe:!0,attendee:!0,streamer:!0,viewer:!0,smartDevice:!0,selfServiceProposition:!1,navInfoAnimated:!1,navInfoImportantAnimated:!1,navMoveAnimated:!1,navMoveImportantAnimated:!1,navPointAnimated:!1,navPointImportantAnimated:!1,navTitleAnimated:!1,navTitleImportantAnimated:!1,navTransparentAnimated:!1,navTransparentImportantAnimated:!1,useTextureEnvironment:!0,usePaths:!1,antialias:!0,alpha:!1,premultipliedAlpha:!1},navs:{iconMinScale:1,iconMaxScale:1.4},profiles:{streamer:"480p_2",publisher:"1080p_2",screen:"720p_2"},logo:null,selfServiceAudio:null,colors:{menuBackground:"#000000",menuForeground:"#ffffff",menuOverBackground:"#0099ff",menuOverForeground:"#ffffff",menuBackBackground:"#0099ff",menuBackForeground:"#000000",menuBackOverBackground:"#0099ff",menuBackOverForeground:"#ffffff"},editor:{disabledViewTypes:["waiting-room","room-3d","media"],disabledViewItemTypes:["texture"]},assets:"/Modules/B-Here/Client/docs/",dist:"/Modules/B-Here/Client/dist/",workers:{image:"/Modules/B-Here/Client/docs/js/workers/image.service.worker.js",prefetch:"/Modules/B-Here/Client/docs/js/workers/prefetch.service.worker.js"},textures:{envMap:"textures/envMap/studio_small_03_2k.hdr",grid:"textures/grid/grid.jpg"},toneMappingExposure:1,githubDocs:"https://raw.githubusercontent.com/actarian/b-here/beta-bhere-sso/docs/",template:{email:{supportRequest:"/template/modules/b-here/email/support-request.cshtml"}}};let O=Object.assign({port:5e3,fontFamily:"Work Sans, sans-serif",colors:{menuBackground:"#000000",menuForeground:"#ffffff",menuOverBackground:"#0099ff",menuOverForeground:"#ffffff",menuBackBackground:"#0099ff",menuBackForeground:"#000000",menuBackOverBackground:"#0099ff",menuBackOverForeground:"#ffffff"},editor:{disabledViewTypes:["waiting-room","room-3d","media"],disabledViewItemTypes:["texture"]},renderOrder:{panorama:0,room:10,plane:20,tile:30,model:40,banner:50,nav:60,panel:70,menu:80,debug:90,pointer:100}},P,H);O=S.merge(O,window.bhere);const U=new class{get STATIC(){return A.STATIC}set STATIC(t){A.STATIC=!0===t||"true"===t,console.log("Environment.STATIC.set",A.STATIC)}get href(){return I?this.githubDocs:this.assets}getAbsoluteUrl(t,e){let s=`${window.location.origin}${t}`;return Object.keys(e).forEach((t=>{s=s.replace(`$${t}`,e[t])})),s}getPath(t){return this.isLocal(t)?this.href+t:t}isLocal(t){return-1===t.indexOf("://")}merge(t){t&&S.merge(this,t)}constructor(t){t&&Object.assign(this,t)}}(O);console.log("environment",U);
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var B=function(){return B=Object.assign||function(t){for(var e,s=1,i=arguments.length;s<i;s++)for(var n in e=arguments[s])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t},B.apply(this,arguments)},D=function(){return D=Object.assign||function(t){for(var e,s=1,i=arguments.length;s<i;s++)for(var n in e=arguments[s])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t},D.apply(this,arguments)},z=function(t){return void 0===t&&(t={}),{arrayFormat:t.arrayFormat||"none",booleanFormat:t.booleanFormat||"none",nullFormat:t.nullFormat||"default"}},V=function(t){return encodeURIComponent(t)},j=function(t){return decodeURIComponent(t)},N=function(t,e,s){return null===e?function(t,e){return"hidden"===e.nullFormat?"":"string"===e.nullFormat?t+"=null":t}(t,s):"boolean"==typeof e?function(t,e,s){return"empty-true"===s.booleanFormat&&e?t:t+"="+("unicode"===s.booleanFormat?e?"✓":"✗":e.toString())}(t,e,s):Array.isArray(e)?function(t,e,s){var i=function(t){return"index"===t.arrayFormat?function(t,e){return t+"["+e+"]"}:"brackets"===t.arrayFormat?function(t){return t+"[]"}:function(t){return t}}(s);return e.map((function(e,s){return i(t,s)+"="+V(e)})).join("&")}(t,e,s):t+"="+V(e)},F=function(t){var e=t.indexOf("?");return-1===e?t:t.slice(e+1)},G=function(t){var e=t.indexOf("["),s=-1!==e;return{hasBrackets:s,name:s?t.slice(0,e):t}},q=function(t,e){var s=z(e);return F(t).split("&").reduce((function(t,e){var i=e.split("="),n=i[0],o=i[1],a=G(n),r=a.hasBrackets,l=a.name,c=t[l],d=function(t,e){if(void 0===t)return"empty-true"===e.booleanFormat||null;if("string"===e.booleanFormat){if("true"===t)return!0;if("false"===t)return!1}if("unicode"===e.booleanFormat){if("✓"===j(t))return!0;if("✗"===j(t))return!1}return"string"===e.nullFormat&&"null"===t?null:j(t)}(o,s);return t[l]=void 0===c?r?[d]:d:(Array.isArray(c)?c:[c]).concat(d),t}),{})},Z=function(t,e){var s=z(e);return Object.keys(t).filter((function(e){return void 0!==t[e]})).map((function(e){return N(e,t[e],s)})).filter(Boolean).join("&")},W=/[^!$'()*+,;|:]/g,K=function(t){return t.replace(W,(function(t){return encodeURIComponent(t)}))},X={default:K,uri:encodeURI,uriComponent:encodeURIComponent,none:function(t){return t},legacy:encodeURI},Y={default:decodeURIComponent,uri:decodeURI,uriComponent:decodeURIComponent,none:function(t){return t},legacy:decodeURIComponent},J=function(t,e,s){var i=X[e]||K;return s?String(t).split("/").map(i).join("/"):i(String(t))},Q=function(t){return"("+(t?t.replace(/(^<|>$)/g,""):"[a-zA-Z0-9-_.~%':|=+\\*@$]+")+")"},tt=[{name:"url-parameter",pattern:/^:([a-zA-Z0-9-_]*[a-zA-Z0-9]{1})(<(.+?)>)?/,regex:function(t){return new RegExp(Q(t[2]))}},{name:"url-parameter-splat",pattern:/^\*([a-zA-Z0-9-_]*[a-zA-Z0-9]{1})/,regex:/([^?]*)/},{name:"url-parameter-matrix",pattern:/^;([a-zA-Z0-9-_]*[a-zA-Z0-9]{1})(<(.+?)>)?/,regex:function(t){return new RegExp(";"+t[1]+"="+Q(t[2]))}},{name:"query-parameter",pattern:/^(?:\?|&)(?::)?([a-zA-Z0-9-_]*[a-zA-Z0-9]{1})/},{name:"delimiter",pattern:/^(\/|\?)/,regex:function(t){return new RegExp("\\"+t[0])}},{name:"sub-delimiter",pattern:/^(!|&|-|_|\.|;)/,regex:function(t){return new RegExp(t[0])}},{name:"fragment",pattern:/^([0-9a-zA-Z]+)/,regex:function(t){return new RegExp(t[0])}}],et=function t(e,s){if(void 0===s&&(s=[]),!tt.some((function(i){var n=e.match(i.pattern);return!!n&&(s.push({type:i.name,match:n[0],val:n.slice(1,2),otherVal:n.slice(2),regex:i.regex instanceof Function?i.regex(n):i.regex}),n[0].length<e.length&&(s=t(e.substr(n[0].length),s)),!0)})))throw new Error("Could not parse path '"+e+"'");return s},st=function(t){return null!=t},it={urlParamsEncoding:"default"},nt=function(){function t(t,e){if(!t)throw new Error("Missing path in Path constructor");this.path=t,this.options=D(D({},it),e),this.tokens=et(t),this.hasUrlParams=this.tokens.filter((function(t){return/^url-parameter/.test(t.type)})).length>0,this.hasSpatParam=this.tokens.filter((function(t){return/splat$/.test(t.type)})).length>0,this.hasMatrixParams=this.tokens.filter((function(t){return/matrix$/.test(t.type)})).length>0,this.hasQueryParams=this.tokens.filter((function(t){return/^query-parameter/.test(t.type)})).length>0,this.spatParams=this.getParams("url-parameter-splat"),this.urlParams=this.getParams(/^url-parameter/),this.queryParams=this.getParams("query-parameter"),this.params=this.urlParams.concat(this.queryParams),this.source=this.tokens.filter((function(t){return void 0!==t.regex})).map((function(t){return t.regex.source})).join("")}return t.createPath=function(e,s){return new t(e,s)},t.prototype.isQueryParam=function(t){return-1!==this.queryParams.indexOf(t)},t.prototype.isSpatParam=function(t){return-1!==this.spatParams.indexOf(t)},t.prototype.test=function(t,e){var s=this,i=D(D({caseSensitive:!1,strictTrailingSlash:!1},this.options),e),n=function(t,e){return e||"\\/"===t?t:t.replace(/\\\/$/,"")+"(?:\\/)?"}(this.source,i.strictTrailingSlash),o=this.urlTest(t,n+(this.hasQueryParams?"(\\?.*$|$)":"$"),i.caseSensitive,i.urlParamsEncoding);if(!o||!this.hasQueryParams)return o;var a=q(t,i.queryParams);return 0===Object.keys(a).filter((function(t){return!s.isQueryParam(t)})).length?(Object.keys(a).forEach((function(t){return o[t]=a[t]})),o):null},t.prototype.partialTest=function(t,e){var s=this,i=D(D({caseSensitive:!1,delimited:!0},this.options),e),n=function(t,e){return e?/(\/)$/.test(t)?t:t+"(\\/|\\?|\\.|;|$)":t}(this.source,i.delimited),o=this.urlTest(t,n,i.caseSensitive,i.urlParamsEncoding);if(!o)return o;if(!this.hasQueryParams)return o;var a=q(t,i.queryParams);return Object.keys(a).filter((function(t){return s.isQueryParam(t)})).forEach((function(t){return function(t,e,s){void 0===s&&(s="");var i=t[e];return t[e]=void 0===i?s:Array.isArray(i)?i.concat(s):[i,s],t}(o,t,a[t])})),o},t.prototype.build=function(t,e){var s=this;void 0===t&&(t={});var i=D(D({ignoreConstraints:!1,ignoreSearch:!1,queryParams:{}},this.options),e),n=Object.keys(t).filter((function(t){return!s.isQueryParam(t)})).reduce((function(e,n){if(!st(t[n]))return e;var o=t[n],a=s.isSpatParam(n);return"boolean"==typeof o?e[n]=o:Array.isArray(o)?e[n]=o.map((function(t){return J(t,i.urlParamsEncoding,a)})):e[n]=J(o,i.urlParamsEncoding,a),e}),{});if(this.urlParams.some((function(e){return!st(t[e])}))){var o=this.urlParams.filter((function(e){return!st(t[e])}));throw new Error("Cannot build path: '"+this.path+"' requires missing parameters { "+o.join(", ")+" }")}if(!i.ignoreConstraints&&!this.tokens.filter((function(t){return/^url-parameter/.test(t.type)&&!/-splat$/.test(t.type)})).every((function(t){return new RegExp("^"+Q(t.otherVal[0])+"$").test(n[t.val])})))throw new Error("Some parameters of '"+this.path+"' are of invalid format");var a=this.tokens.filter((function(t){return!1===/^query-parameter/.test(t.type)})).map((function(t){return"url-parameter-matrix"===t.type?";"+t.val+"="+n[t.val[0]]:/^url-parameter/.test(t.type)?n[t.val[0]]:t.match})).join("");if(i.ignoreSearch)return a;var r=this.queryParams.filter((function(e){return-1!==Object.keys(t).indexOf(e)})).reduce((function(e,s){return e[s]=t[s],e}),{}),l=Z(r,i.queryParams);return l?a+"?"+l:a},t.prototype.getParams=function(t){var e=t instanceof RegExp?function(e){return t.test(e.type)}:function(e){return e.type===t};return this.tokens.filter(e).map((function(t){return t.val[0]}))},t.prototype.urlTest=function(t,e,s,i){var n=this,o=new RegExp("^"+e,s?"":"i"),a=t.match(o);return a?this.urlParams.length?a.slice(1,this.urlParams.length+1).reduce((function(t,e,s){return t[n.urlParams[s]]=(Y[i]||decodeURIComponent)(e),t}),{}):{}:null},t}(),ot=function(t){var e="";return t.reduce((function(t,s){var i,n,o,a,r=null!=(n=null===(i=s.parser)||void 0===i?void 0:i.urlParams.reduce((function(t,e){return t[e]="url",t}),{}))?n:{},l=null!=(a=null===(o=s.parser)||void 0===o?void 0:o.queryParams.reduce((function(t,e){return t[e]="query",t}),r))?a:{};return void 0!==s.name&&(t[e=e?e+"."+s.name:s.name]=l),t}),{})},at=function t(e,s,i,n,o){void 0===n&&(n={});for(var a=n.queryParamsMode,r=void 0===a?"default":a,l=n.strictTrailingSlash,c=void 0!==l&&l,d=n.strongMatching,h=void 0===d||d,u=n.caseSensitive,p=void 0!==u&&u,m=1===e.length&&""===e[0].name,v=function(e){var a,l=null,d=void 0,u=s;if("/"===o&&"/"===e.path&&(u="/"+s),e.children.length||(l=e.parser.test(u,{caseSensitive:p,strictTrailingSlash:c,queryParams:n.queryParams,urlParamsEncoding:n.urlParamsEncoding})),l||(l=e.parser.partialTest(u,{delimited:h,caseSensitive:p,queryParams:n.queryParams,urlParamsEncoding:n.urlParamsEncoding})),l){var v=e.parser.build(l,{ignoreSearch:!0,urlParamsEncoding:n.urlParamsEncoding});c||e.children.length||(v=v.replace(/\/$/,"")),d=0===u.toLowerCase().indexOf(v.toLowerCase())?u.slice(v.length):u,c||e.children.length||(d=d.replace(/^\/\?/,"?"));var g=function(t,e,s){var i=z(s);if(""===F(t))return{querystring:"",removedParams:{}};var n=t.split("&").reduce((function(t,s){var i=t[0],n=t[1],o=s.split("=")[0],a=G(o).name;return-1===e.indexOf(a)?[i.concat(s),n]:[i,n.concat(s)]}),[[],[]]),o=n[0],a=n[1];return{querystring:o.join("&"),removedParams:q(a.join("&"),i)}}((a=u.replace(v,""),a.split("?")[1]||""),e.parser.queryParams,n.queryParams).querystring;if(d=function(t){return t.split("?")[0]}(d)+(g?"?"+g:""),c||m||"/"!==d||/\/$/.test(v)||(d=""),i.segments.push(e),Object.keys(l).forEach((function(t){return i.params[t]=l[t]})),!m&&!d.length)return{value:i};if(!m&&"strict"!==r&&0===d.indexOf("?")){var f=q(d.slice(1),n.queryParams);return Object.keys(f).forEach((function(t){return i.params[t]=f[t]})),{value:i}}var b=e.getNonAbsoluteChildren();return b.length?{value:t(b,d,i,n,v)}:{value:null}}},g=0,f=e;g<f.length;g++){var b=v(f[g]);if("object"==typeof b)return b.value}return null};
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var rt=function(t){return function(e,s){var i,n,o,a,r,l,c=e.path.replace(/<.*?>/g,"").split("?")[0].replace(/(.+)\/$/,"$1"),d=s.path.replace(/<.*?>/g,"").split("?")[0].replace(/(.+)\/$/,"$1");if("/"===c)return 1;if("/"===d)return-1;if(null===(i=e.parser)||void 0===i?void 0:i.hasSpatParam)return 1;if(null===(n=s.parser)||void 0===n?void 0:n.hasSpatParam)return-1;var h=(c.match(/\//g)||[]).length,u=(d.match(/\//g)||[]).length;if(h<u)return 1;if(h>u)return-1;var p=null!=(a=null===(o=e.parser)||void 0===o?void 0:o.urlParams.length)?a:0,m=null!=(l=null===(r=s.parser)||void 0===r?void 0:r.urlParams.length)?l:0;if(p<m)return-1;if(p>m)return 1;var v=(c.split("/").slice(-1)[0]||"").length,g=(d.split("/").slice(-1)[0]||"").length;return v<g?1:v>g?-1:t.indexOf(e)-t.indexOf(s)}},lt=function(){function t(t,e,s,i){return void 0===t&&(t=""),void 0===e&&(e=""),void 0===s&&(s=[]),void 0===i&&(i={}),this.name=t,this.absolute=/^~/.test(e),this.path=this.absolute?e.slice(1):e,this.parser=this.path?new nt(this.path):null,this.children=[],this.parent=i.parent,this.checkParents(),this.add(s,i.onAdd,!i.finalSort&&!1!==i.sort),i.finalSort&&this.sortDescendants(),this}return t.prototype.getParentSegments=function(t){return void 0===t&&(t=[]),this.parent&&this.parent.parser?this.parent.getParentSegments(t.concat(this.parent)):t.reverse()},t.prototype.setParent=function(t){this.parent=t,this.checkParents()},t.prototype.setPath=function(t){void 0===t&&(t=""),this.path=t,this.parser=t?new nt(t):null},t.prototype.add=function(e,s,i){var n=this;if(void 0===i&&(i=!0),null==e)return this;if(e instanceof Array)return e.forEach((function(t){return n.add(t,s,i)})),this;if(!(e instanceof t||e instanceof Object))throw new Error("RouteNode.add() expects routes to be an Object or an instance of RouteNode.");if(e instanceof t)e.setParent(this),this.addRouteNode(e,i);else{if(!e.name||!e.path)throw new Error("RouteNode.add() expects routes to have a name and a path defined.");var o=new t(e.name,e.path,e.children,{finalSort:!1,onAdd:s,parent:this,sort:i}),a=o.getParentSegments([o]).map((function(t){return t.name})).join(".");s&&s(B(B({},e),{name:a})),this.addRouteNode(o,i)}return this},t.prototype.addNode=function(e,s){return this.add(new t(e,s)),this},t.prototype.getPath=function(t){var e,s=this.getSegmentsByName(t);return s?(e=s)?e.map((function(t){return t.path})).join(""):null:null},t.prototype.getNonAbsoluteChildren=function(){return this.children.filter((function(t){return!t.absolute}))},t.prototype.sortChildren=function(){var t,e;this.children.length&&(t=this.children,e=t.slice(0),t.sort(rt(e)))},t.prototype.sortDescendants=function(){this.sortChildren(),this.children.forEach((function(t){return t.sortDescendants()}))},t.prototype.buildPath=function(t,e,s){void 0===e&&(e={}),void 0===s&&(s={});var i=this.getSegmentsByName(t);if(!i)throw new Error("[route-node][buildPath] '{routeName}' is not defined");return function(t,e,s){void 0===e&&(e={}),void 0===s&&(s={});for(var i=s.queryParamsMode,n=void 0===i?"default":i,o=s.trailingSlashMode,a=void 0===o?"default":o,r=[],l=[],c=0,d=t;c<d.length;c++){var h=d[c].parser;h&&(r.push.apply(r,h.queryParams),l.push.apply(l,h.urlParams),l.push.apply(l,h.spatParams))}if("loose"===n){var u=Object.keys(e).reduce((function(t,e){return-1===r.indexOf(e)&&-1===l.indexOf(e)?t.concat(e):t}),[]);r.push.apply(r,u)}var p=r.reduce((function(t,s){return-1!==Object.keys(e).indexOf(s)&&(t[s]=e[s]),t}),{}),m=Z(p,s.queryParams),v=t.reduce((function(t,i){var n,o,a=null!=(o=null===(n=i.parser)||void 0===n?void 0:n.build(e,{ignoreSearch:!0,queryParams:s.queryParams,urlParamsEncoding:s.urlParamsEncoding}))?o:"";return i.absolute?a:t+a}),"").replace(/\/\/{1,}/g,"/"),g=v;return"always"===a?g=/\/$/.test(v)?v:v+"/":"never"===a&&"/"!==v&&(g=/\/$/.test(v)?v.slice(0,-1):v),g+(m?"?"+m:"")}(i,e,s)},t.prototype.buildState=function(t,e){void 0===e&&(e={});var s=this.getSegmentsByName(t);return s&&s.length?{name:t,params:e,meta:ot(s)}:null},t.prototype.matchPath=function(t,e){void 0===e&&(e={}),""!==t||e.strictTrailingSlash||(t="/");var s=this.getSegmentsMatchingPath(t,e);if(!s)return null;var i=s.segments;if(i[0].absolute){var n=i[0].getParentSegments();i.reverse(),i.push.apply(i,n),i.reverse()}var o=i[i.length-1].findSlashChild();return o&&i.push(o),function(t){return t&&t.segments&&t.segments.length?{name:t.segments.map((function(t){return t.name})).filter((function(t){return t})).join("."),params:t.params,meta:ot(t.segments)}:null}(s)},t.prototype.addRouteNode=function(t,e){void 0===e&&(e=!0);var s=t.name.split(".");if(1===s.length){if(-1!==this.children.map((function(t){return t.name})).indexOf(t.name))throw new Error('Alias "'+t.name+'" is already defined in route node');if(-1!==this.children.map((function(t){return t.path})).indexOf(t.path))throw new Error('Path "'+t.path+'" is already defined in route node');this.children.push(t),e&&this.sortChildren()}else{var i=this.getSegmentsByName(s.slice(0,-1).join("."));if(!i)throw new Error("Could not add route named '"+t.name+"', parent is missing.");t.name=s[s.length-1],i[i.length-1].add(t)}return this},t.prototype.checkParents=function(){if(this.absolute&&this.hasParentsParams())throw new Error("[RouteNode] A RouteNode with an abolute path cannot have parents with route parameters")},t.prototype.hasParentsParams=function(){if(this.parent&&this.parent.parser){var t=this.parent.parser;return t.hasUrlParams||t.hasSpatParam||t.hasMatrixParams||t.hasQueryParams||this.parent.hasParentsParams()}return!1},t.prototype.findAbsoluteChildren=function(){return this.children.reduce((function(t,e){return t.concat(e.absolute?e:[]).concat(e.findAbsoluteChildren())}),[])},t.prototype.findSlashChild=function(){return this.getNonAbsoluteChildren().filter((function(t){return t.parser&&/^\/(\?|$)/.test(t.parser.path)}))[0]},t.prototype.getSegmentsByName=function(t){var e=[],s=this.parser?[this]:this.children,i=(this.parser?[""]:[]).concat(t.split(".")).every((function(t){var i=function(t,e){var s=e.filter((function(e){return e.name===t}));return s.length?s[0]:void 0}(t,s);return!!i&&(s=i.children,e.push(i),!0)}));return i?e:null},t.prototype.getSegmentsMatchingPath=function(t,e){var s=(this.parser?[this]:this.children).reduce((function(t,e){return t.concat(e,e.findAbsoluteChildren())}),[]),i=at(s,t,{segments:[],params:{}},e);return i&&1===i.segments.length&&""===i.segments[0].name?null:i},t}();var ct=function(t){var e,s=t.Symbol;return"function"==typeof s?s.observable?e=s.observable:(e=s("observable"),s.observable=e):e="@@observable",e}("undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof module?module:Function("return this")()),dt=function(t){return t.split(".").reduce((function(t,e){return t.concat(t.length?t[t.length-1]+"."+e:e)}),[])},ht=function(t){return t&&t.meta&&t.meta.params},ut=function(t,e){return ht(e)&&null!=e.meta.params[t]?Object.keys(e.meta.params[t]).reduce((function(t,s){return t[s]=e.params[s],t}),{}):{}};
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var pt=function(){return pt=Object.assign||function(t){for(var e,s=1,i=arguments.length;s<i;s++)for(var n in e=arguments[s])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t},pt.apply(this,arguments)},mt={trailingSlashMode:"default",queryParamsMode:"default",strictTrailingSlash:!1,autoCleanUp:!0,allowNotFound:!1,strongMatching:!0,rewritePathOnMatch:!0,caseSensitive:!1,urlParamsEncoding:"default"};var vt="NOT_STARTED",gt="NO_START_PATH_OR_STATE",ft="ALREADY_STARTED",bt="ROUTE_NOT_FOUND",wt="SAME_STATES",yt="CANNOT_DEACTIVATE",xt="CANNOT_ACTIVATE",Ct="TRANSITION_ERR",Mt="CANCELLED",kt="@@router5/UNKNOWN_ROUTE",St="$start",Tt="$stop",Et="$$start",Lt="$$cancel",_t="$$success",It="$$error";function Rt(t){var e=0,s=null;return t.getState=function(){return s},t.setState=function(t){s=t},t.makeState=function(s,i,n,o,a){return{name:s,params:pt(pt({},t.config.defaultParams[s]),i),path:n,meta:o?pt(pt({},o),{id:void 0===a?++e:a}):void 0}},t.makeNotFoundState=function(e,s){return t.makeState(kt,{path:e},e,{options:s})},t.areStatesEqual=function(e,s,i){if(void 0===i&&(i=!0),e.name!==s.name)return!1;var n=function(e){return t.rootNode.getSegmentsByName(e).map((function(t){return t.parser.urlParams})).reduce((function(t,e){return t.concat(e)}),[])},o=i?n(e.name):Object.keys(e.params),a=i?n(s.name):Object.keys(s.params);return o.length===a.length&&o.every((function(t){return e.params[t]===s.params[t]}))},t.areStatesDescendants=function(t,e){return!!new RegExp("^"+t.name+"\\.(.*)$").test(e.name)&&Object.keys(t.params).every((function(s){return t.params[s]===e.params[s]}))},t.forwardState=function(e,s){var i=t.config.forwardMap[e]||e;return{name:i,params:pt(pt(pt({},t.config.defaultParams[e]),t.config.defaultParams[i]),s)}},t.buildState=function(e,s){var i=t.forwardState(e,s),n=i.name,o=i.params;return t.rootNode.buildState(n,o)},t}var $t={onStart:St,onStop:Tt,onTransitionSuccess:_t,onTransitionStart:Et,onTransitionError:It,onTransitionCancel:Lt};function At(t){var e=[];function s(e){var s=t.executeFactory(e),i=Object.keys($t).map((function(e){if(s[e])return t.addEventListener($t[e],s[e])})).filter(Boolean);return function(){i.forEach((function(t){return t()})),s.teardown&&s.teardown()}}return t.getPlugins=function(){return e},t.usePlugin=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var n=t.map((function(t){return e.push(t),s(t)}));return function(){e=e.filter((function(e){return-1===t.indexOf(e)})),n.forEach((function(t){return t()}))}},t}function Pt(t){var e=[],s=[];return t.useMiddleware=function(){for(var i=[],n=0;n<arguments.length;n++)i[n]=arguments[n];var o=i.map((function(i){var n=t.executeFactory(i);return e.push(i),s.push(n),function(){e=e.filter((function(t){return t!==i})),s=s.filter((function(t){return t!==n}))}}));return function(){return o.forEach((function(t){return t()}))}},t.clearMiddleware=function(){return e=[],s=[],t},t.getMiddlewareFactories=function(){return e},t.getMiddlewareFunctions=function(){return s},t}function Ht(t){var e={};function s(e){var s="object"==typeof e,i=s?e.next.bind(e):e,n=t.addEventListener(_t,(function(t,e){i({route:t,previousRoute:e})}));return s?{unsubscribe:n}:n}function i(){var t;return(t={subscribe:function(t){if("object"!=typeof t||null===t)throw new TypeError("Expected the observer to be an object.");return s(t)}})[ct]=function(){return this},t}return t.invokeEventListeners=function(t){for(var s=[],i=1;i<arguments.length;i++)s[i-1]=arguments[i];(e[t]||[]).forEach((function(t){return t.apply(void 0,s)}))},t.removeEventListener=function(t,s){e[t]=e[t].filter((function(t){return t!==s}))},t.addEventListener=function(s,i){return e[s]=(e[s]||[]).concat(i),function(){return t.removeEventListener(s,i)}},t.subscribe=s,t[ct]=i,t["@@observable"]=i,t}function Ot(t,e,s){var i=e.isCancelled,n=e.toState,o=e.fromState,a=e.errorKey,r=void 0===a?void 0:a,l=Array.isArray(t)?t:Object.keys(t),c=function(t){return"object"==typeof t&&void 0!==t.name&&void 0!==t.params&&void 0!==t.path},d=function(t,e,s,n){var a=function(t,e){t?n(t):e&&e!==s&&c(e)?(function(t,e){return e.name!==t.name||e.params!==t.params||e.path!==t.path}(e,s)&&console.error("[router5][transition] Warning: state values (name, params, path) were changed during transition process."),n(null,function(t,e){return pt(pt(pt({},e),t),{meta:pt(pt({},e.meta),t.meta)})}(e,s))):n(null,s)},r=t.call(null,s,o,a);i()?a(null):"boolean"==typeof r?a(r?null:e):c(r)?a(null,r):r&&"function"==typeof r.then&&r.then((function(t){t instanceof Error?a({error:t},null):a(null,t)}),(function(t){t instanceof Error?(console.error(t.stack||t),a(pt(pt({},e),{promiseError:t}),null)):a("object"==typeof t?pt(pt({},e),t):e,null)}))},h=function(e,n){var o;if(i())s();else if(e)s(e);else if(l.length){var a="string"==typeof l[0],c=r&&a?((o={})[r]=l[0],o):{},u=a?t[l[0]]:l[0];l=l.slice(1),d(u,c,n,h)}else s(null,n)};h(null,n)}function Ut(t,e,s,i,n){var o=!1,a=!1,r=t.getOptions(),l=t.getLifecycleFunctions(),c=l[0],d=l[1],h=t.getMiddlewareFunctions(),u=function(){return o},p=function(t,e){return pt(pt({},t),e instanceof Object?e:{error:e})},m=e.name===kt,v={isCancelled:u,toState:e,fromState:s},g=function(t,e){var s,i=t.meta&&t.meta&&t.meta.options||{},n=e?dt(e.name):[],o=dt(t.name),a=Math.min(n.length,o.length);s=!e||i.reload?0:ht(e)||ht(t)?function(){var s,i=function(){var i=n[s],a=o[s];if(i!==a)return{value:s};var r=ut(i,t),l=ut(a,e);return Object.keys(r).length!==Object.keys(l).length?{value:s}:0===Object.keys(r).length?"continue":Object.keys(r).some((function(t){return l[t]!==r[t]}))?{value:s}:void 0};for(s=0;s<a;s+=1){var r=i();if("object"==typeof r)return r.value}return s}():0;var r=n.slice(s).reverse(),l=o.slice(s);return{intersection:e&&s>0?n[s-1]:"",toDeactivate:r,toActivate:l}}(e,s),f=g.toDeactivate,b=g.toActivate,w=!s||i.forceDeactivate?[]:function(t,e,s){var i=f.filter((function(t){return c[t]})).reduce((function(t,e){var s;return pt(pt({},t),((s={})[e]=c[e],s))}),{});Ot(i,pt(pt({},v),{errorKey:"segment"}),(function(t){return s(t?p({code:yt},t):null)}))},y=m?[]:function(t,e,s){var i=b.filter((function(t){return d[t]})).reduce((function(t,e){var s;return pt(pt({},t),((s={})[e]=d[e],s))}),{});Ot(i,pt(pt({},v),{errorKey:"segment"}),(function(t){return s(t?p({code:xt},t):null)}))},x=h.length?function(t,e,s){return Ot(h,pt({},v),(function(e,i){return s(e?p({code:Ct},e):null,i||t)}))}:[];return Ot([].concat(w).concat(y).concat(x),v,(function(s,i){if(a=!0,!u()){if(!s&&r.autoCleanUp){var o=dt(e.name);Object.keys(c).forEach((function(e){-1===o.indexOf(e)&&t.clearCanDeactivate(e)}))}n(s,i||e)}})),function(){o||a||(o=!0,n({code:Mt},null))}}var Bt=function(){};function Dt(t){var e;function s(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];var n=e[0],o=e[e.length-1],a="function"==typeof o?o:Bt,r="object"==typeof e[1]?e[1]:{},l="object"==typeof e[2]?e[2]:{};if(t.isStarted()){var c=t.buildState(n,r);if(!c)return a(d={code:bt}),void t.invokeEventListeners(It,null,t.getState(),d);var d,h=t.makeState(c.name,c.params,t.buildPath(c.name,c.params),{params:c.meta,options:l}),u=!!t.getState()&&t.areStatesEqual(t.getState(),h,!1);if(u&&!l.reload&&!l.force)return a(d={code:wt}),void t.invokeEventListeners(It,h,t.getState(),d);var p=t.getState();return l.skipTransition?(a(null,h),Bt):t.transitionToState(h,p,l,(function(e,i){if(e)if(e.redirect){var n=e.redirect;s(n.name,n.params,pt(pt({},l),{force:!0,redirected:!0}),a)}else a(e);else t.invokeEventListeners(_t,i,p,l),a(null,i)}))}a({code:vt})}return t.navigate=s,t.navigate=s,t.navigateToDefault=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];var n="object"==typeof e[0]?e[0]:{},o=2===e.length?e[1]:"function"==typeof e[0]?e[0]:Bt,a=t.getOptions();return a.defaultRoute?s(a.defaultRoute,a.defaultParams,n,o):function(){}},t.cancel=function(){return e&&(e("navigate"),e=null),t},t.transitionToState=function(s,i,n,o){return void 0===n&&(n={}),void 0===o&&(o=Bt),t.cancel(),t.invokeEventListeners(Et,s,i),e=Ut(t,s,i,n,(function(n,a){e=null,a=a||s,n?(n.code===Mt?t.invokeEventListeners(Lt,s,i):t.invokeEventListeners(It,s,i,n),o(n)):(t.setState(a),o(null,a))}))},t}var zt=function(){};function Vt(t){var e=!1;return t.isStarted=function(){return e},t.start=function(){for(var s=[],i=0;i<arguments.length;i++)s[i]=arguments[i];var n,o,a=t.getOptions(),r=s[s.length-1],l="function"==typeof r?r:zt,c="function"!=typeof s[0]?s[0]:void 0;if(e)return l({code:ft}),t;e=!0,t.invokeEventListeners(St);var d=function(e,s,i){void 0===i&&(i=!0),e||t.invokeEventListeners(_t,s,null,{replace:!0}),e&&i&&t.invokeEventListeners(It,s,null,e),l(e,s)};if(void 0===c&&!a.defaultRoute)return d({code:gt});if("string"==typeof c?n=c:"object"==typeof c&&(o=c),o)t.setState(o),d(null,o);else{o=void 0===n?null:t.matchPath(n);var h=function(){return t.navigateToDefault({replace:!0},l)},u=function(e){return t.navigate(e.name,e.params,{replace:!0,reload:!0,redirected:!0},l)},p=function(e){t.transitionToState(e,t.getState(),{},(function(t,e){t?t.redirect?u(t.redirect):a.defaultRoute?h():d(t,null,!1):d(null,e)}))};o?p(o):a.defaultRoute?h():a.allowNotFound?p(t.makeNotFoundState(n,{replace:!0})):d({code:bt,path:n},null)}return t},t.stop=function(){return e&&(t.setState(null),e=!1,t.invokeEventListeners(Tt)),t},t}var jt=function(t){return"function"==typeof t?t:function(){return function(){return t}}};function Nt(t){var e={},s={},i={},n={};return t.getLifecycleFactories=function(){return[e,s]},t.getLifecycleFunctions=function(){return[i,n]},t.canDeactivate=function(s,n){var o=jt(n);return e[s]=o,i[s]=t.executeFactory(o),t},t.clearCanDeactivate=function(s){return e[s]=void 0,i[s]=void 0,t},t.canActivate=function(e,i){var o=jt(i);return s[e]=o,n[e]=t.executeFactory(o),t},t}var Ft=function(t,e,s){void 0===t&&(t=[]),void 0===e&&(e={}),void 0===s&&(s={});return function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(e){return t.reduce((function(t,e){return e(t)}),e)}}(function(t){return function(e){var s=pt(pt({},mt),t);return e.getOptions=function(){return s},e.setOption=function(t,i){return s[t]=i,e},e}}(e),function(t){return function(e){var s=t;return e.setDependency=function(t,i){return s[t]=i,e},e.setDependencies=function(t){return Object.keys(t).forEach((function(s){return e.setDependency(s,t[s])})),e},e.getDependencies=function(){return s},e.getInjectables=function(){return[e,e.getDependencies()]},e.executeFactory=function(t){return t.apply(void 0,e.getInjectables())},e}}(s),Ht,Rt,Vt,Nt,Dt,At,Pt,function(t){return function(e){e.forward=function(t,s){return e.config.forwardMap[t]=s,e};var s=t instanceof lt?t:new lt("","",t,{onAdd:i});function i(t){t.canActivate&&e.canActivate(t.name,t.canActivate),t.forwardTo&&e.forward(t.name,t.forwardTo),t.decodeParams&&(e.config.decoders[t.name]=t.decodeParams),t.encodeParams&&(e.config.encoders[t.name]=t.encodeParams),t.defaultParams&&(e.config.defaultParams[t.name]=t.defaultParams)}return e.rootNode=s,e.add=function(t,n){return s.add(t,i,!n),n&&s.sortDescendants(),e},e.addNode=function(t,i,n){return s.addNode(t,i),n&&e.canActivate(t,n),e},e.isActive=function(t,s,i,n){void 0===s&&(s={}),void 0===i&&(i=!1),void 0===n&&(n=!0);var o=e.getState();return!!o&&(i||o.name===t?e.areStatesEqual(e.makeState(t,s),o,n):e.areStatesDescendants(e.makeState(t,s),o))},e.buildPath=function(t,s){if(t===kt)return s.path;var i=pt(pt({},e.config.defaultParams[t]),s),n=e.getOptions(),o=n.trailingSlashMode,a=n.queryParamsMode,r=n.queryParams,l=e.config.encoders[t]?e.config.encoders[t](i):i;return e.rootNode.buildPath(t,l,{trailingSlashMode:o,queryParamsMode:a,queryParams:r,urlParamsEncoding:e.getOptions().urlParamsEncoding})},e.matchPath=function(t,s){var i=e.getOptions(),n=e.rootNode.matchPath(t,i);if(n){var o=n.name,a=n.params,r=n.meta,l=e.config.decoders[o]?e.config.decoders[o](a):a,c=e.forwardState(o,l),d=c.name,h=c.params,u=!1===i.rewritePathOnMatch?t:e.buildPath(d,h);return e.makeState(d,h,u,{params:r,source:s})}return null},e.setRootPath=function(t){e.rootNode.setPath(t)},e}}(t))({config:{decoders:{},encoders:{},defaultParams:{},forwardMap:{}}})},Gt=function(){return Gt=Object.assign||function(t){for(var e,s=1,i=arguments.length;s<i;s++)for(var n in e=arguments[s])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t},Gt.apply(this,arguments)};function qt(){for(var t=0,e=0,s=arguments.length;e<s;e++)t+=arguments[e].length;var i=Array(t),n=0;for(e=0;e<s;e++)for(var o=arguments[e],a=0,r=o.length;a<r;a++,n++)i[n]=o[a];return i}var Zt=function(t){return function(){return t}},Wt=function(){},Kt="undefined"!=typeof window&&window.history,Xt=function(t){try{return encodeURI(decodeURI(t))}catch(e){return t}},Yt=Kt?{getBase:function(){return window.location.pathname},pushState:function(t,e,s){return window.history.pushState(t,e,s)},replaceState:function(t,e,s){return window.history.replaceState(t,e,s)},addPopstateListener:function(t,e){var s=e.useHash&&!(-1===window.navigator.userAgent.indexOf("Trident"));return window.addEventListener("popstate",t),s&&window.addEventListener("hashchange",t),function(){window.removeEventListener("popstate",t),s&&window.removeEventListener("hashchange",t)}},getLocation:function(t){var e=t.useHash?window.location.hash.replace(new RegExp("^#"+t.hashPrefix),""):window.location.pathname.replace(new RegExp("^"+t.base),"");return(Xt(e)||"/")+window.location.search},getState:function(){return window.history.state},getHash:function(){return window.location.hash}}:{getBase:Zt(""),pushState:Wt,replaceState:Wt,addPopstateListener:Wt,getLocation:Zt(""),getState:Zt(null),getHash:Zt("")},Jt={forceDeactivate:!0,useHash:!1,hashPrefix:"",base:"",mergeState:!1,preserveHash:!0},Qt="popstate";function te(t,e){void 0===e&&(e=Yt);var s,i=Gt(Gt({},Jt),t),n={forceDeactivate:i.forceDeactivate,source:Qt};return function(t){var o=t.getOptions(),a=t.start;t.buildUrl=function(e,s){return(i.base||"")+(i.useHash?"#"+i.hashPrefix:"")+t.buildPath(e,s)};function r(t,s,n){var o=t?{meta:t.meta,name:t.name,params:t.params,path:t.path}:t,a=!0===i.mergeState?Gt(Gt({},e.getState()),o):o;n?e.replaceState(a,"",s):e.pushState(a,"",s)}function l(s){var a=t.getState(),l=!s.state||!s.state.name,c=l?t.matchPath(e.getLocation(i),Qt):t.makeState(s.state.name,s.state.params,s.state.path,Gt(Gt({},s.state.meta),{source:Qt}),s.state.meta.id),d=o.defaultRoute,h=o.defaultParams;c?a&&t.areStatesEqual(c,a,!1)||t.transitionToState(c,a,n,(function(e,s){if(e)if(e.redirect){var i=e.redirect,o=i.name,u=i.params;t.navigate(o,u,Gt(Gt({},n),{replace:!0,force:!0,redirected:!0}))}else if(e.code===yt){var p=t.buildUrl(a.name,a.params);l||r(c,p,!0)}else d&&t.navigate(d,h,Gt(Gt({},n),{reload:!0,replace:!0}));else t.invokeEventListeners(_t,s,a,{replace:!0})})):d&&t.navigateToDefault(Gt(Gt({},n),{reload:!0,replace:!0}))}function c(){s&&(s(),s=void 0)}return t.matchUrl=function(e){return t.matchPath(function(t){var e=t.match(/^(?:http|https):\/\/(?:[0-9a-z_\-.:]+?)(?=\/)(.*)$/),s=(e?e[1]:t).match(/^(.+?)(#.+?)?(\?.+)?$/);if(!s)throw new Error("[router5] Could not parse url "+t);var n=s[1],o=s[2]||"",a=s[3]||"";return(i.useHash?o.replace(new RegExp("^#"+i.hashPrefix),""):i.base?n.replace(new RegExp("^"+i.base),""):n)+a}(e))},t.start=function(){for(var s=[],n=0;n<arguments.length;n++)s[n]=arguments[n];return 0===s.length||"function"==typeof s[0]?a.apply(void 0,qt([e.getLocation(i)],s)):a.apply(void 0,s),t},t.replaceHistoryState=function(s,i,n){void 0===i&&(i={}),void 0===n&&(n="");var o=t.buildState(s,i),a=t.makeState(o.name,o.params,t.buildPath(o.name,o.params),{params:o.meta}),r=t.buildUrl(s,i);t.lastKnownState=a,e.replaceState(a,n,r)},{onStart:function(){i.useHash&&!i.base&&(i.base=e.getBase()),s=e.addPopstateListener(l,i)},onStop:c,teardown:c,onTransitionSuccess:function(s,n,o){var a=e.getState(),l=a&&a.meta&&a.name&&a.params,c=n&&t.areStatesEqual(n,s,!1),d=o.replace||!l||c,h=t.buildUrl(s.name,s.params);null===n&&!1===i.useHash&&!0===i.preserveHash&&(h+=e.getHash()),r(s,h,d)},onPopState:l}}}class ee{static get router(){return this.router_}static get route(){let t=null;const e=this.router_;return e&&(t=e.getState()),t}static useBrowser(t){if(!Array.isArray(t)||!t.length)return void(this.event$=s.EMPTY);this.routes=t;const e=Ft(t,{allowNotFound:!1,autoCleanUp:!0,defaultRoute:"index",defaultParams:{},queryParams:{arrayFormat:"default",nullFormat:"default",booleanFormat:"default"},queryParamsMode:"default",trailingSlashMode:"default",strictTrailingSlash:!1,caseSensitive:!1,urlParamsEncoding:"default"});this.router_=e,e.usePlugin(te({useHash:!1})),e.start(),this.event$=s.from(e).pipe(i.startWith({route:e.getState(),previousRoute:null}))}static useBrowser$(t){return this.useBrowser(t),this.event$}static setRouterLink(t,e,s){void 0===t&&(t="it.access"),void 0===e&&(e=null),void 0===s&&(s={reload:!0});const i=this.router_;if(i)try{i.navigate(t,e,s)}catch(t){console.log("RouterService.setRouterLink.error",t)}}static replaceHistoryState(t,e){const s=this.router_;if(s)try{s.replaceHistoryState(t,e)}catch(t){console.log("RouterService.replaceHistoryState.error",t)}}static setCurrentParams(t){const e=this.router_;if(e)try{const s=this.route;s&&e.replaceHistoryState(s.name,t)}catch(t){console.log("RouterService.setCurrentParams.error",t)}}static buildPath(t,e){void 0===e&&(e=null);let s=null;const i=this.router_;if(i)try{s=i.buildPath(t,e)}catch(t){console.log("RouterService.buildPath.error",t)}return s}static buildUrl(t,e){void 0===e&&(e=null);let s=null;const i=this.router_;if(i)try{s=i.buildUrl(t,e)}catch(t){console.log("RouterService.buildUrl.error",t)}return s}static isActive(t,e,s,i){void 0===s&&(s=!1),void 0===i&&(i=!0);let n=!1;const o=this.router_;if(o)try{n=o.isActive(t,e,s,i)}catch(t){console.log("RouterService.isActive.error",t)}return n}}ee.routes=[],ee.router_=null;class se{static set state(t){this.state$.next(t)}static get state(){return this.state$.getValue()}static patchState(t){t=Object.assign({},this.state,t),this.state=t}}se.state$=new s.BehaviorSubject({});const ie={Publisher:"publisher",Attendee:"attendee",Streamer:"streamer",Viewer:"viewer",SmartDevice:"smart-device",SelfService:"self-service",Embed:"embed"};class ne{constructor(t){t&&Object.assign(this,t)}}const oe=/^\d{9}-\d{4}-\d{13}(-\d+)?$/;class ae{get roleIndex(){return ae.getRoleIndex(this.role)}set roleIndex(t){if(ae.getRoleIndex(this.role)!==t){const e=Object.keys(ie)[t];this.role=ie[e]}}constructor(t){if(this.userId=se.state.user?se.state.user.id:0,this.role=se.state.role||ie.Viewer,this.timestamp=(new Date).valueOf().toString(),this.pathId=null,"string"==typeof t){if(!t.match(oe))return console.warn("MeetingId","invalid meetingId",t),null;t=ae.decompose(t)}"object"==typeof t&&(t.id&&(this.id=t.id),t.userId&&(this.userId=t.userId),t.role&&(this.role=t.role),t.roleIndex&&(this.roleIndex=t.roleIndex),t.timestamp&&(this.timestamp=t.timestamp),t.pathId&&(this.pathId=t.pathId))}toString(){return ae.compose(this.userId,this.roleIndex,this.timestamp,this.pathId)}toRoles(){const t=this.userId,e=this.timestamp,s=this.pathId;return{id:ae.compose(t,ae.getRoleIndex(ie.Publisher),e,s),idAttendee:ae.compose(t,ae.getRoleIndex(ie.Attendee),e,s),idStreamer:ae.compose(t,ae.getRoleIndex(ie.Streamer),e,s),idViewer:ae.compose(t,ae.getRoleIndex(ie.Viewer),e,s),idSmartDevice:ae.compose(t,ae.getRoleIndex(ie.SmartDevice),e,s),idSelfService:ae.compose(t,ae.getRoleIndex(ie.SelfService),e,s)}}static compose(t,e,s,i){return`${ae.padded(t,9)}-${ae.padded(e,4)}-${s}${i?`-${i}`:""}`}static decompose(t){const e=t.split("-");return{userId:parseInt(e[0]),roleIndex:parseInt(e[1]),timestamp:parseInt(e[2]),pathId:e[3]?parseInt(e[3]):null}}static generateMeetingId(){return(new ae).toRoles()}static getRoleIndex(t){return Object.keys(ie).reduce(((e,s,i)=>ie[s]===t?i:e),-1)}static padded(t,e){const s="000000000"+t;return s.substr(s.length-e)}}class re{get meetingId(){return this.link?new ae(this.link):null}constructor(t){if("string"==typeof(t=t||window.location.href)&&(t=re.decompose(t)),"object"==typeof t){if(Object.assign(this,t),t.user){const e=re.getName(t.user);if(e&&(this.name=e),U.flags.useExtendedUserInfo){const e=re.getFirstName(t.user);e&&(this.firstName=e);const s=re.getLastName(t.user);s&&(this.lastName=s);const i=re.getEmail(t.user);i&&(this.email=i)}}t.name&&(this.name=t.name),U.flags.useExtendedUserInfo&&(t.firstName&&(this.firstName=t.firstName),t.lastName&&(this.lastName=t.lastName),t.email&&(this.email=t.email))}this.link=this.link||null,this.name=this.name||null,this.firstName=this.firstName||null,this.lastName=this.lastName||null,this.email=this.email||null,this.role=this.role||null,this.viewId=this.viewId||null,this.pathId=this.pathId||null,this.embedViewId=this.embedViewId||null,this.support=this.support||!1}toParams(t){void 0===t&&(t=!1);let e={};return this.link&&(e.link=this.link),U.flags.useExtendedUserInfo?(this.firstName&&(e.firstName=this.firstName),this.lastName&&(e.lastName=this.lastName),this.email&&(e.email=this.email)):this.name&&(e.name=this.name),this.role&&!t&&(e.role=this.role),this.viewId&&(e.viewId=this.viewId),this.pathId&&(e.pathId=this.pathId),this.support&&(e.support=this.support),U.flags.useEncryptedUrl&&(e={p:re.encrypt(e)}),e}toString(t){let e;return void 0===t&&(t=!1),e=U.flags.useExtendedUserInfo?{link:this.link,firstName:this.firstName,lastName:this.lastName,email:this.email,role:t?null:this.role,viewId:this.viewId,pathId:this.pathId,support:this.support}:{link:this.link,name:this.name,role:t?null:this.role,viewId:this.viewId,pathId:this.pathId,support:this.support},re.compose(e)}toUrl(){const t=this.toParams();return re.getCurrentUrl(t)}toAccessCodeUrl(){const t=this.toParams();return re.getAccessCodeUrl(t)}toGuidedTourUrl(){const t=this.toParams();return re.getGuidedTourUrl(t)}copyToClipBoard(t){void 0===t&&(t=!1);const e=document.createElement("input");e.style.position="absolute",e.style.top="1000vh",document.querySelector("body").appendChild(e);const s=this.toParams(!0);e.value=window.location.origin+(t?re.getAccessCodeUrl(s):re.getGuidedTourUrl(s)),e.focus(),e.select(),e.setSelectionRange(0,99999),document.execCommand("copy"),e.parentNode.removeChild(e),alert(`link copiato!\n ${e.value}`)}replaceUrl(){ee.setCurrentParams(this.toParams())}static replaceWithOptions(t){const e=re.decompose(window.location.href),s=new re(Object.assign(e,t));return s.replaceUrl(),s}static replaceWithUser(t){return this.replaceWithOptions({user:t})}static replaceWithName(t){return this.replaceWithOptions({name:t})}static replaceWithLink(t){return this.replaceWithOptions({link:t})}static getCurrentUrl(t){void 0===t&&(t=null);const e=ee.route;if(e){const s=e.name;return ee.buildUrl(s,t)}}static getAccessCodeUrl(t){void 0===t&&(t=null);const e=ee.route;if(e){const s=`${e.params.lang}.accessCode`;return ee.buildUrl(s,t)}}static getGuidedTourUrl(t){void 0===t&&(t=null);const e=ee.route;if(e){const s=`${e.params.lang}.guidedTour`;return ee.buildUrl(s,t)}}static getName(t){return t&&t.firstName&&t.lastName?`${t.firstName} ${t.lastName}`:null}static getFirstName(t){return t&&t.firstName?t.firstName:null}static getLastName(t){return t&&t.lastName?t.lastName:null}static getEmail(t){return t&&t.email?t.email:null}static compose(t){if(U.flags.useEncryptedUrl){return`?p=${re.encrypt(t)}`}return`?${(t=Object.keys(t).map((e=>({key:e,value:t[e]}))).filter((t=>null!=t.value&&!1!==t.value)).map((t=>`${t.key}=${t.value}`))).join("&")}`}static decompose(t){let e={};if(U.flags.useEncryptedUrl){const s=new URLSearchParams(t.split("?")[1]);s.has("p")&&(e=re.decrypt(s.get("p")))}else if(t.indexOf("?")>-1){new URLSearchParams(t.split("?")[1]).forEach(((t,s)=>{switch(s){case"viewId":case"pathId":case"embedViewId":t=t?parseInt(t):null;break;case"support":t=!!t&&"true"===t}e[s]=t}))}return e}static decrypt(t){return JSON.parse(window.atob(t))}static encrypt(t){return window.btoa(JSON.stringify(t))}static validateParams(t){if(U.flags.useEncryptedUrl){return{p:re.encrypt(t)}}return t}}class le extends t.Structure{getFactory(t){let e=null;const s=ee.routes.find((e=>e.name===t.name));return s&&(e=s.factory),e}onInit(){this.route$().pipe(i.switchMap((t=>this.factory$(t))),i.takeUntil(this.unsubscribe$)).subscribe((t=>{}))}route$(){return ee.event$.pipe(i.map((t=>{const e=t.route;return this.route=e,e})))}factory$(e){const n=this.getFactory(e),{module:o,node:a}=t.getContext(this);return this.factory_=n,s.of(n).pipe(i.tap((()=>{this.element&&(this.element.parentNode.removeChild(this.element),o.remove(this.element,this),this.element=void 0,this.instance=void 0)})),i.map((()=>{if(n&&n.meta.template){let t=document.createElement("div");t.innerHTML=n.meta.template,1===t.children.length&&(t=t.firstElementChild),a.appendChild(t);const s=o.makeInstance(t,n,n.meta.selector,this,void 0,{route:e});return o.compile(t,s),this.instance=s,this.element=t,{element:t,instance:s}}})))}onChanges(){}}le.meta={selector:"router-outlet,[router-outlet]",hosts:{host:le}};class ce extends t.Component{onInit(){this.state={};const e=new re;if(e.link){const s=e.toGuidedTourUrl(),{node:i}=t.getContext(this);new QRious({element:i.querySelector(".qrcode"),value:s,size:256})}else window.location.href=window.location.origin+re.getGuidedTourUrl()}}function de(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function he(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?de(Object(s),!0).forEach((function(e){ue(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):de(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function ue(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}ce.meta={selector:"[access-code-component]",hosts:{host:le},template:`\n\t\t<div class="page page--access-code">\n\t\t\t${g}\n\t\t\t\x3c!-- access-code --\x3e\n\t\t\t<div class="ui ui--info ui--info-centered">\n\t\t\t\t<div class="group--info">\n\t\t\t\t\t<div class="group--info__content stagger--childs">\n\t\t\t\t\t\t<div class="title" [innerHTML]="'access_code_title' | label"></div>\n\t\t\t\t\t\t<div class="picture">\n\t\t\t\t\t\t\t<canvas class="qrcode"></canvas>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t${f}\n\t\t\t${b}\n\t\t\t${y}\n\t\t</div>\n\t`};class pe extends t.Component{get group(){if(this.formGroup)return this.formGroup;if(!this.host)throw"missing form collection";return this.host.control}getControl(t){return this.group.get(t)}}function me(t){return new e.FormGroup(function(t){const s=t.reduce(((t,s,i)=>{const n=[];if(s.required&&n.push("checkbox"===s.type?e.Validators.RequiredTrueValidator():e.Validators.RequiredValidator()),"email"===s.type&&n.push(e.Validators.EmailValidator()),"url"===s.type&&n.push(e.Validators.PatternValidator("(https?://(?:www.|(?!www))[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9].[^s]{2,}|www.[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9].[^s]{2,}|https?://(?:www.|(?!www))[a-zA-Z0-9]+.[^s]{2,}|www.[a-zA-Z0-9]+.[^s]{2,})")),null!=s.pattern&&n.push(e.Validators.PatternValidator(s.pattern)),t[s.name]=new e.FormControl(null!=s.value?s.value:null,n),"select"===s.type||"custom-select"===s.type){const e=(s.options||[]).slice();e.unshift({id:null,name:"select"}),t[s.name].options=e}return t}),{});return s}(t))}function ve(t,e){const s=t.reduce(((t,e,s)=>(e.test&&(t[e.name]=e.test),t)),{});e.patch(s)}pe.meta={selector:"[controls]",inputs:["formGroup","fields"],hosts:{host:e.FormAbstractCollectionDirective},template:'\n\t\t<div *for="let field of fields">\n\t\t\t<div *if="[\'text\', \'email\', \'url\'].indexOf(field.type) !== -1" control-text [control]="getControl(field.name)" [label]="field.label | label"></div>\n\t\t\t<div *if="field.type == \'select\'" control-select [control]="getControl(field.name)" [label]="field.label | label"></div>\n\t\t\t<div *if="field.type == \'custom-select\'" control-custom-select [control]="getControl(field.name)" [label]="field.label | label"></div>\n\t\t\t<div *if="field.type == \'textarea\'" control-textarea [control]="getControl(field.name)" [label]="field.label | label"></div>\n\t\t\t<div *if="field.type == \'checkbox\'" control-checkbox [control]="getControl(field.name)" [label]="field.label | label"></div>\n\t\t\t<input *if="field.type == \'hidden\'" [name]="field.name" [formControl]="getControl(field.name)" value="" type="text" style="display:none !important;" />\n\t\t</div>\n\t'};class ge extends t.Pipe{static get labels(){return U.labels}static transform(t){if("@copy"===t)return this.getCopy();const e=ge.labels;let s=null!=e[t]?e[t]:t;return"string"==typeof s&&-1!==s.indexOf("@copy")&&(s=s.replace("@copy",this.getCopy())),s}static getKeys(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];return ge.transform(e.map((t=>t.replace("-","_"))).join("_"))}static getCopy(){return`©${(new Date).getFullYear()}`}}ge.meta={name:"label"};class fe{static has(t){return new URLSearchParams(window.location.search).has(t)}static get(t){return new URLSearchParams(window.location.search).get(t)}static set(t,e){const s=new URLSearchParams(window.location.search);"string"==typeof t?s.set(t,e):s.set(t,""),this.pushParams(s)}static delete(t){const e=new URLSearchParams(window.location.search);e.has(t)&&(e.delete(t),this.pushParams(e))}static pushParams(t){if(window.history&&window.history.pushState){const e=document.title,s=`${window.location.href.split("?")[0]}?${t.toString()}`;window.history.pushState(t.toString(),e,s)}}static replace(t,e){const s=window.history;if(s&&s.replaceState){const i=window.location,n=document.title;if("/"===i.pathname){const t=i.origin+e+i.search;s.replaceState(s.state,n,t)}else if(-1!==i.href.indexOf(t)){const o=i.href.replace(t,e);s.replaceState(s.state,n,o)}}}static deserialize(t){const e=this.get("params");return this.decode(t,e)}static serialize(t,e){const s=this.deserialize(),i=this.encode(t,e,s);this.set("params",i)}static decode(t,e){let s=null;if(e){const t=window.atob(e);s=JSON.parse(t)}return t&&s&&(s=s[t]),s||null}static encode(t,e,s){s=s||{};let i=null;"string"==typeof t?s[t]=e:s=t;const n=JSON.stringify(s);return i=window.btoa(n),i}}class be{static get lang(){return this.lang$.getValue()}static set lang(t){this.lang!==t&&this.lang$.next(t)}static setAlternates(t,e){this.languages=e,this.lang=t}static setRoute(t,e){const s=t.params.lang,i=U.languages.map((i=>{const n="it"===i?"Italiano":"English",o=t.name.replace(new RegExp(`(^${s}$)|(^${s}.)`),((t,e,s,n)=>e?i:`${i}.`)),a=e.find((t=>t.name===o));return a?{name:a.name,params:t.params,href:a.path,lang:a.defaultParams.lang,title:n}:null})).filter((t=>null!==t));this.setAlternates(s,i)}static get hasLanguages(){return this.languages.length>1}static get activeLanguage(){return this.languages.find((t=>t.lang===this.lang))}static getDefaultLanguages(){return U.alternates||[]}static getDefaultLanguage(){return U.defaultLanguage||(this.languages?this.languages[0].lang:null)}static setLanguage(t){this.lang=t.lang}static setLanguage$(t){if("string"==typeof t&&(t=this.languages.find((e=>e.lang===t))),!t)return;const e=U.flags.production?`/api/${t.lang}/labels/`:`./api/${t.lang}/labels.json`;return s.from(fetch(e).then((t=>t.json()))).pipe(i.tap((e=>{U.labels=e,ee.replaceHistoryState(t.name,t.params);const s=this.activeLanguage.href.split("?")[0],i=t.href.split("?")[0];fe.replace(s,i),this.lang=t.lang})))}static setLanguage$_(t){return s.from(fetch(t.href).then((t=>t.text()))).pipe(i.tap((e=>{const s=/(window\.labels\s*=\s*\n*\s*\{((\{.+?\})|.)+?\})/gms.exec(e);s&&(new Function(s[0]).call(window),ge.setLabels());const i=/(window\.bhere\s*=\s*\n*\s*\{((\{.+?\})|.)+?\})/gms.exec(e);if(i){const t={};new Function(i[0].replace("window","this")).call(t),t.bhere&&S.merge(U,t.bhere)}fe.replace(this.activeLanguage.href,t.href),this.lang=t.lang})))}static toggleLanguages(){this.showLanguages=!this.showLanguages,this.pushChanges()}}be.languages=be.getDefaultLanguages(),be.lang$=new s.BehaviorSubject(be.getDefaultLanguage());class we extends t.Pipe{static transform(t){return t.replace(":lang",be.lang)}}we.meta={name:"route"};const ye=[["480p_1",640,480,15,500,!0],["480p_2",640,480,30,1e3,!0],["480p_3",480,480,15,400,!0],["480p_4",640,480,30,750,!0],["480p_6",480,480,30,600,!0],["480p_8",848,480,15,610,!0],["480p_9",848,480,30,930,!0],["480p_10",640,480,10,400,!0],["720p_1",1280,720,15,1130,!0],["720p_2",1280,720,30,2e3,!0],["720p_3",1280,720,30,1710,!0],["720p_5",960,720,15,910,!0],["720p_6",960,720,30,1380,!0],["1080p_1",1920,1080,15,2080,!1],["1080p_2",1920,1080,30,3e3,!1],["1080p_3",1920,1080,30,3150,!1],["1080p_5",1920,1080,60,4780,!1]].map((t=>({profile:t[0],resolution:{width:t[1],height:t[2]},frameRate:{min:t[3],max:t[3]},bitrate:{min:t[4],max:t[4]},compatible:t[5]})));function xe(t){return t.role===ie.Publisher||t.role===ie.SmartDevice?ye.find((t=>t.profile===U.profiles.publisher)):ye.find((t=>t.profile===U.profiles.streamer))}const Ce="idle",Me="checklist",ke="link",Se="login",Te="name",Ee="device",Le="should-connect",_e="connecting",Ie="connected",Re="agoraEvent",$e="channelMembers",Ae="supportRequest",Pe="supportRequestAccepted",He="supportRequestRejected",Oe="requestControl",Ue="requestControlAccepted",Be="requestControlRejected",De="requestControlDismiss",ze="requestControlDismissed",Ve="requestPeerInfo",je="requestPeerInfoResult",Ne="requestInfo",Fe="requestInfoResult",Ge="requestInfoDismiss",qe="requestInfoDismissed",Ze="requestInfoRejected",We="remoteSilencing",Ke="controlInfo",Xe="addLike",Ye="showPanel",Je="playMedia",Qe="zoomMedia",ts="currentTimeMedia",es="playModel",ss="mode",is="navInfo",ns="navToView",os="navToGrid",as="navLink",rs="navLinkClose",ls="vrStarted",cs="vrEnded",ds="vrState",hs="menuToggle",us="chatMessage",ps="chatTypingBegin",ms="chatTypingEnd",vs="selectItem",gs="virtual-tour",fs="live-meeting",bs="self-service-tour",ws="embed",ys="none";class xs{constructor(t){Object.assign(this,t)}}class Cs extends xs{}class Ms extends xs{}class ks extends xs{}class Ss extends xs{}class Ts extends xs{}class Es extends xs{}class Ls extends xs{}class _s{static http$(t,e,n,o){let a=null;return s.from(fetch(e,{method:t,headers:{Accept:"application/json","Content-Type":"application/json"},body:-1!==["POST","PUT","PATCH"].indexOf(t)?JSON.stringify(n):void 0}).then((t=>{a=t;try{const e=t.headers.get("content-type");let s;return s=e&&-1!==e.indexOf("application/json")?t.json():t.text(),t.ok?s:s.then((t=>Promise.reject(t)))}catch(e){return t.ok?(console.warn("HttpService.http$","Cannot parse response"),Promise.resolve()):Promise.reject(e)}}))).pipe(i.catchError((t=>s.throwError(this.getError(t,a)))))}static get$(t,e,s){const i=this.query(e);return this.http$("GET",`${t}${i}`,void 0,s)}static delete$(t){return this.http$("DELETE",t)}static post$(t,e){return this.http$("POST",t,e)}static put$(t,e){return this.http$("PUT",t,e)}static patch$(t,e){return this.http$("PATCH",t,e)}static query(t){return""}static getError(t,e){let s="object"==typeof t?t:{};return s.status||(s.status=e?e.status:0),s.statusCode||(s.statusCode=e?e.status:0),s.statusMessage||(s.statusMessage=e?e.statusText:t),s}}class Is{static setUser(t){this.user$.next(t)}static me$(){return _s.get$("/api/user/me").pipe(i.map((t=>this.mapUser(t))),i.catchError((t=>{if(404===t.status||404===t.statusCode)return s.of(null);throw t})),i.switchMap((t=>(this.setUser(t),this.user$))))}static login$(t){return _s.post$("/api/user/login",t).pipe(i.map((t=>this.mapUser(t))),i.tap((t=>this.setUser(t))))}static logout$(){return _s.get$("/api/user/logout").pipe(i.map((t=>this.mapUser(t))),i.tap((t=>this.setUser(null))))}static guidedTour$(t){return _s.post$("/api/user/guided-tour",t).pipe(i.map((t=>this.mapUser(t))),i.tap((t=>this.setUser(t))))}static selfServiceTour$(t){return _s.post$("/api/user/self-service-tour",t).pipe(i.map((t=>this.mapUser(t))),i.tap((t=>this.setUser(t))))}static selfServiceSupportRequest$(t,e,s){const n={user:t,meetingId:e,link:s};return _s.post$("/api/user/self-service-support-request",n).pipe(i.tap((e=>{U.flags.production||fetch(U.template.email.supportRequest).then((t=>t.text())).then((e=>{e=(e=e.replace("{{username}}",re.getName(t))).replace("{{href}}",s);const i=(new DOMParser).parseFromString(e,"text/html");setTimeout((()=>{const t=window.open();t.document.head.innerHTML=i.querySelector("head").innerHTML,t.document.body.innerHTML=i.querySelector("body").innerHTML}),3e3)}))})))}static resolve$(t,e){return"login"===e?this.login$(t):"guided-tour"===e?this.guidedTour$(t):"self-service-tour"===e?this.selfServiceTour$(t):void 0}static log$(t){return _s.post$("/api/user/log",t)}static temporaryUser$(t){return void 0===t&&(t=ie.Embed),s.of({id:this.uuid(),type:t,username:t}).pipe(i.map((t=>this.mapUser(t))),i.switchMap((t=>(this.setUser(t),this.user$))))}static overrideUser$(t){return void 0===t&&(t=ie.Embed),this.me$().pipe(i.switchMap((e=>e?(e.type=t,e.username=t,this.user$):this.temporaryUser$(t))))}static uuid(){return(new Date).getTime()}static mapUser(t){return new ne(t)}static getMode(t){let e;switch(t){case ie.Publisher:case ie.Attendee:case ie.Streamer:case ie.Viewer:case ie.Publisher:case ie.Publisher:e=gs;break;case ie.SelfService:e=bs;break;case ie.SmartDevice:e=fs;break;case ie.Embed:e=ws;break;default:e=ys}return e}}Is.user$=new s.BehaviorSubject(null);let Rs=0;class $s{constructor(t){t&&Object.assign(this,t)}toJson(){return JSON.stringify(this)}static newEvent(t,e,s){console.log("WebhookEvent.newEvent",t,e,s);const i=new $s,n=(new Date).getTime();return i.timestamp=n,i.id=`${n}-${++Rs}`,i.action=t,i.data=e,s&&(i.extra="string"==typeof s?JSON.parse(s):s),se.state.link&&(i.meetingId=se.state.link,i.userSessionId=se.state.uid,i.userRole=se.state.role,i.fullName=se.state.name),i}static parseEvent(t){if(t&&"data"in t){const e="string"==typeof t.data?JSON.parse(t.data):t.data;return"action"in e?new $s(e):null}return null}}class As{static internal$_(t){return s.of(t).pipe(i.tap((t=>{console.log("WebhookService.internal$_.postMessage",t),window.parent&&window.parent.postMessage(t.action,t.toJson())})),i.switchMap((t=>this.event$_.pipe(i.filter((t=>t.id==t.id)),i.first()))),i.map((e=>(console.log("WebhookService.internal$_.handleResponse_",t,e),this.handleResponse_(t,e)))),i.catchError((e=>this.handleError_(t,e))))}static send$_(t,e){return _s.post$(t,e).pipe(i.map((t=>this.handleResponse_(e,t))),i.catchError((t=>this.handleError_(e,t))))}static send$(t,e,i){if(console.log("WebhookService.send$",t,e,i),this.enabled){const n=$s.newEvent(t,e,i),o=U.webhook.uris.map((t=>"internal"===t?this.internal$_(n):this.send$_(t,n)));return s.forkJoin(o)}return s.of(null)}static handleResponse_(t,e){console.log("WebhookService.handleResponse_",e);const s=Object.assign({},t);return s.remoteStatus=1,s.remoteResponse=e,s}static handleError_(t,e){const i=Object.assign({},t);return i.remoteStatus=0,i.remoteError=e,s.of(i)}static get enabled(){const t=U.webhook,e=t&&t.uris&&t.uris.length>0;return e&&(t.methods=t.methods||{},t.methods.nav=t.methods.nav||[]),e}}As.event$_=s.fromEvent(window,"message").pipe(i.map((t=>$s.parseEvent(t))),i.filter((t=>null!==t)),i.shareReplay(1));class Ps extends t.Component{onInit(){this.state={status:"access"},window.onSSOPopupClose=t=>{"success"===t?(alert("Login Successful"),Is.me$().pipe(i.first()).subscribe((t=>{const e=we.transform(":lang.selfServiceTour"),s=U.pathMapper&&U.pathMapper.ssoLogin?U.pathMapper.ssoLogin(t):null;s?ee.setRouterLink(e,re.validateParams({pathId:s})):ee.setRouterLink(e)}))):alert("Login Failed")}}onSelfServiceTourRequest(){this.initRequestForm(),this.state.status="self-service-tour",this.pushChanges(),R&&-1!==window.navigator.userAgent.indexOf("OculusBrowser")&&(this.test(),this.onSubmit())}onGuidedTourRequest(){this.initRequestForm(),this.state.status="guided-tour",this.pushChanges()}onSSOLogin(t){const e=`${location.protocol}//${location.host}/sso/login`;return window.open(e,"BHere | SSO Login","left=20,top=20,width=600,height=600,toolbar=1,resizable=0"),t.preventDefault(),!1}onSSORegister(t){const e=`${location.protocol}//${location.host}/sso/register`;return window.open(e,"BHere | SSO Register","left=20,top=20,width=600,height=600,toolbar=1,resizable=0"),t.preventDefault(),!1}onGuidedTourAccess(){Is.logout$().pipe(i.first()).subscribe((()=>{ee.setRouterLink(we.transform(":lang.guidedTour"))}))}onLogin(){this.initLoginForm(),this.state.status="login",this.pushChanges()}initRequestForm(){this.formSubscription&&this.formSubscription.unsubscribe();const t=this.data=U.data||{roles:[{id:1,name:"Show room"},{id:2,name:"Architetto"},{id:3,name:"Interior designer"},{id:4,name:"Privato"},{id:5,name:"Altro"}]},e=this.fields=U.fields||[{type:"text",name:"firstName",label:"access_first_name",required:!0,test:"Jhon"},{type:"text",name:"lastName",label:"access_last_name",required:!0,test:"Appleseed"},{type:"email",name:"email",label:"access_email",required:!0,test:"jhonappleseed@gmail.com"},{type:"custom-select",name:"role",label:"access_role",required:!0,options:t.roles,test:t.roles[0].id},{type:"checkbox",name:"privacy",label:"access_privacy_disclaimer",required:!0,test:!0}];e.push({type:"hidden",name:"checkField",value:"",test:""}),U.antiforgery&&e.push({type:"none",name:"checkRequest",value:U.antiforgery,test:U.antiforgery});const s=this.form=me(e);this.controls=s.controls,this.formSubscription=s.changes$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((t=>{this.pushChanges()})),this.error=null}initLoginForm(){this.formSubscription&&this.formSubscription.unsubscribe();const t=this.form=new e.FormGroup({username:new e.FormControl(null,e.Validators.RequiredValidator()),password:new e.FormControl(null,e.Validators.RequiredValidator()),checkRequest:window.antiforgery||"",checkField:""});this.controls=t.controls,this.formSubscription=t.changes$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((t=>{this.pushChanges()})),this.error=null}test(){"login"===this.state.status?this.form.patch({username:"publisher",password:"publisher",checkRequest:window.antiforgery||"",checkField:""}):ve(this.fields,this.form)}reset(){this.form.reset()}onBack(){this.state.status="access",this.pushChanges()}onSubmit(){if(this.form.valid){this.form.submitted=!0;const t=this.form.value,e=he({},t),s=this.controls;Object.keys(e).forEach((t=>{if(s[t].options){const i=s[t].options;e[t]=i.find((s=>s.id===e[t])).name}}));const n=this.state.status;Is.resolve$(t,n).pipe(i.first()).subscribe((t=>{switch(n){case"guided-tour":this.onHandleHook("GuidedTour",e).pipe(i.first()).subscribe((t=>{this.state.status="guided-tour-success",this.pushChanges()}));break;case"self-service-tour":this.onHandleHook("SelfServiceTour",e).pipe(i.first()).subscribe((t=>{const e=we.transform(":lang.selfServiceTour"),s=U.pathMapper&&U.pathMapper.selfService?U.pathMapper.selfService(user):null;s?ee.setRouterLink(e,re.validateParams({pathId:s})):ee.setRouterLink(e)}));break;case"login":ee.setRouterLink(we.transform(":lang.guidedTour"))}this.form.reset()}),(t=>{console.log("AccessComponent.error",t),this.error=t,this.pushChanges()}))}else this.form.touched=!0}isValid(){return this.form.valid}onHandleHook(t,e){const s=e;return As.send$(t,s,null)}}Ps.meta={selector:"[access-component]",hosts:{host:le},template:`\n\t\t<div class="page page--access">\n\t\t\t\x3c!-- background --\x3e\n\t\t\t<div class="background" [class]="{ 'background--image': ('background.image' | env), 'background--video': ('background.video' | env) }" *if="state.status != 'connected'">\n\t\t\t\t<img [src]="'background.image' | env | asset" *if="'background.image' | env" />\n\t\t\t\t<video [src]="'background.video' | env | asset" *if="'background.video' | env" oncanplay="this.muted = true; this.classList.add('ready');" playsinline autoplay muted loop></video>\n\t\t\t</div>\n\t\t\t\x3c!-- access --\x3e\n\t\t\t<div class="ui ui--info ui--info-centered" *if="state.status == 'access'">\n\t\t\t\t<div class="group--info">\n\t\t\t\t\t<div class="group--info__content stagger--childs">\n\t\t\t\t\t\t<div class="title" [innerHTML]="'access_title' | label"></div>\n\t\t\t\t\t\t<div *if="'selfService' | flag">\n\t\t\t\t\t\t\t<button type="button" class="btn--next" (click)="onSelfServiceTourRequest($event)">\n\t\t\t\t\t\t\t\t<span [innerHTML]="'access_tour' | label"></span>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div *if="'guidedTourRequest' | flag">\n\t\t\t\t\t\t\t<div class="info" [innerHTML]="'access_or' | label"></div>\n\t\t\t\t\t\t\t<button type="button" class="btn--next" (click)="onGuidedTourRequest($event)">\n\t\t\t\t\t\t\t\t<span [innerHTML]="'access_guided_tour' | label"></span>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div *if="'guidedTourAccess' | flag">\n\t\t\t\t\t\t\t<div class="info" [innerHTML]="'access_has_meeting_id' | label"></div>\n\t\t\t\t\t\t\t<button type="button" class="btn--next" (click)="onGuidedTourAccess($event)">\n\t\t\t\t\t\t\t\t<span [innerHTML]="'access_guided_tour_cta' | label"></span>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div *if="'ssoLogin' | flag">\n\t\t\t\t\t\t\t<div class="info" [innerHTML]="'access_sso_login_info' | label"></div>\n\t\t\t\t\t\t\t<button type="button" class="btn--next" (click)="onSSOLogin($event)">\n\t\t\t\t\t\t\t\t<span [innerHTML]="'access_sso_login_cta' | label"></span>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div *if="'ssoRegister' | flag">\n\t\t\t\t\t\t\t<div class="info" [innerHTML]="'access_sso_register_info' | label"></div>\n\t\t\t\t\t\t\t<button type="button" class="btn--next" (click)="onSSORegister($event)">\n\t\t\t\t\t\t\t\t<span [innerHTML]="'access_sso_register_cta' | label"></span>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t\x3c!-- guided-tour --\x3e\n\t\t\t<div class="ui ui--info" *if="state.status == 'self-service-tour' || state.status == 'guided-tour'">\n\t\t\t\t<div class="group--info">\n\t\t\t\t\t<form class="form" [formGroup]="form" (submit)="isValid() && onSubmit()" name="form" role="form" novalidate autocomplete="off">\n\t\t\t\t\t\t<div class="group--info__content stagger--childs">\n\t\t\t\t\t\t\t<div class="title" *if="state.status == 'self-service-tour'" [innerHTML]="'access_fill_fields' | label"></div>\n\t\t\t\t\t\t\t<div class="title" *if="state.status == 'guided-tour'" [innerHTML]="'access_guided_tour_request' | label"></div>\n\t\t\t\t\t\t\t\x3c!-- controls --\x3e\n\t\t\t\t\t\t\t<div controls [formGroup]="form" [fields]="fields"></div>\n\t\t\t\t\t\t\t<div class="group--error" *if="error">\n\t\t\t\t\t\t\t\t<span class="status-code" [innerHTML]="error.statusCode"></span>\n\t\t\t\t\t\t\t\t<span class="status-message" [innerHTML]="error.statusMessage"></span>\n\t\t\t\t\t\t\t\t<span class="friendly-message" [innerHTML]="error.friendlyMessage"></span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\x3c!-- <div class="info" *if="isValid()" [innerHTML]="'access_take_part' | label"></div> --\x3e\n\t\t\t\t\t\t\t<button type="submit" class="btn--next" [class]="{ disabled: !isValid() }">\n\t\t\t\t\t\t\t\t<span *if="!form.submitted" [innerHTML]="'access_send' | label"></span>\n\t\t\t\t\t\t\t\t<span *if="form.submitted" [innerHTML]="'access_sent' | label"></span>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t<button type="button" class="btn--mode" (click)="onBack($event)">\n\t\t\t\t\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#arrow-prev"></use></svg>\n\t\t\t\t\t\t\t\t<span [innerHTML]="'access_back' | label"></span>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t<test-component [form]="form" (test)="test($event)" (reset)="reset($event)"></test-component>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</form>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t\x3c!-- guided-tour success --\x3e\n\t\t\t<div class="ui ui--info ui--info-centered" *if="state.status == 'guided-tour-success'">\n\t\t\t\t<div class="group--info">\n\t\t\t\t\t<div class="group--info__content stagger--childs">\n\t\t\t\t\t\t<div class="title" [innerHTML]="'access_request_sent' | label"></div>\n\t\t\t\t\t\t<div class="info" [innerHTML]="'access_info_request' | label"></div>\n\t\t\t\t\t\t<button type="button" class="btn--mode" (click)="onBack($event)">\n\t\t\t\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#arrow-prev"></use></svg>\n\t\t\t\t\t\t\t<span [innerHTML]="'access_back' | label"></span>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t\x3c!-- login --\x3e\n\t\t\t<div class="ui ui--info ui--info-centered" *if="state.status == 'login'">\n\t\t\t\t<div class="group--info">\n\t\t\t\t\t<form class="form" [formGroup]="form" (submit)="isValid() && onSubmit()" name="form" role="form" novalidate autocomplete="off">\n\t\t\t\t\t\t<div class="group--info__content stagger--childs">\n\t\t\t\t\t\t\t<div class="title" [innerHTML]="'access_login' | label"></div>\n\t\t\t\t\t\t\t<input name="checkField" [formControl]="controls.checkField" value="" type="text" style="display:none !important;" />\n\t\t\t\t\t\t\t<div control-text [control]="controls.username" [label]="'access_username' | label"></div>\n\t\t\t\t\t\t\t<div control-password [control]="controls.password" [label]="'access_password' | label"></div>\n\t\t\t\t\t\t\t<div class="group--error" *if="error">\n\t\t\t\t\t\t\t\t<span class="status-code" [innerHTML]="error.statusCode"></span>\n\t\t\t\t\t\t\t\t<span class="status-message" [innerHTML]="error.statusMessage"></span>\n\t\t\t\t\t\t\t\t<span class="friendly-message" [innerHTML]="error.friendlyMessage"></span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="info" *if="isValid()" [innerHTML]="'access_cta' | label"></div>\n\t\t\t\t\t\t\t<button type="submit" class="btn--next" [class]="{ disabled: !isValid() }">\n\t\t\t\t\t\t\t\t<span [innerHTML]="'access_cta' | label"></span>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t<button type="button" class="btn--mode" (click)="onBack($event)">\n\t\t\t\t\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#arrow-prev"></use></svg>\n\t\t\t\t\t\t\t\t<span [innerHTML]="'access_back' | label"></span>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t<test-component [form]="form" (test)="test($event)" (reset)="reset($event)"></test-component>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</form>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<header>\n\t\t\t\t\x3c!-- logo --\x3e\n\t\t\t\t<div class="btn--logo" (click)="onBack($event)">\n\t\t\t\t\t<img [src]="'logo' | env" *if="'logo' | env" />\n\t\t\t\t\t<svg viewBox="0 0 270 98" *if="!('logo' | env)"><use xlink:href="#b-here"></use></svg>\n\t\t\t\t</div>\n\t\t\t\t${y}\n\t\t\t</header>\n\t\t\t<footer>\n\t\t\t\t<span class="group--colophon" *if="state.status != 'connected'">\n\t\t\t\t\t${b}\n\t\t\t\t\t${w}\n\t\t\t\t</span>\n\t\t\t\t\x3c!-- login --\x3e\n\t\t\t\t<button type="button" class="btn--absolute" (click)="onLogin($event)" *if="state.status == 'access'">\n\t\t\t\t\t<span [innerHTML]="'access_cta' | label"></span> <svg class="lock" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#lock"></use></svg>\n\t\t\t\t</button>\n\t\t\t</footer>\n\t\t</div>\n\t`};class Hs{static emoji$(){return null!=Hs.items_?s.of(Hs.items_):_s.get$(`${U.assets}api/emoji/emoji.json`).pipe(i.map((t=>(Hs.items_=t,t))))}}class Os extends t.Component{onInit(){this.items=[],Hs.emoji$().pipe(i.first()).subscribe((t=>{setTimeout((()=>{this.items=t,this.pushChanges()}),1)}))}onSelect(t){this.emoji.next(t)}onClose(t){this.close.next()}}Os.meta={selector:"[agora-chat-emoji]",outputs:["emoji","close"]};class Us{static message(t){this.message$.next(t)}static in(t){this.in$.next(t)}static sendBack(t){t=Object.assign({},t,{remoteId:t.clientId}),this.in$.next(t)}static out(t){this.out$.next(t)}}Us.message$=new s.ReplaySubject(1),Us.in$=new s.ReplaySubject(1),Us.send=Us.in,Us.out$=new s.ReplaySubject(1);const Bs="unknown",Ds="ios",zs="android",Vs="windowsPhone",js="vrHeadset";class Ns{static get platform(){return this.platform_||(this.platform_=this.getDevicePlatform()),this.platform_}static get isIOS(){return-1!==["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].indexOf(navigator.platform)||-1!==navigator.userAgent.indexOf("Mac")&&"ontouchend"in document}static get isVRHeadset(){return-1!==navigator.userAgent.indexOf("VR")||-1!==navigator.userAgent.indexOf("Quest")||-1!==navigator.userAgent.indexOf("Oculus")}static getDevicePlatform(){const t=navigator.userAgent||navigator.vendor||window.opera;return/windows phone/i.test(t)?Vs:/android/i.test(t)?zs:this.isIOS?Ds:this.isVRHeadset?js:Bs}}class Fs{static delete(t){this.isSessionStorageSupported()&&window.sessionStorage.removeItem(t)}static exist(t){if(this.isSessionStorageSupported())return void 0!==window.sessionStorage[t]}static get(t){let e=null;if(this.isSessionStorageSupported()&&void 0!==window.sessionStorage[t])try{e=JSON.parse(window.sessionStorage[t])}catch(e){console.log("SessionStorageService.get.error parsing",t,e)}return e}static set(t,e){if(this.isSessionStorageSupported())try{const s=[],i=JSON.stringify(e,(function(t,e){if("object"==typeof e&&null!==e){if(-1!==s.indexOf(e))return;s.push(e)}return e}));window.sessionStorage.setItem(t,i)}catch(s){console.log("SessionStorageService.set.error serializing",t,e,s)}}static isSessionStorageSupported(){if(this.supported)return!0;let t=!1;try{t="sessionStorage"in window&&null!==window.sessionStorage,t?(window.sessionStorage.setItem("test","1"),window.sessionStorage.removeItem("test")):t=!1}catch(e){t=!1}return this.supported=t,t}}const Gs="client",qs="editor";class Zs{static set editorStreams(t){this.editorStreams$.next(t)}static get editorStreams(){return this.editorStreams$.getValue()}static set editorScreens(t){this.editorScreens$.next(t)}static get editorScreens(){return this.editorScreens$.getValue()}static set local(t){this.local$.next(t)}static get local(){return this.local$.getValue()}static set screen(t){this.screen$.next(t)}static get screen(){return this.screen$.getValue()}static set remotes(t){this.remotes$.next(t)}static get remotes(){return this.remotes$.getValue()}static set peers(t){this.peers$.next(t)}static get peers(){return this.peers$.getValue()}static orderedRemotes$(){return s.combineLatest([Zs.remotes$,s.interval(1e3)]).pipe(i.map((t=>{const e=[];return t[0].forEach((t=>{let s=null,i=null,n=null,o=0,a=0,r=0;t.clientInfo&&(o=t.clientInfo.audioLevel=t.getAudioLevel(),a=t.clientInfo.peekAudioLevel=Math.max(t.clientInfo.audioLevel,.2),r=t.clientInfo.order,s=t.clientInfo.role||null,i=t.clientInfo.uid||null,n=t.clientInfo.screenUid||null),e.push({role:s,uid:i,screenUid:n,audioLevel:o,peekAudioLevel:a,order:r,remote:t})})),e.sort(((t,e)=>{const s=t.role===ie.Publisher?2:t.role===ie.Attendee?1:0;return(e.role===ie.Publisher?2:e.role===ie.Attendee?1:0)-s||e.peekAudioLevel-t.peekAudioLevel||(t.order||0)-(e.order||0)})),e.forEach(((t,e)=>{t.remote.clientInfo&&(t.remote.clientInfo.order=e)})),e})),i.distinctUntilChanged(((t,e)=>t.map((t=>`${t.uid}-${t.screenUid}`)).join("|")===e.map((t=>`${t.uid}-${t.screenUid}`)).join("|"))),i.map((t=>t.map((t=>t.remote)))))}static getEditorStreams$(){return s.of(null).pipe(i.switchMap((()=>{if(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia&&this.mode===qs){const t=document.querySelector("body"),e=document.createElement("div"),s=document.createElement("video");e.setAttribute("id","stream-editor"),e.setAttribute("style","position:absolute; top: 5000px; line-height: 0;"),e.appendChild(s),t.appendChild(e),navigator.mediaDevices.getUserMedia({video:{width:800,height:450}}).then((t=>{"srcObject"in s?s.srcObject=t:s.src=window.URL.createObjectURL(t),s.oncanplay=()=>{const t={getId:()=>"editor",clientInfo:{role:ie.Publisher,uid:"editor"}},e={getId:()=>"editor",clientInfo:{role:ie.Attendee,uid:"editor"}},s={getId:()=>"editor",clientInfo:{role:ie.SmartDevice,uid:"editor"}};this.editorStreams$.next([t,e,e,e,e,s])},s.play()})).catch((t=>{console.log("EditorComponent.getUserMedia.error",t.name,t.message)}))}return this.editorStreams$})),i.shareReplay(1))}static getEditorScreens$(){return s.of(null).pipe(i.switchMap((()=>{if(navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia&&this.mode===qs){const t=document.querySelector("body"),e=document.createElement("div"),s=document.createElement("video");e.setAttribute("id","stream-editor-screen"),e.setAttribute("style","position:absolute; top: 5000px; line-height: 0;"),e.appendChild(s),t.appendChild(e),navigator.mediaDevices.getDisplayMedia({screen:{width:800,height:450}}).then((t=>{"srcObject"in s?s.srcObject=t:s.src=window.URL.createObjectURL(t),s.oncanplay=()=>{const t={getId:()=>"editor-screen",clientInfo:{role:ie.Publisher,uid:"editor",screenUid:"editor-screen"}},e={getId:()=>"editor-screen",clientInfo:{role:ie.Attendee,uid:"editor",screenUid:"editor-screen"}};this.editorScreens$.next([t,e])},s.play()})).catch((t=>{console.log("EditorComponent.getUserMedia.error",t.name,t.message)}))}return this.editorScreens$})),i.shareReplay(1))}static get publisherStreamId(){const t=this.remotes.slice(),e=this.local;e&&t.unshift(e);const s=t.find((t=>t.clientInfo&&t.clientInfo.role===ie.Publisher&&t.clientInfo.uid===t.getId()));return s?s.getId():null}static getPublisherStreamId$(){const t=this.publisherStreamId;return t?s.of(t):this.streams$.pipe(i.map((()=>this.publisherStreamId)),i.filter((t=>t)))}static getRemoteById(t){const e=Zs.remotes.find((e=>e.getId()===t));if(e)return e}static remoteAdd(t){const e=this.remotes.slice();e.push(t),this.remotes=e}static remoteRemove(t){const e=this.remotes.slice(),s=e.find((e=>e.getId()===t));return s&&(s.isPlaying()&&s.stop(),e.splice(e.indexOf(s),1),this.remotes=e),s}static remoteSetClientInfo(t,e){const s=this.remotes,i=s.find((e=>e.getId()===t));i&&(i.clientInfo=e),this.remotes=s}}Zs.mode=Gs,Zs.editorStreams$=new s.BehaviorSubject(null),Zs.editorScreens$=new s.BehaviorSubject(null),Zs.local$=new s.BehaviorSubject(null),Zs.screen$=new s.BehaviorSubject(null),Zs.remotes$=new s.BehaviorSubject([]),Zs.peers$=new s.BehaviorSubject([]),Zs.streams$=s.combineLatest([Zs.local$,Zs.screen$,Zs.remotes$,Zs.getEditorStreams$(),Zs.getEditorScreens$()]).pipe(i.map((t=>{const e=t[0],s=t[1],i=t[2],n=t[3],o=t[4];let a=i;return e&&(a=a.slice(),a.push(e)),s&&(a=a.slice(),a.push(s)),n&&a.push(...n),o&&a.push(...o),a})),i.shareReplay(1));class Ws extends class{constructor(){this.events={}}on(t,e){const s=this.events[t]=this.events[t]||[];return s.push(e),()=>{this.events[t]=s.filter((t=>t!==e))}}off(t,e){const s=this.events[t];s&&(this.events[t]=s.filter((t=>t!==e)))}once(t,e){const s=i=>{e(i),this.off(t,s)};this.on(t,s)}emit(t,e){const s=this.events[t];s&&s.forEach((t=>{t(e)}));const i=this.events.broadcast;i&&i.forEach((s=>{s(t,e)}))}has(t){const e=this.events[t];return e&&e.length}}{static getSingleton(t){if(!E)return this.AGORA||(this.AGORA=new Ws(t)),this.AGORA}constructor(t){if(Ws.AGORA)throw"AgoraService is a singleton";super(),this.previousMuteAudio_=!1,this.onStreamPublished=this.onStreamPublished.bind(this),this.onStreamUnpublished=this.onStreamUnpublished.bind(this),this.onStreamAdded=this.onStreamAdded.bind(this),this.onStreamRemoved=this.onStreamRemoved.bind(this),this.onStreamSubscribed=this.onStreamSubscribed.bind(this),this.onMuteVideo=this.onMuteVideo.bind(this),this.onUnmuteVideo=this.onUnmuteVideo.bind(this),this.onMuteAudio=this.onMuteAudio.bind(this),this.onUnmuteAudio=this.onUnmuteAudio.bind(this),this.onVolumeIndicator=this.onVolumeIndicator.bind(this),this.onPeerConnect=this.onPeerConnect.bind(this),this.onPeerLeaved=this.onPeerLeaved.bind(this),this.onConnectionStateChange=this.onConnectionStateChange.bind(this),this.onTokenPrivilegeWillExpire=this.onTokenPrivilegeWillExpire.bind(this),this.onTokenPrivilegeDidExpire=this.onTokenPrivilegeDidExpire.bind(this),this.onMessage=this.onMessage.bind(this);const e=se.state;se.patchState({devices:e.role!==ie.Attendee&&t?t:{videos:[],audios:[]},quality:xe(e),membersCount:0})}get isAudienceRole(){return se.state.role===ie.Viewer||se.state.role===ie.SelfService}addStreamDevice(t){this.removeStreamDevice();const e={deviceId:"video-stream",label:"videostream",kind:"videostream",src:t},s={deviceId:"audio-stream",label:"videostream",kind:"videostream",src:t},i=se.state.devices;i.videos.push(e),i.audios.push(s),se.patchState({devices:i})}removeStreamDevice(){const t=se.state.devices;t.videos=t.videos.filter((t=>"videostream"!==t.kind)),t.audios=t.audios.filter((t=>"videostream"!==t.kind)),se.patchState({devices:t})}devices$(){const t=se.state.devices,e=this.defaultVideos=this.defaultVideos||t.videos.slice(),i=this.defaultAudios=this.defaultAudios||t.videos.slice();return t.videos=e.slice(),t.audios=i.slice(),s.from(new Promise(((e,s)=>{const i=()=>{Ws.getDevices().then((i=>{n.close();for(let e=0;e<i.length;e++){const s=i[e];"videoinput"===s.kind&&s.deviceId&&t.videos.push({label:s.label||"camera-"+t.videos.length,deviceId:s.deviceId,kind:s.kind}),"audioinput"===s.kind&&s.deviceId&&t.audios.push({label:s.label||"microphone-"+t.audios.length,deviceId:s.deviceId,kind:s.kind})}t.videos.length>0||t.audios.length>0?e(t):s(t)})).catch((t=>{s(t)}))},n=AgoraRTC.createStream({audio:!0,video:!0});n.init((()=>{i()}),(()=>{i()}))})))}connect$(t){const e=se.state.devices;return t&&(e.video=t.video,e.audio=t.audio),se.state.connecting||(se.patchState({status:_e,connecting:!0,devices:e}),setTimeout((()=>{this.createClient((()=>{const t=this.getChannelNameLink();Ws.rtcToken$(t).subscribe((e=>{this.join(e.token,t)}))}))}),250)),se.state$}membersCount$(t){const e=this.messageClient;return s.interval(2e3).pipe(i.switchMap((()=>s.from(e.getChannelMemberCount([t])))),i.map((e=>e[t])),i.distinctUntilChanged())}observeMemberCount(){this.unobserveMemberCount(),this.membersCountSubscription=this.membersCount$(se.state.channelNameLink).subscribe((t=>{se.patchState({membersCount:t})}))}unobserveMemberCount(){this.membersCountSubscription&&(this.membersCountSubscription.unsubscribe(),this.membersCountSubscription=null,se.patchState({membersCount:0}))}createClient(t){this.client&&t(),AgoraRTC.Logger.setLogLevel(AgoraRTC.Logger.NONE);const e=this.client=AgoraRTC.createClient({mode:"live",codec:"h264"}),s=()=>{U.flags.useProxy&&(e.startProxyServer(3),console.log("AgoraService.client.startProxyServer")),e.init(U.appKey,(()=>{t()}),(t=>{this.client=null}))};this.isAudienceRole?e.setClientRole("audience",(function(t){t||s()})):s(),e.on("error",this.onError),e.on("stream-published",this.onStreamPublished),e.on("stream-unpublished",this.onStreamUnpublished),e.on("stream-added",this.onStreamAdded),e.on("stream-removed",this.onStreamRemoved),e.on("stream-subscribed",this.onStreamSubscribed),e.on("mute-video",this.onMuteVideo),e.on("unmute-video",this.onUnmuteVideo),e.on("mute-audio",this.onMuteAudio),e.on("unmute-audio",this.onUnmuteAudio),e.on("peer-online",this.onPeerConnect),e.on("peer-leave",this.onPeerLeaved),e.on("onTokenPrivilegeWillExpire",this.onTokenPrivilegeWillExpire),e.on("onTokenPrivilegeDidExpire",this.onTokenPrivilegeDidExpire);(this.messageClient=AgoraRTM.createInstance(U.appKey,{logFilter:AgoraRTM.LOG_FILTER_OFF})).setParameters({logFilter:AgoraRTM.LOG_FILTER_OFF})}getChannelNameLink(){let t=se.state.link||"";const e=t.match(/(\d{9})-(\d{4})-(\d{13})/);e&&(t=`${e[1]}-${e[3]}`);return`${se.state.channelName}-${t}`}static getUniqueUserId(){return(1e13*(100*(1+Math.floor(8*Math.random()))+10*(1+Math.floor(8*Math.random()))+1*(1+Math.floor(8*Math.random())))+Date.now()).toString()}join(t,e){this.channel=null;const s=this.client,i=Fs.get("bHereClientId")||Ws.getUniqueUserId();s.join(t,e,i,(t=>{se.patchState({status:Ie,channelNameLink:e,connected:!0,uid:t}),Fs.set("bHereClientId",t),Ws.rtmToken$(t).subscribe((e=>{this.joinMessageChannel(e.token,t).then((e=>{this.isAudienceRole||this.autoDetectDevice().then((e=>{this.createMediaStream(t,e.video,e.audio)})),this.observeMemberCount()}),(t=>{console.log("joinMessageChannel.error",t)}))}))}),(t=>{console.log("AgoraService.join.error",t),"DYNAMIC_KEY_EXPIRED"===t&&Ws.rtcToken$(e).subscribe((t=>{this.join(t.token,e)}))}))}joinMessageChannel(t,e){let s;return new Promise(((i,n)=>{const o=this.messageClient;o.login({token:t,uid:e.toString()}).then((()=>(s=o.createChannel(se.state.channelNameLink),s.join()))).then((()=>{this.channel=s,s.on("ChannelMessage",this.onMessage),this.emit("channel",s),i(e),s.getMembers().then((t=>{t=t.filter((t=>t!==e.toString()));const s={type:$e,members:t};this.broadcastMessage(s)}))})).catch(n)}))}detectDevices(t){Ws.getDevices().then((e=>{const s=[],i=[];for(let t=0;t<e.length;t++){const n=e[t];"videoinput"==n.kind&&s.push({label:n.label||"camera-"+s.length,deviceId:n.deviceId,kind:n.kind}),"audioinput"==n.kind&&i.push({label:n.label||"microphone-"+s.length,deviceId:n.deviceId,kind:n.kind})}t({videos:s,audios:i})})).catch((t=>{console.log("AgoraService.detectDevices",t)}))}getVideoOptions(t,e){return new Promise(((s,i)=>{if(e)if("videostream"===e.kind){const i=document.querySelector("#"+e.deviceId);i.crossOrigin="anonymous";var n=new Hls;n.attachMedia(i),n.on(Hls.Events.MEDIA_ATTACHED,(()=>{n.loadSource(e.src),n.on(Hls.Events.MANIFEST_PARSED,((e,n)=>{i.play().then((e=>{const n=i.captureStream();t.videoSource=n.getVideoTracks()[0],s(t)}),(t=>{console.log("AgoraService.getVideoOptions.error",t)}))}))}))}else if("videoplayer"===e.kind||"videostream"===e.kind){const i=document.querySelector("#"+e.deviceId);i.crossOrigin="anonymous";const n=i.captureStream();t.videoSource=n.getVideoTracks()[0],s(t)}else t.cameraId=e.deviceId,s(t);else s(t)}))}getAudioOptions(t,e){return new Promise(((s,i)=>{if(e)if("videostream"===e.kind){const i=document.querySelector("#"+e.deviceId);i.crossOrigin="anonymous";var n=new Hls;n.attachMedia(i),n.on(Hls.Events.MEDIA_ATTACHED,(()=>{n.loadSource(e.src),n.on(Hls.Events.MANIFEST_PARSED,((e,o)=>{n.loadLevel=o.levels.length-1,i.play().then((e=>{const n=i.captureStream();t.audioSource=n.getAudioTracks()[0],s(t)}),(t=>{console.log("AgoraService.getAudioOptions.error",t)}))}))}))}else if("videoplayer"===e.kind||"videostream"===e.kind){const i=document.querySelector("#"+e.deviceId);i.crossOrigin="anonymous";const n=i.captureStream();t.audioSource=n.getAudioTracks()[0],s(t)}else t.microphoneId=e.deviceId,s(t);else s(t)}))}autoDetectDevice(){return new Promise(((t,e)=>{const s=se.state;s.role===ie.SmartDevice?Ws.getDevices().then((e=>{const s={videos:[],audios:[],video:null,audio:null};e.forEach((t=>{"videoinput"===t.kind?s.videos.push(t):"audioinput"===t.kind&&s.audios.push(t)})),s.video=s.videos[0]||null,s.audio=s.audios[0]||null,se.patchState({devices:s}),t(s)})).catch((t=>{e(t)})):t(s.devices)}))}createMediaStream(t,e,s){const i={streamID:t,video:Boolean(e),audio:Boolean(s),screen:!1};Promise.all([this.getVideoOptions(i,e),this.getAudioOptions(i,s)]).then((t=>{const e=Object.assign({},se.state.quality);this.createLocalStreamWithOptions(i,e)}))}createLocalStreamWithOptions(t,e){const s=AgoraRTC.createStream(t);e&&s.setVideoProfile(e.profile),s.init((()=>{Zs.local=s,setTimeout((()=>{this.publishLocalStream()}),1)}),(t=>{console.log("AgoraService.initLocalStream.init.error",t)}))}initLocalStream(){Zs.local.init((()=>{this.publishLocalStream()}),(t=>{console.log("AgoraService.initLocalStream.init.error",t)}))}publishLocalStream(){const t=this.client,e=Zs.local;t.publish(e,(t=>{console.log("AgoraService.publishLocalStream.error",e.getId(),t)})),e.clientInfo={role:se.state.role,name:se.state.name,uid:se.state.uid,screenUid:se.state.screenUid},Zs.local=e}unpublishLocalStream(){const t=this.client,e=Zs.local;e&&t.unpublish(e,(t=>{console.log("AgoraService.unpublishLocalStream.error",e.getId(),t)})),Zs.local=null}leaveChannel(){return se.patchState({connecting:!1}),this.unpublishLocalStream(),this.unpublishScreenStream(),Zs.remotes=[],Zs.peers=[],new Promise(((t,e)=>{this.leaveMessageChannel().then((()=>{Promise.all([this.leaveClient(),this.leaveScreenClient()]).then((()=>{t()})).catch((t=>{e(t)}))})).catch((t=>{e(t)}))}))}leaveClient(){return new Promise(((t,e)=>{const s=this.client;s?s.leave((()=>{this.client=null,U.flags.useProxy&&(s.stopProxyServer(),console.log("AgoraService.client.stopProxyServer")),t()}),(t=>{console.log("AgoraService.leaveClient.error",t),e(t)})):t()}))}leaveMessageChannel(){return new Promise(((t,e)=>{{this.unobserveMemberCount();const s=this.channel;if(!s)return t();const i=this.messageClient;s.leave().then((()=>{this.channel=null,i.logout().then((()=>{this.messageClient=null,t()}),e)}),e)}}))}toggleCamera(){const t=Zs.local;t&&t.video&&(t.userMuteVideo?(t.unmuteVideo(),se.patchState({cameraMuted:!1}),this.broadcastEvent(new Ss({streamId:t.getId()}))):(t.muteVideo(),se.patchState({cameraMuted:!0}),this.broadcastEvent(new ks({streamId:t.getId()}))))}toggleAudio(){const t=Zs.local;t&&t.audio&&(t.userMuteAudio?(t.unmuteAudio(),se.patchState({audioMuted:!1}),this.broadcastEvent(new Es({streamId:t.getId()}))):(t.muteAudio(),se.patchState({audioMuted:!0}),this.broadcastEvent(new Ts({streamId:t.getId()}))))}setAudio(t){const e=Zs.local;e&&e.audio&&(t?(this.previousMuteAudio_=e.userMuteAudio,e.userMuteAudio||(e.muteAudio(),se.patchState({audioMuted:!0}),this.broadcastEvent(new Ts({streamId:e.getId()})))):e.userMuteAudio&&!this.previousMuteAudio_&&(e.unmuteAudio(),se.patchState({audioMuted:!1}),this.broadcastEvent(new Es({streamId:e.getId()}))))}toggleMode(){const t=se.state.mode===gs?fs:gs;se.patchState({mode:t}),Us.send({type:ss,mode:t})}toggleNavInfo(){const t=!se.state.showNavInfo;se.patchState({showNavInfo:t}),Us.send({type:is,showNavInfo:t})}dismissControl(){return new Promise(((t,e)=>{const s=se.state.controlling;s?this.sendRemoteControlDismiss(s).then((()=>{se.patchState({controlling:!1}),t(s)})):t(!1)}))}requestControl(t){return new Promise(((e,s)=>{this.sendRemoteControlRequest(t).then((t=>{se.patchState({controlling:t}),e(t)}))}))}toggleControl(t){this.dismissSpy().then((()=>{this.dismissControl().then((e=>{e!==t&&this.requestControl(t).then((t=>{}))}))}))}toggleSilence(){const t=!se.state.silencing;this.sendMessage({type:We,silencing:t}),se.patchState({silencing:t})}dismissSpy(){return new Promise(((t,e)=>{const s=se.state.spying;s?this.sendRemoteSpyDismiss(s).then((()=>{se.patchState({spying:!1}),t(s)})):t(!1)}))}requestSpy(t){return new Promise(((e,s)=>{this.sendSpyRemoteRequestInfo(t).then((()=>{se.patchState({spying:t}),e(t)}))}))}toggleSpy(t){this.dismissControl().then((()=>{this.dismissSpy().then((e=>{e!==t&&this.requestSpy(t).then((t=>{console.log("AgoraService.toggleSpy",t)}))}))}))}sendRemoteRequestPeerInfo(t){return new Promise(((e,s)=>{this.sendMessage({type:Ve,messageId:this.newMessageId(),remoteId:t}).then((t=>{if(t.type===je){if(t.clientInfo.role===ie.Publisher){const e={hosted:!0};t.clientInfo.controllingId&&(e.controlling=t.clientInfo.controllingId,e.mode=t.clientInfo.mode,this.sendControlRemoteRequestInfo(t.clientInfo.controllingId)),se.patchState(e)}e(t)}}))}))}sendRemoteControlRequest(t){return new Promise(((e,s)=>{this.sendMessage({type:Oe,messageId:this.newMessageId(),controllingId:t}).then((s=>{s.type===Ue?e(t):s.type===Be&&e(!1)}))}))}sendRemoteControlDismiss(t){return new Promise(((e,s)=>{this.sendMessage({type:De,messageId:this.newMessageId(),controllingId:t}).then((s=>{s.type===ze?e(t):s.type===Be&&e(!1)}))}))}sendControlRemoteRequestInfo(t){return new Promise(((e,s)=>{this.sendMessage({type:Ne,messageId:this.newMessageId(),remoteId:t}).then((s=>{s.type===Fe&&(se.patchState({controlling:t}),e(s))}))}))}sendSpyRemoteRequestInfo(t){return new Promise(((e,s)=>{this.sendMessage({type:Ne,messageId:this.newMessageId(),remoteId:t}).then((s=>{s.type===Fe&&(se.patchState({spying:t}),e(s))}))}))}sendRemoteSpyDismiss(t){return new Promise(((e,s)=>{this.sendMessage({type:Ge,messageId:this.newMessageId(),remoteId:t}).then((s=>{s.type===qe?e(t):s.type===Ze&&e(!1)}))}))}newMessageId(){return`${se.state.uid}-${Date.now().toString()}`}navToView(t,e,s){void 0===e&&(e=!1),void 0===s&&(s=!1),se.state.controlling!==se.state.uid&&se.state.spying!==se.state.uid||this.sendMessage({type:ns,viewId:t,keepOrientation:e,useLastOrientation:s})}getSessionStats(){this.client.getSessionStats((t=>{console.log(`Current Session Duration: ${t.Duration}`),console.log(`Current Session UserCount: ${t.UserCount}`),console.log(`Current Session SendBytes: ${t.SendBytes}`),console.log(`Current Session RecvBytes: ${t.RecvBytes}`),console.log(`Current Session SendBitrate: ${t.SendBitrate}`),console.log(`Current Session RecvBitrate: ${t.RecvBitrate}`)}))}getSystemStats(){this.client.getSystemStats((t=>{console.log(`Current battery level: ${t.BatteryLevel}`)}))}sendMessage(t){return new Promise(((e,s)=>{if(se.state.connected){switch(t.clientId=se.state.uid,t.type){case Ke:case os:case Ye:case Je:case Qe:case ts:case es:case ss:case is:case as:case rs:if(se.state.controlling!==se.state.uid&&se.state.spying!==se.state.uid)return}const i=(t,s)=>{try{const i=JSON.stringify(t);t.messageId&&this.once(`message-${t.messageId}`,(t=>{e(t)})),s.sendMessage({text:i}).then((()=>{t.messageId||e(t)})).catch((t=>{console.log("AgoraService.sendMessage.error",t)}))}catch(t){console.log("AgoraService.sendMessage.error",t)}},n=this.channel;if(n)i(t,n);else try{this.once("channel",(e=>{i(t,e)}))}catch(t){s(t)}}}))}addOrUpdateChannelAttributes(t){const e=this.messageClient;if(e){const i={};if(t.forEach((t=>{const e=t.date.toString();i[e]=JSON.stringify(t)})),Object.keys(i).length){const t=e.addOrUpdateChannelAttributes(se.state.channelNameLink,i,{enableNotificationToChannelMembers:!1});return s.from(t)}return s.of(null)}return s.of(null)}getChannelAttributes(){const t=this.messageClient;if(t){const e=t.getChannelAttributes(se.state.channelNameLink);return s.from(e).pipe(i.map((t=>Object.keys(t).map((e=>t[e])))),i.map((t=>{t.sort(((t,e)=>t.lastUpdateTs-e.lastUpdateTs));return t.map((t=>JSON.parse(t.value)))})))}return s.of(null)}checkBroadcastMessage(t){switch(t.type){case De:se.patchState({controlling:!1}),t.controllingId===se.state.uid&&this.unpublishScreenStream(),this.sendMessage({type:ze,messageId:t.messageId});break;case Ge:se.patchState({spying:!1}),this.sendMessage({type:qe,messageId:t.messageId,remoteId:t.remoteId});break;case Fe:(se.state.role===ie.Publisher||se.state.controlling&&se.state.controlling!==se.state.uid)&&this.broadcastMessage(t);break;case We:se.state.role===ie.Streamer&&this.broadcastMessage(t);break;case Ke:case Ye:case Je:case Qe:case ts:case es:case ss:case is:case ns:case os:case as:case rs:(se.state.controlling&&se.state.controlling!==se.state.uid||se.state.spying&&se.state.spying!==se.state.uid)&&this.broadcastMessage(t);break;default:this.broadcastMessage(t)}}broadcastMessage(t){Us.out(t)}broadcastEvent(t){Us.out({type:Re,event:t})}onMessage(t,e){if(e!==se.state.uid){const e=JSON.parse(t.text);if(e.messageId&&this.has(`message-${e.messageId}`)&&this.emit(`message-${e.messageId}`,e),e.remoteId&&e.remoteId!==se.state.uid&&e.remoteId!==se.state.screenUid)return;if(e.type===ls){const t=document.createElement("div");t.classList.add("player__vr"),e.container=t}this.checkBroadcastMessage(e)}}onError(t){console.log("AgoraService.onError",t)}onStreamPublished(t){const e=Zs.local;e.clientInfo={role:se.state.role,name:se.state.name,uid:se.state.uid,screenUid:se.state.screenUid},Zs.local=e}onStreamUnpublished(t){Zs.local=null}onStreamAdded(t){const e=this.client,s=t.stream;if(!s)return;const i=s.getId();i!==se.state.uid&&i!==se.state.screenUid&&e.subscribe(s,(t=>{console.log("AgoraService.onStreamAdded.subscribe.error",t)}))}onStreamRemoved(t){const e=t.stream.getId();e!==se.state.uid&&e!==se.state.screenUid&&this.remoteRemove(e)}onStreamSubscribed(t){this.remoteAdd(t.stream)}onPeerConnect(t){this.peerAdd(t)}onPeerLeaved(t){const e=t.uid;if(e!==se.state.uid){const t=this.remoteRemove(e);t.clientInfo&&(t.clientInfo.role===ie.Publisher?se.state.role===ie.SelfService?se.patchState({hosted:!0,controlling:!1,spying:!1,silencing:!1}):se.patchState({hosted:!1,controlling:!1,spying:!1,silencing:!1}):(se.state.controlling===e&&se.patchState({controlling:!1}),se.state.spying===e&&se.patchState({spying:!1})))}this.peerRemove(e)}peerAdd(t){const e={uid:t.uid},s=Zs.peers;s.push(e),Zs.peers=s,this.broadcastEvent(new Cs({peer:e}))}peerRemove(t){const e=Zs.peers,s=e.find((e=>e.uid===t));s&&(e.splice(e.indexOf(s),1),Zs.peers=e)}remoteAdd(t){Zs.remoteAdd(t),this.broadcastEvent(new Ms({stream:t}));const e=t.getId();this.sendRemoteRequestPeerInfo(e).then((t=>{Zs.remoteSetClientInfo(e,t.clientInfo)}))}remoteRemove(t){const e=Zs.remoteRemove(t);return e&&e.clientInfo&&e.clientInfo.role===ie.Publisher&&e.clientInfo.screenUid!==t&&se.patchState({hosted:!1}),e}onMuteVideo(t){this.broadcastEvent(new ks({streamId:t.uid}))}onUnmuteVideo(t){this.broadcastEvent(new Ss({streamId:t.uid}))}onMuteAudio(t){this.broadcastEvent(new Ts({streamId:t.uid}))}onUnmuteAudio(t){this.broadcastEvent(new Es({streamId:t.uid}))}onVolumeIndicator(t){const e=t.attr.map((t=>({streamId:t.uid,level:t.level})));this.broadcastEvent(new Ls({streams:e}))}onConnectionStateChange(t){console.log("AgoraService.onConnectionStateChange",t)}onTokenPrivilegeWillExpire(t){console.log("AgoraService.onTokenPrivilegeWillExpire");const e=this.client,s=this.getChannelNameLink();Ws.rtcToken$(s).subscribe((t=>{t.token&&(e.renewToken(t.token),console.log("AgoraService.onTokenPrivilegeWillExpire.renewed"))}))}onTokenPrivilegeDidExpire(t){console.log("AgoraService.onTokenPrivilegeDidExpire");const e=this.client,s=this.getChannelNameLink();Ws.rtcToken$(s).subscribe((t=>{t.token&&(e.renewToken(t.token),console.log("AgoraService.onTokenPrivilegeDidExpire.renewed"))}))}toggleScreen(){Zs.screen?this.unpublishScreenStream():this.screenClient?this.createScreenStream(se.state.screenUid):this.createScreenClient((()=>{const t=this.getChannelNameLink();Ws.rtcToken$(t).subscribe((e=>{this.screenJoin(e.token,t)}))}))}createScreenClient(t){this.screenClient&&t();const e=this.screenClient=AgoraRTC.createClient({mode:"live",codec:"h264"});(()=>{U.flags.useProxy&&(e.startProxyServer(3),console.log("AgoraService.screenClient.startProxyServer")),e.init(U.appKey,(()=>{t()}),(t=>{this.screenClient=null}))})(),e.on("error",this.onScreenError),e.on("stream-published",this.onScreenStreamPublished),e.on("stream-unpublished",this.onScreenStreamUnpublished)}screenJoin(t,e){const s=this.screenClient,i=Ws.getUniqueUserId();s.join(t,e,i,(t=>{se.patchState({screenUid:t}),this.createScreenStream(t)}),(t=>{console.log("AgoraService.screenJoin.error",t),"DYNAMIC_KEY_EXPIRED"===t&&Ws.rtcToken$(e).subscribe((t=>{this.screenJoin(t.token,e)}))}))}createScreenStream(t){const e={streamID:t,audio:!1,video:!1,screen:!0},s=AgoraRTC.createStream(e);s.setScreenProfile(U.profiles.screen),console.log("AgoraService.createScreenStream",e);const i=()=>{this.unpublishScreenStream()};s.init((()=>{Zs.screen=s,s.on("stopScreenSharing",i),s.muteAudio(),setTimeout((()=>{this.publishScreenStream()}),1)}),(function(t){console.log("AgoraService.createScreenStream.screen.init.error",t)}))}publishScreenStream(){const t=this.screenClient,e=Zs.screen;t.publish(e,(t=>{console.log("AgoraService.publishScreenStream.error",e.getId(),t)})),e.clientInfo={role:se.state.role,name:se.state.name,uid:se.state.uid,screenUid:se.state.screenUid},Zs.screen=e}unpublishScreenStream(){const t=this.screenClient,e=Zs.screen;t&&e&&t.unpublish(e,(t=>{console.log("AgoraService.unpublishScreenStream.error",e.getId(),t)})),Zs.screen=null}leaveScreenClient(){return new Promise(((t,e)=>{const s=this.screenClient;s?s.leave((()=>{this.screenClient=null,U.flags.useProxy&&(s.stopProxyServer(),console.log("AgoraService.screenClient.stopProxyServer")),t()}),(t=>{console.log("AgoraService.leaveScreenClient.error",t),e(t)})):t()}))}onScreenError(t){console.log("AgoraService.onScreenError",t)}onScreenStreamPublished(t){const e=Zs.screen;e.clientInfo={role:se.state.role,name:se.state.name,uid:se.state.uid,screenUid:se.state.screenUid},Zs.screen=e}onScreenStreamUnpublished(t){Zs.screen=null}static rtcToken$(t){return U.flags.useToken?_s.post$("/api/token/rtc",{channelName:t,uid:null}):s.of({token:null})}static rtmToken$(t){return U.flags.useToken?_s.post$("/api/token/rtm",{uid:t}):s.of({token:null})}static checkRtcConnection(){return new Promise(((t,e)=>{try{const s=AgoraRTC.createClient({mode:"live",codec:"h264"});U.flags.useProxy&&s.startProxyServer(3),s.init(U.appKey,(()=>{Ws.checkRtcTryJoin(s).then((e=>{t(e)})).catch((t=>{e(t)})).finally((()=>{s.leave((()=>{U.flags.useProxy&&s.stopProxyServer()}),(()=>{}))}))}),(t=>{e(t)}))}catch(t){e(t)}}))}static checkRtcTryJoin(t){return new Promise(((e,s)=>{const i="checkRtcConnection";Ws.rtcToken$(i).subscribe((n=>{t.join(n.token,i,null,(t=>{e(t)}),(e=>{if("DYNAMIC_KEY_EXPIRED"===e)return Ws.checkRtcTryJoin(t);console.log("AgoraService.checkRtcConnection.error",e),s(e)}))}),(t=>s(t)))}))}static checkRtmConnection(t){return new Promise(((e,s)=>{try{let i,n=AgoraRTM.createInstance(U.appKey,{logFilter:AgoraRTM.LOG_FILTER_OFF});n.setParameters({logFilter:AgoraRTM.LOG_FILTER_OFF}),Ws.rtmToken$(t).subscribe((o=>{n.login({token:o.token,uid:t.toString()}).then((()=>{i=n.createChannel("checkRtcConnection"),i.join().then((()=>{e(t),i.leave()})).catch((t=>{s(t)})).finally((()=>{i.leave().then((()=>{i=null,n.logout().then((()=>{n=null})).catch((()=>{}))})).catch((()=>{}))}))})).catch((t=>{s(t)})).finally((()=>{n&&n.logout().then((()=>{n=null})).catch((()=>{}))}))}),(t=>s(t)))}catch(t){s(t)}}))}static getDevices(){return new Promise(((t,e)=>{let s=Ws.devices_;if(s)t(s);else{s=Ws.devices_=[];const i={audio:!0,video:!0};Ns.platform===Ds&&(i.video={facingMode:"user"}),Ns.platform===js&&(i.video=!1),navigator.mediaDevices&&navigator.mediaDevices.getUserMedia?navigator.mediaDevices.getUserMedia(i).then((i=>{navigator.mediaDevices.enumerateDevices().then((e=>{i.getTracks().forEach((t=>{t.stop()})),e.forEach((t=>{s.push(t)})),t(s)})).catch((t=>{e(t)}))})).catch((t=>{e(t)})):e("Media device not available")}}))}}class Ks{constructor(t,e,s){this.type=us,this.clientId_=e,"string"==typeof t?(this.date=Date.now(),this.clientId=e,this.name=s,this.message=t):"object"==typeof t&&(this.date=t.date,this.clientId=t.clientId,this.name=t.name,this.message=t.message);const i=this.name.split(" ");this.shortName=i[0].substr(0,1).toUpperCase()+(i.length>1?i[1]:i[0]).substr(0,1).toUpperCase()}get me(){return this.clientId===this.clientId_}getPayload(){return{date:this.date,clientId:this.clientId,name:this.name,message:this.message}}getCopy(){return new Ks({date:this.date,clientId:this.clientId,name:this.name,message:this.message},this.clientId_)}}class Xs extends t.Component{onInit(){this.rows=1,this.showEmoji=!1,this.demo=-1!==window.location.pathname.indexOf("layout");const t=this.form=new e.FormGroup({message:null});if(this.controls=t.controls,t.changes$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((t=>{this.checkTypings(t),this.pushChanges()})),se.state$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((t=>{})),Us.out$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((t=>{switch(t.type){case us:this.pushMessage(new Ks(t,se.state.uid,se.state.name));break;case ps:this.typingBegin(t);break;case ms:this.typingEnd(t)}})),this.messages=[],this.groupedMessages=[],this.demo){const t=Xs.getFakeList().map((t=>new Ks(t,se.state.uid,se.state.name)));this.updateMessages(t.slice(0,5)),Us.in$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((t=>{switch(t.clientId=t.clientId||se.state.uid,t.type){case us:break;case ps:case ms:Us.out(t)}}))}else{const t=this.agora=Ws.getSingleton();t&&t.getChannelAttributes().pipe(i.first()).subscribe((t=>{t=t.map((t=>new Ks(t,se.state.uid,se.state.name))),this.updateMessages(t)}))}}onView(){}onChanges(){}onDestroy(){Xs.to&&(clearTimeout(Xs.to),Xs.to=null)}onSubmit(){const t=this.secureText(this.form.value.message),e=this.createMessage(t);this.sendMessage(e),this.form.get("message").value=null,this.demo}onKeyDown(e){if("Enter"===e.key){e.shiftKey?(this.rows=Math.min(4,this.rows+1),this.pushChanges()):(e.preventDefault(),this.onSubmit(),this.rows=1);const{node:s}=t.getContext(this);s.querySelector("textarea").setAttribute("rows",this.rows)}}onToggleEmoji(){this.showEmoji=!this.showEmoji,this.pushChanges()}onSelectEmoji(t){this.showEmoji=!1,this.form.get("message").value=(this.form.get("message").value||"")+t.char}secureText(t){return(new DOMParser).parseFromString(t,"text/html").body.textContent||""}createMessage(t){return new Ks(t,se.state.uid,se.state.name)}sendMessage(t){this.pushMessage(t);const e=this.agora;e&&e.addOrUpdateChannelAttributes([t.getPayload()]).pipe(i.first()).subscribe(),Us.send(t)}onClose(t){this.close.next()}scrollToBottom(){const{node:e}=t.getContext(this),s=e.querySelector(".group--scrollview");s.scrollTop=s.scrollHeight}pushMessage(t){const e=this.messages?this.messages.slice():[];this.removeTyping({type:ps,clientId:t.clientId},this.messages),e.push(t),this.updateMessages(e)}typingBegin(t){const e=this.messages?this.messages.slice():[];e.push(t),this.updateMessages(e)}typingEnd(t){const e=this.messages?this.messages.slice():[];this.removeTyping({type:ps,clientId:t.clientId},e),this.updateMessages(e)}removeTyping(t,e,s){void 0===s&&(s=!0);const i=e.reduce(((e,s,i)=>s.type===t.type&&s.clientId===t.clientId?i:e),-1);return-1!==i&&(e.splice(i,1),!0===s&&this.removeTyping(t,e,!0)),i}checkTypings(t){const e=t.message&&t.message.length>0;this.typings_!==e&&(this.typings_=e,e?Us.send({type:ps}):Us.send({type:ms}))}updateMessages(t){this.messages=t,this.groupedMessages=[],this.pushChanges();const e=[];t.forEach((t=>{if(t.type===us){const s=e.length?e[e.length-1]:null;s&&s.clientId===t.clientId?s.message+=`<p>${t.message}</p>`:e.push(t.getCopy())}else if(t.type===ps){const s=e.reduce(((e,s,i)=>s.clientId===t.clientId?s:e),null);s&&(s.typing=!0)}})),this.groupedMessages=e,this.pushChanges(),setTimeout((()=>{this.scrollToBottom()}),1)}isValid(){return this.form.valid&&this.form.value.message&&this.form.value.message.length>0}randomMessage(){Xs.to&&(clearTimeout(Xs.to),Xs.to=null),Xs.to=setTimeout((()=>{const t=Xs.createRandomMessage();this.sendMessage(t)}),1e3*(2+6*Math.random()))}}Xs.meta={selector:"[agora-chat]",outputs:["close"],template:'\n\t\t<div class="group--scrollview" [class]="\'rows--\' + rows">\n\t\t\t<div class="group--virtual" *virtual="let item of groupedMessages" [mode]="4" [width]="350" [gutter]="0" [reverse]="true">\n\t\t\t\t\x3c!-- serve un nodo figlio --\x3e\n\t\t\t\t<div class="listing__item message" [class]="{ me: item.me, typing: item.typing }">\n\t\t\t\t\t<div class="message__avatar" [title]="item.name"><span [innerHTML]="item.shortName"></span></div>\n\t\t\t\t\t<div class="message__content">\n\t\t\t\t\t\t<div [innerHTML]="item.message | message"></div>\n\t\t\t\t\t\t<div class="typing-indicator">\n\t\t\t\t\t\t\t<span></span>\n\t\t\t\t\t\t\t<span></span>\n\t\t\t\t\t\t\t<span></span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="group--message" [class]="\'rows--\' + rows">\n\t\t\t<form class="form" [formGroup]="form" (submit)="isValid() && onSubmit($event)" name="form" role="form" novalidate autocomplete="off">\n\t\t\t\t<div class="group--form group--form--addon" [class]="{ required: controls.message.validators.length, \'addon\': controls.message.valid }">\n\t\t\t\t\t\x3c!-- <input type="text" class="control--text" [formControl]="controls.message" [placeholder]="\'bhere_write_a_message\' | label" /> --\x3e\n\t\t\t\t\t<button type="button" class="control--pre" (click)="onToggleEmoji()">\n\t\t\t\t\t\t<svg class="emoji" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#emoji"></use></svg>\n\t\t\t\t\t</button>\n\t\t\t\t\t<textarea class="control--text" [formControl]="controls.message" [placeholder]="\'bhere_write_a_message\' | label" rows="1" (keydown)="onKeyDown($event)"></textarea>\n\t\t\t\t\t<button type="submit" class="control--addon">\n\t\t\t\t\t\t<svg class="copy" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#send"></use></svg>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t</form>\n\t\t</div>\n\t\t<div class="group--close">\n\t\t\t<button type="button" class="btn--close" [title]="\'title_close\' | label" (click)="onClose($event)">\n\t\t\t\t<svg class="copy" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#close"></use></svg>\n\t\t\t</button>\n\t\t</div>\n\t\t<div class="group--emoji" [class]="\'rows--\' + rows" agora-chat-emoji (emoji)="onSelectEmoji($event)" (close)="onToggleEmoji()" *if="showEmoji">\n\t\t\t<div class="group--virtual" *virtual="let item of items" [mode]="1" [width]="40" [gutter]="10" [reverse]="true">\n\t\t\t\t\x3c!-- serve un nodo figlio --\x3e\n\t\t\t\t<div class="listing__item emoji">\n\t\t\t\t\t<button type="button" class="btn--emoji" (click)="onSelect(item)"><span [innerHTML]="item.char"></span></button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="group--close">\n\t\t\t\t<button type="button" class="btn--close" [title]="\'title_close\' | label" (click)="onClose($event)">\n\t\t\t\t\t<svg class="copy" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#close"></use></svg>\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t</div>\n\t'},Xs.getFakeList=()=>{let t=[{date:161459223e4,name:"Jhon Appleseed",message:"Function-based web-enabled benchmark",clientId:"7341614597544882"},{date:161459224e4,name:"Jhon Appleseed",message:"Customizable exuding superstructure",clientId:"7341614597544882"},{date:161459225e4,name:"Gilles Pitkins",message:"Synergistic interactive archive",clientId:"cfe9ff5b-f7da-449d-bf5a-3184b5eba6ea"},{date:161459226e4,name:"Jhon Appleseed",message:"Digitized client-server initiative",clientId:"7341614597544882"},{date:161459227e4,name:"Jhon Appleseed",message:"Quality-focused tertiary open system",clientId:"7341614597544882"},{date:161459228e4,name:"Jhon Appleseed",message:"Exclusive uniform middleware",clientId:"7341614597544882"},{date:161459229e4,name:"John Pruckner",message:"Decentralized disintermediate extranet",clientId:"ae51e846-d043-41e9-bb5c-3189181e5b43"},{date:16145923e5,name:"Lamont Georgievski",message:"Enhanced static approach",clientId:"1961cd9e-93aa-4bd0-b96a-89fcbd36b257"},{date:161459231e4,name:"Jhon Appleseed",message:"Ergonomic clear-thinking info-mediaries",clientId:"7341614597544882"},{date:161459232e4,name:"Jeri Pedroni",message:"Grass-roots dynamic encryption",clientId:"13d69bba-3656-449b-8fe3-d7a87062b044"},{date:161459233e4,name:"Frederik Dechelle",message:"Compatible disintermediate policy",clientId:"9151ebe0-efa8-40b4-a341-b8fd489e9c88"},{date:161459234e4,name:"Jhon Appleseed",message:"Inverse user-facing adapter",clientId:"7341614597544882"},{date:161459235e4,name:"Jhon Appleseed",message:"Future-proofed even-keeled application",clientId:"7341614597544882"},{date:161459236e4,name:"Cassie Jonathon",message:"Profit-focused content-based budgetary management",clientId:"5b3dc6f3-2a3d-493d-aac5-66ddfce2d709"},{date:161459237e4,name:"Jhon Appleseed",message:"Managed intermediate monitoring",clientId:"7341614597544882"},{date:161459238e4,name:"Jhon Appleseed",message:"Exclusive client-server encoding",clientId:"7341614597544882"},{date:161459239e4,name:"Jhon Appleseed",message:"Cross-group system-worthy matrices",clientId:"7341614597544882"},{date:16145924e5,name:"Jhon Appleseed",message:"Upgradable encompassing benchmark",clientId:"7341614597544882"},{date:161459241e4,name:"Emelen Beevors",message:"Function-based full-range knowledge base",clientId:"c93aea47-ebd8-4e5e-88fd-52053dd35cd1"},{date:161459242e4,name:"Jhon Appleseed",message:"Synergistic system-worthy capability",clientId:"7341614597544882"}];for(;t.length<100;)t=t.concat(t);return t},Xs.createRandomMessage=t=>new Ks({date:Date.now(),clientId:"9fe0e1b9-6a6b-418b-b916-4bbff3eeb123",name:"Herman frederick",message:"Lorem ipsum dolor"},se.state.uid,se.state.name),Xs.randomMessage=(t,e)=>{Xs.to&&(clearTimeout(Xs.to),Xs.to=null),Xs.to=setTimeout((()=>{const s=function(){const t=e.filter((t=>"7341614597544882"!==t.id));let s=t[Math.floor(t.length*Math.random())];return s=new Ks({date:Date.now(),clientId:"9fe0e1b9-6a6b-418b-b916-4bbff3eeb123",name:s.name,message:s.message},se.state.uid,se.state.name),s}();t.sendMessage(s),Xs.randomMessage(t,e)}),1e3*(2+6*Math.random()))};class Ys extends t.Component{}Ys.meta={selector:"[agora-check]",inputs:["value"],template:'\n\t\t<svg *if="value == null" class="checkmark idle" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 52 52">\n\t\t\t<circle class="checkmark__circle" cx="26" cy="26" r="25" fill="none"/>\n\t\t</svg>\n\t\t<svg *if="value === true" class="checkmark success" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 52 52">\n\t\t\t<circle class="checkmark__circle" cx="26" cy="26" r="25" fill="none"/>\n\t\t\t<path class="checkmark__icon" fill="none" d="M14.1 27.2l7.1 7.2 16.7-16.8" stroke-linecap="round"/>\n\t\t</svg>\n\t\t<svg *if="value === false" class="checkmark error" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 52 52">\n\t\t\t<circle class="checkmark__circle" cx="26" cy="26" r="25" fill="none"/>\n\t\t\t<path class="checkmark__icon" stroke-linecap="round" fill="none" d="M16 16 36 36 M36 16 16 36"/>\n\t\t</svg>\n\t'};class Js{constructor(t){this.data=t}}class Qs extends Js{}class ti extends Js{}class ei{static get hasModal(){return this.hasModal_}static set hasModal(t){if(this.hasModal_!==t){this.hasModal_=t;const e=document.querySelector("body");t?e.classList.add("modal-open"):e.classList.remove("modal-open")}}static open$(t){return this.busy$.next(!0),(t.iframe?s.of(`<div class="iframe-modal" iframe-modal src="${t.iframe}"></div>`):this.getTemplate$(t)).pipe(i.map((e=>({node:this.getNode(e),data:t.data,modal:t}))),i.tap((t=>{this.modal$.next(t),this.hasModal=!0,this.busy$.next(!1)})),i.switchMap((t=>this.events$)),i.tap((t=>this.hasModal=!1)))}static getTemplate$(t){return t.src?s.from(fetch(t.src).then((t=>t.text()))):t.template?s.of(t.template):EMPTY}static getNode(t){const e=document.createElement("div");e.innerHTML=t;return e.firstElementChild}static reject(t){this.modal$.next(null),this.events$.next(new ti(t))}static resolve(t){this.modal$.next(null),this.events$.next(new Qs(t))}}ei.modal$=new s.Subject,ei.events$=new s.Subject,ei.busy$=new s.Subject;class si{static delete(t){this.isLocalStorageSupported()&&window.localStorage.removeItem(t)}static exist(t){if(this.isLocalStorageSupported())return void 0!==window.localStorage[t]}static get(t){let e=null;if(this.isLocalStorageSupported()&&void 0!==window.localStorage[t])try{e=JSON.parse(window.localStorage[t])}catch(e){console.log("LocalStorageService.get.error parsing",t,e)}return e}static set(t,e){if(this.isLocalStorageSupported())try{const s=[],i=JSON.stringify(e,(function(t,e){if("object"==typeof e&&null!==e){if(-1!==s.indexOf(e))return;s.push(e)}return e}));window.localStorage.setItem(t,i)}catch(s){console.log("LocalStorageService.set.error serializing",t,e,s)}}static isLocalStorageSupported(){if(this.supported)return!0;let t=!1;try{t="localStorage"in window&&null!==window.localStorage,t?(window.localStorage.setItem("test","1"),window.localStorage.removeItem("test")):t=!1}catch(e){t=!1}return this.supported=t,t}}const ii=100;class ni{static checklist$(){return se.state$.pipe(i.first(),i.map((t=>{const e={shouldCheckAudio:!0,shouldCheckVideo:!0,key:"checklist_audio_video",uid:null,checklist:{browser:null,https:null,video:null,audio:null,rtc:null,rtm:null},errors:{}};return t.role===ie.Viewer&&(e.shouldCheckAudio=!1,e.shouldCheckVideo=!1),Ns.platform===js&&(e.shouldCheckAudio=!0,e.shouldCheckVideo=!1),e.key=`checklist${e.shouldCheckAudio?"_audio":""}${e.shouldCheckVideo?"_video":""}`,e})),i.switchMap((t=>(!0===si.get(t.key)&&Object.keys(t.checklist).forEach((e=>{t.checklist[e]=!0})),s.of(t)))))}static isChecked(t){return Object.keys(t.checklist).reduce(((e,s,i)=>{const n=e&&t.checklist[s];switch(s){case"audio":return n||!t.shouldCheckAudio;case"video":return n||!t.shouldCheckVideo;default:return n}}),!0)}static isChecked$(){return this.checklist$().pipe(i.map((t=>this.isChecked(t))))}static checkEvent$(){return this.checklist$().pipe(i.switchMap((t=>{if(!0===Object.keys(t.checklist).reduce(((e,s,i)=>e&&t.checklist[s]),!0))return s.of(t);{si.set(t.key,!1);const e=new s.Subject,n=s.of(t).pipe(i.delay(1e3),i.switchMap((t=>(e.next(t),this.checkBrowserEvent$(t)))),i.switchMap((t=>(e.next(t),this.checkHttpsEvent$(t)))),i.switchMap((t=>(e.next(t),this.checkAudioEvent$(t)))),i.switchMap((t=>(e.next(t),this.checkVideoEvent$(t)))),i.switchMap((t=>(e.next(t),this.checkRtcEvent$(t)))),i.switchMap((t=>(e.next(t),this.checkRtmEvent$(t)))),i.tap((t=>{si.set(t.key,!0)})));return s.merge(e,n)}})))}static check$(){return this.checklist$().pipe(i.switchMap((t=>!0===Object.keys(t.checklist).reduce(((e,s,i)=>e&&t.checklist[s]),!0)?s.of(t):(si.set(t.key,!1),s.of(t).pipe(i.delay(1e3),i.switchMap((t=>this.checkBrowserEvent$(t))),i.switchMap((t=>this.checkHttpsEvent$(t))),i.switchMap((t=>this.checkAudioEvent$(t))),i.switchMap((t=>this.checkVideoEvent$(t))),i.switchMap((t=>this.checkRtcEvent$(t))),i.switchMap((t=>this.checkRtmEvent$(t))),i.tap((t=>{si.set(t.key,!0)})))))))}static checkBrowser$(){const t=AgoraRTC.checkSystemRequirements();return s.of(t)}static checkBrowserEvent$(t){return this.checkBrowser$().pipe(i.switchMap((e=>(t.checklist.browser=e,e?s.of(t).pipe(i.delay(ii)):(t.errors.browser=ge.transform("bhere_browser_error"),this.checkHttpsEvent$(t).pipe(i.switchMap((t=>s.throwError(t)))))))),i.catchError((e=>(console.log("checkBrowserEvent$.error",e),t.checklist.browser=!1,t.errors.browser=ge.transform("bhere_browser_error"),s.throwError(t)))))}static checkHttps$(){const t="https:"===window.location.protocol;return s.of(t)}static checkHttpsEvent$(t){return this.checkHttps$().pipe(i.switchMap((e=>(t.checklist.https=e,e?s.of(t).pipe(i.delay(ii)):(t.errors.https=ge.transform("bhere_https_error"),s.throwError(t))))),i.catchError((e=>(console.log("checkHttpsEvent$.error",e),t.checklist.https=!1,t.errors.https=ge.transform("bhere_https_error"),s.throwError(t)))))}static checkAudio$(){return s.from(Ws.getDevices()).pipe(i.map((t=>null!=t.find((t=>"audioinput"===t.kind&&t.deviceId)))))}static checkAudioEvent$(t){return t.shouldCheckAudio?this.checkAudio$().pipe(i.switchMap((e=>(t.checklist.audio=e,e?s.of(t).pipe(i.delay(ii)):(t.errors.audio=ge.transform("bhere_audio_error"),s.throwError(t))))),i.catchError((e=>(console.log("checkAudioEvent$.error",e),t.checklist.audio=!1,t.errors.audio=ge.transform("bhere_audio_error"),s.throwError(t))))):s.of(t)}static checkVideo$(){return s.from(Ws.getDevices()).pipe(i.map((t=>null!=t.find((t=>"videoinput"===t.kind&&t.deviceId)))))}static checkVideoEvent$(t){return t.shouldCheckVideo?this.checkVideo$().pipe(i.switchMap((e=>(t.checklist.video=e,e?s.of(t).pipe(i.delay(ii)):(t.errors.video=ge.transform("bhere_video_error"),s.throwError(t))))),i.catchError((e=>(console.log("checkVideoEvent$.error",e),t.checklist.video=!1,t.errors.video=ge.transform("bhere_video_error"),s.throwError(t))))):s.of(t)}static checkRtc$(){return s.from(Ws.checkRtcConnection())}static checkRtcEvent$(t){return this.checkRtc$().pipe(i.switchMap((e=>(t.uid=e,t.checklist.rtc=!1!==e,e?s.of(t).pipe(i.delay(ii)):(t.errors.rtc=ge.transform("bhere_rtc_error"),s.throwError(t))))),i.catchError((e=>(console.log("checkRtcEvent$.error",e),t.checklist.rtc=!1,t.errors.rtc=ge.transform("bhere_rtc_error"),s.throwError(t)))))}static checkRtm$(t){return s.from(Ws.checkRtmConnection(t))}static checkRtmEvent$(t){return this.checkRtm$(t.uid).pipe(i.switchMap((e=>(t.checklist.rtm=!1!==e,e?s.of(t):(t.errors.rtm=ge.transform("bhere_rtm_error"),s.throwError(t))))),i.catchError((e=>(console.log("checkRtmEvent$.error",e),t.checklist.rtm=!1,t.errors.rtm=ge.transform("bhere_rtm_error"),s.throwError(t)))))}}class oi extends t.Component{onClose(){ei.resolve()}}oi.meta={selector:"[agora-configure-firewall-modal]",template:'\n\t\t<div class="modal__header">\n\t\t\t<button type="button" class="btn--close" (click)="onClose()">\n\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#close"></use></svg>\n\t\t\t</button>\n\t\t</div>\n\t\t<div class="container">\n\t\t\t<div class="form" [innerHTML]="\'bhere_configure_firewall\' | label"></div>\n\t\t\t<div class="group--cta">\n\t\t\t\t<button type="button" class="btn--accept" (click)="onClose()">\n\t\t\t\t\t<span>Chiudi</span>\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t</div>\n\t'},oi.chunk=()=>'<div class="configure-firewall-modal" agora-configure-firewall-modal></div>';class ai extends t.Component{onInit(){this.platform=Ns.platform,this.checklist={},this.errors={},this.state={},this.busy=!0,this.shouldCheckAudio=!1,this.shouldCheckVideo=!1,ni.checkEvent$().pipe(i.takeUntil(this.unsubscribe$)).subscribe((t=>{this.shouldCheckAudio=t.shouldCheckAudio,this.shouldCheckVideo=t.shouldCheckVideo,this.checklist=t.checklist,this.errors=t.errors||{};const e=ni.isChecked(t);e?(this.checklist.success=e,this.busy=!1,this.pushChanges(),this.state.role===ie.SmartDevice&&this.onNext()):this.pushChanges()}),(t=>{this.errors=t.errors||{},this.checklist.error=!0,this.busy=!1,this.pushChanges()}))}onNext(){this.checked.next(this.checklist)}openHttps(){window.location.href=window.location.href.replace("http://","https://").replace(":5000",":6443")}showFirewallConfiguration(){ei.open$({template:oi.chunk()}).pipe(i.first()).subscribe()}}ai.meta={selector:"[agora-checklist]",outputs:["checked"],template:'\n\t<div class="group--info">\n\t\t<div class="group--info__content stagger--childs">\n\t\t\t<div class="title" *if="busy" [innerHTML]="\'bhere_checklist_busy\' | label"></div>\n\t\t\t<div class="title" *if="checklist.success" [innerHTML]="\'bhere_checklist_success\' | label"></div>\n\t\t\t<div class="title" *if="checklist.error" [innerHTML]="\'bhere_checklist_error\' | label"></div>\n\t\t\t<ul class="group--checklist stagger--childs">\n\t\t\t\t<li class="checklist__item check"><span>Browser</span> <span agora-check [value]="checklist.browser"></span></li>\n\t\t\t\t<li class="checklist__item error" *if="errors.browser"><a class="btn--link" href="https://browsehappy.com/" target="_blank" rel="noopener" [innerHTML]="errors.browser"></a></li>\n\t\t\t\t<li class="checklist__item check"><span>Https</span> <span agora-check [value]="checklist.https"></span></li>\n\t\t\t\t<li class="checklist__item error" *if="errors.https"><a class="btn--link" (click)="openHttps()" [innerHTML]="errors.https"></a></li>\n\t\t\t\t<li class="checklist__item check" *if="shouldCheckAudio"><span>Audio</span> <span agora-check [value]="checklist.audio"></span></li>\n\t\t\t\t<li class="checklist__item error" *if="errors.audio"><span [innerHTML]="errors.audio"></span></li>\n\t\t\t\t<li class="checklist__item check" *if="shouldCheckVideo"><span>Video</span> <span agora-check [value]="checklist.video"></span></li>\n\t\t\t\t<li class="checklist__item error" *if="errors.video"><span [innerHTML]="errors.video"></span></li>\n\t\t\t\t<li class="checklist__item check"><span>Realtime Communication</span> <span agora-check [value]="checklist.rtc"></span></li>\n\t\t\t\t<li class="checklist__item error" *if="errors.rtc"><a class="btn--link" (click)="showFirewallConfiguration()" [innerHTML]="errors.rtc"></a></li>\n\t\t\t\t<li class="checklist__item check"><span>Realtime Messaging</span> <span agora-check [value]="checklist.rtm"></span></li>\n\t\t\t\t<li class="checklist__item error" *if="errors.rtm"><a class="btn--link" (click)="showFirewallConfiguration()" [innerHTML]="errors.rtm"></a></li>\n\t\t\t</ul>\n\t\t\t<button type="submit" class="btn--next" [class]="{ disabled: !checklist.success, ready: checklist.success }" (click)="onNext()">\n\t\t\t\t<span [innerHTML]="\'bhere_proceed\' | label"></span>\n\t\t\t</button>\n\t\t</div>\n\t</div>\n\t'};class ri{static get context(){return!this.context_&&"AudioContext"in window&&(this.context_=new AudioContext),this.context_}static get analyser(){if(!this.analyser_)try{this.analyser_=this.context.createAnalyser()}catch(t){console.log("AudioStreamService.analyser",t)}return this.analyser_}static addSource(t){const e=t instanceof MediaStream?t.id:t;return this.sources_[e]||(t instanceof MediaStream?this.sources_[e]=this.context.createMediaStreamSource(t.clone()):this.sources_[e]=this.context.createMediaElementSource(t)),this.sources_[e]}static removeSource(t){const e=t instanceof MediaStream?t.id:t;return this.removeSourceKey(e)}static removeSourceKey(t){let e;return this.sources_[t]&&(e=this.sources_[t],this.analyser&&e.disconnect(this.analyser),e.disconnect(),delete this.sources_[t]),e}static frequency$(t,e){if(void 0===e&&(e=64),e%2==1)throw e;const n=new Uint8Array(e/2);if(this.context){const o=this.analyser;if(o){o.fftSize=e;this.addSource(t).connect(o)}const a=new s.BehaviorSubject(n);return ri.frame$.pipe(i.withLatestFrom(a),i.map((t=>{let[e,s]=t;return o&&o.getByteFrequencyData(s),s})),i.tap((t=>a.next(t))),i.finalize((()=>{this.removeSource(t)})))}return s.of(n)}static volume$(t){const e={volume:0,clipped:!1};if(this.context){const n=this.addSource(t),o=ri.audioMeterCreate();n.connect(o);const a=new s.BehaviorSubject(e);return ri.frame$.pipe(i.withLatestFrom(a),i.map((t=>{let[e,s]=t;return s.clipped=o.checkClipping(),s.volume=o.volume,s})),i.tap((t=>a.next(t))),i.finalize((()=>{this.removeSource(t)})))}return s.of(e)}static audioMeterCreate(t,e,s){void 0===t&&(t=.98),void 0===e&&(e=.95),void 0===s&&(s=750);const i=this.context;if(i){const n=i.createScriptProcessor(512);return n.onaudioprocess=this.audioMeterProcess,n.checkClipping=this.audioMeterClip,n.dispose=this.audioMeterDispose,n.clipping=!1,n.lastClip=0,n.volume=0,n.clipLevel=t,n.averaging=e,n.clipLag=s,n.connect(i.destination),n}}static audioMeterProcess(t){const e=t.inputBuffer.getChannelData(0),s=e.length;let i,n=0;for(let t=0;t<s;t++)i=e[t],Math.abs(i)>=this.clipLevel&&(this.clipping=!0,this.lastClip=window.performance.now()),n+=i*i;const o=Math.sqrt(n/s);this.volume=Math.max(o,this.volume*this.averaging)}static audioMeterClip(){return!!this.clipping&&(this.lastClip+this.clipLag<window.performance.now()&&(this.clipping=!1),this.clipping)}static audioMeterDispose(){this.disconnect(),this.onaudioprocess=null}static step$(t){return s.Observable.create((e=>{requestAnimationFrame((s=>{const i=t?(s-t.startTime)/1e3:0;e.next({startTime:s,deltaTime:i})}))})).pipe(i.map((t=>(t.deltaTime>1/30&&(t.deltaTime=1/30),t))))}static dispose(){Object.keys(this.sources_).forEach((t=>{this.removeSourceKey(t)}));const t=this.analyser;t&&t.disconnect(),this.sources_={}}}ri.sources_={},ri.frame$=s.of(void 0).pipe(i.expand((t=>ri.step$(t))),i.filter((t=>void 0!==t)),i.map((t=>t.deltaTime)),i.share());class li extends t.Component{get video(){return this.video_}set video(t){this.video_!==t&&(this.video_=t,this.change&&(this.change.next(),this.init(),this.initStream()))}get audio(){return this.audio_}set audio(t){this.audio_!==t&&(this.audio_=t,this.change&&(this.change.next(),this.init(),this.initStream()))}get hasPreview(){return this.platform!==Ds&&this.platform!==js}onInit(){this.init()}init(){if(this.initialized_)return;this.initialized_=!0,this.platform=Ns.platform;const{node:e}=t.getContext(this);this.onLoadedMetadata=this.onLoadedMetadata.bind(this);(this.preview=e.querySelector("video")).addEventListener("loadedmetadata",this.onLoadedMetadata);const s=e.querySelector(".audio");this.hasPreview&&(this.bars=new Array(32).fill(0).map((t=>{const e=document.createElement("div");return e.classList.add("bar"),s.appendChild(e),e})))}onDestroy(){this.preview.removeEventListener("loadedmetadata",this.onLoadedMetadata),this.hasPreview&&ri.dispose()}initStream(){const e=this.preview;if(!this.preview)return;const{node:s}=t.getContext(this);if(this.video_||this.audio_){if(s.classList.add("ready"),navigator.mediaDevices&&navigator.mediaDevices.getUserMedia){const t=xe(se.state),s={video:!!this.video_&&{deviceId:this.video_,width:{ideal:t.resolution.width},height:{ideal:t.resolution.height},frameRate:{ideal:t.frameRate.min,max:t.frameRate.max}},audio:!!this.audio_&&{deviceId:this.audio_}};this.platform===Ds&&(s.video.facingMode="user"),navigator.mediaDevices.getUserMedia(s).then((t=>{this.hasPreview?("srcObject"in e?e.srcObject=t:e.src=window.URL.createObjectURL(t),this.audio_&&this.analyzeData(t),this.loadingStream_=t):this.stream.next(t)})).catch((t=>{console.log("AgoraDevicePreviewComponent.initStream.error",t.name,t.message),this.stream.next(null)}))}}else s.classList.remove("ready"),this.hasPreview&&("srcObject"in e?e.srcObject=null:e.src=null,this.analyzeData(null)),this.stream.next(null)}onLoadedMetadata(e){const{node:s}=t.getContext(this);s.classList.add("loaded"),this.preview.play(),this.stream.next(this.loadingStream_)}analyzeData(t){this.frequencySubscription&&this.frequencySubscription.unsubscribe(),t&&(this.frequencySubscription=ri.frequency$(t,64).pipe(i.takeUntil(this.unsubscribe$)).subscribe((t=>{this.bars.forEach(((e,s)=>{const i=Math.min(100,5+t[s])/100;e.style.left=3.125*s+"%",e.style.transform=`scale(1,${i})`,e.style.opacity=i}))})))}}li.meta={selector:"[agora-device-preview]",outputs:["stream","change"],inputs:["video","audio"]};class ci extends t.Component{get hasPreview(){return this.platform!==Ds&&this.platform!==js}onInit(){if(this.platform=Ns.platform,this.isHttps="https:"===window.location.protocol,this.state={},this.devices={videos:[],audios:[]},this.stream=null,this.form=null,this.isHttps){const t=this.agora=Ws.getSingleton();se.state$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((t=>{this.state=t,this.pushChanges()})),t&&t.devices$().subscribe((t=>{this.devices=t,this.initForm(t),this.pushChanges()}),(t=>{console.log("AgoraDeviceComponent.devices$.error",t)}))}}openHttps(t){window.location.href=window.location.href.replace("http://","https://").replace(":5000",":6443")}initForm(t){const s=this.form=new e.FormGroup({video:new e.FormControl(null,t.videos.length?e.Validators.RequiredValidator():void 0),audio:new e.FormControl(null,t.audios.length?e.Validators.RequiredValidator():void 0)}),n=this.controls=s.controls,o=t.videos.map((t=>({id:t.deviceId,name:t.label})));o.length>0&&o.unshift({id:null,name:"bhere_select_video"}),n.video.options=o;const a=t.audios.map((t=>({id:t.deviceId,name:t.label})));a.length>0&&a.unshift({id:null,name:"bhere_select_audio"}),n.audio.options=a,s.changes$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((t=>{this.pushChanges()}))}onStreamDidChange(t){this.stream=null,this.pushChanges()}onStream(t){this.stream=t,this.pushChanges()}isValid(){return this.form.valid&&(this.stream||!this.hasPreview)}onEnter(t){const e=this.form.value,s=this.devices;s.video=s.videos.find((t=>t.deviceId===e.video)),s.audio=s.audios.find((t=>t.deviceId===e.audio)),this.enter.next(s)}}ci.meta={selector:"[agora-device]",outputs:["enter"],template:'\n\t<div class="group--info" *if="!isHttps">\n\t\t<div class="group--info__content stagger--childs">\n\t\t\t<div class="title" [innerHTML]="\'bhere_invalid_protocol\' | label"></div>\n\t\t\t<div class="info" [innerHTML]="\'bhere_reload_in_https\' | label"></div>\n\t\t\t<button type="button" class="btn--connect" (click)="openHttps($event)">\n\t\t\t\t<span [innerHTML]="\'bhere_reload\' | label"></span>\n\t\t\t</button>\n\t\t</div>\n\t</div>\n\t<div class="group--info" *if="form">\n\t\t<form class="form" [formGroup]="form" (submit)="isValid() && onEnter($event)" name="form" role="form" novalidate autocomplete="off">\n\t\t\t\x3c!-- PREVIEW --\x3e\n\t\t\t<div class="agora-device-preview" agora-device-preview [video]="controls.video.value" [audio]="controls.audio.value" (stream)="onStream($event)" (change)="onStreamDidChange($event)" *if="this.hasPreview">\n\t\t\t\t<video class="video" muted></video>\n\t\t\t\t<div class="audio"></div>\n\t\t\t</div>\n\t\t\t<div class="group--info__content stagger--childs">\n\t\t\t\t\x3c!-- VIDEO --\x3e\n\t\t\t\t<div control-custom-select [control]="controls.video" label="Video" *if="devices.videos.length"></div>\n\t\t\t\t\x3c!-- AUDIO --\x3e\n\t\t\t\t<div control-custom-select [control]="controls.audio" label="Audio" *if="devices.audios.length"></div>\n\t\t\t\t<div class="info" *if="!isValid()" [innerHTML]="\'bhere_select_video_audio\' | label"></div>\n\t\t\t\t<div class="info" *if="isValid()" [innerHTML]="\'bhere_video_audio_connected\' | label"></div>\n\t\t\t\t<button type="submit" class="btn--connect" [class]="{ disabled: !isValid() }">\n\t\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#call"></use></svg>\n\t\t\t\t\t<span *if="!state.connecting" [innerHTML]="\'bhere_enter\' | label"></span>\n\t\t\t\t\t<span *if="state.connecting" [innerHTML]="\'bhere_connecting\' | label"></span>\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t</form>\n\t</div>\n\t'};class di{constructor(t){t&&Object.assign(this,t),this.items=this.items||[],this.originalItems=this.items.slice()}get payload(){const t={};return Object.keys(this).forEach((e=>{-1!==View.allowedProps.indexOf(e)&&(t[e]=this[e])})),t}}function hi(t){return t=new di(t)}di.allowedProps=["id","name","items"];const ui={id:null,name:"Principale",items:[]};class pi{static set paths(t){this.paths$.next(t)}static get paths(){return this.paths$.getValue()}static set path(t){this.path$.next(t)}static get path(){return this.path$.getValue()}static getCurrentPath$(t){return void 0===t&&(t=null),this.pathGet$().pipe(i.switchMap((e=>{this.paths=e;let s=ui;if(t){const i=e.find((e=>e.id===t));i&&(s=i)}return this.path=s,this.path$})))}static pathGet$(){return U.flags.usePaths?_s.get$("/api/path").pipe(i.map((t=>(t.paths=t.paths.map((t=>hi(t))),t.paths.unshift(ui),t.paths)))):s.of([])}static addPath(t){const e=this.paths.slice();e.push(t),this.paths=e,this.path=t}static editPath(t){const e=this.paths.slice(),s=e.reduce(((e,s,i)=>s.id===t.id?i:e),-1);if(s>0){let i=this.path;i.id===t.id&&(i=t),e.splice(s,1,t),this.paths=e,this.path=i}}static deletePath(t){const e=this.paths.slice(),s=e.indexOf(t);if(s>0){e.splice(s,1),this.paths=e;let i=this.path;i.id===t.id&&(i=e[0]),this.path=i}}static pathCreate$(t){return _s.post$("/api/path",t).pipe(i.map((t=>hi(t))))}static pathUpdate$(t){return _s.put$(`/api/path/${t.id}`,t).pipe(i.map((t=>hi(t))))}static pathDelete$(t){return _s.delete$(`/api/path/${t.id}`)}}pi.paths$=new s.BehaviorSubject([ui]),pi.path$=new s.BehaviorSubject(ui);class mi extends t.Component{get selfServiceTourRoute(){const t=this.form.get("path").value,e=[we.transform(":lang.selfServiceTour")];return t&&e.push(re.validateParams({pathId:t})),e}onInit(){this.state={},this.paths=[],this.pathId=null,this.form=null,se.state$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((t=>{this.state=t,this.pushChanges()})),U.flags.usePaths?pi.getCurrentPath$().pipe(i.first(),i.tap(),i.takeUntil(this.unsubscribe$)).subscribe((t=>{this.paths=pi.paths,this.pathId=t.id||"",this.onLoad()})):this.onLoad()}onLoad(){const t=this.form=new e.FormGroup({path:this.pathId,id:new e.FormControl(null,[e.Validators.PatternValidator(oe),e.Validators.RequiredValidator()]),idAttendee:null,idStreamer:null,idViewer:null,idSmartDevice:null}),s=this.controls=t.controls,n=this.paths.map((t=>({id:t.id||"",name:t.name})));n.length>0&&n.unshift({id:null,name:"bhere_select_path"}),s.path.options=n,t.changes$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((t=>{this.pathId!==t.path&&null!==t.id&&(this.pathId=t.path,this.onGenerateMeetingId()),this.pushChanges()}))}onGenerateMeetingId(t){let e=this.pathId?String(this.pathId):null;e=e&&e.length?e:null;const s=new ae({pathId:e}).toRoles();this.form.patch(s)}onInputDidChange(t){"publisher"===this.state.role&&setTimeout((()=>{if(this.form.get("id").valid){const t=this.form.get("id").value,e=new ae(t).toRoles();this.form.patch(e)}else this.form.get("idAttendee").reset(),this.form.get("idStreamer").reset(),this.form.get("idViewer").reset(),this.form.get("idSmartDevice").reset()}),1)}onCopyToClipBoard(t,e){void 0===e&&(e=!1);new re({link:t}).copyToClipBoard(e)}onNext(t){let e=this.controls.id.value;re.replaceWithLink(e),this.link.next(e)}isValid(){return this.form.valid}}mi.meta={selector:"[agora-link]",outputs:["link"],template:'\n\t<div class="group--info" *if="form">\n\t\t<form class="form" [formGroup]="form" (submit)="isValid() && onNext($event)" name="form" role="form" novalidate autocomplete="off">\n\t\t\t<div class="group--info__content stagger--childs">\n\t\t\t\t<div class="stagger--childs" *if="state.role !== \'publisher\'">\n\t\t\t\t\t<div class="group--form group--form--addon" [class]="{ required: controls.id.validators.length, \'addon\': controls.id.valid }">\n\t\t\t\t\t\t<label [innerHTML]="\'bhere_insert_meeting_id\' | label"></label>\n\t\t\t\t\t\t<input type="text" class="control--text" [formControl]="controls.id" [placeholder]="\'bhere_meeting_id\' | label" />\n\t\t\t\t\t\t<div class="control--addon" (click)="onCopyToClipBoard(controls.id.value)" *if="controls.id.valid">\n\t\t\t\t\t\t\t<svg class="copy" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#copy"></use></svg>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="stagger--childs" *if="state.role === \'publisher\'">\n\t\t\t\t\t\x3c!-- PATH --\x3e\n\t\t\t\t\t<div control-custom-select [control]="controls.path" [label]="\'bhere_path\' | label" *if="(\'usePaths\' | flag) && paths.length"></div>\n\t\t\t\t\t\x3c!--IDS --\x3e\n\t\t\t\t\t<div class="group--form group--form--addon" [class]="{ required: controls.id.validators.length, \'addon\': controls.id.valid }">\n\t\t\t\t\t\t<label><svg class="lock" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#lock"></use></svg> <span [innerHTML]="\'bhere_insert_meeting_id\' | label"></span></label>\n\t\t\t\t\t\t<input type="text" class="control--text" [formControl]="controls.id" [placeholder]="\'bhere_meeting_id\' | label" (change)="onInputDidChange($event)" />\n\t\t\t\t\t\t<div class="control--addon" (click)="onCopyToClipBoard(controls.id.value)" *if="controls.id.valid">\n\t\t\t\t\t\t\t<svg class="copy" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#copy"></use></svg>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="group--form group--form--addon addon" *if="(\'attendee\' | flag) && controls.idAttendee.valid && controls.idAttendee.value !== null">\n\t\t\t\t\t\t<label><svg class="lock" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#lock"></use></svg> <span [innerHTML]="\'bhere_attendee_meeting_id\' | label"></span></label>\n\t\t\t\t\t\t<input type="text" class="control--text" [formControl]="controls.idAttendee" [placeholder]="\'bhere_attendee_meeting_id\' | label" readonly />\n\t\t\t\t\t\t<div class="control--addon" (click)="onCopyToClipBoard(controls.idAttendee.value)" *if="controls.idAttendee.valid">\n\t\t\t\t\t\t\t<svg class="copy" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#copy"></use></svg>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="group--form group--form--addon addon" *if="(\'streamer\' | flag) && controls.idStreamer.valid && controls.idStreamer.value !== null">\n\t\t\t\t\t\t<label [innerHTML]="\'bhere_streamer_meeting_id\' | label"></label>\n\t\t\t\t\t\t<input type="text" class="control--text" [formControl]="controls.idStreamer" [placeholder]="\'bhere_streamer_meeting_id\' | label" readonly />\n\t\t\t\t\t\t<div class="control--addon" (click)="onCopyToClipBoard(controls.idStreamer.value)" *if="controls.idStreamer.valid">\n\t\t\t\t\t\t\t<svg class="copy" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#copy"></use></svg>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="group--form group--form--addon addon" *if="(\'viewer\' | flag) && controls.idViewer.valid && controls.idViewer.value !== null">\n\t\t\t\t\t\t<label [innerHTML]="\'bhere_viewer_meeting_id\' | label"></label>\n\t\t\t\t\t\t<input type="text" class="control--text" [formControl]="controls.idViewer" [placeholder]="\'bhere_viewer_meeting_id\' | label" readonly />\n\t\t\t\t\t\t<div class="control--addon" (click)="onCopyToClipBoard(controls.idViewer.value)" *if="controls.idViewer.valid">\n\t\t\t\t\t\t\t<svg class="copy" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#copy"></use></svg>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="group--form group--form--addon addon" *if="(\'smartDevice\' | flag) && controls.idSmartDevice.valid && controls.idSmartDevice.value !== null">\n\t\t\t\t\t\t<label [innerHTML]="\'bhere_smart_device_meeting_id\' | label"></label>\n\t\t\t\t\t\t<input type="text" class="control--text" [formControl]="controls.idSmartDevice" [placeholder]="\'bhere_smart_device_meeting_id\' | label" readonly />\n\t\t\t\t\t\t<div class="control--addon" (click)="onCopyToClipBoard(controls.idSmartDevice.value, true)" *if="controls.idSmartDevice.valid">\n\t\t\t\t\t\t\t<svg class="copy" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#copy"></use></svg>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="info" *if="controls.id.errors.required" [innerHTML]="\'bhere_insert_meeting_id\' | label"></div>\n\t\t\t\t<div class="info" *if="controls.id.errors.pattern" [innerHTML]="\'bhere_invalid_meeting_id\' | label"></div>\n\t\t\t\t<div class="info" *if="isValid()" [innerHTML]="\'bhere_take_part_meeting\' | label"></div>\n\t\t\t\t<button type="button" class="btn--generate" *if="state.role == \'publisher\'" (click)="onGenerateMeetingId($event)">\n\t\t\t\t\t<span [innerHTML]="\'bhere_generate_meeting_id\' | label"></span>\n\t\t\t\t</button>\n\t\t\t\t<button type="submit" class="btn--next" [class]="{ disabled: !isValid() }">\n\t\t\t\t\t<span [innerHTML]="\'bhere_take_part\' | label"></span>\n\t\t\t\t</button>\n\t\t\t\t<a [routerLink]="selfServiceTourRoute" class="btn--secondary" *if="state.role === \'publisher\'">\n\t\t\t\t\t<span [innerHTML]="\'bhere_self_service\' | label"></span>\n\t\t\t\t</a>\n\t\t\t</div>\n\t\t</form>\n\t</div>\n\t'};class vi extends t.Component{onInit(){const t=this.form=new e.FormGroup({username:new e.FormControl(null,e.Validators.RequiredValidator()),password:new e.FormControl(null,e.Validators.RequiredValidator()),checkRequest:window.antiforgery||"",checkField:""});this.controls=t.controls,t.changes$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((t=>{this.pushChanges()})),this.error=null}test(){this.form.patch({username:"publisher",password:"publisher",checkRequest:window.antiforgery||"",checkField:""})}reset(){this.form.reset()}onSubmit(){if(this.form.valid){const t=this.form.value;this.form.submitted=!0,this.error=null,this.pushChanges(),Is.login$(t).pipe(i.first()).subscribe((t=>{se.state.role===t.type?(this.onNext(t),this.form.reset()):(this.error={friendlyMessage:ge.transform("error_credentials")},this.pushChanges())}),(t=>{console.log("AccessComponent.error",t),this.error=t,this.pushChanges()}))}else this.form.touched=!0}isValid(){return this.form.valid}onNext(t){re.replaceWithUser(t),this.login.next(t)}}vi.meta={selector:"[agora-login]",outputs:["login"],template:'\n\t<div class="group--info">\n\t\t<form class="form" [formGroup]="form" (submit)="isValid() && onSubmit()" name="form" role="form" novalidate autocomplete="off">\n\t\t\t<div class="group--info__content stagger--childs">\n\t\t\t\t<div class="title" [innerHTML]="\'bhere_login\' | label"></div>\n\t\t\t\t<input name="checkField" [formControl]="controls.checkField" value="" type="text" style="display:none !important;" />\n\t\t\t\t<div control-text [control]="controls.username" [label]="\'bhere_username\' | label"></div>\n\t\t\t\t<div control-password [control]="controls.password" [label]="\'bhere_password\' | label"></div>\n\t\t\t\t<div class="group--error" *if="error">\n\t\t\t\t\t<span class="status-code" [innerHTML]="error.statusCode"></span>\n\t\t\t\t\t<span class="status-message" [innerHTML]="error.statusMessage"></span>\n\t\t\t\t\t<span class="friendly-message" [innerHTML]="error.friendlyMessage"></span>\n\t\t\t\t</div>\n\t\t\t\t<div class="info" *if="isValid()" [innerHTML]="\'bhere_cta\' | label"></div>\n\t\t\t\t<button type="submit" class="btn--next" [class]="{ disabled: !isValid() }">\n\t\t\t\t\t<span [innerHTML]="\'bhere_cta\' | label"></span>\n\t\t\t\t</button>\n\t\t\t\t<test-component [form]="form" (test)="test($event)" (reset)="reset($event)"></test-component>\n\t\t\t</div>\n\t\t</form>\n\t</div>\n\t'};class gi extends t.Component{onInit(){const t=new re;this.state={};const e=this.fields=[];if(U.flags.useExtendedUserInfo){const s=t.firstName,i=t.lastName,n=t.email;e.push({type:"text",name:"firstName",label:"access_first_name",required:!0,value:s,test:"Jhon"},{type:"text",name:"lastName",label:"access_last_name",required:!0,value:i,test:"Appleseed"},{type:"email",name:"email",label:"access_email",required:!0,value:n,test:"jhonappleseed@gmail.com"})}else{const s=t.name;e.push({type:"text",name:"name",label:"bhere_name_and_surname",pattern:/^\w{2,}\s\w{2,}/,required:!0,value:s,test:"Jhon Appleseed"})}e.push({type:"checkbox",name:"privacy",label:"access_privacy_disclaimer",required:!0,test:!0},{type:"hidden",name:"checkField",value:"",test:""},{type:"none",name:"checkRequest",value:U.antiforgery||"",test:U.antiforgery||""});const s=this.form=me(e);this.controls=s.controls,s.changes$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((t=>{this.pushChanges()})),se.state$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((t=>{this.state=t,this.pushChanges()}))}test(){ve(this.fields,this.form)}isValid(){return this.form.valid}onNext(t){let e,s;U.flags.useExtendedUserInfo?(s={firstName:this.controls.firstName.value,lastName:this.controls.lastName.value,email:this.controls.email.value},e=`${s.firstName} ${s.lastName}`):(s={name:this.controls.name.value},e=s.name),re.replaceWithOptions(s),this.name.next(e)}}gi.meta={selector:"[agora-name]",outputs:["name"],template:'\n\t<div class="group--info" *if="form">\n\t\t<form class="form" [formGroup]="form" (submit)="isValid() && onNext($event)" name="form" role="form" novalidate autocomplete="off">\n\t\t\t<div class="group--info__content stagger--childs">\n\t\t\t\t\x3c!-- controls --\x3e\n\t\t\t\t<div controls [formGroup]="form" [fields]="fields"></div>\n\t\t\t\t\x3c!-- NAME --\x3e\n\t\t\t\t\x3c!--\n\t\t\t\t<div class="group--form group--form--addon" [class]="{ required: controls.name.validators.length }">\n\t\t\t\t\t<label [innerHTML]="\'bhere_fill_fullname\' | label"></label>\n\t\t\t\t\t<input type="text" class="control--text" [formControl]="controls.name" [placeholder]="\'bhere_name_and_surname\' | label" />\n\t\t\t\t</div>\n\t\t\t\t<div class="info" *if="!controls.name.valid" [innerHTML]="\'bhere_fill_name_and_surname\' | label"></div>\n\t\t\t\t--\x3e\n\t\t\t\t<div class="info" *if="!isValid()"><span [innerHTML]="\'bhere_fill_name_and_surname\' | label"></span></div>\n\t\t\t\t<div class="info" *if="isValid()"><span [innerHTML]="\'bhere_proceed_as\' | label"></span> <span [innerHTML]="controls.name.value"></span></div>\n\t\t\t\t<button type="submit" class="btn--next" [class]="{ disabled: !isValid() }">\n\t\t\t\t\t<span [innerHTML]="\'bhere_proceed\' | label"></span>\n\t\t\t\t</button>\n\t\t\t\t<test-component [form]="form" (test)="test($event)" (reset)="reset($event)"></test-component>\n\t\t\t</div>\n\t\t</form>\n\t</div>\n\t'};class fi extends t.Component{set videoMuted(e){if(this.videoMuted_!==e){this.videoMuted_=e;const{node:s}=t.getContext(this);e?s.classList.add("video--muted"):s.classList.remove("video--muted")}}set audioMuted(e){if(this.audioMuted_!==e){this.audioMuted_=e;const{node:s}=t.getContext(this);e?s.classList.add("audio--muted"):s.classList.remove("audio--muted")}}get streamId(){return this.streamId_}set streamId(t){this.streamId_=t}get stream(){return this.stream_}set stream(e){if(this.stream_!==e){const{node:s}=t.getContext(this),i=this.player=s.querySelector(".agora-stream__player");for(;i.childElementCount>0;)i.removeChild(i.firstElementChild);this.stream_&&this.stream_.isPlaying()&&this.stream_.player.div.parentNode===i&&(console.log("AgoraStreamComponent stopping stream",this.stream_.getId(),"on",this.stream_.player.div.parentNode),this.stream_.stop()),this.stream_=e,e&&(this.videoMuted=e.userMuteVideo,this.audioMuted=e.userMuteAudio);const n=e?e.getId():null;if(this.streamId=n,n){const t=`stream-${n}`;i.setAttribute("id",t);const s=this;e.isPlaying()?i.appendChild(e.player.div):(this.shouldUseResumeGesture=!1,e.play(t,{fit:"cover"},(t=>{t&&"aborted"!==t.status&&(s.shouldUseResumeGesture=!0,s.pushChanges())})))}else i.removeAttribute("id")}}set vrContainer(t){this.vrContainer_!==t&&(this.vrContainer_=t,t?(this.stream_.vrContainer=t,this.player.appendChild(t)):this.stream_.vrContainer&&this.stream_.vrContainer.parentNode&&(this.stream_.vrContainer.parentNode.removeChild(this.stream_.vrContainer),this.stream_.vrContainer=null))}get videoNode(){let e=this.videoNode_;if(!e){const s=t.getContext(this).node.querySelector(".agora-stream__player");e=document.createElement("video"),this.onLoadedMetadata=this.onLoadedMetadata.bind(this),e.addEventListener("loadedmetadata",this.onLoadedMetadata),s.appendChild(e),this.videoNode_=e}return e}onInit(){this.videoMuted=!1,this.audioMuted=!1,this.shouldUseResumeGesture=!1,this.state={},se.state$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((t=>{this.state=t,this.pushChanges()})),Us.out$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((t=>{switch(t.type){case Re:const e=t.event;this.streamId&&e.streamId===this.streamId&&(e instanceof ks&&(this.videoMuted=!0),e instanceof Ss&&(this.videoMuted=!1),e instanceof Ts&&(this.audioMuted=!0),e instanceof Es&&(this.audioMuted=!1));break;case ls:this.streamId===t.clientId&&(this.vrContainer=t.container);break;case cs:this.streamId===t.clientId&&(this.vrContainer=null)}}))}setMediaStream(t){const e=this.videoNode;"srcObject"in e?e.srcObject=t:e.src=t?window.URL.createObjectURL(t):null}onLoadedMetadata(t){this.videoNode.play().then((t=>{}),(t=>{console.log("AgoraStreamComponent.play.error",t)}))}onToggleControl(t){this.toggleControl.next(t)}onToggleSpy(t){this.toggleSpy.next(t)}}fi.meta={selector:"[agora-stream]",outputs:["toggleControl","toggleSpy"],inputs:["stream"]};const bi={WaitingRoom:{id:1,name:"waiting-room"},Panorama:{id:2,name:"panorama"},PanoramaGrid:{id:3,name:"panorama-grid"},Room3d:{id:4,name:"room-3d"},Model:{id:5,name:"model"},Media:{id:6,name:"media"}},wi={Nav:{id:1,name:"nav"},Plane:{id:2,name:"plane"},CurvedPlane:{id:3,name:"curved-plane"},Model:{id:4,name:"model"},Texture:{id:5,name:"texture"}};class yi{constructor(t){t&&(Object.assign(this,t),this.updateIndices(t.items)),this.items=(this.items||[]).filter((t=>function(t){let e;if(t.type.name===wi.Nav.name)e=null==t.viewId||function(t){return!$i(t.title)&&!$i(t.abstract)}(t)||se.state.navigable;else e=!0;return e}(t))).map((t=>Ii(t))),this.tiles&&(this.tiles=this.tiles.map((t=>Ri(t)))),this.originalItems=this.items.slice(),this.lastOrientation={latitude:0,longitude:0},this.path=!0}get payload(){const t={};return Object.keys(this).forEach((e=>{if(-1!==yi.allowedProps.indexOf(e))switch(e){case"items":t[e]=this[e].map((t=>Ii(t).payload));break;case"tiles":t[e]=this[e].map((t=>Ri(t).payload));break;default:t[e]=this[e]}})),t}get pathItems(){return this.items.filter((t=>t.path))}get shortType(){return this.type?this.type.split("-").map((t=>t.substring(0,1).toUpperCase())).join(""):"??"}updateIndices(t){if(t){let e=0,s=0,i=0,n=0,o=0;t.forEach(((t,a)=>{if(t.index=a,t.asset)switch(t.asset.file){case"publisherStream":t.asset.index=e++;break;case"nextAttendeeStream":t.asset.index=s++;break;case"smartDeviceStream":t.asset.index=i++;break;case"publisherScreen":t.asset.index=n++;break;case"attendeeScreen":t.asset.index=o++}}))}}}yi.allowedProps=["id","type","name","hidden","likes","asset","items","orientation","zoom","ar","tiles","invertAxes","flipAxes"];class xi extends yi{constructor(t){super(t)}}class Ci extends yi{static mapTiles(t,e,s,i){void 0===t&&(t=[]),void 0===e&&(e=!1),void 0===s&&(s=!1),void 0===i&&(i="");const n=e?-1:1;return t.map(((t,e)=>{const o=new THREE.Vector2;return(t="string"==typeof t?{id:e+1,asset:{folder:i,file:t},navs:[]}:t).asset.file.replace(/_x([-|\d]+)_y([-|\d]+)/g,((t,e,i)=>{s?(o.y=parseInt(e),o.x=parseInt(i)*n):(o.x=parseInt(e),o.y=parseInt(i)*n)})),{id:t.id,type:Object.assign({},bi.PanoramaGrid),asset:t.asset,navs:t.navs||[],indices:o}}))}set index(t){this.index_!==t&&(this.index_=t,this.tiles.forEach(((e,s)=>e.selected=s===t)),this.updateCurrentItems(),this.index$.next(t))}get index(){return this.index_}constructor(t){t.tiles=Ci.mapTiles(t.tiles,t.flipAxes,t.invertAxes,t.asset?t.asset.folder:""),super(t),this.index_=0,this.index$=new s.Subject,this.tiles.forEach(((t,e)=>t.selected=0===e)),this.tiles.length&&(this.items=this.originalItems.concat(this.tiles[0].navs),this.asset=this.tiles[0].asset)}updateCurrentItems(){this.items=this.originalItems.concat(this.tiles[this.index_].navs)}getTileIndex(t,e){return this.tiles.reduce(((s,i,n)=>i.indices.x===t&&i.indices.y===e?n:s),-1)}hasTile(t,e){return-1!==this.getTileIndex(t,e)}getTile(t,e){const s=this.getTileIndex(t,e);if(-1!==s)return this.index=s,this.tiles[s]}}class Mi extends yi{constructor(t){super(t)}}class ki extends yi{constructor(t){super(t)}}class Si extends yi{constructor(t){super(t)}}class Ti{constructor(t){t&&Object.assign(this,t),this.path=!0;const e=this.links||(this.link?[this.link]:[]);this.links=e}get firstLink(){return this.links&&this.links.length?this.links[0]:null}get payload(){const t={};return Object.keys(this).forEach((e=>{-1!==Ti.allowedProps.indexOf(e)&&(t[e]=this[e])})),!t.link||t.link.title&&t.link.href||delete t.link,t}get hasPanel(){return this.type.name===wi.Nav.name&&(this.title&&""!==this.title||this.abstract&&""!==this.abstract||this.asset||this.link)}}Ti.allowedProps=["id","type","title","abstract","asset","link","links","viewId","hook","hookExtra","keepOrientation","important","transparent","position","rotation","scale","radius","height","arc"];class Ei extends Ti{}class Li{constructor(t){t&&Object.assign(this,t),this.navs=(this.navs||[]).map((t=>Ii(t))),this.originalItems=this.navs.slice()}get payload(){const t={};return Object.keys(this).forEach((e=>{if(-1!==Li.allowedProps.indexOf(e))if("navs"===e)t[e]=this[e].map((t=>Ii(t).payload));else t[e]=this[e]})),t}}function _i(t){switch(t.type.name){case bi.Panorama.name:t=new xi(t);break;case bi.PanoramaGrid.name:t=new Ci(t);break;case bi.Room3d.name:t=new Mi(t);break;case bi.Model.name:t=new ki(t);break;case bi.Media.name:t=new Si(t);break;default:t=new yi(t)}return t}function Ii(t){if(t.type.name===wi.Nav.name)t=new Ei(t);else t=new Ti(t);return t}function Ri(t){return new Li(t)}function $i(t){return t&&t.length>0}Li.allowedProps=["id","asset","navs"];class Ai{constructor(t){t&&Object.assign(this,t),this.items=(this.items||[]).map((t=>Ii(t))),this.originalItems=this.items.slice()}get payload(){const t={};return Object.keys(this).forEach((e=>{if(-1!==View.allowedProps.indexOf(e))if("items"===e)t[e]=this[e].map((t=>Ii(t).payload));else t[e]=this[e]})),t}}function Pi(t){return t=new Ai(t)}Ai.allowedProps=["id","name","asset","items"];class Hi{static set active(t){this.active$.next(t)}static get active(){return this.active$.getValue()}static navmapGet$(){return _s.get$("/api/navmap").pipe(i.map((t=>(t.navmaps.map((t=>Pi(t))),t.navmaps))))}static navmapCreate$(t){return _s.post$("/api/navmap",t).pipe(i.map((t=>Pi(t))))}static navmapUpdate$(t){return _s.put$(`/api/navmap/${t.id}`,t).pipe(i.map((t=>Pi(t))))}static navmapDelete$(t){return _s.delete$(`/api/navmap/${t.id}`)}static itemCreate$(t,e){return _s.post$(`/api/navmap/${t.id}/item`,e).pipe(i.map((t=>Ii(t))))}static itemUpdate$(t,e){return e=Ii(e),_s.put$(`/api/navmap/${t.id}/item/${e.id}`,e.payload).pipe(i.map((t=>Ii(t))))}static itemDelete$(t,e){return _s.delete$(`/api/navmap/${t.id}/item/${e.id}`)}}Hi.active$=new s.BehaviorSubject(!1);class Oi{static push(t){return function(t){(window.dataLayer||[]).push(t),console.log("GtmService.dataLayer",t)}(t)}}const Ui="info",Bi="alert",Di="dialog",zi="centered",Vi="bottom-right";class ji{constructor(t){this.toast=t}}class Ni extends ji{}class Fi extends ji{}class Gi{static open$(t){switch(t.id=(new Date).getTime(),t.type=t.type||Ui,t.position=t.position||zi,t.type){case Bi:t.acceptMessage=t.acceptMessage||"Ok";break;case Di:t.acceptMessage=t.acceptMessage||"Accept",t.rejectMessage=t.rejectMessage||"Reject"}return this.toast$.next(t),t.type===Ui&&setTimeout((()=>{this.resolve(t)}),t.duration||4e3),this.events$}static resolve(t){this.toast$.next(null),this.events$.next(new Ni(t))}static reject(t){this.toast$.next(null),this.events$.next(new Fi(t))}}Gi.toast$=new s.Subject,Gi.events$=new s.Subject;class qi extends t.Component{get modal(){return this.modal_}set modal(e){const{module:s}=t.getContext(this);this.modal_&&this.modal_.node&&(s.remove(this.modal_.node,this),this.modalNode.removeChild(this.modal_.node)),e&&e.node&&(this.modal_=e,this.modalNode.appendChild(e.node),s.compile(e.node)),this.modal_=e,this.pushChanges()}get busy(){return this.busy_}set busy(t){this.busy_!==t&&(this.busy_=t,this.pushChanges())}onInit(){this.busy_=!1;const{node:e}=t.getContext(this);this.modalNode=e.querySelector(".modal-outlet__modal"),ei.modal$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((t=>this.modal=t)),ei.busy$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((t=>this.busy=t))}reject(t){ei.reject()}}qi.meta={selector:"[modal-outlet]",template:'\n\t<div class="modal-outlet__container" [class]="{ active: modal, busy: busy }">\n\t\t<div class="modal-outlet__background" (click)="reject($event)"></div>\n\t\t<div class="modal-outlet__modal"></div>\n\t\t\x3c!-- spinner --\x3e\n\t\t<div class="spinner spinner--contrasted" *if="busy"></div>\n\t</div>\n\t'};class Zi extends t.Component{onInit(){super.onInit();const{parentInstance:e,node:s}=t.getContext(this);if(e instanceof qi){const t=this.data=e.modal.data;if(t&&t.ar){const e=Zi.getUrl(t);new QRious({element:s.querySelector(".qrcode"),value:e,size:256})}}}onClose(){ei.reject()}static getUrl(t){const e=ee.buildUrl(we.transform(":lang.tryInAr"),{viewId:t.id}),s=window.location.origin+e;return console.log("TryInARModalComponent.getUrl",s),s}static openInAR(t){const e=this.getUrl(t);window.open(e,"_blank")}}Zi.meta={selector:"[try-in-ar-modal]",template:'\n\t\t<div class="modal__header">\n\t\t\t<button type="button" class="btn--close" (click)="onClose()">\n\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#close"></use></svg>\n\t\t\t</button>\n\t\t</div>\n\t\t<div class="container">\n\t\t\t<div class="form">\n\t\t\t\t<div class="title">Inquadra il qrcode con il cellulare o il tablet per vedere il VR.</div>\n\t\t\t\t<div class="picture">\n\t\t\t\t\t<canvas class="qrcode"></canvas>\n\t\t\t\t</div>\n\t\t\t\t<div class="group--cta">\n\t\t\t\t\t<button type="button" class="btn--accept" (click)="onClose()">\n\t\t\t\t\t\t<span>Chiudi</span>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t'},Zi.chunk=()=>'<div class="try-in-ar-modal" try-in-ar-modal></div>';const Wi=["jpeg","jpg","png","hdr"],Ki=["mp4","webm"],Xi=["fbx","gltf","glb","usdz"],Yi={Image:{id:1,name:"image"},Video:{id:2,name:"video"},Model:{id:3,name:"model"},PublisherStream:{id:4,name:"publisher-stream",file:"publisherStream"},AttendeeStream:{id:5,name:"next-attendee-stream",file:"nextAttendeeStream"},PublisherScreen:{id:6,name:"publisher-screen",file:"publisherScreen"},AttendeeScreen:{id:7,name:"attendee-screen",file:"attendeeScreen"},SmartDeviceStream:{id:8,name:"smart-device-stream",file:"smartDeviceStream"}},Ji={ImageOrVideo:{id:1,name:"Image or Video",ids:[1,2]},Publisher:{id:3,name:"Publisher",ids:[4]},Attendee:{id:4,name:"Attendee",ids:[5]}};const Qi=[Yi.PublisherStream.name,Yi.AttendeeStream.name,Yi.PublisherScreen.name,Yi.AttendeeScreen.name,Yi.SmartDeviceStream.name];function tn(t){return t&&-1!==Qi.indexOf(t.type.name)}function en(t){let e;return t&&t.asset&&(e=Object.keys(Ji).find((e=>-1!==Ji[e].ids.indexOf(t.asset.type.id)))),Ji[e||"ImageOrVideo"]}function sn(t){const e=(s=t,Object.keys(Ji).reduce(((t,e)=>{const i=Ji[e];return i.id===s?i:t}),null));var s;const i=function(t){return Object.keys(Yi).reduce(((e,s)=>{const i=Yi[s];return i.id===t?i:e}),null)}(e.ids[0]),n=i.file;return new on({type:i,folder:"",file:n})}function nn(t){const e=t.split(".").pop().toLowerCase();return-1!==Wi.indexOf(e)?Yi.Image:-1!==Ki.indexOf(e)?Yi.Video:-1!==Xi.indexOf(e)?Yi.Model:void 0}class on{constructor(t){t&&Object.assign(this,t)}get payload(){const t={};return Object.keys(this).forEach((e=>{-1!==on.allowedProps.indexOf(e)&&(t[e]=this[e])})),t}static fromUrl(t){const e=t.split("/"),s=e.pop(),i=e.join("/")+"/",n=nn(s);return new on({type:n,folder:i,file:s})}static get defaultMediaAsset(){return{id:-1,type:{id:Yi.Image,name:"image"},folder:"/textures/grid/",file:"grid.jpg"}}}function an(t){return t.type.name,t=new on(t)}on.allowedProps=["id","type","folder","file","linkedPlayId","chromaKeyColor","autoplay","loop"];const rn={id:"waiting-room",type:{id:1,name:"waiting-room"},name:"Waiting Room",likes:0,liked:!1,asset:{type:{id:1,name:"image"},folder:"/textures/waiting-room/",file:"waiting-room.jpg"},items:[],orientation:{latitude:0,longitude:0}};class ln{static get dataViews(){return this.data?this.data.views:[]}static get validViews(){return this.data?this.data.views.filter((t=>t.type.name!==bi.WaitingRoom.name)):[]}static get pathViews(){return this.validViews.filter((t=>t.path))}static get validPathViews(){return(this.editor?this.data.views:this.validViews).filter((t=>t.path))}static set action(t){this.action$_.next(t)}static get action(){return this.action$_.getValue()}static set viewId(t){this.action$_.next({viewId:t,keepOrientation:!1,useLastOrientation:!1})}static get viewId(){const t=this.action$_.getValue();return t?t.viewId:null}static getDataView(t){return this.dataViews.find((e=>e.id===t))||null}static get currentView(){const t=this.viewId;return null!==t?this.getDataView(t):null}static getValidPathId(t){if(!t)return null;return null==this.validPathViews.find((e=>e.id===t))?null:t}static getFirstPathId(){const t=this.editor&&null===this.path.id?this.dataViews:this.pathViews;return t.length?t[0].id:null}static data$(){if(!this.data$_){const t=(U.flags.production?"/api/view":`${U.assets}api/data.json`)+"?lang="+be.lang;this.data$_=_s.get$(t).pipe(i.map((t=>(t.views=t.views.map((t=>_i(t))),this.data=t,t))),i.shareReplay(1))}return this.data$_}static view$(){const t=new re,e=this.getValidPathId(t.viewId),s=this.getValidPathId(t.embedViewId)||e||this.getFirstPathId();return this.action$_.next({viewId:s}),this.action$_.pipe(i.distinctUntilChanged(((t,e)=>t.viewId===e.viewId)),i.map((t=>{let e=this.dataViews.find((e=>e.id===t.viewId));return e&&(e.keepOrientation=t.keepOrientation||!1,e.useLastOrientation=t.useLastOrientation||!1),e||this.getWaitingRoom()})))}static setDataAndPath(t,e){this.data=t,t.views.forEach((t=>{t.path=!e||-1===e.items.indexOf(t.id),t.items.forEach((t=>{let s=!0;e&&(t.type.name===wi.Nav.name&&(s=-1===e.items.indexOf(t.viewId)),t.path=s)}))})),this.path=e}static hostedView$(t,e){this.setDataAndPath(t,e),this.editor=!1;const n=this.getWaitingRoom();return s.combineLatest([this.view$(),this.hosted$()]).pipe(i.map((t=>{const e=t[0];return t[1]?e:n})),i.distinctUntilChanged(((t,e)=>t.id===e.id)),i.tap((t=>{if(t.id!==n.id){re.replaceWithOptions({viewId:t.id});const e=ln.getPrefetchAssets(t);t.prefetchAssets=e}})))}static editorView$(t,e){this.setDataAndPath(t,e),this.editor=!0;const s=this.getWaitingRoom();return this.view$().pipe(i.map((t=>{const i={pathId:null};return t.id!==s.id&&(i.viewId=t.id),e&&null!==e.id&&(i.pathId=e.id),re.replaceWithOptions(i),t})))}static hosted$(){return se.state$.pipe(i.map((t=>t.hosted)),i.distinctUntilChanged())}static viewById$(t){return this.data$().pipe(i.map((e=>this.dataViews.find((e=>e.id===t)))))}static viewLike$(t){return t.liked?s.of(null):(t.liked=!0,U.flags.production?_s.get$(`/api/view/${t.id}/like`):(t.likes=t.likes||0,t.likes++,s.of(t)))}static setViewLike$(t){return this.viewById$(t.viewId).pipe(i.tap((e=>{e&&(e.likes=t.likes)})))}static getWaitingRoom(){return this.dataViews.find((t=>t.type.name===bi.WaitingRoom.name))||rn}static getPrefetchAssets(t){const e=this.validPathViews;return t.items.filter((t=>t.type.name===wi.Nav.name&&null!=t.viewId)).map((t=>e.find((e=>e.id===t.viewId)))).filter((t=>t&&t.asset&&t.asset.type.name===Yi.Image.name)).map((t=>U.getPath(t.asset.folder+t.asset.file)))}static addView(t){const e=this.data,s=e.views.slice();s.push(t),e.views=s,this.viewId=t.id}static deleteView(t){const e=this.data,s=e.views.slice(),i=s.reduce(((e,s,i)=>s.id===t.id?i:e),-1);if(i>0){s.splice(i,1),e.views=s;const t=this.dataViews;t.length>0&&(this.viewId=t[0].id)}}}ln.action$_=new s.BehaviorSubject(null);let cn=null;class dn{static get items$(){if(!cn){const t=si.get("wishlist")||[];cn=new s.BehaviorSubject(t)}return cn}static getItems(){return this.items$.getValue()}static indexOf(t){return this.getItems().reduce(((e,s,i)=>-1===e&&s.viewId===t.viewId&&s.itemId===t.itemId?i:e),-1)}static has(t){return-1!==this.indexOf(t)}static add$(t){const e=this.getItems();return this.has(t)||(e.push(t),si.set("wishlist",e),this.items$.next(e)),this.items$}static remove$(t){const e=this.getItems(),s=this.indexOf(t);return-1!==s&&(e.splice(s,1),si.set("wishlist",e),this.items$.next(e)),this.items$}static toggle$(t){const e=this.getItems(),s=this.indexOf(t);return-1!==s?(e.splice(s,1),si.set("wishlist",e),this.items$.next(e)):(e.push(t),si.set("wishlist",e),this.items$.next(e)),this.items$}}class hn{constructor(t){this.loader=t}}class un extends hn{}class pn extends hn{}class mn extends hn{}class vn extends hn{}class gn extends hn{}class fn{static getLoader(){return fn.loader||(fn.loader=new THREE.TextureLoader)}static getPath(t){return U.getPath(t.asset.folder+t.asset.file)}static loadTexture(t,e){const s=fn.getPath(t);return fn.getLoader().load(s,e)}static isVideo(t){return t.asset&&t.asset.file&&(-1!==t.asset.file.indexOf(".mp4")||-1!==t.asset.file.indexOf(".webm"))}static isStream(t){return tn(t.asset)}static isMutedStream(t){let e=!1;switch(t.asset.type.name){case Yi.PublisherStream.name:e=se.state.role===ie.Publisher;break;case Yi.AttendeeStream.name:e=se.state.role===ie.Attendee;break;case Yi.PublisherScreen.name:case Yi.AttendeeScreen.name:e=!0;break;case Yi.SmartDeviceStream.name:e=se.state.role===ie.SmartDevice}return e}static isPublisherStream(t){return t.asset&&t.asset.type.name===Yi.PublisherStream.name}static isAttendeeStream(t){return t.asset&&t.asset.type.name===Yi.AttendeeStream.name}static isSmartDeviceStream(t){return t.asset&&t.asset.type.name===Yi.SmartDeviceStream.name}static isPublisherScreen(t){return t.asset&&t.asset.type.name===Yi.PublisherScreen.name}static isAttendeeScreen(t){return t.asset&&t.asset.type.name===Yi.AttendeeScreen.name}get isVideo(){return fn.isVideo(this.item)}get isStream(){return fn.isStream(this.item)}get isMutedStream(){return fn.isMutedStream(this.item)}get isPublisherStream(){return fn.isPublisherStream(this.item)}get isAttendeeStream(){return fn.isAttendeeStream(this.item)}get isSmartDeviceStream(){return fn.isSmartDeviceStream(this.item)}get isPublisherScreen(){return fn.isPublisherScreen(this.item)}get isAttendeeScreen(){return fn.isAttendeeScreen(this.item)}get isPlayableVideo(){return this.isVideo}get isAutoplayVideo(){return this.isStream}get muted(){return this.muted_}set muted(t){this.muted_=t,this.video&&this.isVideo&&(this.video.muted=!0===t)}constructor(t){this.item=t,this.toggle=this.toggle.bind(this),this.muted_=!1,this.subscription=se.state$.subscribe((t=>this.muted=t.volumeMuted))}load(t){const e=this.item;let s;if(this.isStream&&e.streamId){const i=e.streamId,n=document.querySelector(`#stream-${i} video`);if(!n)return;const o=()=>{this.disposed||(n.removeEventListener("canplay",o),s=this.texture=new THREE.VideoTexture(n),s.minFilter=THREE.LinearFilter,s.magFilter=THREE.LinearFilter,s.mapping=THREE.UVMapping,s.needsUpdate=!0,"function"==typeof t&&t(s,this))},a=this.isMutedStream;n.crossOrigin="anonymous",n.volume=a?0:1,n.muted=a,n.readyState>=n.HAVE_FUTURE_DATA?o():n.addEventListener("canplay",o)}else if(this.isVideo){const i=e.asset&&e.asset.autoplay||!1,n=e.asset&&e.asset.loop||!1,o=this.video=document.createElement("video");o.crossOrigin="anonymous",o.preload="metadata",o.volume=.8,o.muted=i,o.playsInline=!0,o.loop=n;const a=()=>{this.disposed||(o.oncanplay=null,s=new THREE.VideoTexture(o),s.minFilter=THREE.LinearFilter,s.magFilter=THREE.LinearFilter,s.mapping=THREE.UVMapping,s.needsUpdate=!0,"function"==typeof t&&t(s,this),i?this.play(e.silent):o.pause())},r=()=>{this.disposed||fn.events$.next(new vn(this))},l=()=>{this.disposed||n||fn.events$.next(new pn(this))};o.oncanplay=a,o.ontimeupdate=r,o.onended=l,o.src=fn.getPath(e),o.load()}else e.asset?fn.loadTexture(e,(e=>{this.disposed||(e.minFilter=THREE.LinearFilter,e.magFilter=THREE.LinearFilter,e.mapping=THREE.UVMapping,e.wrapS=THREE.RepeatWrapping,e.wrapT=THREE.RepeatWrapping,"function"==typeof t&&t(e,this))})):t(null,this);return this}get progress(){return this.video?this.video.currentTime/this.video.duration:0}set progress(t){if(this.video){const e=this.video.duration*t;this.video.seekable.length>t&&this.video.currentTime!==e&&(this.video.currentTime=e,fn.events$.next(new gn(this)))}}play(t){this.video&&(this.video.muted=this.muted_,this.video.play().then((()=>{t||fn.events$.next(new un(this))}),(t=>{console.log("MediaLoader.play.error",this.item.asset.file,t)})))}pause(t){this.video&&this.isVideo&&(this.video.muted=!0,this.video.pause(),t||fn.events$.next(new pn(this)))}toggle(){if(this.video&&this.isVideo)return this.video.paused?(this.video.muted=this.muted_,this.play(),!0):(this.pause(),!1)}dispose(){this.subscription.unsubscribe(),this.pause(!0),this.isVideo&&this.video&&(this.video.ontimeupdate=null,this.video.onended=null,fn.events$.next(new mn(this))),this.disposed=!0,delete this.video}}fn.events$=new s.ReplaySubject(1);class bn{static get defaultGeometry(){return bn.defaultGeometry_||(bn.defaultGeometry_=new THREE.BoxBufferGeometry(1,1,1))}static get planeGeometry(){return bn.planeGeometry_||(bn.planeGeometry_=new THREE.PlaneBufferGeometry(1,1,2,2))}static get sphereGeometry(){return bn.sphereGeometry_||(bn.sphereGeometry_=new THREE.SphereBufferGeometry(3,12,12))}static get panoramaGeometry(){return bn.panoramaGeometry_||(bn.panoramaGeometry_=new THREE.SphereBufferGeometry(101,36,36))}}new THREE.Vector3;class wn{static get origin(){const t=this.host;if(t){const e=this.origin_;e.set(0,0,0);(t.renderer.xr.isPresenting?t.renderer.xr.getCamera(t.camera):t.camera).localToWorld(e)}return this.origin_}static getDistanceToCamera(t,e,s,i,n){void 0===n&&(n=.88);const o=2*Math.atan(Math.PI*e/360),a=i.y*t.zoom/o,r=i.x*t.zoom/o/s;return n*Math.max(a,r)}}wn.origin_=new THREE.Vector3;class yn{}yn.items=[],yn.hittest=function(t,e,s){void 0===e&&(e=!1);let i=!1;this.down!==e&&(this.down=e,this.lock=!1,i=!0);const n=this.items.filter((t=>t.parent&&!t.freezed)),o=t.intersectObjects(n);let a,r;const l={};o.forEach(((t,e)=>{const s=t.object;a=s.uuid,0===e&&(this.lastIntersectedObject!==s||i?(this.lastIntersectedObject=s,r=s):s.intersection&&(Math.abs(s.intersection.point.x-t.point.x)>.01||Math.abs(s.intersection.point.y-t.point.y)>.01)&&(s.intersection=t,s.emit("move",s))),l[a]=t})),0===o.length&&(this.lastIntersectedObject=null);return n.forEach((t=>{t.intersection=l[t.uuid],t.over=t===this.lastIntersectedObject||t.intersection&&!t.depthTest&&(!this.lastIntersectedObject||this.lastIntersectedObject.depthTest),t.down=e&&t.over&&!this.lock,t.down&&(this.lock=!0)})),r}.bind(yn),yn.dispose=function(t){if(t){const e=this.items.indexOf(t);-1!==e&&this.items.splice(e,1)}}.bind(yn);class xn extends n.Mesh{get freezed(){return this.freezed_}set freezed(t){this.freezed_=t,this.children.filter((t=>t.__lookupGetter__("freezed"))).forEach((e=>e.freezed=t))}constructor(t,e){super(t=t||bn.defaultGeometry,e=e||new THREE.MeshBasicMaterial({color:16711935})),this.freezed=!1}freeze(){this.freezed=!0}unfreeze(){this.freezed=!1}}class Cn extends xn{constructor(t,e){super(t=t||bn.defaultGeometry,e=e||new THREE.MeshBasicMaterial({color:16711935})),this.events={}}on(t,e){const s=this.events[t]=this.events[t]||[];return s.push(e),()=>{this.events[t]=s.filter((t=>t!==e))}}off(t,e){const s=this.events[t];s&&(this.events[t]=s.filter((t=>t!==e)))}emit(t,e){const s=this.events[t];s&&s.forEach((t=>{t(e)}));const i=this.events.broadcast;i&&i.forEach((s=>{s(t,e)}))}}class Mn extends Cn{constructor(t,e){super(t,e),this.depthTest=!0,this.over_=!1,this.down_=!1,yn.items.push(this)}get isInteractiveMesh(){return!0}get over(){return this.over_}set over(t){this.over_!=t&&(this.over_=t,t?this.emit("over",this):this.emit("out",this))}get down(){return this.down_}set down(t){t=t&&this.over,this.down_!=t&&(this.down_=t,t?this.emit("down",this):this.emit("up",this))}}class kn extends n.DataTextureLoader{constructor(t){super(t),this.type=n.HalfFloatType}parse(t){const e=function(t,e){switch(t){case 1:console.error("THREE.RGBELoader Read Error: "+(e||""));break;case 2:console.error("THREE.RGBELoader Write Error: "+(e||""));break;case 3:console.error("THREE.RGBELoader Bad File Format: "+(e||""));break;default:console.error("THREE.RGBELoader: Error: "+(e||""))}return-1},s=function(t,e,s){e=e||1024;let i=t.pos,n=-1,o=0,a="",r=String.fromCharCode.apply(null,new Uint16Array(t.subarray(i,i+128)));for(;0>(n=r.indexOf("\n"))&&o<e&&i<t.byteLength;)a+=r,o+=r.length,i+=128,r+=String.fromCharCode.apply(null,new Uint16Array(t.subarray(i,i+128)));return-1<n&&(!1!==s&&(t.pos+=o+n+1),a+r.slice(0,n))},i=function(t,e,s,i){const n=t[e+3],o=Math.pow(2,n-128)/255;s[i+0]=t[e+0]*o,s[i+1]=t[e+1]*o,s[i+2]=t[e+2]*o,s[i+3]=1},o=function(t,e,s,i){const o=t[e+3],a=Math.pow(2,o-128)/255;s[i+0]=n.DataUtils.toHalfFloat(Math.min(t[e+0]*a,65504)),s[i+1]=n.DataUtils.toHalfFloat(Math.min(t[e+1]*a,65504)),s[i+2]=n.DataUtils.toHalfFloat(Math.min(t[e+2]*a,65504)),s[i+3]=n.DataUtils.toHalfFloat(1)},a=new Uint8Array(t);a.pos=0;const r=function(t){const i=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,n=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,o=/^\s*FORMAT=(\S+)\s*$/,a=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,r={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let l,c;if(t.pos>=t.byteLength||!(l=s(t)))return e(1,"no header found");if(!(c=l.match(/^#\?(\S+)/)))return e(3,"bad initial token");for(r.valid|=1,r.programtype=c[1],r.string+=l+"\n";l=s(t),!1!==l;)if(r.string+=l+"\n","#"!==l.charAt(0)){if((c=l.match(i))&&(r.gamma=parseFloat(c[1])),(c=l.match(n))&&(r.exposure=parseFloat(c[1])),(c=l.match(o))&&(r.valid|=2,r.format=c[1]),(c=l.match(a))&&(r.valid|=4,r.height=parseInt(c[1],10),r.width=parseInt(c[2],10)),2&r.valid&&4&r.valid)break}else r.comments+=l+"\n";return 2&r.valid?4&r.valid?r:e(3,"missing image size specifier"):e(3,"missing format specifier")}(a);if(-1!==r){const t=r.width,s=r.height,l=function(t,s,i){const n=s;if(n<8||n>32767||2!==t[0]||2!==t[1]||128&t[2])return new Uint8Array(t);if(n!==(t[2]<<8|t[3]))return e(3,"wrong scanline width");const o=new Uint8Array(4*s*i);if(!o.length)return e(4,"unable to allocate buffer space");let a=0,r=0;const l=4*n,c=new Uint8Array(4),d=new Uint8Array(l);let h=i;for(;h>0&&r<t.byteLength;){if(r+4>t.byteLength)return e(1);if(c[0]=t[r++],c[1]=t[r++],c[2]=t[r++],c[3]=t[r++],2!=c[0]||2!=c[1]||(c[2]<<8|c[3])!=n)return e(3,"bad rgbe scanline format");let s,i=0;for(;i<l&&r<t.byteLength;){s=t[r++];const n=s>128;if(n&&(s-=128),0===s||i+s>l)return e(3,"bad scanline data");if(n){const e=t[r++];for(let t=0;t<s;t++)d[i++]=e}else d.set(t.subarray(r,r+s),i),i+=s,r+=s}const u=n;for(let t=0;t<u;t++){let e=0;o[a]=d[t+e],e+=n,o[a+1]=d[t+e],e+=n,o[a+2]=d[t+e],e+=n,o[a+3]=d[t+e],a+=4}h--}return o}(a.subarray(a.pos),t,s);if(-1!==l){let e,a,c,d;switch(this.type){case n.FloatType:d=l.length/4;const t=new Float32Array(4*d);for(let e=0;e<d;e++)i(l,4*e,t,4*e);e=t,c=n.FloatType;break;case n.HalfFloatType:d=l.length/4;const s=new Uint16Array(4*d);for(let t=0;t<d;t++)o(l,4*t,s,4*t);e=s,c=n.HalfFloatType;break;default:console.error("THREE.RGBELoader: unsupported type: ",this.type)}return{width:t,height:s,data:e,header:r.string,gamma:r.gamma,exposure:r.exposure,format:a,type:c}}}return null}setDataType(t){return this.type=t,this}load(t,e,s,i){return super.load(t,(function(t,s){switch(t.type){case n.FloatType:case n.HalfFloatType:t.encoding=n.LinearEncoding,t.minFilter=n.LinearFilter,t.magFilter=n.LinearFilter,t.generateMipmaps=!1,t.flipY=!0}e&&e(t,s)}),s,i)}}class Sn{static keydown$(){return this.keydown$_||(this.keydown$_=s.fromEvent(window,"keydown").pipe(i.shareReplay(1))),this.keydown$_}static keyup$(){return this.keyup$_||(this.keyup$_=s.fromEvent(window,"keyup").pipe(i.shareReplay(1))),this.keyup$_}static keys$(){return this.keys$_||(this.keys$_=s.merge(this.keydown$(),this.keyup$()).pipe(i.map((t=>{const e=this.keys;return"keydown"===t.type?e[t.key]=!0:delete e[t.key],this.keys})),i.startWith(this.keys),i.shareReplay(1))),this.keys$_}static key$(){if(!this.key$_){const t=/\w/;this.key$_=this.keydown$().pipe(i.filter((e=>e.key&&e.key.match(t))),i.map((t=>t.key)),i.shareReplay(1))}return this.key$_}static typing$(){if(!this.typing$_){let t,e="";this.typing$_=this.key$().pipe(i.map((s=>(t&&clearTimeout(t),e+=s,t=setTimeout((()=>{e=""}),1500),e))),i.shareReplay(1))}return this.typing$_}}Sn.keys={};let Tn=0;class En{static switchLoaders(){const t=Object.keys(this.items).map((t=>this.items[t])),e=t.length?s.combineLatest(t):s.of(t);this.progress$.next(e)}static getRef(){const t=++Tn;return this.items[t]=new s.BehaviorSubject({loaded:0,total:1}),this.switchLoaders(),t}static setProgress(t,e,s){void 0===s&&(s=1);const i=this.items[t];i&&i.next({loaded:e,total:s}),e>=s&&setTimeout((()=>{delete this.items[t],this.switchLoaders()}),300),this.switchLoaders()}}En.progress={value:0,loaded:0,total:0,count:0,title:""},En.items={},En.progress$=new s.ReplaySubject(1).pipe(i.switchAll(),i.map((()=>{const t=Object.keys(En.items).map((t=>En.items[t])),e=t.reduce(((t,e,s,i)=>{const n=e.getValue(),o=n.loaded||0,a=n.total||1,r=o/a;return t.value+=r,t.loaded+=o,t.total+=a,t}),{value:0,loaded:0,total:0});return e.count=t.length,t.length&&(e.value/=e.count),e.title=`${Math.round(100*e.value)}%`,En.progress=e,e})));let Ln=0;const _n="complete";class In{static worker(){return this.worker_||(this.worker_=new Worker(U.workers.prefetch)),this.worker_}static events$(t){if(!("Worker"in window))return s.of({type:_n,data:t});const e=this.worker();e.postMessage({id:Ln});const n=++Ln;return e.postMessage({id:n,assets:t}),s.fromEvent(e,"message").pipe(i.map((t=>t.data)),i.filter((e=>e.assets===t)),i.tap((t=>{})),i.takeWhile((t=>t.type!==_n),!0),i.finalize((()=>{e.postMessage({id:n})})))}static load$(t){return this.events$(t).pipe(i.filter((t=>t.type===_n)),i.map((t=>t.data)))}static prefetch(t){this.load$(t).subscribe((t=>{}))}static cancel(){if(!("Worker"in window))return null;const t=this.worker();return t.postMessage({id:Ln}),t}}class Rn{constructor(t){this.x=0,this.y=0,this.top=0,this.right=0,this.bottom=0,this.left=0,this.width=0,this.height=0,this.set(t)}static contains(t,e,s){return t.top<=s&&s<=t.bottom&&t.left<=e&&e<=t.right}static intersectRect(t,e){return!(e.left>t.right||e.right<t.left||e.top>t.bottom||e.bottom<t.top)}static fromNode(t){if(!t)return;const e=t.rect_||(t.rect_=new Rn);if(!t.getClientRects().length)return e;const s=t.getBoundingClientRect();return e.x=s.left,e.y=s.top,e.top=s.top,e.left=s.left,e.width=s.width,e.height=s.height,e.right=e.left+e.width,e.bottom=e.top+e.height,e.setCenter(),e}set(t){t&&(Object.assign(this,t),this.right=this.left+this.width,this.bottom=this.top+this.height),this.setCenter()}setSize(t,e){this.width=t,this.height=e,this.right=this.left+this.width,this.bottom=this.top+this.height,this.setCenter()}setCenter(){const t=this.center||(this.center={});t.top=this.top+this.height/2,t.left=this.left+this.width/2,t.x=t.left,t.y=t.top}contains(t,e){return Rn.contains(this,t,e)}intersect(t){return Rn.intersectRect(this,t)}intersection(t){const e=this.intersection_||(this.intersection_={left:0,top:0,width:0,height:0,x:0,y:0,pow:{x:-1,y:-1},offset:function(t){t=t||0;return(this.top-this.rect.height/2+t)/-this.height},scroll:function(t){t=t||0;return(this.top-this.rect.height/2+t)/-this.height}});e.left=this.left,e.top=this.top,e.width=this.width,e.height=this.height,e.x=this.left+this.width/2,e.y=this.top+this.height/2,e.rect=t;const s=e.offset(0);return e.pow.y=s,e}}const $n=[16763904,65484,52479,13434624,13369599,16777215];class An{static get headGeometry(){return this.headGeometry_||(this.headGeometry_=new THREE.SphereBufferGeometry(.2,36,24)),this.headGeometry_}constructor(t){const e=this.clientId=t.clientId,s=this.container=t.container,i=this.renderer=new THREE.WebGLRenderer({antialias:!0,alpha:!1,premultipliedAlpha:!0});i.setClearColor(0,1),i.setPixelRatio(window.devicePixelRatio),i.setSize(320,240),i.toneMapping=THREE.ACESFilmicToneMapping,i.toneMappingExposure=.8,i.outputEncoding=THREE.sRGBEncoding,s.appendChild(i.domElement);const n=this.camera=new THREE.PerspectiveCamera(70,320/240,.01,1e3);n.position.set(0,0,-.5),n.target=new THREE.Vector3,n.lookAt(n.target);const o=this.scene=new THREE.Scene,a=this.light=new THREE.PointLight(16777215,1,100);a.position.set(0,2,-2),o.add(a);const r=this.head=this.addHead();o.add(r),this.remote=Zs.getRemoteById(e)}addHead(){const t=An.headGeometry,e=this.canvas=document.createElement("canvas");e.width=1024,e.height=512,this.ctx=this.canvas.getContext("2d");const s=this.map=new THREE.CanvasTexture(e);s.offset.x=-.25;const i=$n[this.clientId%$n.length],n=new THREE.MeshStandardMaterial({map:s,color:i});return this.chalk(0),new THREE.Mesh(t,n)}render(){if(this.tick_?++this.tick_:this.tick_=1,this.remote){const t=12*this.remote.getAudioLevel();this.chalk(t)}const t=this.renderer,e=this.scene,s=this.camera;t.render(e,s)}update(t){const e=t.camera;this.head.quaternion.set(e[3],e[4],e[5],e[6])}dispose(){this.subscription&&this.subscription.unsubscribe()}chalk(t){t=(t+.5*Math.PI)%(2*Math.PI);const e=30*Math.sin(t),s=10*Math.cos(t),i=256,n=this.ctx;n.fillStyle="#888888",n.fillRect(0,0,1024,512),n.fillStyle="white",n.beginPath(),n.arc(472,206,7,0,2*Math.PI),n.arc(552,206,7,0,2*Math.PI),n.closePath(),n.fill(),n.beginPath(),n.moveTo(472-s,286),n.bezierCurveTo(472-s,316,552+s,316,552+s,286),n.bezierCurveTo(552+s,i+e,472-s,i+e,472-s,286),n.closePath(),n.fill(),this.map.needsUpdate=!0}}class Pn{static get defaultTexture(){return Pn.defaultTexture_||(Pn.defaultTexture_=(new THREE.TextureLoader).load("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyNpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDYuMC1jMDA2IDc5LjE2NDc1MywgMjAyMS8wMi8xNS0xMTo1MjoxMyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDIyLjMgKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjcyODFGQkE0QUMxODExRUJBQkRBQTEyMzUzMjUxRjg2IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjcyODFGQkE1QUMxODExRUJBQkRBQTEyMzUzMjUxRjg2Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NzI4MUZCQTJBQzE4MTFFQkFCREFBMTIzNTMyNTFGODYiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NzI4MUZCQTNBQzE4MTFFQkFCREFBMTIzNTMyNTFGODYiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz55AlN+AAAAZUlEQVR42uzQAQEAAAQDMPTvfD3YIqyT1GdTzwkQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAgAtWgAEAVbYDfaostxgAAAAASUVORK5CYII="))}static get gridTexture(){return Pn.gridTexture_||(Pn.gridTexture_=(new THREE.TextureLoader).load(U.getPath(U.textures.grid)))}}class Hn extends Mn{static getLoader(){return Hn.loader||(Hn.loader=new THREE.TextureLoader)}static getTextureOff(){return Hn.textureOff||(Hn.textureOff=Hn.getLoader().load(U.getPath("textures/ui/play-off.png")))}static getTextureOn(){return Hn.textureOn||(Hn.textureOn=Hn.getLoader().load(U.getPath("textures/ui/play-on.png")))}static getMaterial(){return new THREE.MeshBasicMaterial({map:Hn.getTextureOff(),color:16777215,opacity:1,transparent:!0})}get playing(){return this.playing_}set playing(t){if(this.playing_!==t){this.playing_=t;this.material.map=t?Hn.getTextureOn():Hn.getTextureOff(),this.onOut()}}constructor(t){const e=bn.planeGeometry,s=Hn.getMaterial();super(e,s),this.playing_=!1,this.material=s,this.host=t,this.colorOff=new THREE.Color(s.color.getHex()),this.colorOn=new THREE.Color("#888888"),this.addEventListener()}update(t){const e=this.scale,s=t.scale.x/t.scale.y;e.set(.3/s,.3,1)}disposeMaterial(){this.material&&(this.material.map&&!1!==this.material.map.disposable&&this.material.map.dispose(),this.material.dispose())}dispose(){this.removeEventListener(),this.disposeMaterial()}onOver(){const t=this.material.color,e=this.colorOn,s=this.material;gsap.to(t,{r:e.r,g:e.g,b:e.b,duration:.2,ease:Power2.easeInOut}),gsap.to(s,{opacity:1,duration:.2,ease:Power2.easeInOut})}onOut(){const t=this.material.color,e=this.colorOff,s=this.material;gsap.to(t,{r:e.r,g:e.g,b:e.b,duration:.2,ease:Power2.easeInOut}),gsap.to(s,{opacity:this.playing?0:1,duration:.2,ease:Power2.easeInOut})}addEventListener(){this.onOver=this.onOver.bind(this),this.onOut=this.onOut.bind(this),this.on("over",this.onOver),this.on("out",this.onOut)}removeEventListener(){this.off("over",this.onOver),this.off("out",this.onOut)}}class On extends Mn{static getLoader(){return On.loader||(On.loader=new THREE.TextureLoader)}static getTextureOff(){return On.textureOff||(On.textureOff=On.getLoader().load(U.getPath("textures/ui/zoom-off.png")))}static getTextureOn(){return On.textureOn||(On.textureOn=On.getLoader().load(U.getPath("textures/ui/zoom-on.png")))}static getMaterial(){return new THREE.MeshBasicMaterial({map:On.getTextureOff(),color:16777215,opacity:1,transparent:!0})}get zoomed(){return this.zoomed_}set zoomed(t){if(this.zoomed_!==t){this.zoomed_=t;this.material.map=t?On.getTextureOn():On.getTextureOff()}}constructor(t){const e=bn.planeGeometry,s=On.getMaterial();super(e,s),this.zoomed_=!1,this.material=s,this.host=t,this.colorOff=new THREE.Color(s.color.getHex()),this.colorOn=new THREE.Color("#888888"),this.object=new THREE.Object3D,this.addEventListener()}disposeMaterial(){this.material&&(this.material.map&&!1!==this.material.map.disposable&&this.material.map.dispose(),this.material.dispose())}dispose(){this.removeEventListener(),this.disposeMaterial()}onOver(){const t=this.material.color,e=this.colorOn;this.material,gsap.to(t,{r:e.r,g:e.g,b:e.b,duration:.2,ease:Power2.easeInOut})}onOut(){const t=this.material.color,e=this.colorOff;this.material,gsap.to(t,{r:e.r,g:e.g,b:e.b,duration:.2,ease:Power2.easeInOut})}onToggle(){this.emit("zoomed",!this.zoomed)}addEventListener(){this.onOver=this.onOver.bind(this),this.onOut=this.onOut.bind(this),this.onToggle=this.onToggle.bind(this),this.on("over",this.onOver),this.on("out",this.onOut),this.on("down",this.onToggle)}removeEventListener(){this.off("over",this.onOver),this.off("out",this.onOut),this.off("down",this.onToggle)}}const Un="\nvarying vec2 vUvShader;\n\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\tvUvShader = uv;\n\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}\n",Bn="\n#define USE_MAP\n#define threshold 0.55\n#define padding 0.05\nvarying vec2 vUvShader;\n\nuniform vec3 diffuse;\nuniform float opacity;\n\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\n// uniform sampler2D map;\nuniform sampler2D playMap;\nuniform vec2 mapResolution;\nuniform vec2 playMapResolution;\nuniform float mapTween;\nuniform float playMapTween;\nuniform vec3 playMapColor;\nuniform vec3 chromaKeyColor;\nuniform bool isVideo;\n\nvoid main() {\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\n\t// main\n\tvec4 mapRgba = texture2D(map, vUvShader);\n\tvec4 chromaKey = vec4(chromaKeyColor, 1.0);\n    vec3 chromaKeyDiff = mapRgba.rgb - chromaKey.rgb;\n    float chromaKeyValue = smoothstep(threshold - padding, threshold + padding, dot(chromaKeyDiff, chromaKeyDiff));\n\t/*\n\tif (isVideo) {\n\t\tvec4 playMapRgba = texture2D(playMap, vUvShader);\n\t\tdiffuseColor = vec4(mapRgba.rgb + (playMapColor * playMapTween * 0.2) + (playMapRgba.rgb * mapTween * playMapRgba.a), opacity * chromaKeyValue);\n\t} else {\n\t\tdiffuseColor = vec4(mapRgba.rgb + (playMapColor * playMapTween * 0.2), opacity * chromaKeyValue);\n\t}\n\t*/\n\t// diffuseColor = vec4(mapRgba.rgb + (playMapColor * playMapTween * 0.2), opacity * chromaKeyValue);\n\tdiffuseColor = vec4(mapRgba.rgb, opacity * chromaKeyValue);\n\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t// accumulation (baked indirect lighting only)\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t// modulation\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\n\t#include <envmap_fragment>\n\n\tgl_FragColor = vec4(outgoingLight, diffuseColor.a);\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n";class Dn extends Mn{static getMaterial(t){return new THREE.ShaderMaterial({depthTest:!0,depthWrite:!0,transparent:!0,toneMapped:!1,vertexShader:Un,fragmentShader:t?Bn:"\n#define USE_MAP\n\nvarying vec2 vUvShader;\n\nuniform vec3 diffuse;\nuniform float opacity;\n\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\n// uniform sampler2D map;\nuniform sampler2D playMap;\nuniform vec2 mapResolution;\nuniform vec2 playMapResolution;\nuniform float mapTween;\nuniform float playMapTween;\nuniform vec3 playMapColor;\nuniform bool isVideo;\n\nvoid main() {\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4(vec3(1.0), opacity);\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\n\t// main\n\tvec4 mapRgba = texture2D(map, vUvShader);\n\tif (isVideo) {\n\t\tvec4 playMapRgba = texture2D(playMap, vUvShader);\n\t\tdiffuseColor = vec4(mapRgba.rgb + (playMapColor * playMapTween * 0.2) + (playMapRgba.rgb * mapTween * playMapRgba.a), opacity);\n\t} else {\n\t\tdiffuseColor = vec4(mapRgba.rgb + (playMapColor * playMapTween * 0.2), opacity);\n\t}\n\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\n\tReflectedLight reflectedLight = ReflectedLight(vec3(0.0), vec3(0.0), vec3(0.0), vec3(0.0));\n\n\t// accumulation (baked indirect lighting only)\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\n\t// modulation\n\t#include <aomap_fragment>\n\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",uniforms:{map:{type:"t",value:Pn.defaultTexture},mapResolution:{value:new THREE.Vector2},mapTween:{value:1},color:{value:new THREE.Color("#FFFFFF")},playMap:{type:"t",value:Pn.defaultTexture},playMapResolution:{value:new THREE.Vector2},playMapTween:{value:0},playMapColor:{value:new THREE.Color("#000000")},opacity:{value:0},isVideo:{value:!1}},extensions:{fragDepth:!0}})}static getChromaKeyMaterial(t){void 0===t&&(t=[0,1,0]);const e=new THREE.ShaderMaterial({depthTest:!0,depthWrite:!0,transparent:!0,toneMapped:!1,vertexShader:Un,fragmentShader:Bn,uniforms:{map:{type:"t",value:null},mapResolution:{value:new THREE.Vector2},mapTween:{value:1},color:{value:new THREE.Color("#FFFFFF")},chromaKeyColor:{value:new THREE.Color(t[0],t[1],t[2])},playMap:{type:"t",value:Pn.defaultTexture},playMapResolution:{value:new THREE.Vector2},playMapTween:{value:0},playMapColor:{value:new THREE.Color("#000000")},opacity:{value:0},isVideo:{value:!1}},extensions:{fragDepth:!0}});return e.map=!0,e}static isPublisherStream(t){return t.clientInfo&&t.clientInfo.role===ie.Publisher&&t.clientInfo.uid===t.getId()}static isAttendeeStream(t){return t.clientInfo&&t.clientInfo.role===ie.Attendee&&t.clientInfo.uid===t.getId()}static isSmartDeviceStream(t){return t.clientInfo&&t.clientInfo.role===ie.SmartDevice&&t.clientInfo.uid===t.getId()}static isPublisherScreen(t){return t.clientInfo&&t.clientInfo.role===ie.Publisher&&t.clientInfo.screenUid===t.getId()}static isAttendeeScreen(t){return t.clientInfo&&t.clientInfo.role===ie.Attendee&&t.clientInfo.screenUid===t.getId()}static getTypeMatcher(t){let e;switch(t.name){case Yi.PublisherStream.name:e=this.isPublisherStream;break;case Yi.AttendeeStream.name:e=this.isAttendeeStream;break;case Yi.SmartDeviceStream.name:e=this.isSmartDeviceStream;break;case Yi.PublisherScreen.name:e=this.isPublisherScreen;break;case Yi.AttendeeScreen.name:e=this.isAttendeeScreen;break;default:e=t=>!1}return e}static getStreamId$(t){if(!t.asset)return s.of(null);const e=t.asset.type,n=t.asset.file;return tn(t.asset)?Zs.streams$.pipe(i.map((s=>{let i,n=0;const o=this.getTypeMatcher(e);return s.forEach((e=>{o(e)&&(n===t.asset.index&&(i=e),n++)})),i?i.getId():null}))):s.of(n)}static getMaterialByItem(t){let e;return e=t.asset&&t.asset.chromaKeyColor?Dn.getChromaKeyMaterial(t.asset.chromaKeyColor):(t.asset,new THREE.MeshBasicMaterial({color:16777215,toneMapped:!1})),e}static getUniformsByItem(t){let e=null;return t.asset&&(e={mapTween:1,playMapTween:0,opacity:0}),e}get editing(){return this.editing_}set editing(t){this.editing_!==t&&(this.editing_=t,this.zoomed="media"===this.view.type.name||!t&&this.zoomed)}constructor(t,e,s,i){super(s,Dn.getMaterialByItem(t)),this.zoomed_=!1,this.item=t,this.view=e,this.items=e.items,this.host=i,this.uniforms=Dn.getUniformsByItem(t),this.object=new THREE.Object3D,this.tempPosition=new THREE.Vector3,this.tempRotation=new THREE.Vector3,t.silent=this.isAutoplayLoop,this.mediaLoader=new fn(t),this.onOver=this.onOver.bind(this),this.onOut=this.onOut.bind(this),this.onToggle=this.onToggle.bind(this),this.onZoomed=this.onZoomed.bind(this),this.addPlayBtn(),this.addZoomBtn(),this.userData.render=(t,e)=>{this.render(this,t,e)}}load(t){if(this.playBtn&&this.remove(this.playBtn),this.zoomBtn&&this.remove(this.zoomBtn),!this.item.asset)return this.onAppear(),void("function"==typeof t&&t(this));const e=this.material;this.mediaLoader.load((s=>{const i=this.mediaLoader;i&&(s&&(e.map=s,e.uniforms&&(e.uniforms.map.value=s,e.uniforms.mapResolution.value=new THREE.Vector2(s.image.width||s.image.videoWidth,s.image.height||s.image.videoHeight),i.isPlayableVideo&&this.makePlayMap(s,(t=>{t.minFilter=THREE.LinearFilter,t.magFilter=THREE.LinearFilter,t.mapping=THREE.UVMapping,t.wrapS=THREE.RepeatWrapping,t.wrapT=THREE.RepeatWrapping,e.uniforms.playMap.value=t,e.uniforms.playMapResolution.value=new THREE.Vector2(t.image.width,t.image.height),e.needsUpdate=!0})))),e.needsUpdate=!0,this.onAppear(),i.isPlayableVideo&&this.playBtn&&(e.uniforms&&(e.uniforms.isVideo.value=!0),this.on("over",this.onOver),this.on("out",this.onOut),this.on("down",this.onToggle),this.add(this.playBtn)),this.zoomBtn&&this.add(this.zoomBtn),"function"==typeof t&&t(this))}))}makePlayMap(t,e){const s=t.image.width||t.image.videoWidth,i=t.image.height||t.image.videoHeight,n=s/i,o=document.createElement("canvas");o.width=s,o.height=i;const a=o.getContext("2d");a.imageSmoothingEnabled=!0,a.imageSmoothingQuality="high";const r=new Image;r.onload=function(){const t=r.width/r.height;let l,c;n>t?(l=.32*i,c=l/t):(c=.32*s,l=c*t),a.drawImage(r,s/2-l/2,i/2-c/2,l,c);const d=new THREE.CanvasTexture(o);"function"==typeof e&&e(d)},r.crossOrigin="anonymous",r.src=U.getPath("textures/ui/play.png")}events$(){const t=this.item,e=this.items;return t.asset&&t.asset.linkedPlayId&&this.freeze(),fn.events$.pipe(i.filter((e=>e.loader.item&&e.loader.item.id===t.id)),i.map((s=>{if(s instanceof un?(this.playing=!0,this.isAutoplayLoop||(this.playBtn&&(this.playBtn.playing=!0),this.emit("playing",!0)),this.onOut()):s instanceof pn?(this.playing=!1,this.playBtn&&(this.playBtn.playing=!1),this.emit("playing",!1),this.onOut()):s instanceof gn&&this.emit("currentTime",s.loader.video.currentTime),t.asset&&t.asset.linkedPlayId){e.find((e=>e.asset&&-1!==s.src.indexOf(e.asset.file)&&s.id===t.asset.linkedPlayId))&&(s instanceof un?this.play():s instanceof pn&&this.pause())}return s})))}onAppear(){const t=this.uniforms,e=this.material;e.uniforms&&gsap.to(t,{duration:.4,opacity:1,ease:Power2.easeInOut,onUpdate:()=>{e.uniforms.opacity.value=t.opacity}}),this.zoomed="media"===this.view.type.name||!this.editing&&this.zoomed}onDisappear(){const t=this.uniforms,e=this.material;e.uniforms&&gsap.to(t,{duration:.4,opacity:0,ease:Power2.easeInOut,onUpdate:()=>{e.uniforms.opacity.value=t.opacity}})}onOver(){const t=this.uniforms,e=this.material;e.uniforms&&gsap.to(t,{duration:.4,mapTween:this.playing?0:1,playMapTween:1,opacity:1,ease:Power2.easeInOut,overwrite:!0,onUpdate:()=>{e.uniforms.mapTween.value=t.mapTween,e.uniforms.playMapTween.value=t.playMapTween,e.uniforms.opacity.value=t.opacity}}),this.playBtn&&this.playBtn.onOver()}onOut(){const t=this.uniforms,e=this.material;e.uniforms&&gsap.to(t,{duration:.4,mapTween:this.playing?0:1,playMapTween:0,opacity:1,ease:Power2.easeInOut,overwrite:!0,onUpdate:()=>{e.uniforms.mapTween.value=t.mapTween,e.uniforms.playMapTween.value=t.playMapTween,e.uniforms.opacity.value=t.opacity}}),this.playBtn&&this.playBtn.onOut()}onToggle(){this.playing=this.mediaLoader.toggle(),this.playBtn&&(this.playBtn.playing=this.playing),this.emit("playing",this.playing),this.onOut()}play(){this.mediaLoader.play()}pause(){this.mediaLoader.pause()}setPlayingState(t){this.playing!==t&&(this.playing=t,t?this.mediaLoader.play():this.mediaLoader.pause(),this.onOut(),this.playBtn&&(this.playBtn.playing=t))}setZoomedState(t){this.zoomed=t}setCurrentTime(t){this.mediaLoader.video&&(this.mediaLoader.video.currentTime=t)}disposeMaterial(){this.material&&(this.material.map&&!1!==this.material.map.disposable&&this.material.map.dispose(),this.material.dispose())}disposeMediaLoader(){const t=this.mediaLoader;t&&(t.isPlayableVideo&&(this.off("over",this.onOver),this.off("out",this.onOut),this.off("down",this.onToggle)),t.dispose(),this.mediaLoader=null)}dispose(){this.removePlayBtn(),this.removeZoomBtn(),this.disposeMediaLoader()}get isAutoplayLoop(){return"media"!==this.view.type.name&&this.item.asset&&this.item.asset.autoplay&&this.item.asset.loop}addPlayBtn(){if(this.removePlayBtn(),!this.isAutoplayLoop){const t=this.playBtn=new Hn(this.host);t.on("over",this.onOver),t.on("out",this.onOut),t.on("down",this.onToggle),t.position.z=.01}}removePlayBtn(){this.playBtn&&(this.remove(this.playBtn),this.playBtn.off("over",this.onOver),this.playBtn.off("out",this.onOut),this.playBtn.off("down",this.onToggle),this.playBtn.dispose(),delete this.playBtn)}onZoomed(t){this.zoomed=t,this.emit("zoomed",t)}addZoomBtn(){if(this.removeZoomBtn(),!("media"===this.view.type.name||this.item.asset&&this.item.asset.chromaKeyColor)){(this.zoomBtn=new On(this.host)).on("zoomed",this.onZoomed)}}removeZoomBtn(){this.zoomBtn&&(this.remove(this.zoomBtn),this.zoomBtn.off("zoomed",this.onZoomed),this.zoomBtn.dispose(),this.zoomBtn=null,delete this.zoomBtn)}updateByItem(t){this.disposeMaterial(),this.disposeMediaLoader(),this.material=Dn.getMaterialByItem(t),this.uniforms=Dn.getUniformsByItem(t),this.addPlayBtn(),this.addZoomBtn(),t.silent=this.isAutoplayLoop,this.mediaLoader=new fn(t)}updateFromItem(t){t.position&&this.position.fromArray(t.position),t.rotation&&this.rotation.fromArray(t.rotation),t.scale&&this.scale.fromArray(t.scale),this.playBtn&&this.playBtn.update(this),this.updateZoom()}updateZoom(){if(this.originalPosition=this.position.clone(),this.originalScale=this.scale.clone(),this.originalQuaternion=this.quaternion.clone(),this.object.position.copy(this.originalPosition),this.object.scale.copy(this.originalScale),this.object.quaternion.copy(this.originalQuaternion),this.zoomBtn){const t=this.zoomBtn.scale,e=this.zoomBtn.position,s=this.scale.x/this.scale.y,i=.1;t.set(i/s,i,1),e.x=.5-i/s/2,e.y=i/2-.5,e.z=.01}}render(t,e){if(!this.editing){const t=this.object;this.zoomed&&!this.host.renderer.xr.isPresenting&&this.updateObjectMatrix(),this.position.copy(t.position),this.scale.copy(t.scale),this.quaternion.copy(t.quaternion)}}updateObjectMatrix(){const t=this.object,e=this.host;if(this.zoomed){const s=this.originalScale;let i,n=e.camera,o=n.fov,a=n.aspect;const r=this.tempPosition,l=this.tempRotation;i=.01;const c=e.renderer.xr;if(c.isPresenting){n=c.getCamera(n);const t=n.projectionMatrix.elements,e=t[0],s=t[5];a=s/e;o=57.29577951308232*(2*Math.atan(1/s)),i=1}t.scale.copy(s).multiplyScalar(i);const d=wn.getDistanceToCamera(n,o,a,t.scale);n.getWorldDirection(l),l.multiplyScalar(d),r.set(0,0,0),n.localToWorld(r),r.add(l),t.position.copy(r),t.lookAt(wn.origin),c.isPresenting&&(t.position.y-=t.scale.y/2)}}get zoomed(){return this.zoomed_}set zoomed(t){this.zoomed_!==t&&(this.zoomed_=t,t?(this.renderOrder=U.renderOrder.panel+5,this.material.depthTest=!0):(this.renderOrder=0,this.material.depthTest=!0,this.object.position.copy(this.originalPosition),this.object.scale.copy(this.originalScale),this.object.quaternion.copy(this.originalQuaternion)),this.material.needsUpdate=!0,this.updateObjectMatrix(),this.zoomBtn&&(this.zoomBtn.zoomed=t))}}class zn{constructor(){this.x=0,this.y=0}}class Vn{constructor(t){t&&Object.assign(this,t)}}class jn extends Vn{constructor(t){super(t),this.distance=new zn,this.strength=new zn,this.speed=new zn}}class Nn extends Vn{constructor(t){super(t),this.distance=new zn,this.strength=new zn,this.speed=new zn}}class Fn extends Vn{constructor(t){super(t)}}let Gn;class qn{static getPosition(t,e){return t instanceof MouseEvent?e?(e.x=t.clientX,e.y=t.clientY):e={x:t.clientX,y:t.clientY}:window.TouchEvent&&t instanceof TouchEvent&&t.touches.length>0&&(e?(e.x=t.touches[0].pageX,e.y=t.touches[0].pageY):e={x:t.touches[0].pageX,y:t.touches[0].pageY}),e}static down$(t,e){let n;return s.merge(s.fromEvent(t,"mousedown").pipe(i.filter((t=>0===t.button))),s.fromEvent(t,"touchstart")).pipe(i.map((s=>{if(n=n||new jn,n.node=t,n.target=s.target,n.originalEvent=s,n.down=this.getPosition(s,n.down),n.down)return n.distance=new zn,n.strength=new zn,n.speed=new zn,e.next(n),n})),i.filter((t=>void 0!==t)))}static move$(t,e,n,o){let a;return s.fromEvent(document,o.originalEvent instanceof MouseEvent?"mousemove":"touchmove").pipe(i.startWith(o),i.map((s=>{a=a||new Nn,a.node=t,a.target=s.target,a.originalEvent=s,a.position=this.getPosition(s,a.position);if(void 0!==o.down&&void 0!==a.position)return a.distance.x=a.position.x-o.down.x,a.distance.y=a.position.y-o.down.y,a.strength.x=a.distance.x/window.innerWidth*2,a.strength.y=a.distance.y/window.innerHeight*2,a.speed.x=o.speed.x+.1*(a.strength.x-o.strength.x),a.speed.y=o.speed.y+.1*(a.strength.y-o.strength.y),o.distance.x=a.distance.x,o.distance.y=a.distance.y,o.speed.x=a.speed.x,o.speed.y=a.speed.y,o.strength.x=a.strength.x,o.strength.y=a.strength.y,e.next(a),a})))}static dismissEvent(t,e,s,i){return Gn=Gn||new Fn,e.next(Gn),s.next(),i&&Math.abs(i.distance.x)>10&&(t.preventDefault(),t.stopImmediatePropagation()),Gn}static up$(t,e,n,o){return s.fromEvent(document,o.originalEvent instanceof MouseEvent?"mouseup":"touchend").pipe(i.map((t=>this.dismissEvent(t,e,n,o))))}static observe$(t){t=t||document;const e=qn.events$,n=qn.dismiss$;return this.down$(t,e).pipe(i.switchMap((o=>(qn.downEvent=o,s.merge(this.move$(t,e,n,o),this.up$(t,e,n,o)).pipe(i.takeUntil(n))))),i.switchMap((()=>e)))}}qn.events$=new s.ReplaySubject(1),qn.dismiss$=new s.Subject;const Zn="panorama",Wn="model";class Kn{}class Xn extends Kn{}const Yn=new Xn,Jn=new class extends Kn{},Qn=new class extends Kn{};class to{get dolly(){return this.dolly_}set dolly(t){const e=THREE.Math.clamp(t,15,75);this.dolly_!==e&&(this.dolly_=e,this.markAsDirty())}getDollyValue(){return 1-(this.dolly_-15)/60-.5}get zoom(){return this.zoom_}set zoom(t){const e=THREE.Math.clamp(t,15,75);this.zoom_!==e&&(this.zoom_=e,this.markAsDirty())}getZoomValue(){return 2-(this.zoom_-15)/60}get mode(){return this.mode_}set mode(t){this.mode_!==t&&(this.mode_=t,to.mode=t,this.markAsDirty())}get controlled(){return se.state.controlling&&se.state.controlling!==se.state.uid}get controlling(){return se.state.controlling&&se.state.controlling===se.state.uid}get silencing(){return se.state.silencing}get silenced(){return se.state.silencing&&se.state.role===ie.Streamer}get spyed(){return se.state.spying&&se.state.spying===se.state.uid}get spying(){return se.state.spying&&se.state.spying!==se.state.uid}get isMediaView(){const t=ln.currentView;return t&&t.type.name===bi.Media.name}get locked(){return this.controlled||this.spying||this.isMediaView}constructor(t){this.mode_=to.mode=Zn,this.dolly_=70,this.zoom_=70,this.longitude=0,this.latitude=0,this.direction=1,this.radius=101,this.position=new THREE.Vector3,this.inertia=new THREE.Vector2,this.rotation=new THREE.Euler(0,0,0,"XYZ"),this.target=new THREE.Vector3,this.updatePosition=new THREE.Vector3,this.updateTarget=new THREE.Vector3,this.camera=t,this.setLongitudeLatitude(0,0),this.events$=new s.ReplaySubject(1)}setOrientation(t){t&&(this.setLongitudeLatitude(t.longitude,t.latitude),this.markAsDirty())}getOrientation(){return{latitude:this.latitude,longitude:this.longitude}}setLongitudeLatitude(t,e){e=Math.max(-80,Math.min(80,e)),this.longitude=(t<0?360+t:t)%360,this.latitude=e;const s=THREE.Math.degToRad(90-e),i=THREE.Math.degToRad(t);this.phi=s,this.theta=i}observe$(t){let e,n;return s.combineLatest([Sn.keys$(),qn.observe$(t)]).pipe(i.filter((t=>!this.locked)),i.map((t=>{const s=t[0],i=t[1];if(i instanceof jn)e=this.latitude,n=this.longitude;else if(i instanceof Nn)if(s.Shift)this.events$.next(Jn);else if(s.Control)this.events$.next(Qn);else{const t=this.mode_===Wn?-1:1;this.setLongitudeLatitude(n-.1*i.distance.x*t,e+.1*i.distance.y)}return i})),i.filter((t=>t instanceof Nn)),i.startWith({latitude:this.latitude,longitude:this.longitude}),i.tap((t=>this.markAsDirty())),i.switchMap((t=>this.events$)))}walk(t,e){let s;if(this.mode_===Wn)s=3;else s=this.radius;const i=new THREE.Vector2(t.x,t.y).normalize().multiplyScalar(s),n=Math.atan2(i.y,i.x);let o=THREE.MathUtils.radToDeg(n);o=(o<0?360+o:o)%360;const a=this.latitude,r=this.longitude;let l=o-r;l=Math.abs(l)>180?l-l/Math.abs(l)*360:l;let c=0-a;c=Math.abs(c)>90?c-c/Math.abs(c)*90:c;const d={tween:0};gsap.to(d,{duration:.7,tween:1,delay:0,ease:Power2.easeInOut,onUpdate:()=>{this.setLongitudeLatitude(r+l*d.tween,a+c*d.tween),this.position.set(t.x*d.tween,0,t.y*d.tween),this.markAsDirty()},onComplete:()=>{"function"==typeof e&&e(o,0)}})}walkComplete(t,e){this.setLongitudeLatitude(t,e),this.position.set(0,0,0),this.markAsDirty()}lookAt(t){if(t){let e=t.position.clone();let s;if(e=this.camera.parent.worldToLocal(e),this.mode_===Wn)s=3;else s=this.radius;const i=new THREE.Vector3(e.x,e.z,e.y).normalize().multiplyScalar(s),n=Math.atan2(i.y,i.x),o=Math.acos(i.z/s);let a=THREE.MathUtils.radToDeg(n);a=(a<0?360+a:a)%360;let r=90-THREE.MathUtils.radToDeg(o);r=Math.max(-80,Math.min(80,r)),this.setLongitudeLatitude(a,r),this.markAsDirty()}}setVRCamera(t){if(t){const e=this.radius,s=new THREE.Vector3(0,0,-e),i=new THREE.Quaternion(t[3],t[4],t[5],t[6]);s.applyQuaternion(i);const n=new THREE.Vector3(s.x,s.z,s.y).normalize().multiplyScalar(e),o=Math.atan2(n.y,n.x),a=Math.acos(n.z/e);let r=THREE.MathUtils.radToDeg(o);r=(r<0?360+r:r)%360;let l=90-THREE.MathUtils.radToDeg(a);l=Math.max(-80,Math.min(80,l)),this.setLongitudeLatitude(r,l),this.markAsDirty()}}render(){se.state.hosted||(this.longitude+=.025,this.isDirty=!0),this.isDirty&&(this.isDirty=!1,this.update())}markAsDirty(){this.isDirty=!0}update(){let t,e=this.updatePosition,s=this.updateTarget;const i=this.getZoomValue();this.getDollyValue();const n=THREE.MathUtils.degToRad(90-this.latitude),o=THREE.MathUtils.degToRad(this.longitude),a=this.camera,r=a.parent;if(this.mode_===Wn)t=3,e.copy(this.position),s.x=this.position.x+t*Math.sin(n)*Math.cos(o),s.y=this.position.y+t*Math.cos(n),s.z=this.position.z+t*Math.sin(n)*Math.sin(o),s=r.worldToLocal(s),a.target.copy(e),a.position.copy(s);else t=this.radius,s.x=this.position.x+t*Math.sin(n)*Math.cos(o),s.y=this.position.y+t*Math.cos(n),s.z=this.position.z+t*Math.sin(n)*Math.sin(o),e.copy(this.position),s=r.worldToLocal(s),a.target.copy(s),a.position.copy(e);a.zoom=i,a.lookAt(a.target),a.updateProjectionMatrix();const l=ln.currentView;l&&(l.lastOrientation.longitude=this.longitude,l.lastOrientation.latitude=this.latitude),this.events$.next(Yn)}}to.orbitMoveEvent=Yn;let eo=0;const so="progress",io="complete";class no{static worker(){return this.worker_||(this.worker_=new Worker(U.workers.image)),this.worker_}static events$(t,e){if(!("Worker"in window)||this.isBlob(t)||this.isCors(t))return s.of({type:io,data:t});const n=++eo,o=this.worker();return o.postMessage({src:t,id:n,size:e}),s.fromEvent(o,"message").pipe(i.map((t=>t.data)),i.filter((e=>e.src===t)),i.auditTime(100),i.map((t=>{if(t.type===io&&t.data instanceof Blob){const e=URL.createObjectURL(t.data);t.data=e}return t})),i.takeWhile((t=>t.type!==io),!0),i.finalize((()=>{o.postMessage({id:n})})))}static load$(t,e){return this.events$(t,e).pipe(i.filter((t=>t.type===io)),i.map((t=>t.data)))}static isCors(t){return!1}static isBlob(t){return 0===t.indexOf("blob:")}}class oo{static get video(){return this.video_}static set video(t){if(this.video_&&(this.video_.muted=!0,this.video_.pause(),this.video_.parentNode&&this.video_.parentNode.removeChild(this.video_),this.video_=null),t){const t=this.video_=document.createElement("video");t.loop=!0,t.playsInline=!0,t.crossOrigin="anonymous"}}static get muted(){return this.muted_}static set muted(t){this.muted_=t,this.video&&(this.video.muted=!0===t)}static set cubeRenderTarget(t){this.cubeRenderTarget_&&(this.cubeRenderTarget_.texture.dispose(),this.cubeRenderTarget_.dispose()),this.cubeRenderTarget_=t}static set texture(t){this.texture_&&this.texture_.dispose(),this.texture_=t}static load(t,e,s){if(fn.events$.next(new mn(this)),this.video=null,t)return t.type.name===Yi.PublisherStream.name?this.loadPublisherStreamBackground(e,s):-1!==t.file.indexOf(".mp4")||-1!==t.file.indexOf(".webm")?this.loadVideoBackground(U.getPath(t.folder),t.file,e,s):-1!==t.file.indexOf(".m3u8")?this.loadHlslVideoBackground(t.file,e,s):-1!==t.file.indexOf(".hdr")?this.loadRgbeBackground(U.getPath(t.folder),t.file,e,s):this.loadBackgroundImageService(U.getPath(t.folder),t.file,e,s)}static loadBackgroundImageService(t,e,n,o){const a=En.getRef(),r=new Image;no.events$(t+e).pipe(i.tap((t=>{t.type===so&&En.setProgress(a,t.data.loaded,t.data.total)})),i.filter((t=>t.type===io)),i.switchMap((t=>{const e=s.fromEvent(r,"load");return r.crossOrigin="anonymous",r.src=t.data,e})),i.takeWhile((t=>t.type!==io),!0)).subscribe((t=>{const e=new THREE.Texture(r);e.minFilter=THREE.LinearFilter,e.magFilter=THREE.LinearFilter,e.mapping=THREE.UVMapping,e.toneMapped=!1,e.needsUpdate=!0,"function"==typeof o&&(o(e),URL.revokeObjectURL(t.data)),En.setProgress(a,1)}))}static loadBackground(t,e,s,i){const n=En.getRef(),o=new THREE.TextureLoader;return o.setPath(t).load(e,(t=>{t.minFilter=THREE.LinearFilter,t.magFilter=THREE.LinearFilter,t.mapping=THREE.UVMapping,t.needsUpdate=!0,"function"==typeof i&&i(t),En.setProgress(n,1)}),(t=>{En.setProgress(n,t.loaded,t.total)})),o}static loadRgbeBackground(t,e,s,i){const n=En.getRef(),o=new kn;return o.setDataType(THREE.UnsignedByteType).setPath(t).load(e,(t=>{"function"==typeof i&&i(t,!0),En.setProgress(n,1)}),(t=>{En.setProgress(n,t.loaded,t.total)})),o}static loadHlslVideoBackground(t,e,s){const i=En.getRef(),n=document.createElement("video");if(n.oncanplay=()=>{(()=>{n.oncanplay=null;const t=new THREE.VideoTexture(n);t.minFilter=THREE.LinearFilter,t.magFilter=THREE.LinearFilter,t.mapping=THREE.UVMapping,t.needsUpdate=!0,"function"==typeof s&&s(t),En.setProgress(i,1)})()},Hls.isSupported()){var o=new Hls;o.attachMedia(n),o.on(Hls.Events.MEDIA_ATTACHED,(()=>{o.loadSource(t),o.on(Hls.Events.MANIFEST_PARSED,((t,e)=>{n.play()}))}))}}static get progress(){const t=this.video;return t?t.currentTime/t.duration:0}static set progress(t){const e=this.video;if(e){const s=e.duration*t;e.seekable.length>t&&e.currentTime!==s&&(e.currentTime=s,fn.events$.next(new gn(this)))}}static play(t){const e=this.video;e&&(e.muted=this.muted_,e.play().then((()=>{t||fn.events$.next(new un(this))}),(t=>{console.log("PanoramaLoader.play.error",e.src,t)})))}static pause(t){const e=this.video;e&&(e.muted=!0,e.pause(),t||fn.events$.next(new pn(this)))}static loadVideoBackground(t,e,s,i){const n=En.getRef();this.video=!0;const o=this.video;o.oncanplay=()=>{o.oncanplay=null;const t=new THREE.VideoTexture(o);t.minFilter=THREE.LinearFilter,t.magFilter=THREE.LinearFilter,t.mapping=THREE.UVMapping,t.needsUpdate=!0,"function"==typeof i&&i(t),En.setProgress(n,1),this.play()},o.ontimeupdate=()=>{fn.events$.next(new vn(this))},o.onended=()=>{},o.crossOrigin="anonymous",o.src=t+e,o.load()}static loadPublisherStreamBackground(t,e){const s=t=>{const s=document.querySelector(`#stream-${t} video`);if(!s)return;const i=()=>{const t=this.texture=new THREE.VideoTexture(s);t.minFilter=THREE.LinearFilter,t.magFilter=THREE.LinearFilter,t.mapping=THREE.UVMapping,t.needsUpdate=!0,"function"==typeof e&&e(t)};s.crossOrigin="anonymous",s.readyState>=s.HAVE_FUTURE_DATA?i():s.oncanplay=()=>{i()}};Zs.getPublisherStreamId$().pipe(i.first()).subscribe((t=>s(t)))}}class ao{constructor(t){this.muted_=!1,this.subscription=se.state$.subscribe((t=>oo.muted=t.volumeMuted)),this.tween=0,this.create(t)}create(t){this.renderer=t,this.onCubeMapDispose=this.onCubeMapDispose.bind(this);const e=new THREE.BoxGeometry(202,202,202),s=this.getBlackMaterial(),i=new Mn(e,s);i.userData={render:(t,e,s,n,o)=>{i.matrixWorld.copyPosition(o.matrixWorld);const a=this.cubeMap,r=this.texture;a&&r&&r.isVideoTexture&&this.updateCubeMapEquirectangularTexture(a,s,r)}},i.name="[panorama]",this.mesh=i}getBlackMaterial(){return new THREE.MeshBasicMaterial({name:"PanoramaStandardMaterial",color:0,side:THREE.BackSide,depthTest:!1,depthWrite:!1,fog:!1})}getShaderMaterial(t){const e=new THREE.ShaderMaterial({name:"PanoramaCubeMaterial",uniforms:this.cloneUniforms(THREE.ShaderLib.cube.uniforms),vertexShader:THREE.ShaderLib.cube.vertexShader,fragmentShader:THREE.ShaderLib.cube.fragmentShader,side:THREE.BackSide,depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1});t.mapping=THREE.EquirectangularReflectionMapping;const s=this.toCubeMap(t,this.renderer);return e.map=s,e.uniforms.envMap.value=s,e.uniforms.flipEnvMap.value=s.isCubeTexture&&s._needsFlipEnvMap?-1:1,e.needsUpdate=!0,this.mesh.geometry.deleteAttribute("normal"),this.mesh.geometry.deleteAttribute("uv"),Object.defineProperty(e,"envMap",{get:function(){return this.uniforms.envMap.value},configurable:!0}),e}makeEnvMap(t){let e=this.mesh.material;if(e.uniforms){t.mapping=THREE.EquirectangularReflectionMapping;const s=this.toCubeMap(t,this.renderer);e.map=s,e.uniforms.envMap.value=s,e.uniforms.flipEnvMap.value=s.isCubeTexture&&s._needsFlipEnvMap?-1:1,e.needsUpdate=!0}else e.dispose(),e=this.getShaderMaterial(t),this.mesh.material=e}toCubeMap(t,e){this.cubeMap&&this.cubeMap.dispose();const s=t.image,i=s.height||s.videoHeight,n=new THREE.WebGLCubeRenderTarget(i/2,{generateMipmaps:!0,type:THREE.HalfFloatType,encoding:THREE.LinearEncoding,minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,mapping:THREE.CubeUVReflectionMapping,format:THREE.RGBAFormat});return n.addEventListener("dispose",this.onCubeMapDispose),this.setCubeMapEquirectangularTexture(n,t),this.updateCubeMapEquirectangularTexture(n,e,t),this.cubeMap=n,this.texture=t,this.mapTextureMapping(n.texture,t.mapping)}setCubeMapEquirectangularTexture(t,e){t.texture.type=e.type,t.texture.format=THREE.RGBAFormat,t.texture.encoding=THREE.sRGBEncoding,t.texture.generateMipmaps=e.generateMipmaps,t.texture.minFilter=e.minFilter,t.texture.magFilter=e.magFilter,t.texture.needsUpdate=!0;const s={uniforms:{tEquirect:{value:null}},vertexShader:"\n\t\t\t\t\tvarying vec3 vWorldDirection;\n\t\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\t\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\t\t\t\t\t}\n\t\t\t\t\tvoid main() {\n\t\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\t\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t\t#include <project_vertex>\n\t\t\t\t\t}\n\t\t\t\t",fragmentShader:"\n\t\t\t\t\tuniform sampler2D tEquirect;\n\t\t\t\t\tvarying vec3 vWorldDirection;\n\t\t\t\t\t#include <common>\n\t\t\t\t\tvoid main() {\n\t\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\t\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\t\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t\t\t\t\t}\n\t\t\t\t"},i=new THREE.BoxGeometry(5,5,5),n=new THREE.ShaderMaterial({name:"CubemapFromEquirect",uniforms:this.cloneUniforms(s.uniforms),vertexShader:s.vertexShader,fragmentShader:s.fragmentShader,side:THREE.BackSide,blending:THREE.NoBlending});n.uniforms.tEquirect.value=e;const o=new THREE.Mesh(i,n),a=new THREE.CubeCamera(1,10,t);return t.camera=a,t.mesh=o,t}updateCubeMapEquirectangularTexture(t,e,s){const i=s.minFilter;s.minFilter===THREE.LinearMipmapLinearFilter&&(s.minFilter=THREE.LinearFilter),t.camera.update(e,t.mesh),s.minFilter=i}cloneUniforms(t){const e={};for(const s in t){e[s]={};for(const i in t[s]){const n=t[s][i];n&&(n.isColor||n.isMatrix3||n.isMatrix4||n.isVector2||n.isVector3||n.isVector4||n.isTexture||n.isQuaternion)?e[s][i]=n.clone():Array.isArray(n)?e[s][i]=n.slice():e[s][i]=n}}return e}mapTextureMapping(t,e){return e===THREE.EquirectangularReflectionMapping?t.mapping=THREE.CubeReflectionMapping:e===THREE.EquirectangularRefractionMapping&&(t.mapping=THREE.CubeRefractionMapping),t}onCubeMapDispose(){const t=this.cubeMap;t&&(t.removeEventListener("dispose",this.onCubeMapDispose),t.texture.dispose(),t.mesh.geometry.dispose(),t.mesh.material.dispose(),void 0!==t&&(this.cubeMap=null))}change(t,e,s,i){const n=t instanceof Ci?t.tiles[t.index_]:t,o=this.mesh.material;this.load(n,e,(e=>{"function"==typeof i&&i(t),o.uniforms&&o.uniforms.uTween&&(o.uniforms.uTween.value=1,o.needsUpdate=!0),"function"==typeof s&&s(e)}))}crossfade(t,e,s){const i=this.mesh.material;this.load(t,e,(t=>{i.uniforms&&i.uniforms.uTween&&(i.uniforms.uTween.value=1,i.needsUpdate=!0),"function"==typeof s&&s(t)}))}getLocalizedAsset(t){if(t&&t.locale){const e=t.locale[be.lang];e&&(t=e)}return t}load(t,e,s){const i=t.type.name===bi.Media.name?on.defaultMediaAsset:t.asset;if(!i)return;if(i.type.name===Yi.Model.name)return void("function"==typeof s&&s(null));const n=this.getLocalizedAsset(i);this.currentAsset=n.folder+n.file,oo.load(n,e,((t,e)=>{if(n.folder+n.file!==this.currentAsset)return void t.dispose();const i=this.makeEnvMap(t);"function"==typeof s&&s(i)}))}dispose(){this.subscription.unsubscribe(),this.cubeMap&&this.cubeMap.dispose()}}const ro=4/3,lo=[16777215,16763904,65484,52479,13434624,13369599];class co{static get geometry(){return new THREE.PlaneBufferGeometry(.12,.09,2,2)}setRemote(t,e,s){this.remote=t;let i,n,o,a,r,l,c;s<4?(i=1,n=0,o=e,a=.12*i,r=a/ro,l=0,c=r/2-s*r/2,this.plane.position.set(l,c+r*e,.005)):(i=.5,n=e%2,o=Math.floor(e/2),a=.12*i,r=a/ro,l=-a/2,c=r/2-Math.ceil(s/2)*r/2,this.plane.position.set(l+n*a,c+o*r,.005)),this.plane.scale.set(i,i,i),"number"==typeof t?this.plane.material.color.set(lo[e%lo.length]):t.texture?(this.plane.material.map=t.texture,this.plane.material.needsUpdate=!0):this.addStreamTexture(t.getId(),(e=>{t.texture=e,this.plane.material.map=e,this.plane.material.needsUpdate=!0}))}addStreamTexture(t,e){const s=`#stream-${t}`,i=document.querySelector(`${s} video`);if(!i)return;const n=()=>{const t=new THREE.VideoTexture(i);t.minFilter=THREE.LinearFilter,t.magFilter=THREE.LinearFilter,t.mapping=THREE.UVMapping,t.needsUpdate=!0,"function"==typeof e&&e(t)};i.crossOrigin="anonymous",i.readyState>=i.HAVE_FUTURE_DATA?n():i.oncanplay=()=>{n()}}constructor(){const t=co.geometry,e=new THREE.MeshBasicMaterial({color:16777215});this.plane=new THREE.Mesh(t,e)}}class ho{set remotes(t){t.forEach(((e,s)=>{let i=this.streams[s];i||(i=new co),i.setRemote(e,s,t.length),this.phone.add(i.plane),this.streams[s]=i}));for(let e=t.length;e<this.streams.length;e++)this.phone.remove(this.streams[e].plane);this.streams.length=t.length}constructor(){const t=this.mesh=new THREE.Group,e=this.phone=this.create();t.add(e),this.streams=[],Zs.remotes$.subscribe((t=>{this.remotes=t}))}create(){const t=new THREE.BoxBufferGeometry(.12,.27,.005,2,2,1),e=new THREE.MeshStandardMaterial({color:0,transparent:!0,opacity:.6}),s=new THREE.Mesh(t,e);return s.rotation.set(-Math.PI/4,0,0),s}}class uo{constructor(t){void 0===t&&(t="#ffffff"),this.position=new THREE.Vector3;const e=bn.planeGeometry,s=(new THREE.TextureLoader).load(U.getPath("textures/ui/nav-point.png")),i=new THREE.MeshBasicMaterial({color:new THREE.Color(t),depthTest:!1,depthWrite:!1,map:s,transparent:!0,opacity:.9}),n=this.mesh=new THREE.Mesh(e,i);n.renderOrder=U.renderOrder.pointer,n.position.set(-1e5,-1e5,-1e5)}update(t){if(yn.lastIntersectedObject){const e=this.position;e.copy(yn.lastIntersectedObject.intersection.point),e.multiplyScalar(.99);const s=this.mesh;s.position.set(e.x,e.y,e.z),e.sub(t.position);const i=e.length()/80;s.scale.set(i,i,i),s.lookAt(wn.origin)}}setPosition(t,e,s,i){const n=this.position;n.set(t,e,s).multiplyScalar(80);const o=this.mesh;o.position.copy(n),n.sub(i.position);const a=n.length()/80;o.scale.set(a,a,a),o.lookAt(wn.origin)}}class po{constructor(){this.gravity=new THREE.Vector3(0,-9.8,0),this.controllerPosition=new THREE.Vector3,this.controllerDirection=new THREE.Vector3,this.currentPosition=new THREE.Vector3,this.targetPosition=new THREE.Vector3;const t=new THREE.BufferGeometry,e=this.vertices=new Float32Array(33);e.fill(0);const s=new Float32Array(33);s.fill(.5),t.setAttribute("position",new THREE.BufferAttribute(e,3)),t.setAttribute("color",new THREE.BufferAttribute(s,3));const i=new THREE.LineBasicMaterial({vertexColors:!0,blending:THREE.AdditiveBlending});this.line=new THREE.Line(t,i);const n=(new THREE.TextureLoader).load(U.getPath("textures/ui/nav-point.png"));(this.target=new THREE.Mesh(new THREE.PlaneBufferGeometry(.3,.3,1,1),new THREE.MeshBasicMaterial({map:n,blending:THREE.AdditiveBlending,color:5592405,transparent:!0}))).rotation.x=-Math.PI/2}addToController(t,e){this.currentController=t,t.add(this.line),e.add(this.target)}removeFromController(t,e,s,i,n){const o=this.currentController;if(o===t){const t=this.gravity,a=this.currentPosition,r=this.controllerPosition,l=this.controllerDirection;s.xr.getCamera(i).getWorldPosition(a),a.y=0,o.getWorldPosition(r),o.getWorldDirection(l),l.multiplyScalar(6);const c=(-l.y+Math.sqrt(l.y**2-2*r.y*t.y))/t.y,d=this.getPositionT(this.targetPosition,c,r,l,t);d.addScaledVector(a,-1),n.position.add(d),this.currentController=null,o.remove(this.line),e.remove(this.target)}}update(){const t=this.currentController;if(t){const e=this.gravity,s=this.controllerPosition,i=this.controllerDirection,n=this.targetPosition;t.getWorldPosition(s),t.getWorldDirection(i),i.multiplyScalar(6);const o=(-i.y+Math.sqrt(i.y**2-2*s.y*e.y))/e.y,a=n.set(0,0,0);for(let n=1;n<=10;n++)this.getPositionT(a,n*o/10,s,i,e),t.worldToLocal(a),a.toArray(this.vertices,3*n);this.line.geometry.attributes.position.needsUpdate=!0,this.getPositionT(this.target.position,.98*o,s,i,e)}}getPositionT(t,e,s,i,n){return t.copy(s),t.addScaledVector(i,e),t.addScaledVector(n,.5*e**2),t}}const mo="waiting",vo="enabled",go="ended",fo="started",bo="disabled",wo="needs-https",yo="unavailable";class xo{static getService(){return this.service_||(this.service_=new xo),this.service_}get status(){return this.status$.getValue()}get state(){return this.state$.getValue()}constructor(){if(xo.service_)throw"VRService is a singleton class!";const t=this.state_={camera:{position:new THREE.Vector3,quaternion:new THREE.Quaternion,scale:new THREE.Vector3,array:new Array(10).fill(0)}};this.onSessionStarted=this.onSessionStarted.bind(this),this.onSessionEnded=this.onSessionEnded.bind(this),this.status$=new s.BehaviorSubject(mo),this.session$=new s.Subject,this.state$=new s.BehaviorSubject(t),this.currentSession=null,"xr"in navigator?navigator.xr.isSessionSupported("immersive-vr").then((t=>{t?this.status$.next(vo):this.status$.next(bo)})):!1===window.isSecureContext?this.status$.next(wo):this.status$.next(yo)}onSessionStarted(t){t.addEventListener("end",this.onSessionEnded),this.currentSession=t,this.session$.next(t),this.status$.next(fo)}onSessionEnded(){this.currentSession.removeEventListener("end",this.onSessionEnded),this.currentSession=null,this.session$.next(null),this.status$.next(go)}toggleVR(t){if(null===this.currentSession){const t={optionalFeatures:["local-floor","bounded-floor"]};navigator.xr.requestSession("immersive-vr",t).then(this.onSessionStarted)}else this.currentSession.end()}isDisabled(){switch(this.status$.getValue()){case mo:case bo:case wo:case yo:return!0;default:return!1}}getLabel(){let t;switch(this.status$.getValue()){case mo:t="Waiting VR";break;case vo:case go:t="Enter VR";break;case fo:t="Exit VR";break;case bo:t="VR Disabled";break;case wo:t="VR Needs Https";break;case yo:t="VR Unavailable"}return t}updateState(t){if(this.status===fo){t.renderer,t.scene;const e=t.camera,s=this.state_;e.matrixWorld.decompose(s.camera.position,s.camera.quaternion,s.camera.scale),s.camera.array[0]=s.camera.position.x,s.camera.array[1]=s.camera.position.y,s.camera.array[2]=s.camera.position.z,s.camera.array[3]=s.camera.quaternion.x,s.camera.array[4]=s.camera.quaternion.y,s.camera.array[5]=s.camera.quaternion.z,s.camera.array[6]=s.camera.quaternion.w,s.camera.array[7]=s.camera.scale.x,s.camera.array[8]=s.camera.scale.y,s.camera.array[9]=s.camera.scale.z,this.state$.next(s)}}}class Co extends class{constructor(){this.events={}}on(t,e){const s=this.events[t]=this.events[t]||[];return s.push(e),()=>{this.events[t]=s.filter((t=>t!==e))}}off(t,e){const s=this.events[t];s&&(this.events[t]=s.filter((t=>t!==e)))}emit(t,e){const s=this.events[t];s&&s.forEach((t=>{t(e)}));const i=this.events.broadcast;i&&i.forEach((s=>{s(t,e)}))}}{constructor(t){super(),this.gamepad=t,this.buttons={},this.axes={}}update(){this.updateButtons(),this.updateAxes()}updateButtons(){this.gamepad.buttons.forEach(((t,e)=>{const s=t.pressed,i=this.buttons[e]||(this.buttons[e]=new Mo(e,this));i.pressed!==s&&(i.pressed=s,s?this.emit("press",i):void 0!==status&&this.emit("release",i))}))}updateAxes(){const t=this.gamepad.axes;for(let e=0;e<t.length;e+=2){const s=Math.floor(e/2),i=this.axes[s]||(this.axes[s]=new ko(s,this)),n=t[e],o=t[e+1];if(i.x!==n||i.y!==o){if(i.x=n,i.y=o,Math.abs(n)>Math.abs(o)){const t=n<-.85,e=n>.85;i.left!==t&&(i.left=t,this.emit(t?"left":"none",i)),i.right!==e&&(i.right=e,this.emit(e?"right":"none",i))}else{const t=o<-.85,e=o>.85;i.up!==t&&(i.up=t,this.emit(t?"up":"none",i)),i.down!==e&&(i.down=e,this.emit(e?"down":"none",i))}this.emit("axis",i)}}}feedback(t,e){void 0===t&&(t=.1),void 0===e&&(e=50);const s=this.gamepad.hapticActuators;return s&&s.length?s[0].pulse(t,e):Promise.reject()}}class Mo{constructor(t,e){this.index=t,this.gamepad=e,this.pressed=!1}}class ko extends THREE.Vector2{constructor(t,e){super(),this.index=t,this.gamepad=e,this.left=this.right=this.up=this.down=!1}}class So extends n.Loader{constructor(t){super(t),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register((function(t){return new Io(t)})),this.register((function(t){return new Oo(t)})),this.register((function(t){return new Uo(t)})),this.register((function(t){return new Ro(t)})),this.register((function(t){return new $o(t)})),this.register((function(t){return new Ao(t)})),this.register((function(t){return new Po(t)})),this.register((function(t){return new Ho(t)})),this.register((function(t){return new Lo(t)})),this.register((function(t){return new Bo(t)}))}load(t,e,s,i){const o=this;let a;a=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:n.LoaderUtils.extractUrlBase(t),this.manager.itemStart(t);const r=function(e){i?i(e):console.error(e),o.manager.itemError(t),o.manager.itemEnd(t)},l=new n.FileLoader(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(t,(function(s){try{o.parse(s,a,(function(s){e(s),o.manager.itemEnd(t)}),r)}catch(t){r(t)}}),s,r)}setDRACOLoader(t){return this.dracoLoader=t,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(t){return this.ktx2Loader=t,this}setMeshoptDecoder(t){return this.meshoptDecoder=t,this}register(t){return-1===this.pluginCallbacks.indexOf(t)&&this.pluginCallbacks.push(t),this}unregister(t){return-1!==this.pluginCallbacks.indexOf(t)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(t),1),this}parse(t,e,s,i){let o;const a={},r={};if("string"==typeof t)o=t;else{if(n.LoaderUtils.decodeText(new Uint8Array(t,0,4))===Do){try{a[Eo.KHR_BINARY_GLTF]=new jo(t)}catch(t){return void(i&&i(t))}o=a[Eo.KHR_BINARY_GLTF].content}else o=n.LoaderUtils.decodeText(new Uint8Array(t))}const l=JSON.parse(o);if(void 0===l.asset||l.asset.version[0]<2)return void(i&&i(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.")));const c=new ya(l,{path:e||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});c.fileLoader.setRequestHeader(this.requestHeader);for(let t=0;t<this.pluginCallbacks.length;t++){const e=this.pluginCallbacks[t](c);r[e.name]=e,a[e.name]=!0}if(l.extensionsUsed)for(let t=0;t<l.extensionsUsed.length;++t){const e=l.extensionsUsed[t],s=l.extensionsRequired||[];switch(e){case Eo.KHR_MATERIALS_UNLIT:a[e]=new _o;break;case Eo.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:a[e]=new qo;break;case Eo.KHR_DRACO_MESH_COMPRESSION:a[e]=new No(l,this.dracoLoader);break;case Eo.KHR_TEXTURE_TRANSFORM:a[e]=new Fo;break;case Eo.KHR_MESH_QUANTIZATION:a[e]=new Zo;break;default:s.indexOf(e)>=0&&void 0===r[e]&&console.warn('THREE.GLTFLoader: Unknown extension "'+e+'".')}}c.setExtensions(a),c.setPlugins(r),c.parse(s,i)}parseAsync(t,e){const s=this;return new Promise((function(i,n){s.parse(t,e,i,n)}))}}function To(){let t={};return{get:function(e){return t[e]},add:function(e,s){t[e]=s},remove:function(e){delete t[e]},removeAll:function(){t={}}}}const Eo={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression"};class Lo{constructor(t){this.parser=t,this.name=Eo.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const t=this.parser,e=this.parser.json.nodes||[];for(let s=0,i=e.length;s<i;s++){const i=e[s];i.extensions&&i.extensions[this.name]&&void 0!==i.extensions[this.name].light&&t._addNodeRef(this.cache,i.extensions[this.name].light)}}_loadLight(t){const e=this.parser,s="light:"+t;let i=e.cache.get(s);if(i)return i;const o=e.json,a=((o.extensions&&o.extensions[this.name]||{}).lights||[])[t];let r;const l=new n.Color(16777215);void 0!==a.color&&l.fromArray(a.color);const c=void 0!==a.range?a.range:0;switch(a.type){case"directional":r=new n.DirectionalLight(l),r.target.position.set(0,0,-1),r.add(r.target);break;case"point":r=new n.PointLight(l),r.distance=c;break;case"spot":r=new n.SpotLight(l),r.distance=c,a.spot=a.spot||{},a.spot.innerConeAngle=void 0!==a.spot.innerConeAngle?a.spot.innerConeAngle:0,a.spot.outerConeAngle=void 0!==a.spot.outerConeAngle?a.spot.outerConeAngle:Math.PI/4,r.angle=a.spot.outerConeAngle,r.penumbra=1-a.spot.innerConeAngle/a.spot.outerConeAngle,r.target.position.set(0,0,-1),r.add(r.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+a.type)}return r.position.set(0,0,0),r.decay=2,void 0!==a.intensity&&(r.intensity=a.intensity),r.name=e.createUniqueName(a.name||"light_"+t),i=Promise.resolve(r),e.cache.add(s,i),i}createNodeAttachment(t){const e=this,s=this.parser,i=s.json.nodes[t],n=(i.extensions&&i.extensions[this.name]||{}).light;return void 0===n?null:this._loadLight(n).then((function(t){return s._getNodeRef(e.cache,n,t)}))}}class _o{constructor(){this.name=Eo.KHR_MATERIALS_UNLIT}getMaterialType(){return n.MeshBasicMaterial}extendParams(t,e,s){const i=[];t.color=new n.Color(1,1,1),t.opacity=1;const o=e.pbrMetallicRoughness;if(o){if(Array.isArray(o.baseColorFactor)){const e=o.baseColorFactor;t.color.fromArray(e),t.opacity=e[3]}void 0!==o.baseColorTexture&&i.push(s.assignTexture(t,"map",o.baseColorTexture))}return Promise.all(i)}}class Io{constructor(t){this.parser=t,this.name=Eo.KHR_MATERIALS_CLEARCOAT}getMaterialType(t){const e=this.parser.json.materials[t];return e.extensions&&e.extensions[this.name]?n.MeshPhysicalMaterial:null}extendMaterialParams(t,e){const s=this.parser,i=s.json.materials[t];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const o=[],a=i.extensions[this.name];if(void 0!==a.clearcoatFactor&&(e.clearcoat=a.clearcoatFactor),void 0!==a.clearcoatTexture&&o.push(s.assignTexture(e,"clearcoatMap",a.clearcoatTexture)),void 0!==a.clearcoatRoughnessFactor&&(e.clearcoatRoughness=a.clearcoatRoughnessFactor),void 0!==a.clearcoatRoughnessTexture&&o.push(s.assignTexture(e,"clearcoatRoughnessMap",a.clearcoatRoughnessTexture)),void 0!==a.clearcoatNormalTexture&&(o.push(s.assignTexture(e,"clearcoatNormalMap",a.clearcoatNormalTexture)),void 0!==a.clearcoatNormalTexture.scale)){const t=a.clearcoatNormalTexture.scale;e.clearcoatNormalScale=new n.Vector2(t,t)}return Promise.all(o)}}class Ro{constructor(t){this.parser=t,this.name=Eo.KHR_MATERIALS_SHEEN}getMaterialType(t){const e=this.parser.json.materials[t];return e.extensions&&e.extensions[this.name]?n.MeshPhysicalMaterial:null}extendMaterialParams(t,e){const s=this.parser,i=s.json.materials[t];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const o=[];e.sheenColor=new n.Color(0,0,0),e.sheenRoughness=0,e.sheen=1;const a=i.extensions[this.name];return void 0!==a.sheenColorFactor&&e.sheenColor.fromArray(a.sheenColorFactor),void 0!==a.sheenRoughnessFactor&&(e.sheenRoughness=a.sheenRoughnessFactor),void 0!==a.sheenColorTexture&&o.push(s.assignTexture(e,"sheenColorMap",a.sheenColorTexture)),void 0!==a.sheenRoughnessTexture&&o.push(s.assignTexture(e,"sheenRoughnessMap",a.sheenRoughnessTexture)),Promise.all(o)}}class $o{constructor(t){this.parser=t,this.name=Eo.KHR_MATERIALS_TRANSMISSION}getMaterialType(t){const e=this.parser.json.materials[t];return e.extensions&&e.extensions[this.name]?n.MeshPhysicalMaterial:null}extendMaterialParams(t,e){const s=this.parser,i=s.json.materials[t];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const n=[],o=i.extensions[this.name];return void 0!==o.transmissionFactor&&(e.transmission=o.transmissionFactor),void 0!==o.transmissionTexture&&n.push(s.assignTexture(e,"transmissionMap",o.transmissionTexture)),Promise.all(n)}}class Ao{constructor(t){this.parser=t,this.name=Eo.KHR_MATERIALS_VOLUME}getMaterialType(t){const e=this.parser.json.materials[t];return e.extensions&&e.extensions[this.name]?n.MeshPhysicalMaterial:null}extendMaterialParams(t,e){const s=this.parser,i=s.json.materials[t];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const o=[],a=i.extensions[this.name];e.thickness=void 0!==a.thicknessFactor?a.thicknessFactor:0,void 0!==a.thicknessTexture&&o.push(s.assignTexture(e,"thicknessMap",a.thicknessTexture)),e.attenuationDistance=a.attenuationDistance||0;const r=a.attenuationColor||[1,1,1];return e.attenuationColor=new n.Color(r[0],r[1],r[2]),Promise.all(o)}}class Po{constructor(t){this.parser=t,this.name=Eo.KHR_MATERIALS_IOR}getMaterialType(t){const e=this.parser.json.materials[t];return e.extensions&&e.extensions[this.name]?n.MeshPhysicalMaterial:null}extendMaterialParams(t,e){const s=this.parser.json.materials[t];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const i=s.extensions[this.name];return e.ior=void 0!==i.ior?i.ior:1.5,Promise.resolve()}}class Ho{constructor(t){this.parser=t,this.name=Eo.KHR_MATERIALS_SPECULAR}getMaterialType(t){const e=this.parser.json.materials[t];return e.extensions&&e.extensions[this.name]?n.MeshPhysicalMaterial:null}extendMaterialParams(t,e){const s=this.parser,i=s.json.materials[t];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const o=[],a=i.extensions[this.name];e.specularIntensity=void 0!==a.specularFactor?a.specularFactor:1,void 0!==a.specularTexture&&o.push(s.assignTexture(e,"specularIntensityMap",a.specularTexture));const r=a.specularColorFactor||[1,1,1];return e.specularColor=new n.Color(r[0],r[1],r[2]),void 0!==a.specularColorTexture&&o.push(s.assignTexture(e,"specularColorMap",a.specularColorTexture).then((function(t){t.encoding=n.sRGBEncoding}))),Promise.all(o)}}class Oo{constructor(t){this.parser=t,this.name=Eo.KHR_TEXTURE_BASISU}loadTexture(t){const e=this.parser,s=e.json,i=s.textures[t];if(!i.extensions||!i.extensions[this.name])return null;const n=i.extensions[this.name],o=e.options.ktx2Loader;if(!o){if(s.extensionsRequired&&s.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return e.loadTextureImage(t,n.source,o)}}class Uo{constructor(t){this.parser=t,this.name=Eo.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(t){const e=this.name,s=this.parser,i=s.json,n=i.textures[t];if(!n.extensions||!n.extensions[e])return null;const o=n.extensions[e],a=i.images[o.source];let r=s.textureLoader;if(a.uri){const t=s.options.manager.getHandler(a.uri);null!==t&&(r=t)}return this.detectSupport().then((function(n){if(n)return s.loadTextureImage(t,a,r);if(i.extensionsRequired&&i.extensionsRequired.indexOf(e)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return s.loadTexture(t)}))}detectSupport(){return this.isSupported||(this.isSupported=new Promise((function(t){const e=new Image;e.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",e.onload=e.onerror=function(){t(1===e.height)}}))),this.isSupported}}class Bo{constructor(t){this.name=Eo.EXT_MESHOPT_COMPRESSION,this.parser=t}loadBufferView(t){const e=this.parser.json,s=e.bufferViews[t];if(s.extensions&&s.extensions[this.name]){const t=s.extensions[this.name],i=this.parser.getDependency("buffer",t.buffer),n=this.parser.options.meshoptDecoder;if(!n||!n.supported){if(e.extensionsRequired&&e.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return Promise.all([i,n.ready]).then((function(e){const s=t.byteOffset||0,i=t.byteLength||0,o=t.count,a=t.byteStride,r=new ArrayBuffer(o*a),l=new Uint8Array(e[0],s,i);return n.decodeGltfBuffer(new Uint8Array(r),o,a,l,t.mode,t.filter),r}))}return null}}const Do="glTF",zo=1313821514,Vo=5130562;class jo{constructor(t){this.name=Eo.KHR_BINARY_GLTF,this.content=null,this.body=null;const e=new DataView(t,0,12);if(this.header={magic:n.LoaderUtils.decodeText(new Uint8Array(t.slice(0,4))),version:e.getUint32(4,!0),length:e.getUint32(8,!0)},this.header.magic!==Do)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const s=this.header.length-12,i=new DataView(t,12);let o=0;for(;o<s;){const e=i.getUint32(o,!0);o+=4;const s=i.getUint32(o,!0);if(o+=4,s===zo){const s=new Uint8Array(t,12+o,e);this.content=n.LoaderUtils.decodeText(s)}else if(s===Vo){const s=12+o;this.body=t.slice(s,s+e)}o+=e}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class No{constructor(t,e){if(!e)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=Eo.KHR_DRACO_MESH_COMPRESSION,this.json=t,this.dracoLoader=e,this.dracoLoader.preload()}decodePrimitive(t,e){const s=this.json,i=this.dracoLoader,n=t.extensions[this.name].bufferView,o=t.extensions[this.name].attributes,a={},r={},l={};for(const t in o){const e=la[t]||t.toLowerCase();a[e]=o[t]}for(const e in t.attributes){const i=la[e]||e.toLowerCase();if(void 0!==o[e]){const n=s.accessors[t.attributes[e]],o=na[n.componentType];l[i]=o,r[i]=!0===n.normalized}}return e.getDependency("bufferView",n).then((function(t){return new Promise((function(e){i.decodeDracoFile(t,(function(t){for(const e in t.attributes){const s=t.attributes[e],i=r[e];void 0!==i&&(s.normalized=i)}e(t)}),a,l)}))}))}}class Fo{constructor(){this.name=Eo.KHR_TEXTURE_TRANSFORM}extendTexture(t,e){return void 0!==e.texCoord&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),void 0===e.offset&&void 0===e.rotation&&void 0===e.scale||(t=t.clone(),void 0!==e.offset&&t.offset.fromArray(e.offset),void 0!==e.rotation&&(t.rotation=e.rotation),void 0!==e.scale&&t.repeat.fromArray(e.scale),t.needsUpdate=!0),t}}class Go extends n.MeshStandardMaterial{constructor(t){super(),this.isGLTFSpecularGlossinessMaterial=!0;const e=["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n"),s=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n"),i=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n"),o=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n"),a=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb * ( 1. - max( specularFactor.r, max( specularFactor.g, specularFactor.b ) ) );","vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );","material.roughness = max( 1.0 - glossinessFactor, 0.0525 ); // 0.0525 corresponds to the base mip of a 256 cubemap.","material.roughness += geometryRoughness;","material.roughness = min( material.roughness, 1.0 );","material.specularColor = specularFactor;"].join("\n"),r={specular:{value:(new n.Color).setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};this._extraUniforms=r,this.onBeforeCompile=function(t){for(const e in r)t.uniforms[e]=r[e];t.fragmentShader=t.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",e).replace("#include <metalnessmap_pars_fragment>",s).replace("#include <roughnessmap_fragment>",i).replace("#include <metalnessmap_fragment>",o).replace("#include <lights_physical_fragment>",a)},Object.defineProperties(this,{specular:{get:function(){return r.specular.value},set:function(t){r.specular.value=t}},specularMap:{get:function(){return r.specularMap.value},set:function(t){r.specularMap.value=t,t?this.defines.USE_SPECULARMAP="":delete this.defines.USE_SPECULARMAP}},glossiness:{get:function(){return r.glossiness.value},set:function(t){r.glossiness.value=t}},glossinessMap:{get:function(){return r.glossinessMap.value},set:function(t){r.glossinessMap.value=t,t?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_UV=""):(delete this.defines.USE_GLOSSINESSMAP,delete this.defines.USE_UV)}}}),delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this.setValues(t)}copy(t){return super.copy(t),this.specularMap=t.specularMap,this.specular.copy(t.specular),this.glossinessMap=t.glossinessMap,this.glossiness=t.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this}}class qo{constructor(){this.name=Eo.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,this.specularGlossinessParams=["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"]}getMaterialType(){return Go}extendParams(t,e,s){const i=e.extensions[this.name];t.color=new n.Color(1,1,1),t.opacity=1;const o=[];if(Array.isArray(i.diffuseFactor)){const e=i.diffuseFactor;t.color.fromArray(e),t.opacity=e[3]}if(void 0!==i.diffuseTexture&&o.push(s.assignTexture(t,"map",i.diffuseTexture)),t.emissive=new n.Color(0,0,0),t.glossiness=void 0!==i.glossinessFactor?i.glossinessFactor:1,t.specular=new n.Color(1,1,1),Array.isArray(i.specularFactor)&&t.specular.fromArray(i.specularFactor),void 0!==i.specularGlossinessTexture){const e=i.specularGlossinessTexture;o.push(s.assignTexture(t,"glossinessMap",e)),o.push(s.assignTexture(t,"specularMap",e))}return Promise.all(o)}createMaterial(t){const e=new Go(t);return e.fog=!0,e.color=t.color,e.map=void 0===t.map?null:t.map,e.lightMap=null,e.lightMapIntensity=1,e.aoMap=void 0===t.aoMap?null:t.aoMap,e.aoMapIntensity=1,e.emissive=t.emissive,e.emissiveIntensity=1,e.emissiveMap=void 0===t.emissiveMap?null:t.emissiveMap,e.bumpMap=void 0===t.bumpMap?null:t.bumpMap,e.bumpScale=1,e.normalMap=void 0===t.normalMap?null:t.normalMap,e.normalMapType=n.TangentSpaceNormalMap,t.normalScale&&(e.normalScale=t.normalScale),e.displacementMap=null,e.displacementScale=1,e.displacementBias=0,e.specularMap=void 0===t.specularMap?null:t.specularMap,e.specular=t.specular,e.glossinessMap=void 0===t.glossinessMap?null:t.glossinessMap,e.glossiness=t.glossiness,e.alphaMap=null,e.envMap=void 0===t.envMap?null:t.envMap,e.envMapIntensity=1,e.refractionRatio=.98,e}}class Zo{constructor(){this.name=Eo.KHR_MESH_QUANTIZATION}}class Wo extends n.Interpolant{constructor(t,e,s,i){super(t,e,s,i)}copySampleValue_(t){const e=this.resultBuffer,s=this.sampleValues,i=this.valueSize,n=t*i*3+i;for(let t=0;t!==i;t++)e[t]=s[n+t];return e}}Wo.prototype.beforeStart_=Wo.prototype.copySampleValue_,Wo.prototype.afterEnd_=Wo.prototype.copySampleValue_,Wo.prototype.interpolate_=function(t,e,s,i){const n=this.resultBuffer,o=this.sampleValues,a=this.valueSize,r=2*a,l=3*a,c=i-e,d=(s-e)/c,h=d*d,u=h*d,p=t*l,m=p-l,v=-2*u+3*h,g=u-h,f=1-v,b=g-h+d;for(let t=0;t!==a;t++){const e=o[m+t+a],s=o[m+t+r]*c,i=o[p+t+a],l=o[p+t]*c;n[t]=f*e+b*s+v*i+g*l}return n};const Ko=new n.Quaternion;class Xo extends Wo{interpolate_(t,e,s,i){const n=super.interpolate_(t,e,s,i);return Ko.fromArray(n).normalize().toArray(n),n}}const Yo=0,Jo=1,Qo=2,ta=3,ea=4,sa=5,ia=6,na={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},oa={9728:n.NearestFilter,9729:n.LinearFilter,9984:n.NearestMipmapNearestFilter,9985:n.LinearMipmapNearestFilter,9986:n.NearestMipmapLinearFilter,9987:n.LinearMipmapLinearFilter},aa={33071:n.ClampToEdgeWrapping,33648:n.MirroredRepeatWrapping,10497:n.RepeatWrapping},ra={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},la={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},ca={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},da={CUBICSPLINE:void 0,LINEAR:n.InterpolateLinear,STEP:n.InterpolateDiscrete},ha="OPAQUE",ua="MASK",pa="BLEND";function ma(t,e,s){for(const i in s.extensions)void 0===t[i]&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[i]=s.extensions[i])}function va(t,e){void 0!==e.extras&&("object"==typeof e.extras?Object.assign(t.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function ga(t,e){if(t.updateMorphTargets(),void 0!==e.weights)for(let s=0,i=e.weights.length;s<i;s++)t.morphTargetInfluences[s]=e.weights[s];if(e.extras&&Array.isArray(e.extras.targetNames)){const s=e.extras.targetNames;if(t.morphTargetInfluences.length===s.length){t.morphTargetDictionary={};for(let e=0,i=s.length;e<i;e++)t.morphTargetDictionary[s[e]]=e}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function fa(t){const e=t.extensions&&t.extensions[Eo.KHR_DRACO_MESH_COMPRESSION];let s;return s=e?"draco:"+e.bufferView+":"+e.indices+":"+ba(e.attributes):t.indices+":"+ba(t.attributes)+":"+t.mode,s}function ba(t){let e="";const s=Object.keys(t).sort();for(let i=0,n=s.length;i<n;i++)e+=s[i]+":"+t[s[i]]+";";return e}function wa(t){switch(t){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}class ya{constructor(t={},e={}){this.json=t,this.extensions={},this.plugins={},this.options=e,this.cache=new To,this.associations=new Map,this.primitiveCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={},"undefined"!=typeof createImageBitmap&&!1===/Firefox|^((?!chrome|android).)*safari/i.test(navigator.userAgent)?this.textureLoader=new n.ImageBitmapLoader(this.options.manager):this.textureLoader=new n.TextureLoader(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new n.FileLoader(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}setExtensions(t){this.extensions=t}setPlugins(t){this.plugins=t}parse(t,e){const s=this,i=this.json,n=this.extensions;this.cache.removeAll(),this._invokeAll((function(t){return t._markDefs&&t._markDefs()})),Promise.all(this._invokeAll((function(t){return t.beforeRoot&&t.beforeRoot()}))).then((function(){return Promise.all([s.getDependencies("scene"),s.getDependencies("animation"),s.getDependencies("camera")])})).then((function(e){const o={scene:e[0][i.scene||0],scenes:e[0],animations:e[1],cameras:e[2],asset:i.asset,parser:s,userData:{}};ma(n,o,i),va(o,i),Promise.all(s._invokeAll((function(t){return t.afterRoot&&t.afterRoot(o)}))).then((function(){t(o)}))})).catch(e)}_markDefs(){const t=this.json.nodes||[],e=this.json.skins||[],s=this.json.meshes||[];for(let s=0,i=e.length;s<i;s++){const i=e[s].joints;for(let e=0,s=i.length;e<s;e++)t[i[e]].isBone=!0}for(let e=0,i=t.length;e<i;e++){const i=t[e];void 0!==i.mesh&&(this._addNodeRef(this.meshCache,i.mesh),void 0!==i.skin&&(s[i.mesh].isSkinnedMesh=!0)),void 0!==i.camera&&this._addNodeRef(this.cameraCache,i.camera)}}_addNodeRef(t,e){void 0!==e&&(void 0===t.refs[e]&&(t.refs[e]=t.uses[e]=0),t.refs[e]++)}_getNodeRef(t,e,s){if(t.refs[e]<=1)return s;const i=s.clone(),n=(t,e)=>{const s=this.associations.get(t);null!=s&&this.associations.set(e,s);for(const[s,i]of t.children.entries())n(i,e.children[s])};return n(s,i),i.name+="_instance_"+t.uses[e]++,i}_invokeOne(t){const e=Object.values(this.plugins);e.push(this);for(let s=0;s<e.length;s++){const i=t(e[s]);if(i)return i}return null}_invokeAll(t){const e=Object.values(this.plugins);e.unshift(this);const s=[];for(let i=0;i<e.length;i++){const n=t(e[i]);n&&s.push(n)}return s}getDependency(t,e){const s=t+":"+e;let i=this.cache.get(s);if(!i){switch(t){case"scene":i=this.loadScene(e);break;case"node":i=this.loadNode(e);break;case"mesh":i=this._invokeOne((function(t){return t.loadMesh&&t.loadMesh(e)}));break;case"accessor":i=this.loadAccessor(e);break;case"bufferView":i=this._invokeOne((function(t){return t.loadBufferView&&t.loadBufferView(e)}));break;case"buffer":i=this.loadBuffer(e);break;case"material":i=this._invokeOne((function(t){return t.loadMaterial&&t.loadMaterial(e)}));break;case"texture":i=this._invokeOne((function(t){return t.loadTexture&&t.loadTexture(e)}));break;case"skin":i=this.loadSkin(e);break;case"animation":i=this.loadAnimation(e);break;case"camera":i=this.loadCamera(e);break;default:throw new Error("Unknown type: "+t)}this.cache.add(s,i)}return i}getDependencies(t){let e=this.cache.get(t);if(!e){const s=this,i=this.json[t+("mesh"===t?"es":"s")]||[];e=Promise.all(i.map((function(e,i){return s.getDependency(t,i)}))),this.cache.add(t,e)}return e}loadBuffer(t){const e=this.json.buffers[t],s=this.fileLoader;if(e.type&&"arraybuffer"!==e.type)throw new Error("THREE.GLTFLoader: "+e.type+" buffer type is not supported.");if(void 0===e.uri&&0===t)return Promise.resolve(this.extensions[Eo.KHR_BINARY_GLTF].body);const i=this.options;return new Promise((function(t,o){s.load(n.LoaderUtils.resolveURL(e.uri,i.path),t,void 0,(function(){o(new Error('THREE.GLTFLoader: Failed to load buffer "'+e.uri+'".'))}))}))}loadBufferView(t){const e=this.json.bufferViews[t];return this.getDependency("buffer",e.buffer).then((function(t){const s=e.byteLength||0,i=e.byteOffset||0;return t.slice(i,i+s)}))}loadAccessor(t){const e=this,s=this.json,i=this.json.accessors[t];if(void 0===i.bufferView&&void 0===i.sparse)return Promise.resolve(null);const o=[];return void 0!==i.bufferView?o.push(this.getDependency("bufferView",i.bufferView)):o.push(null),void 0!==i.sparse&&(o.push(this.getDependency("bufferView",i.sparse.indices.bufferView)),o.push(this.getDependency("bufferView",i.sparse.values.bufferView))),Promise.all(o).then((function(t){const o=t[0],a=ra[i.type],r=na[i.componentType],l=r.BYTES_PER_ELEMENT,c=l*a,d=i.byteOffset||0,h=void 0!==i.bufferView?s.bufferViews[i.bufferView].byteStride:void 0,u=!0===i.normalized;let p,m;if(h&&h!==c){const t=Math.floor(d/h),s="InterleavedBuffer:"+i.bufferView+":"+i.componentType+":"+t+":"+i.count;let c=e.cache.get(s);c||(p=new r(o,t*h,i.count*h/l),c=new n.InterleavedBuffer(p,h/l),e.cache.add(s,c)),m=new n.InterleavedBufferAttribute(c,a,d%h/l,u)}else p=null===o?new r(i.count*a):new r(o,d,i.count*a),m=new n.BufferAttribute(p,a,u);if(void 0!==i.sparse){const e=ra.SCALAR,s=na[i.sparse.indices.componentType],l=i.sparse.indices.byteOffset||0,c=i.sparse.values.byteOffset||0,d=new s(t[1],l,i.sparse.count*e),h=new r(t[2],c,i.sparse.count*a);null!==o&&(m=new n.BufferAttribute(m.array.slice(),m.itemSize,m.normalized));for(let t=0,e=d.length;t<e;t++){const e=d[t];if(m.setX(e,h[t*a]),a>=2&&m.setY(e,h[t*a+1]),a>=3&&m.setZ(e,h[t*a+2]),a>=4&&m.setW(e,h[t*a+3]),a>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return m}))}loadTexture(t){const e=this.json,s=this.options,i=e.textures[t].source,n=e.images[i];let o=this.textureLoader;if(n.uri){const t=s.manager.getHandler(n.uri);null!==t&&(o=t)}return this.loadTextureImage(t,i,o)}loadTextureImage(t,e,s){const i=this,o=this.json,a=o.textures[t],r=o.images[e],l=(r.uri||r.bufferView)+":"+a.sampler;if(this.textureCache[l])return this.textureCache[l];const c=this.loadImageSource(e,s).then((function(e){e.flipY=!1,a.name&&(e.name=a.name);const s=(o.samplers||{})[a.sampler]||{};return e.magFilter=oa[s.magFilter]||n.LinearFilter,e.minFilter=oa[s.minFilter]||n.LinearMipmapLinearFilter,e.wrapS=aa[s.wrapS]||n.RepeatWrapping,e.wrapT=aa[s.wrapT]||n.RepeatWrapping,i.associations.set(e,{textures:t}),e})).catch((function(){return null}));return this.textureCache[l]=c,c}loadImageSource(t,e){const s=this,i=this.json,o=this.options;if(void 0!==this.sourceCache[t])return this.sourceCache[t].then((function(t){return t.clone()})).catch((function(t){throw t}));const a=i.images[t],r=self.URL||self.webkitURL;let l=a.uri||"",c=!1;if(void 0!==a.bufferView)l=s.getDependency("bufferView",a.bufferView).then((function(t){c=!0;const e=new Blob([t],{type:a.mimeType});return l=r.createObjectURL(e),l}));else if(void 0===a.uri)throw new Error("THREE.GLTFLoader: Image "+t+" is missing URI and bufferView");const d=Promise.resolve(l).then((function(t){return new Promise((function(s,i){let a=s;!0===e.isImageBitmapLoader&&(a=function(t){const e=new n.Texture(t);e.needsUpdate=!0,s(e)}),e.load(n.LoaderUtils.resolveURL(t,o.path),a,void 0,i)}))})).then((function(t){var e;return!0===c&&r.revokeObjectURL(l),t.userData.mimeType=a.mimeType||((e=a.uri).search(/\.jpe?g($|\?)/i)>0||0===e.search(/^data\:image\/jpeg/)?"image/jpeg":e.search(/\.webp($|\?)/i)>0||0===e.search(/^data\:image\/webp/)?"image/webp":"image/png"),t})).catch((function(t){throw console.error("THREE.GLTFLoader: Couldn't load texture",l),t}));return this.sourceCache[t]=d,d}assignTexture(t,e,s){const i=this;return this.getDependency("texture",s.index).then((function(n){if(void 0===s.texCoord||0==s.texCoord||"aoMap"===e&&1==s.texCoord||console.warn("THREE.GLTFLoader: Custom UV set "+s.texCoord+" for texture "+e+" not yet supported."),i.extensions[Eo.KHR_TEXTURE_TRANSFORM]){const t=void 0!==s.extensions?s.extensions[Eo.KHR_TEXTURE_TRANSFORM]:void 0;if(t){const e=i.associations.get(n);n=i.extensions[Eo.KHR_TEXTURE_TRANSFORM].extendTexture(n,t),i.associations.set(n,e)}}return t[e]=n,n}))}assignFinalMaterial(t){const e=t.geometry;let s=t.material;const i=void 0===e.attributes.tangent,o=void 0!==e.attributes.color,a=void 0===e.attributes.normal;if(t.isPoints){const t="PointsMaterial:"+s.uuid;let e=this.cache.get(t);e||(e=new n.PointsMaterial,n.Material.prototype.copy.call(e,s),e.color.copy(s.color),e.map=s.map,e.sizeAttenuation=!1,this.cache.add(t,e)),s=e}else if(t.isLine){const t="LineBasicMaterial:"+s.uuid;let e=this.cache.get(t);e||(e=new n.LineBasicMaterial,n.Material.prototype.copy.call(e,s),e.color.copy(s.color),this.cache.add(t,e)),s=e}if(i||o||a){let t="ClonedMaterial:"+s.uuid+":";s.isGLTFSpecularGlossinessMaterial&&(t+="specular-glossiness:"),i&&(t+="derivative-tangents:"),o&&(t+="vertex-colors:"),a&&(t+="flat-shading:");let e=this.cache.get(t);e||(e=s.clone(),o&&(e.vertexColors=!0),a&&(e.flatShading=!0),i&&(e.normalScale&&(e.normalScale.y*=-1),e.clearcoatNormalScale&&(e.clearcoatNormalScale.y*=-1)),this.cache.add(t,e),this.associations.set(e,this.associations.get(s))),s=e}s.aoMap&&void 0===e.attributes.uv2&&void 0!==e.attributes.uv&&e.setAttribute("uv2",e.attributes.uv),t.material=s}getMaterialType(){return n.MeshStandardMaterial}loadMaterial(t){const e=this,s=this.json,i=this.extensions,o=s.materials[t];let a;const r={},l=o.extensions||{},c=[];if(l[Eo.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){const t=i[Eo.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];a=t.getMaterialType(),c.push(t.extendParams(r,o,e))}else if(l[Eo.KHR_MATERIALS_UNLIT]){const t=i[Eo.KHR_MATERIALS_UNLIT];a=t.getMaterialType(),c.push(t.extendParams(r,o,e))}else{const s=o.pbrMetallicRoughness||{};if(r.color=new n.Color(1,1,1),r.opacity=1,Array.isArray(s.baseColorFactor)){const t=s.baseColorFactor;r.color.fromArray(t),r.opacity=t[3]}void 0!==s.baseColorTexture&&c.push(e.assignTexture(r,"map",s.baseColorTexture)),r.metalness=void 0!==s.metallicFactor?s.metallicFactor:1,r.roughness=void 0!==s.roughnessFactor?s.roughnessFactor:1,void 0!==s.metallicRoughnessTexture&&(c.push(e.assignTexture(r,"metalnessMap",s.metallicRoughnessTexture)),c.push(e.assignTexture(r,"roughnessMap",s.metallicRoughnessTexture))),a=this._invokeOne((function(e){return e.getMaterialType&&e.getMaterialType(t)})),c.push(Promise.all(this._invokeAll((function(e){return e.extendMaterialParams&&e.extendMaterialParams(t,r)}))))}!0===o.doubleSided&&(r.side=n.DoubleSide);const d=o.alphaMode||ha;if(d===pa?(r.transparent=!0,r.depthWrite=!1):(r.transparent=!1,d===ua&&(r.alphaTest=void 0!==o.alphaCutoff?o.alphaCutoff:.5)),void 0!==o.normalTexture&&a!==n.MeshBasicMaterial&&(c.push(e.assignTexture(r,"normalMap",o.normalTexture)),r.normalScale=new n.Vector2(1,1),void 0!==o.normalTexture.scale)){const t=o.normalTexture.scale;r.normalScale.set(t,t)}return void 0!==o.occlusionTexture&&a!==n.MeshBasicMaterial&&(c.push(e.assignTexture(r,"aoMap",o.occlusionTexture)),void 0!==o.occlusionTexture.strength&&(r.aoMapIntensity=o.occlusionTexture.strength)),void 0!==o.emissiveFactor&&a!==n.MeshBasicMaterial&&(r.emissive=(new n.Color).fromArray(o.emissiveFactor)),void 0!==o.emissiveTexture&&a!==n.MeshBasicMaterial&&c.push(e.assignTexture(r,"emissiveMap",o.emissiveTexture)),Promise.all(c).then((function(){let s;return s=a===Go?i[Eo.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(r):new a(r),o.name&&(s.name=o.name),s.map&&(s.map.encoding=n.sRGBEncoding),s.emissiveMap&&(s.emissiveMap.encoding=n.sRGBEncoding),s.sheenColorMap&&(s.sheenColorMap.encoding=n.sRGBEncoding),s.specularColorMap&&(s.specularColorMap.encoding=n.sRGBEncoding),s.specularMap&&(s.specularMap.encoding=n.sRGBEncoding),va(s,o),e.associations.set(s,{materials:t}),o.extensions&&ma(i,s,o),s}))}createUniqueName(t){const e=n.PropertyBinding.sanitizeNodeName(t||"");let s=e;for(let t=1;this.nodeNamesUsed[s];++t)s=e+"_"+t;return this.nodeNamesUsed[s]=!0,s}loadGeometries(t){const e=this,s=this.extensions,i=this.primitiveCache;function o(t){return s[Eo.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(t,e).then((function(s){return Ca(s,t,e)}))}const a=[];for(let s=0,r=t.length;s<r;s++){const r=t[s],l=fa(r),c=i[l];if(c)a.push(c.promise);else{let t;t=r.extensions&&r.extensions[Eo.KHR_DRACO_MESH_COMPRESSION]?o(r):Ca(new n.BufferGeometry,r,e),i[l]={primitive:r,promise:t},a.push(t)}}return Promise.all(a)}loadMesh(t){const e=this,s=this.json,i=this.extensions,o=s.meshes[t],a=o.primitives,r=[];for(let t=0,e=a.length;t<e;t++){const e=void 0===a[t].material?(void 0===(l=this.cache).DefaultMaterial&&(l.DefaultMaterial=new n.MeshStandardMaterial({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:n.FrontSide})),l.DefaultMaterial):this.getDependency("material",a[t].material);r.push(e)}var l;return r.push(e.loadGeometries(a)),Promise.all(r).then((function(s){const r=s.slice(0,s.length-1),l=s[s.length-1],c=[];for(let s=0,d=l.length;s<d;s++){const d=l[s],h=a[s];let u;const p=r[s];if(h.mode===ea||h.mode===sa||h.mode===ia||void 0===h.mode)u=!0===o.isSkinnedMesh?new n.SkinnedMesh(d,p):new n.Mesh(d,p),!0!==u.isSkinnedMesh||u.geometry.attributes.skinWeight.normalized||u.normalizeSkinWeights(),h.mode===sa?u.geometry=Ma(u.geometry,n.TriangleStripDrawMode):h.mode===ia&&(u.geometry=Ma(u.geometry,n.TriangleFanDrawMode));else if(h.mode===Jo)u=new n.LineSegments(d,p);else if(h.mode===ta)u=new n.Line(d,p);else if(h.mode===Qo)u=new n.LineLoop(d,p);else{if(h.mode!==Yo)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+h.mode);u=new n.Points(d,p)}Object.keys(u.geometry.morphAttributes).length>0&&ga(u,o),u.name=e.createUniqueName(o.name||"mesh_"+t),va(u,o),h.extensions&&ma(i,u,h),e.assignFinalMaterial(u),c.push(u)}for(let s=0,i=c.length;s<i;s++)e.associations.set(c[s],{meshes:t,primitives:s});if(1===c.length)return c[0];const d=new n.Group;e.associations.set(d,{meshes:t});for(let t=0,e=c.length;t<e;t++)d.add(c[t]);return d}))}loadCamera(t){let e;const s=this.json.cameras[t],i=s[s.type];if(i)return"perspective"===s.type?e=new n.PerspectiveCamera(n.MathUtils.radToDeg(i.yfov),i.aspectRatio||1,i.znear||1,i.zfar||2e6):"orthographic"===s.type&&(e=new n.OrthographicCamera(-i.xmag,i.xmag,i.ymag,-i.ymag,i.znear,i.zfar)),s.name&&(e.name=this.createUniqueName(s.name)),va(e,s),Promise.resolve(e);console.warn("THREE.GLTFLoader: Missing camera parameters.")}loadSkin(t){const e=this.json.skins[t],s={joints:e.joints};return void 0===e.inverseBindMatrices?Promise.resolve(s):this.getDependency("accessor",e.inverseBindMatrices).then((function(t){return s.inverseBindMatrices=t,s}))}loadAnimation(t){const e=this.json.animations[t],s=[],i=[],o=[],a=[],r=[];for(let t=0,n=e.channels.length;t<n;t++){const n=e.channels[t],l=e.samplers[n.sampler],c=n.target,d=void 0!==c.node?c.node:c.id,h=void 0!==e.parameters?e.parameters[l.input]:l.input,u=void 0!==e.parameters?e.parameters[l.output]:l.output;s.push(this.getDependency("node",d)),i.push(this.getDependency("accessor",h)),o.push(this.getDependency("accessor",u)),a.push(l),r.push(c)}return Promise.all([Promise.all(s),Promise.all(i),Promise.all(o),Promise.all(a),Promise.all(r)]).then((function(s){const i=s[0],o=s[1],a=s[2],r=s[3],l=s[4],c=[];for(let t=0,e=i.length;t<e;t++){const e=i[t],s=o[t],d=a[t],h=r[t],u=l[t];if(void 0===e)continue;let p;switch(e.updateMatrix(),e.matrixAutoUpdate=!0,ca[u.path]){case ca.weights:p=n.NumberKeyframeTrack;break;case ca.rotation:p=n.QuaternionKeyframeTrack;break;default:p=n.VectorKeyframeTrack}const m=e.name?e.name:e.uuid,v=void 0!==h.interpolation?da[h.interpolation]:n.InterpolateLinear,g=[];ca[u.path]===ca.weights?e.traverse((function(t){t.morphTargetInfluences&&g.push(t.name?t.name:t.uuid)})):g.push(m);let f=d.array;if(d.normalized){const t=wa(f.constructor),e=new Float32Array(f.length);for(let s=0,i=f.length;s<i;s++)e[s]=f[s]*t;f=e}for(let t=0,e=g.length;t<e;t++){const e=new p(g[t]+"."+ca[u.path],s.array,f,v);"CUBICSPLINE"===h.interpolation&&(e.createInterpolant=function(t){return new(this instanceof n.QuaternionKeyframeTrack?Xo:Wo)(this.times,this.values,this.getValueSize()/3,t)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),c.push(e)}}const d=e.name?e.name:"animation_"+t;return new n.AnimationClip(d,void 0,c)}))}createNodeMesh(t){const e=this.json,s=this,i=e.nodes[t];return void 0===i.mesh?null:s.getDependency("mesh",i.mesh).then((function(t){const e=s._getNodeRef(s.meshCache,i.mesh,t);return void 0!==i.weights&&e.traverse((function(t){if(t.isMesh)for(let e=0,s=i.weights.length;e<s;e++)t.morphTargetInfluences[e]=i.weights[e]})),e}))}loadNode(t){const e=this.json,s=this.extensions,i=this,o=e.nodes[t],a=o.name?i.createUniqueName(o.name):"";return function(){const e=[],s=i._invokeOne((function(e){return e.createNodeMesh&&e.createNodeMesh(t)}));return s&&e.push(s),void 0!==o.camera&&e.push(i.getDependency("camera",o.camera).then((function(t){return i._getNodeRef(i.cameraCache,o.camera,t)}))),i._invokeAll((function(e){return e.createNodeAttachment&&e.createNodeAttachment(t)})).forEach((function(t){e.push(t)})),Promise.all(e)}().then((function(e){let r;if(r=!0===o.isBone?new n.Bone:e.length>1?new n.Group:1===e.length?e[0]:new n.Object3D,r!==e[0])for(let t=0,s=e.length;t<s;t++)r.add(e[t]);if(o.name&&(r.userData.name=o.name,r.name=a),va(r,o),o.extensions&&ma(s,r,o),void 0!==o.matrix){const t=new n.Matrix4;t.fromArray(o.matrix),r.applyMatrix4(t)}else void 0!==o.translation&&r.position.fromArray(o.translation),void 0!==o.rotation&&r.quaternion.fromArray(o.rotation),void 0!==o.scale&&r.scale.fromArray(o.scale);return i.associations.has(r)||i.associations.set(r,{}),i.associations.get(r).nodes=t,r}))}loadScene(t){const e=this.json,s=this.extensions,i=this.json.scenes[t],o=this,a=new n.Group;i.name&&(a.name=o.createUniqueName(i.name)),va(a,i),i.extensions&&ma(s,a,i);const r=i.nodes||[],l=[];for(let t=0,s=r.length;t<s;t++)l.push(xa(r[t],a,e,o));return Promise.all(l).then((function(){return o.associations=(t=>{const e=new Map;for(const[t,s]of o.associations)(t instanceof n.Material||t instanceof n.Texture)&&e.set(t,s);return t.traverse((t=>{const s=o.associations.get(t);null!=s&&e.set(t,s)})),e})(a),a}))}}function xa(t,e,s,i){const o=s.nodes[t];return i.getDependency("node",t).then((function(t){if(void 0===o.skin)return t;let e;return i.getDependency("skin",o.skin).then((function(t){e=t;const s=[];for(let t=0,n=e.joints.length;t<n;t++)s.push(i.getDependency("node",e.joints[t]));return Promise.all(s)})).then((function(s){return t.traverse((function(t){if(!t.isMesh)return;const i=[],o=[];for(let t=0,a=s.length;t<a;t++){const a=s[t];if(a){i.push(a);const s=new n.Matrix4;void 0!==e.inverseBindMatrices&&s.fromArray(e.inverseBindMatrices.array,16*t),o.push(s)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',e.joints[t])}t.bind(new n.Skeleton(i,o),t.matrixWorld)})),t}))})).then((function(t){e.add(t);const n=[];if(o.children){const e=o.children;for(let o=0,a=e.length;o<a;o++){const a=e[o];n.push(xa(a,t,s,i))}}return Promise.all(n)}))}function Ca(t,e,s){const i=e.attributes,o=[];function a(e,i){return s.getDependency("accessor",e).then((function(e){t.setAttribute(i,e)}))}for(const e in i){const s=la[e]||e.toLowerCase();s in t.attributes||o.push(a(i[e],s))}if(void 0!==e.indices&&!t.index){const i=s.getDependency("accessor",e.indices).then((function(e){t.setIndex(e)}));o.push(i)}return va(t,e),function(t,e,s){const i=e.attributes,o=new n.Box3;if(void 0===i.POSITION)return;{const t=s.json.accessors[i.POSITION],e=t.min,a=t.max;if(void 0===e||void 0===a)return void console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");if(o.set(new n.Vector3(e[0],e[1],e[2]),new n.Vector3(a[0],a[1],a[2])),t.normalized){const e=wa(na[t.componentType]);o.min.multiplyScalar(e),o.max.multiplyScalar(e)}}const a=e.targets;if(void 0!==a){const t=new n.Vector3,e=new n.Vector3;for(let i=0,n=a.length;i<n;i++){const n=a[i];if(void 0!==n.POSITION){const i=s.json.accessors[n.POSITION],o=i.min,a=i.max;if(void 0!==o&&void 0!==a){if(e.setX(Math.max(Math.abs(o[0]),Math.abs(a[0]))),e.setY(Math.max(Math.abs(o[1]),Math.abs(a[1]))),e.setZ(Math.max(Math.abs(o[2]),Math.abs(a[2]))),i.normalized){const t=wa(na[i.componentType]);e.multiplyScalar(t)}t.max(e)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}o.expandByVector(t)}t.boundingBox=o;const r=new n.Sphere;o.getCenter(r.center),r.radius=o.min.distanceTo(o.max)/2,t.boundingSphere=r}(t,e,s),Promise.all(o).then((function(){return void 0!==e.targets?function(t,e,s){let i=!1,n=!1,o=!1;for(let t=0,s=e.length;t<s;t++){const s=e[t];if(void 0!==s.POSITION&&(i=!0),void 0!==s.NORMAL&&(n=!0),void 0!==s.COLOR_0&&(o=!0),i&&n&&o)break}if(!i&&!n&&!o)return Promise.resolve(t);const a=[],r=[],l=[];for(let c=0,d=e.length;c<d;c++){const d=e[c];if(i){const e=void 0!==d.POSITION?s.getDependency("accessor",d.POSITION):t.attributes.position;a.push(e)}if(n){const e=void 0!==d.NORMAL?s.getDependency("accessor",d.NORMAL):t.attributes.normal;r.push(e)}if(o){const e=void 0!==d.COLOR_0?s.getDependency("accessor",d.COLOR_0):t.attributes.color;l.push(e)}}return Promise.all([Promise.all(a),Promise.all(r),Promise.all(l)]).then((function(e){const s=e[0],a=e[1],r=e[2];return i&&(t.morphAttributes.position=s),n&&(t.morphAttributes.normal=a),o&&(t.morphAttributes.color=r),t.morphTargetsRelative=!0,t}))}(t,e.targets,s):t}))}function Ma(t,e){let s=t.getIndex();if(null===s){const e=[],i=t.getAttribute("position");if(void 0===i)return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),t;for(let t=0;t<i.count;t++)e.push(t);t.setIndex(e),s=t.getIndex()}const i=s.count-2,o=[];if(e===n.TriangleFanDrawMode)for(let t=1;t<=i;t++)o.push(s.getX(0)),o.push(s.getX(t)),o.push(s.getX(t+1));else for(let t=0;t<i;t++)t%2==0?(o.push(s.getX(t)),o.push(s.getX(t+1)),o.push(s.getX(t+2))):(o.push(s.getX(t+2)),o.push(s.getX(t+1)),o.push(s.getX(t)));o.length/3!==i&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const a=t.clone();return a.setIndex(o),a}const ka={Handedness:Object.freeze({NONE:"none",LEFT:"left",RIGHT:"right"}),ComponentState:Object.freeze({DEFAULT:"default",TOUCHED:"touched",PRESSED:"pressed"}),ComponentProperty:Object.freeze({BUTTON:"button",X_AXIS:"xAxis",Y_AXIS:"yAxis",STATE:"state"}),ComponentType:Object.freeze({TRIGGER:"trigger",SQUEEZE:"squeeze",TOUCHPAD:"touchpad",THUMBSTICK:"thumbstick",BUTTON:"button"}),ButtonTouchThreshold:.05,AxisTouchThreshold:.1,VisualResponseProperty:Object.freeze({TRANSFORM:"transform",VISIBILITY:"visibility"})},Sa={xAxis:0,yAxis:0,button:0,state:ka.ComponentState.DEFAULT};async function Ta(t){const e=await fetch(t);if(e.ok)return e.json();throw new Error(e.statusText)}async function Ea(t,e,s,i){if(void 0===s&&(s=null),void 0===i&&(i=!0),!t)throw new Error("No xrInputSource supplied");if(!e)throw new Error("No basePath supplied");const n=await async function(t){if(!t)throw new Error("No basePath supplied");return await Ta(`${t}/profilesList.json`)}(e);let o;if(t.profiles.some((t=>{const s=n[t];return s&&(o={profileId:t,profilePath:`${e}/${s.path}`,deprecated:!!s.deprecated}),!!o})),!o){if(!s)throw new Error("No matching profile name found");const t=n[s];if(!t)throw new Error(`No matching profile name found and default profile "${s}" missing.`);o={profileId:s,profilePath:`${e}/${t.path}`,deprecated:!!t.deprecated}}const a=await Ta(o.profilePath);let r;if(i){let e;if(e="any"===t.handedness?a.layouts[Object.keys(a.layouts)[0]]:a.layouts[t.handedness],!e)throw new Error(`No matching handedness, ${t.handedness}, in profile ${o.profileId}`);e.assetPath&&(r=o.profilePath.replace("profile.json",e.assetPath))}return{profile:a,assetPath:r}}class La{constructor(t){this.componentProperty=t.componentProperty,this.states=t.states,this.valueNodeName=t.valueNodeName,this.valueNodeProperty=t.valueNodeProperty,this.valueNodeProperty===ka.VisualResponseProperty.TRANSFORM&&(this.minNodeName=t.minNodeName,this.maxNodeName=t.maxNodeName),this.value=0,this.updateFromComponent(Sa)}updateFromComponent(t){let{xAxis:e,yAxis:s,button:i,state:n}=t;const{normalizedXAxis:o,normalizedYAxis:a}=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0);let s=t,i=e;if(Math.sqrt(t*t+e*e)>1){const n=Math.atan2(e,t);s=Math.cos(n),i=Math.sin(n)}return{normalizedXAxis:.5*s+.5,normalizedYAxis:.5*i+.5}}(e,s);switch(this.componentProperty){case ka.ComponentProperty.X_AXIS:this.value=this.states.includes(n)?o:.5;break;case ka.ComponentProperty.Y_AXIS:this.value=this.states.includes(n)?a:.5;break;case ka.ComponentProperty.BUTTON:this.value=this.states.includes(n)?i:0;break;case ka.ComponentProperty.STATE:this.valueNodeProperty===ka.VisualResponseProperty.VISIBILITY?this.value=this.states.includes(n):this.value=this.states.includes(n)?1:0;break;default:throw new Error(`Unexpected visualResponse componentProperty ${this.componentProperty}`)}}}class _a{constructor(t,e){if(!(t&&e&&e.visualResponses&&e.gamepadIndices&&0!==Object.keys(e.gamepadIndices).length))throw new Error("Invalid arguments supplied");this.id=t,this.type=e.type,this.rootNodeName=e.rootNodeName,this.touchPointNodeName=e.touchPointNodeName,this.visualResponses={},Object.keys(e.visualResponses).forEach((t=>{const s=new La(e.visualResponses[t]);this.visualResponses[t]=s})),this.gamepadIndices=Object.assign({},e.gamepadIndices),this.values={state:ka.ComponentState.DEFAULT,button:void 0!==this.gamepadIndices.button?0:void 0,xAxis:void 0!==this.gamepadIndices.xAxis?0:void 0,yAxis:void 0!==this.gamepadIndices.yAxis?0:void 0}}get data(){return he({id:this.id},this.values)}updateFromGamepad(t){if(this.values.state=ka.ComponentState.DEFAULT,void 0!==this.gamepadIndices.button&&t.buttons.length>this.gamepadIndices.button){const e=t.buttons[this.gamepadIndices.button];this.values.button=e.value,this.values.button=this.values.button<0?0:this.values.button,this.values.button=this.values.button>1?1:this.values.button,e.pressed||1===this.values.button?this.values.state=ka.ComponentState.PRESSED:(e.touched||this.values.button>ka.ButtonTouchThreshold)&&(this.values.state=ka.ComponentState.TOUCHED)}void 0!==this.gamepadIndices.xAxis&&t.axes.length>this.gamepadIndices.xAxis&&(this.values.xAxis=t.axes[this.gamepadIndices.xAxis],this.values.xAxis=this.values.xAxis<-1?-1:this.values.xAxis,this.values.xAxis=this.values.xAxis>1?1:this.values.xAxis,this.values.state===ka.ComponentState.DEFAULT&&Math.abs(this.values.xAxis)>ka.AxisTouchThreshold&&(this.values.state=ka.ComponentState.TOUCHED)),void 0!==this.gamepadIndices.yAxis&&t.axes.length>this.gamepadIndices.yAxis&&(this.values.yAxis=t.axes[this.gamepadIndices.yAxis],this.values.yAxis=this.values.yAxis<-1?-1:this.values.yAxis,this.values.yAxis=this.values.yAxis>1?1:this.values.yAxis,this.values.state===ka.ComponentState.DEFAULT&&Math.abs(this.values.yAxis)>ka.AxisTouchThreshold&&(this.values.state=ka.ComponentState.TOUCHED)),Object.values(this.visualResponses).forEach((t=>{t.updateFromComponent(this.values)}))}}class Ia{constructor(t,e,s){if(!t)throw new Error("No xrInputSource supplied");if(!e)throw new Error("No profile supplied");this.xrInputSource=t,this.assetUrl=s,this.id=e.profileId,this.layoutDescription=e.layouts[t.handedness],this.components={},Object.keys(this.layoutDescription.components).forEach((t=>{const e=this.layoutDescription.components[t];this.components[t]=new _a(t,e)})),this.updateFromGamepad()}get gripSpace(){return this.xrInputSource.gripSpace}get targetRaySpace(){return this.xrInputSource.targetRaySpace}get data(){const t=[];return Object.values(this.components).forEach((e=>{t.push(e.data)})),t}updateFromGamepad(){Object.values(this.components).forEach((t=>{t.updateFromGamepad(this.xrInputSource.gamepad)}))}}class Ra extends THREE.Object3D{constructor(){super(),this.motionController=null,this.envMap=null}setEnvironmentMap(t){return this.envMap==t||(this.envMap=t,this.traverse((t=>{t.isMesh&&(t.material.envMap=this.envMap,t.material.needsUpdate=!0)}))),this}updateMatrixWorld(t){super.updateMatrixWorld(t),this.motionController&&(this.motionController.updateFromGamepad(),Object.values(this.motionController.components).forEach((t=>{Object.values(t.visualResponses).forEach((t=>{const{valueNode:e,minNode:s,maxNode:i,value:n,valueNodeProperty:o}=t;e&&(o===ka.VisualResponseProperty.VISIBILITY?e.visible=n:o===ka.VisualResponseProperty.TRANSFORM&&(e.quaternion.slerpQuaternions(s.quaternion,i.quaternion,n),e.position.lerpVectors(s.position,i.position,n)))}))})))}}function $a(t,e){!function(t,e){Object.values(t.components).forEach((t=>{const{type:s,touchPointNodeName:i,visualResponses:n}=t;if(s===ka.ComponentType.TOUCHPAD)if(t.touchPointNode=e.getObjectByName(i),t.touchPointNode){const e=new THREE.SphereGeometry(.001),s=new THREE.MeshBasicMaterial({color:255}),i=new THREE.Mesh(e,s);t.touchPointNode.add(i)}else console.warn(`Could not find touch dot, ${t.touchPointNodeName}, in touchpad component ${t.id}`);Object.values(n).forEach((t=>{const{valueNodeName:s,minNodeName:i,maxNodeName:n,valueNodeProperty:o}=t;if(o===ka.VisualResponseProperty.TRANSFORM){if(t.minNode=e.getObjectByName(i),t.maxNode=e.getObjectByName(n),!t.minNode)return void console.warn(`Could not find ${i} in the model`);if(!t.maxNode)return void console.warn(`Could not find ${n} in the model`)}t.valueNode=e.getObjectByName(s),t.valueNode||console.warn(`Could not find ${s} in the model`)}))}))}(t.motionController,e),t.envMap&&e.traverse((e=>{e.isMesh&&(e.material.envMap=t.envMap,e.material.needsUpdate=!0)})),t.add(e)}class Aa{constructor(t){void 0===t&&(t=null),this.gltfLoader=t,this.path="https://cdn.jsdelivr.net/npm/@webxr-input-profiles/assets@1.0/dist/profiles",this._assetCache={},this.gltfLoader||(this.gltfLoader=new So)}createControllerModel(t){const e=new Ra;let s=null;return t.addEventListener("connected",(t=>{const i=t.data;"tracked-pointer"===i.targetRayMode&&i.gamepad&&Ea(i,this.path,"generic-trigger").then((t=>{let{profile:n,assetPath:o}=t;e.motionController=new Ia(i,n,o);const a=this._assetCache[e.motionController.assetUrl];if(a)s=a.scene.clone(),$a(e,s);else{if(!this.gltfLoader)throw new Error("GLTFLoader not set.");this.gltfLoader.setPath(""),this.gltfLoader.load(e.motionController.assetUrl,(t=>{this._assetCache[e.motionController.assetUrl]=t,s=t.scene.clone(),$a(e,s)}),null,(()=>{throw new Error(`Asset ${e.motionController.assetUrl} missing or malformed.`)}))}})).catch((t=>{console.warn(t)}))})),t.addEventListener("disconnected",(()=>{e.motionController=null,e.remove(s),s=null})),e}}const Pa=new THREE.Vector3,Ha=new THREE.Vector3(0,-1,0),Oa={type:Ke,orientation:{latitude:0,longitude:0},zoom:1,cameraGroup:{position:[0,0,0],rotation:[0,0,0]},pointer:[0,0,0]};class Ua extends t.Component{get error(){return this.error_}set error(t){this.error_!==t&&(this.error_=t,this.pushChanges())}get view(){return this.view_}set view(t){this.view_!==t&&(this.view_=t,this.setView())}get debugging(){return E}get controlled(){return se.state.controlling&&se.state.controlling!==se.state.uid}get controlling(){return se.state.controlling&&se.state.controlling===se.state.uid}get silencing(){return se.state.silencing}get silenced(){return se.state.silencing&&se.state.role===ie.Streamer}get spyed(){return se.state.spying&&se.state.spying===se.state.uid}get spying(){return se.state.spying&&se.state.spying!==se.state.uid}get locked(){return this.controlled||this.spying}get lockedOrXR(){return this.locked||this.renderer.xr.isPresenting}get showMenu(){return se.state.hosted&&se.state.navigable&&("embed"!==se.state.mode||U.flags.menuEmbed)}get showPointer(){return null!=this.pointer.mesh.parent}set showPointer(t){this.showPointer!==t&&(t?this.scene.add(this.pointer.mesh):this.scene.remove(this.pointer.mesh))}set menu(t){this.menu_!==t&&(this.menu_=t,this.scene.traverse((e=>{(e instanceof Dn||e instanceof Hn)&&(e.freezed=null!=t)})))}get menu(){return this.menu_}onInit(){wn.host=this,this.defaultTexture=Pn.gridTexture,this.index=0,this.error_=null,this.loading=null,this.waiting=null,this.avatars={},this.createScene(),this.addListeners(),this.animate(),Sn.keys$().pipe(i.takeUntil(this.unsubscribe$)).subscribe((t=>{this.keys=t})),be.lang$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((t=>{this.setView()}))}onDestroy(){this.removeListeners();this.renderer.setAnimationLoop((()=>{}))}createScene(){const{node:e}=t.getContext(this);this.size={left:0,top:0,width:0,height:0,aspect:0},this.mouse=new THREE.Vector2,this.controllerMatrix_=new THREE.Matrix4,this.controllerWorldPosition_=new THREE.Vector3,this.controllerWorldDirection_=new THREE.Vector3;const s=this.container=e;this.info=e.querySelector(".world__info"),this.worldRect=Rn.fromNode(s),this.cameraRect=new Rn;const n=this.cameraGroup=new THREE.Group,o=this.camera=new THREE.PerspectiveCamera(70,s.offsetWidth/s.offsetHeight,.01,1e3);o.target=new THREE.Vector3,n.add(o),this.orbitService=new to(o);const a=this.renderer=new THREE.WebGLRenderer({antialias:U.flags.antialias||!1,alpha:U.flags.alpha||!1,premultipliedAlpha:U.flags.premultipliedAlpha||!1,logarithmicDepthBuffer:!0,powerPreference:"high-performance"});a.setClearColor(0,1),a.setPixelRatio(window.devicePixelRatio),a.setSize(s.offsetWidth,s.offsetHeight),a.xr.enabled=!0,a.outputEncoding=THREE.LinearEncoding,a.toneMapping=THREE.ACESFilmicToneMapping,a.toneMappingExposure=U.toneMappingExposure||1,s.childElementCount>0?s.insertBefore(a.domElement,s.children[0]):s.appendChild(a.domElement);(this.raycaster=new THREE.Raycaster).setFromCamera(this.mouse,o);const r=this.scene=new THREE.Scene;r.add(n),U.flags.useTextureEnvironment&&this.addEnvironment();const l=this.objects=new THREE.Group;l.name="[objects]",r.add(l);const c=this.panorama=new ao(a);this.panoramaIntersectObjects=[c.mesh],this.intersectObjects=this.panoramaIntersectObjects,l.add(c.mesh),this.indicator=new uo,this.pointer=new uo("#ff4332");const d=this.ambient=new THREE.AmbientLight(16777215,.25);l.add(d),this.addControllers(),this.resize(),En.progress$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((t=>{const e=0===t.count,s=this.view_;s.items&&s.items.forEach((t=>{t.visible=e}))}))}toggleLights(t){this.ambient&&(this.ambient.visible=t),this.direct&&(this.direct.visible=t)}addEnvironment(){const t=U.textures.envMap.split("/"),e=t.pop(),s=t.join("/")+"/",i=-1!==e.indexOf(".hdr");let n;i?(n=new kn,n.setDataType(THREE.HalfFloatType)):n=new THREE.TextureLoader,n.setPath(U.getPath(s)).load(e,(t=>{i&&t?(t.mapping=THREE.EquirectangularReflectionMapping,this.scene.background=t,this.scene.environment=t):this.setBackground(t)}))}addOffCanvasScene(t){const e=new An(t);this.avatars[t.clientId]=e}removeOffCanvasScene(t){this.avatars[t.clientId],delete this.avatars[t.clientId]}updateOffCanvasScene(t){const e=this.avatars[t.clientId];e&&e.update(t)}setBackground(t){let e=t||this.defaultTexture;e.mapping=THREE.EquirectangularReflectionMapping,e.encoding=THREE.sRGBEncoding,this.scene.environment=e}setView(){if(!this.renderer)return;if(!this.panorama)return;const e=this.view_;if(e){null!=se.state.zoomedId&&se.patchState({zoomedId:null}),this.views&&this.views.forEach((t=>delete t.onUpdateAsset));const s=this.requestInfoResult;s&&e instanceof Ci&&void 0!==s.gridIndex&&(e.index_=s.gridIndex),e.ready=!1,this.cameraGroup.position.set(0,0,0),this.cameraGroup.rotation.set(0,0,0),e.type.name===bi.Room3d.name?(this.renderer.setClearColor(0,1),this.objects.remove(this.panorama.mesh),this.toggleLights(!1)):(this.renderer.setClearColor(0,1),this.objects.add(this.panorama.mesh),this.toggleLights(!0)),this.pushChanges(),In.cancel(),this.panorama.change(e,this.renderer,(s=>{U.flags.useTextureEnvironment||this.setBackground(s),e.ready=!0,e.onUpdateAsset=()=>{this.onViewAssetDidChange()};t.getContext(this)&&this.pushChanges()}),(t=>{this.setViewOrientation(t),In.prefetch(t.prefetchAssets)}))}}onViewAssetDidChange(){this.panorama&&this.panorama.crossfade(this.view,this.renderer,(t=>{U.flags.useTextureEnvironment||this.setBackground(t)}))}setViewOrientation(t){const e=this.requestInfoResult;if(this.requestInfoResult=null,this.orbitService&&(this.orbitService.mode=t.type.name,!this.renderer.xr.isPresenting)){let s;e?(s=e.orientation,this.orbitService.setOrientation(s),this.orbitService.zoom=e.zoom,this.camera.updateProjectionMatrix()):t.keepOrientation||(s=t.useLastOrientation?t.lastOrientation:t.orientation,this.orbitService.setOrientation(s),this.orbitService.zoom=t.zoom,this.camera.updateProjectionMatrix())}}addControllers(){const t=this.controllerGroup=new THREE.Group;this.teleport=new po,this.controllers=[],this.controllerModelFactory=new Aa,this.addController(0),this.addController(1),this.cameraGroup.add(t)}addController(t){const e=se.state.live,s=this.renderer,i=this.controllerGroup,n=s.xr.getController(t),o=this.controllerModelFactory,a=this.teleport,r=this.scene,l=this.camera,c=this.cameraGroup;n.name=`[controller${t+1}]`,i.add(n);const d=t=>{this.controller=t},h=t=>{switch(t.index){case 0:case 1:break;case 4:Us.send({type:hs})}},u=t=>{this.onModelUp()},p=t=>{this.cameraGroup.rotation.y+=Math.PI/180*45},m=t=>{this.cameraGroup.rotation.y-=Math.PI/180*45},v=t=>{this.onModelDistance(t.y)};n.userData.update=()=>{},n.addEventListener("selectstart",(t=>{n.userData.isSelecting=!0,d(n)})),n.addEventListener("selectend",(t=>{n.userData.isSelecting=!1})),n.addEventListener("connected",(a=>{if(n.add(this.buildController(a.data)),e&&"left"===a.data.handedness){const t=this.phone=new ho;n.add(t.mesh)}if(!e||"right"===a.data.handedness){const e=s.xr.getControllerGrip(t);e.name=`[controller-grip${t+1}]`;const a=o.createControllerModel(e);n.userData.model=a,e.add(a),i.add(e)}const r=new Co(a.data.gamepad);r.on("press",h),r.on("release",u),r.on("left",p),r.on("right",m),r.on("axis",v),n.userData.gamepad=r,n.userData.update=()=>{r.update()}})),n.addEventListener("disconnected",(e=>{for(;n.children.length;)n.remove(n.children[0]);const o=s.xr.getControllerGrip(t);for(;o.children.length;)o.remove(o.children[0]);i.remove(o),n.userData.update=()=>{};const d=n.userData.gamepad;d&&(d.off("press",h),d.off("release",u),d.off("left",p),d.off("right",m),d.off("axis",v),delete n.userData.gamepad),a.removeFromController(n,r,s,l,c)})),n.addEventListener("squeezestart",(t=>{this.view&&this.view.type.name===bi.Room3d.name&&(a.addToController(n,r),this.indicator.mesh.visible=!1,n.children[0].visible=!1)})),n.addEventListener("squeezeend",(t=>{a.removeFromController(n,r,s,l,c),this.indicator.mesh.visible=!0,n.children[0].visible=!0}));this.controllers.push(n)}buildController(t){let e,s;switch(t.targetRayMode){case"tracked-pointer":return e=new THREE.BufferGeometry,e.setAttribute("position",new THREE.Float32BufferAttribute([0,0,0,0,0,-1],3)),e.setAttribute("color",new THREE.Float32BufferAttribute([.5,.5,.5,0,0,0],3)),s=new THREE.LineBasicMaterial({vertexColors:!0,blending:THREE.AdditiveBlending}),new THREE.Line(e,s);case"gaze":return e=new THREE.RingBufferGeometry(.02,.04,32).translate(0,0,-1),s=new THREE.MeshBasicMaterial({opacity:.5,transparent:!0}),new THREE.Mesh(e,s)}}updateRaycasterXR(t,e){if(t)return this.controllerMatrix_.identity().extractRotation(t.matrixWorld),e.ray.origin.setFromMatrixPosition(t.matrixWorld),e.ray.direction.set(0,0,-1).applyMatrix4(this.controllerMatrix_),e}repos(t,e){const s=this.worldRect;t.scale.set(.8,.8,.8);const i=(e.x+e.width/2-s.width/2)/s.width*2*this.camera.aspect,n=(e.y+e.height/2-s.height/2)/s.height*2*this.camera.aspect;t.position.set(i,-n,0)}render(t){try{const t=this.renderer,e=this.scene,s=this.camera,i=this.avatars,n=t.xr.isPresenting;if(!n&&se.state.mode===fs)return;n?(gsap.ticker.tick(),this.controllers.forEach((t=>t.userData.update())),this.teleport.update()):this.navWithKeys(),this.orbitService.render();const o=performance.now(),a=this.tick_?++this.tick_:this.tick_=1;e.traverse((i=>{const n=i.userData.render;"function"==typeof n&&n(o,a,t,e,s)})),Object.keys(i).forEach((t=>{i[t].render()})),this.vrService.updateState(this),this.raycasterXRHitTest(),t.render(e,s)}catch(t){this.error=t}}navWithKeys(){if(this.view&&this.view.type.name===bi.Room3d.name&&this.view.mesh&&!this.locked&&!ei.hasModal){this.intersectObjects=this.view.intersectObjects;const t=this.velocity||(this.velocity=new THREE.Vector3),e=this.direction||(this.direction=new THREE.Vector3),s=this.camera,i=.1;if(this.keys.w||this.keys.ArrowUp)s.getWorldDirection(e),e.multiplyScalar(i),t.copy(e);else if(this.keys.s||this.keys.ArrowDown)s.getWorldDirection(e),e.multiplyScalar(-i),t.copy(e);else if(this.keys.d||this.keys.ArrowRight){s.getWorldDirection(e),e.multiplyScalar(i);const n=this.axisY||(this.direction=new THREE.Vector3(0,1,0)),o=-Math.PI/2;e.applyAxisAngle(n,o),t.copy(e)}else if(this.keys.a||this.keys.ArrowLeft){s.getWorldDirection(e),e.multiplyScalar(-i);const n=this.axisY||(this.direction=new THREE.Vector3(0,1,0)),o=-Math.PI/2;e.applyAxisAngle(n,o),t.copy(e)}if(t.manhattanLength()>1e-5){e.copy(this.cameraGroup.position),e.add(t),e.y=0;const s=this.raycaster;s.set(e,Ha);s.intersectObjects(this.view.navIntersectObjects).length&&(this.cameraGroup.position.add(t),this.cameraGroup.position.y=0,this.orbitService.markAsDirty()),t.lerp(Pa,.1)}else t.set(0,0,0)}else this.intersectObjects=this.panoramaIntersectObjects}animate(){this.renderer.setAnimationLoop(this.render)}resize(){try{const t=this.container,e=this.renderer,s=this.camera,i=this.size,n=t.getBoundingClientRect();i.left=Math.floor(n.left),i.top=Math.floor(n.top),i.width=Math.ceil(n.width),i.height=Math.ceil(n.height),i.aspect=i.width/i.height;if(this.worldRect.setSize(i.width,i.height),!e.xr.isPresenting&&(e.setSize(i.width,i.height),s)){s.aspect=i.width/i.height;const t=s.fov*Math.PI/180,e=Math.abs(s.position.z*Math.tan(t/2)*2),n=this.cameraRect;n.width=e*s.aspect,n.height=e,s.updateProjectionMatrix()}}catch(t){this.error=t}}updateRaycasterMouse(t){const e=this.size.width/2,s=this.size.height/2;this.mouse.x=(t.clientX-this.size.left-e)/e,this.mouse.y=-(t.clientY-this.size.top-s)/s;const i=this.raycaster;return i.setFromCamera(this.mouse,this.camera),i}raycasterXRHitTest(){if(this.renderer.xr.isPresenting&&!this.locked){const t=this.updateRaycasterXR(this.controller,this.raycaster);t&&(yn.hittest(t,this.controller.userData.isSelecting),this.indicator.update(this.renderer.xr.getCamera(this.camera)))}}raycasterDesktopHitTest(t){const e=this.updateRaycasterMouse(t);if(!this.lockedOrXR)if(this.dragItem){if("function"==typeof this.dragItem.onDragMove){const t=e.intersectObjects(this.intersectObjects);if(t.length){const e=t[0],s=this.intersectionPoint||(this.intersectionPoint=new THREE.Vector3),i=this.intersectionNormal||(this.intersectionNormal=new THREE.Vector3),n=s.copy(e.point),o=i.copy(e.face.normal);this.dragItem.onDragMove(n,o,this.intersectObjects===this.panoramaIntersectObjects)}}}else this.resizeItem||(yn.hittest(e),this.controlEvent$.next(Oa))}onMouseDown(t){try{if(this.locked)return;if(0!==t.button)return;const e=this.updateRaycasterMouse(t),s=yn.hittest(e,!0);if(this.editor||E)if(this.keys.Shift||this.keys.Control);else{this.select.next({item:null});const t=e.intersectObjects(this.intersectObjects);if(t.length){const e=t[0],s=this.intersectionPoint||(this.intersectionPoint=new THREE.Vector3),i=this.intersectionNormal||(this.intersectionNormal=new THREE.Vector3),n=s.copy(e.point),o=i.copy(e.face.normal);this.viewHit.next({position:n,normal:o,spherical:this.intersectObjects===this.panoramaIntersectObjects})}}else if(this.isTouchDevice()&&s&&"[panorama]"===s.name){const t=this.view.items.find((t=>t.showPanel));t&&(t.showPanel=!1,this.pushChanges())}}catch(t){this.error=t}}onMouseMove(t){try{this.raycasterDesktopHitTest(t)}catch(t){this.error=t}}onMouseUp(t){try{if(this.lockedOrXR)return;this.dragItem&&"function"==typeof this.dragItem.onDragEnd&&(this.dragItem.onDragEnd(),this.dragEnd.next(this.dragItem)),this.dragItem=null,this.resizeItem&&"function"==typeof this.resizeItem.onResizeEnd&&(this.resizeItem.onResizeEnd(),this.resizeEnd.next(this.resizeItem)),this.resizeItem=null;const e=this.updateRaycasterMouse(t);yn.hittest(e,!1);this.checkSelectedItem()}catch(t){this.error=t}}onMouseWheel(t){try{if(this.lockedOrXR)return;const e=t.deltaY*(void 0!==t.wheelDeltaY?1:37),s=this.orbitService;gsap.to(s,{duration:.5,zoom:s.zoom+.1*e,ease:Power4.easeOut,overwrite:!0})}catch(t){this.error=t}}onOrientationDidChange(){this.controlEvent$.next(Oa)}checkSelectedItem(){if(this.view){const t=this.view.items.find((t=>t.selected));t&&t.mesh&&"model"!==this.view.type.name&&this.orbitService.lookAt(t.mesh)}}onVRStarted(){this.objects.position.y=1.3,this.scene.add(this.indicator.mesh),Us.send({type:ls})}onVREnded(){this.objects.position.y=0,this.cameraGroup.rotation.y=0,this.cameraGroup.position.y=0,this.scene.remove(this.indicator.mesh),this.orbitService.markAsDirty(),Us.send({type:cs})}onVRStateDidChange(t){Us.send({type:ds,camera:t.camera.array})}onMenuNav(t){this.menu=void 0,this.navTo.next({viewId:t.id})}onMenuToggle(t){this.locked||(this.menu=t,this.view.items.forEach((t=>t.showPanel=!1)),this.pushChanges())}onNavOver(t){this.menu||(this.view.items.forEach((t=>t.showPanel=!1)),t.item.to&&clearTimeout(t.item.to),t.item.showPanel=t.shouldShowPanel(),this.pushChanges(),Us.send({type:Ye,itemId:t.item.showPanel?t.item.id:null}))}onNavOut(t){this.isTouchDevice()||(t.item.to=setTimeout((()=>{t.item.showPanel=!1,this.pushChanges()}),6e3),this.pushChanges())}onNavDown(t){this.isTouchDevice()||(t.item.showPanel=!1),this.locked||(this.editor&&this.keys.Shift?(this.dragItem=t,this.select.next(t)):this.editor&&this.keys.Control?(this.resizeItem=t,this.select.next(t)):this.navTo.next(t.item))}onNavLink(t){this.locked||this.editor||(U.flags.useIframe?(Us.send({type:as,itemId:t.item.id,linkIndex:t.linkIndex}),this.navLink.next(t)):window.open(t.link.href,"_blank"))}isTouchDevice(){return"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0}onModelDown(t){if(this.editor)return this.onObjectDown(t);const e=this.controller;if(e&&this.renderer.xr.isPresenting){const s=this.tempTarget=t.mesh;this.tempParent=s.parent;const i=new THREE.Vector3;s.localToWorld(i),e.worldToLocal(i),e.add(s),s.position.copy(i)}}onModelDistance(t){const e=this.controller,s=this.tempTarget;if(e&&s&&this.renderer.xr.isPresenting){let e=new THREE.Vector3;e=e.copy(s.position);const i=Math.max(1,Math.min(8,e.distanceTo(Pa)+.02*t));e.normalize(),e=e.multiplyScalar(i),s.position.copy(e)}}onModelUp(){const t=this.tempTarget,e=this.tempParent;if(t&&e){const s=new THREE.Vector3;t.localToWorld(s),e.worldToLocal(s),e.add(t),t.position.copy(s),this.tempTarget=null,this.tempParent=null}}onObjectDown(t){this.lockedOrXR||(this.editor&&this.keys.Shift?(this.dragItem=t,this.select.next(t)):this.editor&&this.keys.Control&&(this.resizeItem=t,this.select.next(t)))}onPanelDown(t){this.locked||(U.flags.useIframe?(Us.send({type:as,itemId:t.item.id,linkIndex:t.linkIndex}),this.navLink.next(t)):window.open(t.link.href,"_blank"))}onPlayMedia(t){this.editor||Us.send({type:Je,itemId:t.itemId,playing:t.playing})}onZoomMedia(t){t.zoomed&&this.view.items.forEach((e=>{e.mesh instanceof Dn&&e.id!==t.itemId&&e.mesh.setZoomedState(!1)})),this.view.items.forEach((t=>t.showPanel=!1)),se.patchState({zoomedId:t.zoomed?t.itemId:null}),Us.send({type:Qe,itemId:t.itemId,zoomed:t.zoomed})}onCurrentTimeMedia(t){this.editor||Us.send({type:ts,itemId:t.itemId,currentTime:t.currentTime})}onPlayModel(t){this.editor||Us.send({type:es,itemId:t.itemId,actionIndex:t.actionIndex})}onGridMove(t){this.view.items=[],this.pushChanges(),this.orbitService.walk(t.position,((e,s)=>{const i=this.view.getTile(t.indices.x,t.indices.y);i&&this.panorama.crossfade(i,this.renderer,(t=>{U.flags.useTextureEnvironment||this.setBackground(t),this.orbitService.walkComplete(e,s),this.view.updateCurrentItems(),this.pushChanges()}))}))}onGridNav(t){this.locked||(Us.send({type:os,viewId:this.view.id,gridIndex:t}),this.pushChanges())}control$(){return this.controlEvent$.pipe(i.filter((()=>this.controlling||this.spyed||this.editor)),i.auditTime(40),i.tap((t=>{t.orientation.latitude=this.orbitService.latitude,t.orientation.longitude=this.orbitService.longitude,t.zoom=this.orbitService.zoom,t.cameraGroup={position:this.cameraGroup.position.toArray(),rotation:this.cameraGroup.rotation.toArray()};const e=this.raycaster.intersectObjects(this.intersectObjects),s=e.length?e[0].point.normalize():null;s&&(t.pointer[0]=s.x,t.pointer[1]=s.y,t.pointer[2]=s.z),Us.send(t)})))}addListeners(){this.controlEvent$=new s.ReplaySubject(1),this.control$().pipe(i.takeUntil(this.unsubscribe$)).subscribe();const t=this.vrService=xo.getService();t.session$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((t=>{this.renderer.xr.setSession(t),t?this.onVRStarted():this.onVREnded()})),t.state$.pipe(i.takeUntil(this.unsubscribe$),i.auditTime(Math.floor(1e3/15))).subscribe((t=>{this.onVRStateDidChange(t)}));this.orbitService.observe$(this.container).pipe(i.shareReplay(1)).pipe(i.filter((t=>t instanceof Xn)),i.auditTime(Math.floor(1e3/15))).pipe(i.takeUntil(this.unsubscribe$)).subscribe((t=>{this.onOrientationDidChange()})),Us.out$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((t=>{switch(t.type){case Ne:t.type=Fe,t.viewId=this.view.id,t.orientation=this.orbitService.getOrientation(),t.zoom=this.orbitService.zoom,t.cameraGroup={position:this.cameraGroup.position.toArray(),rotation:this.cameraGroup.rotation.toArray()},this.view instanceof Ci&&(t.gridIndex=this.view.index),Us.sendBack(t),se.state.role!==ie.Publisher&&se.patchState({spying:t.remoteId});break;case Fe:ln.viewId!==t.viewId?(ln.viewId=t.viewId,this.requestInfoResult=t):(this.renderer.xr.isPresenting||(this.orbitService.setOrientation(t.orientation),this.orbitService.zoom=t.zoom,this.cameraGroup.position.set(t.cameraGroup.position[0],t.cameraGroup.position[1],t.cameraGroup.position[2]),this.cameraGroup.rotation.set(t.cameraGroup.rotation[0],t.cameraGroup.rotation[1],t.cameraGroup.rotation[2])),this.view instanceof Ci&&t.gridIndex&&(this.view.index=t.gridIndex),this.view&&this.view.ready||(this.requestInfoResult=t));break;case Ye:this.menu&&this.menu.removeMenu(),this.view.items.forEach((e=>e.showPanel=e.id===t.itemId)),this.pushChanges();break;case as:const e=this.view.items.find((e=>e.id===t.itemId));if(e){const s=e.links[t.linkIndex];this.navLink.next({item:e,link:s,linkIndex:t.linkIndex})}break;case rs:const s=this.view.items.find((e=>e.id===t.itemId));s&&ei.resolve();break;case Je:{const e=this.view.items.find((e=>e.id===t.itemId));e&&e.mesh instanceof Dn&&e.mesh.setPlayingState(t.playing);break}case Qe:this.view.items.forEach((e=>{e.mesh instanceof Dn&&(e.id===t.itemId?e.mesh.setZoomedState(t.zoomed):e.mesh.setZoomedState(!1))})),se.patchState({zoomedId:t.zoomed?t.itemId:null});break;case ts:{const e=this.view.items.find((e=>e.id===t.itemId));e&&e.mesh instanceof Dn&&e.mesh.setCurrentTime(t.currentTime);break}case es:{const e=this.view.items.find((e=>e.id===t.itemId));e&&e.onMessage(t);break}case os:this.view.id===t.viewId&&(this.view.index=t.gridIndex);break;case ls:this.addOffCanvasScene(t);break;case cs:this.removeOffCanvasScene(t);break;case ds:this.updateOffCanvasScene(t),se.state.spying!==t.clientId&&se.state.controlling!==t.clientId||this.orbitService.setVRCamera(t.camera);break;case Ke:this.renderer.xr.isPresenting||(this.orbitService.setOrientation(t.orientation),this.orbitService.zoom=t.zoom,this.cameraGroup.position.set(t.cameraGroup.position[0],t.cameraGroup.position[1],t.cameraGroup.position[2]),this.cameraGroup.rotation.set(t.cameraGroup.rotation[0],t.cameraGroup.rotation[1],t.cameraGroup.rotation[2])),this.pointer.setPosition(t.pointer[0],t.pointer[1],t.pointer[2],this.camera)}})),Us.in$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((t=>{if(t.type===vs)this.checkSelectedItem()})),se.state$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((t=>{this.state=t,this.showPointer=this.locked})),this.resize=this.resize.bind(this),this.render=this.render.bind(this),this.onMouseDown=this.onMouseDown.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.onMouseWheel=this.onMouseWheel.bind(this),window.addEventListener("resize",this.resize,!1),this.container.addEventListener("wheel",this.onMouseWheel,!1),this.container.addEventListener("mousedown",this.onMouseDown,!1),this.container.addEventListener("mouseup",this.onMouseUp,!1),document.addEventListener("mousemove",this.onMouseMove,!1)}removeListeners(){window.removeEventListener("resize",this.resize,!1),window.removeEventListener("resize",this.resize,!1),document.removeEventListener("mousemove",this.onMouseMove,!1),document.removeEventListener("wheel",this.onMouseWheel,!1),this.container.removeEventListener("mousedown",this.onMouseDown,!1),this.container.removeEventListener("mouseup",this.onMouseUp,!1)}}Ua.meta={selector:"[world]",inputs:["view","views","editor"],outputs:["navTo","navLink","viewHit","dragEnd","resizeEnd","select"],template:'\n\t<div class="world__view" *if="view">\n\t\t<div class="grid" model-grid *if="view.type.name === \'panorama-grid\'" [view]="view" (move)="onGridMove($event)" (nav)="onGridNav($event)"></div>\n\t\t<div *if="view.ready">\n\t\t\t<div model-room [view]="view" *if="view.type.name === \'room-3d\'"></div>\n\t\t\t<div class="world__item" *for="let item of view.pathItems; let index = index;">\n\t\t\t\t<div model-nav [item]="item" [view]="view" (over)="onNavOver($event)" (out)="onNavOut($event)" (down)="onNavDown($event)" (link)="onNavLink($event)" *if="item.type.name == \'nav\'"></div>\n\t\t\t\t<div model-plane [item]="item" [view]="view" (play)="onPlayMedia($event)" (zoom)="onZoomMedia($event)" (down)="onObjectDown($event)" (currentTime)="onCurrentTimeMedia($event)" *if="item.type.name == \'plane\'"></div>\n\t\t\t\t<div model-curved-plane [item]="item" [view]="view" (play)="onPlayMedia($event)" (zoom)="onZoomMedia($event)" (down)="onObjectDown($event)" (currentTime)="onCurrentTimeMedia($event)" *if="item.type.name == \'curved-plane\'"></div>\n\t\t\t\t<div class="model-viewer__item" model-model [item]="item" [view]="view" (down)="onModelDown($event)" (play)="onPlayModel($event)" *if="item.type.name == \'model\'"></div>\n\t\t\t\t<div class="panel" [class]="{ \'panel--lg\': item.asset != null }" model-panel [item]="item" (down)="onPanelDown($event)" *if="item.showPanel"></div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\t<div class="progress-indicator" model-progress [view]="view">\n\t\t<div class="inner"></div>\n\t</div>\n\t<div model-menu [views]="views" (nav)="onMenuNav($event)" (toggle)="onMenuToggle($event)" *if="showMenu"></div>\n\t<div model-debug *if="debugging"></div>\n\t<div class="world__info" *if="error" [innerHTML]="error"></div>\n\t'};class Ba extends t.Component{set renderOrder(t){this.group.renderOrder=t}onInit(){if(!this.host)throw"ModelComponent host is undefined";this.scale=new THREE.Vector3(1,1,1),this.position=new THREE.Vector3;const t=this.group=new THREE.Group;t.name=this.getName(),t.userData.render=(t,e)=>{this.render(this,t,e)},this.getContainer().add(t),this.onCreate(((t,e)=>this.onMount(t,e)),((t,e)=>this.onDismount(t,e)))}onDestroy(){const t=this.group;this.getContainer().remove(t),delete t.userData.render,this.disposeObject(t),this.group=null}getContainer(){return this.host.objects}getName(t){return`${this.constructor.meta.selector}-${this.rxcompId}${t?`-${t}`:""}`}onCreate(t,e){const s=new THREE.MeshStandardMaterial({color:new THREE.Color("#ffcc00"),roughness:.4,metalness:.01,flatShading:!0,transparent:!0,opacity:.9}),i=new THREE.Mesh(bn.defaultGeometry,s);return"function"==typeof t&&t(i),i}onMount(t,e){this.mesh&&this.onDismount(this.mesh),t.name=this.getName("mesh"),this.mesh=t,e&&(e.mesh=t,Object.defineProperty(e,"visible",{get:()=>t.visible,set:t=>{this.setVisible(t)},configurable:!0}),e.onUpdate=()=>{this.onUpdate(e,t)},e.onUpdateAsset=()=>{this.onUpdateAsset(e,t)},e.onMessage=t=>{this.onMessage(t)}),this.group&&this.group.add(t)}onDismount(t,e){this.group.remove(t),"function"==typeof t.dispose&&t.dispose(),this.disposeObject(t),this.mesh=null,e&&(delete e.mesh,delete e.onUpdate,delete e.onUpdateAsset,delete e.onMessage)}disposeObject(t){t.traverse((t=>{(t.isInteractiveMesh||t.isInteractiveSprite)&&yn.dispose(t),t.isMesh?(t.material.map&&!1!==t.material.map.disposable&&t.material.map.dispose(),t.material.dispose(),t.geometry.dispose()):t.isSprite&&(t.material.map&&!1!==t.material.map.disposable&&t.material.map.dispose(),t.material.dispose())}))}calculateScaleAndPosition(){const{node:e}=t.getContext(this);this.host.repos(this,e.getBoundingClientRect())}render(t,e){}setVisible(t){this.mesh&&(this.mesh.visible=t)}getScroll(t){return this.intersection.scroll(t)}getTween(t){let e=Math.min(0,this.intersection.offset(t))+1;return e=Math.max(0,e),e-=1,e}onUpdate(t,e){}onUpdateAsset(t,e){}onMessage(t){}}Ba.meta={selector:"[model]",hosts:{host:Ua},inputs:["item"]};class Da extends Ba{get editing(){return this.editing_}set editing(t){this.editing_!==t&&(this.editing_=t,this.setHelper(t))}onInit(){super.onInit(),this.RADIUS=100}onDestroy(){this.editing=!1,super.onDestroy()}setHelper(t){t?(this.helper||(this.helper=new THREE.BoxHelper(this.mesh,65280)),this.host.scene.add(this.helper)):this.helper&&this.host.scene.remove(this.helper)}updateHelper(){this.helper&&this.helper.setFromObject(this.mesh)}}Da.meta={selector:"[model-editable]",hosts:{host:Ua},inputs:["item"]};const za="none",Va="move",ja="info",Na="point",Fa="title",Ga="transparent",qa="wishlist";class Za extends Da{constructor(){super(...arguments),this.hidden_=!1,this.isMobile_=void 0}static getLoader(){return Za.loader||(Za.loader=new THREE.TextureLoader)}static getTexturePoint(){return Za.texturePoint||(Za.texturePoint=Za.getLoader().load(U.getPath("textures/ui/nav-point.png")))}static getTexturePointImportant(){return Za.texturePointImportant||(Za.texturePointImportant=Za.getLoader().load(U.getPath("textures/ui/nav-point-important.png")))}static getTextureMove(){return Za.textureMove||(Za.textureMove=Za.getLoader().load(U.getPath("textures/ui/nav-more.png")))}static getTextureMoveImportant(){return Za.textureMoveImportant||(Za.textureMoveImportant=Za.getLoader().load(U.getPath("textures/ui/nav-more-important.png")))}static getTextureInfo(){return Za.textureInfo||(Za.textureInfo=Za.getLoader().load(U.getPath("textures/ui/nav-info.png")))}static getTextureInfoImportant(){return Za.textureInfoImportant||(Za.textureInfoImportant=Za.getLoader().load(U.getPath("textures/ui/nav-info-important.png")))}static getTextureWishlist(){return Za.textureWishlist||(Za.textureWishlist=Za.getLoader().load(U.getPath("textures/ui/nav-wishlist-off.png")))}static getTextureWishlistAdded(){return Za.textureWishlistAdded||(Za.textureWishlistAdded=Za.getLoader().load(U.getPath("textures/ui/nav-wishlist-on.png")))}static getTexture(t,e){let s;switch(t){case Va:s=e.important?this.getTextureMoveImportant():this.getTextureMove();break;case ja:s=e.important?this.getTextureInfoImportant():this.getTextureInfo();break;case Na:case Fa:s=e.important?this.getTexturePointImportant():this.getTexturePoint();break;case qa:s=e.added?this.getTextureWishlistAdded():this.getTextureWishlist()}return s.disposable=!1,s.encoding=THREE.sRGBEncoding,s}static getTitleTexture(t,e){let s;if(e===Fa){const e=t.title,i=document.createElement("canvas");i.width=512,i.height=32;const n=i.getContext("2d");n.imageSmoothingEnabled=!0,n.imageSmoothingQuality="high",n.font=`24px ${U.fontFamily}`;let o=n.measureText(e).width+8;o=Math.pow(2,Math.ceil(Math.log(o)/Math.log(2)));const a=o/2,r=16;i.width=o,n.font=`24px ${U.fontFamily}`,n.textAlign="center",n.textBaseline="middle",n.strokeStyle="rgba(0, 0, 0, 0.5)",n.lineWidth=6,n.lineJoin="round",n.miterLimit=2,n.strokeText(e,a,r),n.fillStyle="white",n.fillText(e,a,r),s=new THREE.CanvasTexture(i)}return s}static getNavMode(t,e){let s=za;return t.hook&&"ToggleWishlist"===t.hook?s=qa:t.transparent?s=Ga:t.viewId!==e.id?(s=Va,this.isValidText(t.title)&&(s=Fa),(this.isValidText(t.abstract)||t.asset&&t.asset.id||t.link&&t.link.href)&&(s=Na)):(this.isValidText(t.title)||this.isValidText(t.abstract)||t.asset&&t.asset.id||t.link&&t.link.href)&&(s=ja),s}static hasNavInfo(t){return null!=t.items.find((e=>this.getNavMode(e,t)===ja))}static isValidText(t){return t&&t.length>0}get hidden(){return this.hidden_}set hidden(t){this.hidden_!==t&&(this.hidden_=t,this.updateVisibility(!t))}get isHidden(){return null!=se.state.zoomedId||U.flags.hideNavInfo&&!this.host.editor&&!se.state.showNavInfo&&!(this.host.renderer.xr.isPresenting||se.state.role===ie.SelfService||se.state.role===ie.Embed)&&this.mode===ja}get isAnimated(){let t=!1;const e=this.mode,s=this.item.important;switch(e){case ja:t=s?U.flags.navInfoImportantAnimated:U.flags.navInfoAnimated;break;case Va:t=s?U.flags.navMoveImportantAnimated:U.flags.navMoveAnimated;break;case Na:t=s?U.flags.navPointImportantAnimated:U.flags.navPointAnimated;break;case Fa:t=s?U.flags.navTitleImportantAnimated:U.flags.navTitleAnimated;break;case Ga:t=s?U.flags.navTransparentImportantAnimated:U.flags.navTransparentAnimated}return t}get iconMinScale(){return.03*(U.navs.iconMinScale||1)*(this.isMobile?1.6:1)}get iconMaxScale(){return.03*(U.navs.iconMaxScale||1.5)*(this.isMobile?1.6:1)}get isMobile(){return this.isMobile_}set isMobile(t){this.isMobile_!==t&&(this.isMobile_=t,this.setScale())}render(t,e){this.isMobile=this.host.worldRect.width<768}setScale(t){void 0===t&&(t=0);const e=this.icon;if(e){const s=this.iconMinScale+t*(this.iconMaxScale-this.iconMinScale);e.scale.set(s,s,s)}}shouldShowPanel(){return!this.editing&&this.mode!==Va&&this.mode!==Fa&&this.mode!==qa&&(this.mode!==Ga||Za.isValidText(this.item.title))}updateVisibility(t){this.mesh&&(this.mesh.visible=t),this.sphere&&(this.sphere.freezed=!t),!t&&this.item&&(this.item.showPanel=!1)}setVisible(t){this.mesh&&(this.mesh.visible=t&&!this.hidden_)}onInit(){super.onInit()}onChanges(){const t=this.view,e=this.item;(this.mode=Za.getNavMode(e,this.view))===qa&&(e.added=dn.has({viewId:t.id,itemId:e.id}),this.onCreateSprites(this.mesh,1)),this.editing=e.selected,this.hidden=this.isHidden}onCreate(t,e){const s=this.view,i=this.item,n=this.mode=Za.getNavMode(i,this.view);if(n===za)return;n===qa&&(i.added=dn.has({viewId:s.id,itemId:i.id}));const o=this.isAnimated,a=new THREE.Group;if(n===Ga){const t=this.host.editor?.1:0,e=.2,s=.3;a.position.fromArray(i.position),a.rotation.fromArray(i.rotation),a.scale.fromArray(i.scale);const n=bn.planeGeometry,r=this.plane=new Mn(n,new THREE.MeshBasicMaterial({depthTest:!1,depthWrite:!1,transparent:!0,opacity:t,color:new THREE.Color(U.colors.menuOverBackground),toneMapped:!1}));if(r.name=`[nav] ${i.id}`,r.depthTest=!1,a.add(r),o){const t={pow:0};gsap.to(t,{pow:1,duration:.6,delay:.5+.1*i.index,ease:Power2.easeOut,repeat:-1,yoyo:!0,onUpdate:()=>{r.material.opacity=t.pow*s}})}r.on("over",(()=>{o||(r.material.opacity=e),this.over.next(this)})),r.on("out",(()=>{o||(r.material.opacity=t),this.out.next(this)})),r.on("down",(()=>{o||(r.material.opacity=s),this.down.next(this);const t=this.item.firstLink;!this.host.editor&&!this.shouldShowPanel()&&t&&t.href&&(this.shouldNavToLink=t.href),console.log("ModelNavComponent.down")})),r.on("up",(()=>{if(o||(r.material.opacity=t),null!=this.shouldNavToLink){this.shouldNavToLink=null;const t=this.item,e=t.firstLink;this.link.next({item:t,link:e})}}))}else{const t=new THREE.Vector3(i.position[0],i.position[1],i.position[2]),e=new THREE.Vector3(i.position[0],i.position[1],i.position[2]).normalize();t.distanceToSquared(e)<1e-4&&t.multiplyScalar(Za.RADIUS),a.position.copy(t),this.onCreateSprites(a);const s=bn.sphereGeometry,n=this.sphere=new Mn(s,new THREE.MeshBasicMaterial({depthTest:!1,depthWrite:!1,transparent:!0,opacity:0,color:65535,toneMapped:!1}));n.name=`[nav] ${i.id}`,n.depthTest=!1,a.add(n);const r={pow:0};gsap.to(r,{pow:1,duration:.7,delay:.5+.1*i.index,ease:Power2.easeInOut,overwrite:!0,onUpdate:()=>{this.materials.forEach((t=>{t.opacity=r.pow}))},onComplete:()=>{if(o){const t=this.icon;r.pow=0,gsap.to(r,{pow:1,duration:.6,delay:.5+.1*i.index,ease:Power2.easeOut,repeat:-1,yoyo:!0,onUpdate:()=>{this.setScale(r.pow),t.material.opacity=r.pow}})}}}),n.on("over",(()=>{if(this.over.next(this),!o){const t=this.icon,e={scale:t.scale.x};gsap.to(e,{duration:.35,scale:this.iconMaxScale,delay:0,ease:Power2.easeOut,overwrite:!0,onUpdate:()=>{t.scale.set(e.scale,e.scale,e.scale)}})}})),n.on("out",(()=>{if(this.out.next(this),!o){const t=this.icon,e={scale:t.scale.x};gsap.to(e,{duration:.35,scale:this.iconMinScale,delay:0,ease:Power2.easeOut,overwrite:!0,onUpdate:()=>{t.scale.set(e.scale,e.scale,e.scale)}})}})),n.on("down",(()=>{this.down.next(this)}))}"function"==typeof t&&t(a,i)}onCreateSprites(t,e){void 0===e&&(e=0),this.onRemoveSprite(this.icon),this.onRemoveSprite(this.title);const s=this.item,i=this.mode=Za.getNavMode(s,this.view);if(i!==za)if(i===Ga)this.materials=[];else{const n=Za.getTexture(i,s),o=new THREE.SpriteMaterial({map:n,depthTest:!1,depthWrite:!1,transparent:!0,sizeAttenuation:!1,opacity:e,toneMapped:!1}),a=[o],r=this.icon=new THREE.Sprite(o);let l;r.renderOrder=U.renderOrder.nav,this.setScale(),t.add(r);const c=Za.getTitleTexture(s,i);if(c){l=new THREE.SpriteMaterial({depthTest:!1,depthWrite:!1,transparent:!0,map:c,sizeAttenuation:!1,opacity:e,toneMapped:!1});const s=c.image,i=this.title=new THREE.Sprite(l),n=this.iconMinScale;i.scale.set(n*s.width/s.height,n,n),i.position.set(0,-3.5,0),t.add(i),a.push(l)}this.materials=a}}onRemoveSprite(t){t&&(t.parent&&t.parent.remove(t),t.material.map&&!1!==t.material.map.disposable&&t.material.map.dispose(),t.material.dispose())}onDestroy(){yn.dispose(this.sphere),super.onDestroy()}onUpdate(t,e){this.item=t,this.onCreateSprites(e,1),this.mode===Ga?(t.position&&e.position.fromArray(t.position),t.rotation&&e.rotation.fromArray(t.rotation),t.scale&&e.scale.fromArray(t.scale)):(e.position.fromArray(t.position),e.rotation.set(0,0,0),e.scale.set(1,1,1)),this.updateHelper()}onDragMove(t,e,s){const i=this.item,n=this.mesh;this.editing=!0,i.showPanel=!1,this.mode===Ga?s?(t.normalize().multiplyScalar(Za.RADIUS),n.position.set(t.x,t.y,t.z),n.lookAt(wn.origin)):(n.position.set(0,0,0),n.lookAt(e),n.position.set(t.x,t.y,t.z),n.position.add(e.multiplyScalar(.01))):s?(t.normalize().multiplyScalar(Za.RADIUS),n.position.set(t.x,t.y,t.z)):(n.position.set(t.x,t.y,t.z),n.position.add(e.multiplyScalar(.01))),this.updateHelper()}onDragEnd(){const t=this.item,e=this.mesh;this.mode===Ga?(t.position=e.position.toArray(),t.rotation=e.rotation.toArray(),t.scale=e.scale.toArray()):t.position=e.position.toArray(),this.editing=!1}}Za.RADIUS=100,Za.meta={selector:"[model-nav]",hosts:{host:Ua},outputs:["over","out","down","link"],inputs:["item","view"]};class Wa extends t.Component{get meetingUrl(){return this.meetingUrl_||(this.meetingUrl_=new re),this.meetingUrl_}get isVirtualTourUser(){return-1!==[ie.Publisher,ie.Attendee,ie.Streamer,ie.Viewer].indexOf(se.state.role)}get isEmbed(){if(this.route)return"embed"===this.route.params.mode}get isSelfServiceTour(){if(this.route)return"selfServiceTour"===this.route.params.mode}get isNavigable(){return null==this.meetingUrl.embedViewId}get isBackButtonVisible(){return this.view&&(this.view.type.name===bi.Media.name||this.view.type.name===bi.Model.name)}get isSelfServiceProposition(){return se.state.role===ie.SelfService&&U.flags.selfServiceProposition}get isSelfServiceSupport(){return se.state.role===ie.Publisher&&U.flags.selfServiceProposition&&this.meetingUrl.support}get showNavInfoToggler(){return U.flags.hideNavInfo&&this.state.mode!==fs&&this.view&&Za.hasNavInfo(this.view)}get uiClass(){const t={};return t[this.state.role]=!0,t.chat=this.state.chat,t.remotes=this.state.mode===fs,t.remoteScreen=null!=this.remoteScreen&&!this.hasScreenViewItem,t.locked=this.locked,t}get remoteClass(){return`group--remote--${Math.min(9,this.remotes.length)}`}get controlled(){return se.state.controlling&&se.state.controlling!==se.state.uid}get controlling(){return se.state.controlling&&se.state.controlling===se.state.uid}get silencing(){return se.state.silencing}get silenced(){return se.state.silencing&&se.state.role===ie.Streamer}get spyed(){return se.state.spying&&se.state.spying===se.state.uid}get spying(){return se.state.spying&&se.state.spying!==se.state.uid}get locked(){return this.controlled||this.spying}get remoteScreen(){return this.remoteScreen_}set remoteScreen(t){this.remoteScreen_!==t&&(this.remoteScreen_=t,setTimeout((()=>{window.dispatchEvent(new Event("resize"))}),1))}get pathViews(){return ln.pathViews}onInit(){const{node:e}=t.getContext(this);e.classList.remove("hidden"),this.platform=Ns.platform,this.route=this.host?this.host.route:null,this.state={},this.hosted=null,this.view=null,this.previousView=null,this.form=null,this.local=null,this.screen=null,this.remoteScreen_=null,this.navmaps=[],this.navmap=null,this.hasScreenViewItem=!1,this.remotes=[];(this.vrService=xo.getService()).status$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((t=>this.pushChanges())),this.resolveUser()}getName(t){return se.state.name||re.getName(t)}getLinkRole(){let t=null;if(this.isSelfServiceTour)return t=ie.SelfService,t;const e=((new re).link||"").match(/\d{9}-(\d{4})-\d{13}/);if(e){const s=parseInt(e[1]);t=Object.keys(ie).reduce(((t,e,i)=>i===s?ie[e]:t),null)}return t}resolveUser(){this.isEmbed?Is.temporaryUser$(ie.Embed).pipe(i.first()).subscribe((t=>{this.initWithUser(t)})):this.isSelfServiceTour?Is.overrideUser$(ie.SelfService).pipe(i.first()).subscribe((t=>{this.initWithUser(t)})):Is.me$().pipe(i.first()).subscribe((t=>{this.initWithUser(t)}))}userGuard(t){const e=this.getLinkRole();!t||e&&t.type!==e?this.initWithUser({type:e}):this.initWithUser(t)}userGuardRedirect(t){const e=this.getLinkRole();!t||e&&e!==t.type?e===ie.Publisher||e===ie.Attendee?ee.setRouterLink(we.transform(":lang.access")):this.initWithUser({type:e}):this.initWithUser(t)}setNextStatus(){let t=Ce;const e=se.state;return e.role===ie.SmartDevice&&(e.name=e.name||"Smart Device"),t=e.checklist?e.link?e.user.id||e.role!==ie.Publisher&&e.role!==ie.Attendee?e.name?e.role!==ie.Viewer&&e.role!==ie.SmartDevice?Ee:Le:Te:Se:ke:Me,se.patchState({status:t}),t}getPathId(){const t=new re;let e=t.pathId;if(e)return parseInt(e);const s=t.link;if(s){e=new ae(s).pathId}return e}initWithUser(t){const e=(new re).link,s=this.getPathId(),n=this.getLinkRole()||(t?t.type:null);if(n===ie.SelfService){if(!t||t.type!==ie.SelfService&&t.type!==ie.Publisher)return void ee.setRouterLink(we.transform(":lang.access"));t=Object.assign({},t,{type:ie.SelfService})}else n!==(t=t||{type:n}).type&&(t={type:n});const o=Is.getMode(n),a=this.getMeetingName(t),r=n===ie.Publisher,l=n!==ie.SelfService&&n!==ie.Embed&&!E,c=this.isNavigable,d={user:t,role:n,mode:o,name:a,checklist:null,pathId:s,link:e,channelName:U.channelName,uid:null,status:Ce,connecting:!1,connected:!1,controlling:!1,spying:!1,silencing:!1,hosted:r,live:l,navigable:c,cameraMuted:!1,audioMuted:!1,showNavInfo:!0};se.state=d,se.state$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((t=>{this.state=t,this.hosted=t.hosted,this.pushChanges(),this.locked?document.body.classList.add("locked"):document.body.classList.remove("locked")})),this.initAgora()}getMeetingName(t){const e=new re;let s=null;return s=U.flags.useExtendedUserInfo?e.firstName&&e.lastName?`${e.firstName} ${e.lastName}`:null:e.name?e.name:null,!s&&t.firstName&&t.lastName&&(s=`${t.firstName} ${t.lastName}`),s}viewObserver$(){return ln.data$().pipe(i.switchMap((t=>pi.getCurrentPath$(se.state.pathId).pipe(i.switchMap((e=>ln.hostedView$(t,e)))))),i.map((t=>{this.agora&&this.agora.navToView(t.id,t.keepOrientation,t.useLastOrientation),this.previousView=this.view,this.view=t,this.setNavmap(t),this.hasScreenViewItem=null!=t.items.find((t=>fn.isPublisherScreen(t)||fn.isAttendeeScreen(t))),this.pushChanges();const e=this.state;return Oi.push({action:"b-here-view",viewId:t.id,userType:e.role}),t})))}load(t){this.loadNavmaps(),this.viewObserver$().pipe(i.takeUntil(this.unsubscribe$)).subscribe((e=>{"function"==typeof t&&(t(),t=null)}))}loadNavmaps(){U.flags.navmaps&&Hi.navmapGet$().pipe(i.first()).subscribe((t=>{this.navmaps=t}))}setNavmap(t){const e=(this.navmaps||[]).find((e=>null!=(e.items||[]).find((e=>e.viewId===t.id))))||null;this.navmap=e}toggleNavmap(){se.patchState({showNavmap:!se.state.showNavmap})}onNavmapItem(t){se.patchState({showNavmap:!1}),this.onNavTo(t)}loadAndConnect(t){this.load((()=>{this.connect(t)}))}initAgora(){this.state.role===ie.SelfService||this.state.role===ie.Embed||E?(this.load((()=>{se.patchState({status:Ie,hosted:!0})})),this.checkSelfServiceProposition(),this.checkSelfServiceAudio()):ni.isChecked$().pipe(i.first()).subscribe((t=>{se.patchState({checklist:t}),this.agora=Ws.getSingleton(),this.getLinkRole(),this.setNextStatus()})),Zs.local$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((t=>{this.local=t,this.pushChanges()})),Zs.screen$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((t=>{this.screen===this.remoteScreen&&(this.remoteScreen=null),this.screen=t,this.remoteScreen=t||this.remoteScreen,this.pushChanges()})),Zs.orderedRemotes$().pipe(i.takeUntil(this.unsubscribe$)).subscribe((t=>{this.remotes=[],this.remoteScreen=this.screen,t.forEach((t=>{t.clientInfo&&t.clientInfo.screenUid===t.getId()?this.remoteScreen=t:this.remotes.push(t)})),this.pushChanges()})),Us.out$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((t=>{switch(t.type){case $e:if(this.isSelfServiceSupport){t.members.length>0?(Gi.open$({message:ge.transform("bhere_support_request_sent"),type:Bi,position:Vi}),Us.send({type:Ae})):Gi.open$({message:ge.transform("bhere_support_request_leaved"),type:Bi,position:Vi})}break;case Ae:this.isSelfServiceProposition&&this.openSupportRequestDialog(t.clientInfo);break;case Ve:t.type=je,t.clientInfo={role:se.state.role,name:se.state.name,uid:se.state.uid,screenUid:se.state.screenUid,controllingId:se.state.controlling,mode:se.state.mode},Us.sendBack(t);break;case Pe:Gi.open$({message:ge.transform("bhere_support_request_accepted"),type:Bi,position:Vi});break;case He:Gi.open$({message:ge.transform("bhere_support_request_rejected"),type:Bi,position:Vi});break;case Oe:t.type=Ue,Us.sendBack(t),se.patchState({controlling:t.controllingId}),this.agora&&this.agora.sendControlRemoteRequestInfo(t.controllingId);break;case We:se.patchState({silencing:t.silencing}),this.setAudio(t.silencing);break;case ns:this.onRemoteNavTo(t);break;case ss:se.patchState({mode:t.mode}),window.dispatchEvent(new Event("resize"));break;case is:this.hidePanels(),se.patchState({showNavInfo:t.showNavInfo});break;case Xe:ln.setViewLike$(t).pipe(i.first()).subscribe((t=>this.showLove(t)));break;case us:se.state.chat||se.patchState({chatDirty:!0})}})),Us.in$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((t=>{this.agora&&this.agora.sendMessage(t)})),this.fullscreen$().pipe(i.takeUntil(this.unsubscribe$)).subscribe(),this.agora&&se.state.status===Le&&this.loadAndConnect()}onChecked(t){se.patchState({checklist:!0}),this.setNextStatus()}onLink(t){const e=new ae(t).pathId,s=this.getLinkRole(),i=Is.getMode(s),n=se.state.user;s!==ie.Publisher&&s!==ie.Attendee||n.id&&n.type===s?se.state.name?s===ie.Viewer||s===ie.SmartDevice?(se.patchState({link:t,pathId:e,role:s,mode:i}),this.loadAndConnect()):se.patchState({link:t,pathId:e,role:s,mode:i,status:Ee}):se.patchState({link:t,pathId:e,role:s,mode:i,status:Te}):se.patchState({link:t,pathId:e,role:s,mode:i,status:Se})}onLogin(t){const e=this.getName(t);e?se.patchState({user:t,name:e,status:Ee}):se.patchState({user:t,status:Te})}onName(t){se.state.role===ie.Viewer||se.state.role===ie.SmartDevice?(se.patchState({name:t}),this.loadAndConnect()):se.patchState({name:t,status:Ee})}onEnter(t){this.loadAndConnect(t)}connect(t){this.agora.connect$(t).pipe(i.takeUntil(this.unsubscribe$)).subscribe();const e=this.state;if(e.role===ie.SelfService)Oi.push({action:"b-here-tour",userType:e.role});else if(e.role===ie.Embed)Oi.push({action:"b-here-embed",userType:e.role});else{const t=new re,s=e.link.replace(/-\d+-/,"-"),n={meetingId:e.link,sharedMeetingId:s,userType:e.role};U.flags.useExtendedUserInfo?(n.firstName=t.firstName,n.lastName=t.lastName,n.email=t.email):n.fullName=e.name,Is.log$(n).pipe(i.first()).subscribe(),Oi.push({action:"b-here-meeting",meetingId:e.link,sharedMeetingId:s,userType:e.role})}}disconnect(){this.agora?this.agora.leaveChannel().then((()=>{window.location.reload()}),console.log):this.patchState({connecting:!1,connected:!1})}onNavTo(t){const e=t.viewId,s=this.pathViews.find((t=>t.id===e));s&&(ln.action={viewId:e,keepOrientation:t.keepOrientation,useLastOrientation:t.useLastOrientation},this.onHandleHook(s,t))}onNavLink(t){ei.open$({iframe:t.link.href}).pipe(i.first()).subscribe((e=>{Us.send({type:rs,itemId:t.item.id})}))}onRemoteNavTo(t){const e=t.viewId,s=t.gridIndex;if(e&&ln.viewId!==e){const i=this.pathViews.find((t=>t.id===e));i&&(ln.action={viewId:e,keepOrientation:t.keepOrientation,useLastOrientation:t.useLastOrientation},null!=s&&i instanceof Ci&&(i.index=s))}}onHandleHook(t,e){if("ToggleWishlist"===e.hook){const s={viewId:t.id,itemId:e.id};dn.toggle$(s).pipe(i.switchMap((t=>(s.added=dn.has(s),As.send$(e.hook,s,e.extra)))),i.first()).subscribe((t=>{console.log("AgoraComponent.onHandleHook",t),e.added=s.added,this.pushChanges()}))}}patchState(t){this.state=Object.assign({},this.state,t),this.pushChanges()}toggleCamera(){this.agora?this.agora.toggleCamera():this.patchState({cameraMuted:!this.state.cameraMuted})}toggleAudio(){this.agora?this.agora.toggleAudio():this.patchState({audioMuted:!this.state.audioMuted})}setAudio(t){this.agora?this.agora.setAudio(t):this.patchState({audioMuted:t})}toggleScreen(){this.agora?this.agora.toggleScreen():this.patchState({screen:!this.state.screen}),window.dispatchEvent(new Event("resize"))}toggleVolume(){const t=!this.state.volumeMuted;se.patchState({volumeMuted:t});const e=this.selfServiceAudio;e&&(e.volume=t?0:.5)}toggleMode(){if(this.agora&&se.state.role===ie.Publisher)this.agora.toggleMode();else{const t=this.state.mode===gs?fs:gs;se.patchState({mode:t})}window.dispatchEvent(new Event("resize"))}toggleFullScreen(){const{node:e}=t.getContext(this);!this.state.fullScreen?e.requestFullscreen?e.requestFullscreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen():document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()}fullscreen$(){return s.fromEvent(document,"fullscreenchange").pipe(i.tap((t=>{const e=null!=document.fullscreenElement;se.patchState({fullScreen:e})})))}toggleChat(){se.patchState({chat:!se.state.chat,chatDirty:!1}),window.dispatchEvent(new Event("resize"))}onChatClose(){se.patchState({chat:!1}),window.dispatchEvent(new Event("resize"))}toggleNavInfo(){this.hidePanels(),this.agora?this.agora.toggleNavInfo():this.patchState({showNavInfo:!this.state.showNavInfo})}onBack(){this.previousView&&this.view&&this.previousView.id!==this.view.id&&(ln.action={viewId:this.previousView.id,useLastOrientation:!0})}hidePanels(){this.view.items.forEach((t=>t.showPanel=!1))}onToggleControl(t){if(this.agora)this.agora.toggleControl(t);else{const e=this.state.controlling===t?null:t;this.patchState({controlling:e,spying:!1})}}onToggleSilence(){this.agora?this.agora.toggleSilence():this.patchState({silencing:!this.state.silencing})}onToggleSpy(t){if(this.agora)this.agora.toggleSpy(t);else{const e=this.state.spying===t?null:t;this.patchState({spying:e,controlling:!1})}}addLike(){ln.viewLike$(this.view).pipe(i.first()).subscribe((t=>{t&&(this.view.liked=!0,this.showLove(t),Us.send({type:Xe,viewId:this.view.id,likes:this.view.likes}))}))}showLove(t){if(t&&this.view.id===t.id){const e=this.view.showLove;this.view.likes=t.likes,this.view.showLove=!0,this.pushChanges(),e||setTimeout((()=>{this.view.showLove=!1,this.pushChanges()}),3100)}}tryInAr(){this.platform===Ds||this.platform===zs?Zi.openInAR(this.view):ei.open$({template:Zi.chunk(),data:this.view}).pipe(i.first()).subscribe((t=>{}))}checkSelfServiceProposition(){this.isSelfServiceProposition&&ni.check$().pipe(i.first()).subscribe((t=>{const e=new ae({pathId:se.state.pathId}).toRoles(),s=new re({link:e.id,support:!0}),n=window.location.origin+s.toGuidedTourUrl();console.log("AgoraComponent.initAgora.isSelfServiceProposition",n),Is.selfServiceSupportRequest$(se.state.user,e.id,n).pipe(i.first()).subscribe((t=>{const s=this.getName(se.state.user);se.patchState({checklist:!0,link:e.idSelfService,name:s}),this.agora=Ws.getSingleton(),this.connect()}))}),(t=>{console.log("AgoraComponent.initAgora.isSelfServiceProposition.error",t,name)}))}checkSelfServiceAudio(){if(se.state.role===ie.SelfService&&U.selfServiceAudio){const e=document.createElement("audio");e.setAttribute("playsinline","true"),e.setAttribute("autoplay","true"),e.setAttribute("loop","true"),e.volume=.5,e.src=U.getPath(U.selfServiceAudio);const{node:s}=t.getContext(this);s.parentNode.appendChild(e),this.selfServiceAudio=e,fn.events$.pipe(i.tap((t=>{t instanceof un?e.pause():(t instanceof pn||t instanceof mn)&&e.play()})),i.takeUntil(this.unsubscribe$)).subscribe()}}openSupportRequestDialog(t){Gi.open$({message:ge.transform("bhere_support_request_dialog"),acceptMessage:ge.transform("bhere_support_request_dialog_accept"),rejectMessage:ge.transform("bhere_support_request_dialog_reject"),type:Di,position:Vi}).pipe(i.takeUntil(this.unsubscribe$)).subscribe((t=>{if(t instanceof Ni){Us.send({type:Pe});const t=se.state.name,e=new ae(se.state.link);e.role=ie.Streamer;const s={link:e.toString()};if(U.flags.useExtendedUserInfo){const t=se.state.user;s.firstName=t.firstName,s.lastName=t.lastName,s.email=t.email}else s.name=t;const i=new re(s).toGuidedTourUrl();setTimeout((()=>{window.location.href=i}),1e3)}else Us.send({type:He})}))}}Wa.meta={selector:"[agora-component]",hosts:{host:le},template:`\n\t<div class="page page--agora">\n\t\t${g}\n\t\t\x3c!-- Status Checklist --\x3e\n\t\t<div class="ui ui--info ui--info-centered" *if="state.status == 'checklist'" [agora-checklist] (checked)="onChecked($event)"></div>\n\t\t\x3c!-- Status Link --\x3e\n\t\t<div class="ui ui--info ui--info-centered" *if="state.status == 'link'" [agora-link] (link)="onLink($event)"></div>\n\t\t\x3c!-- Status Login --\x3e\n\t\t<div class="ui ui--info ui--info-centered" *if="state.status == 'login'" [agora-login] (login)="onLogin($event)"></div>\n\t\t\x3c!-- Status Name --\x3e\n\t\t<div class="ui ui--info ui--info-centered" *if="state.status == 'name' || (state.status == 'disconnected' && state.role === 'viewer')" [agora-name] (name)="onName($event)"></div>\n\t\t\x3c!-- Status Device --\x3e\n\t\t<div class="ui ui--info" *if="state.status == 'device' || (state.status == 'disconnected' && state.role !== 'viewer')" [agora-device] (enter)="onEnter($event)"></div>\n\t\t${x}\n\t\t\n\x3c!-- Smart Device --\x3e\n<div class="ui remotes" [class]="uiClass" *if="state.status == 'connected' && state.role == 'smart-device'">\n\t<div class="ui__body"></div>\n\t\x3c!-- remote sidebar --\x3e\n\t<div class="group--remote" [class]="'group--remote--' + remotes.length" *if="state.live">\n\t\t<div class="agora-stream" (toggleSpy)="onToggleSpy($event)" agora-stream [stream]="remote" type="remote" *for="let remote of remotes">\n\t\t\t<div class="agora-stream__player"></div>\n\t\t\t<div class="agora-stream__info">\n\t\t\t\t<svg class="cam-muted" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#cam-muted"></use></svg>\n\t\t\t\t<svg class="mic-muted" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#mic-muted"></use></svg>\n\t\t\t\t<div class="id" [innerHTML]="stream.clientInfo.name || streamId" *if="stream.clientInfo"></div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\t\x3c!-- remote screen --\x3e\n\t<div class="group--remote-screen" *if="remoteScreen && !hasScreenViewItem">\n\t\t<div class="agora-stream" agora-stream [stream]="remoteScreen" type="remote">\n\t\t\t<div class="agora-stream__player"></div>\n\t\t\t<div class="agora-stream__info">\n\t\t\t\t<div class="id" [innerHTML]="stream.clientInfo.name || streamId" *if="stream.clientInfo"></div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\t<div class="group--header">\n\t\t\n\x3c!-- local streams --\x3e\n<div class="group--local" [class]="{ publisher: state.role == 'publisher', viewer: state.role == 'viewer' }" *if="state.live">\n\t<div class="agora-stream" agora-stream [stream]="local" type="local" *if="local">\n\t\t<div class="agora-stream__player"></div>\n\t\t<div class="agora-stream__info">\n\t\t\t<svg class="cam-muted" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#cam-muted"></use></svg>\n\t\t\t<svg class="mic-muted" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#mic-muted"></use></svg>\n\t\t</div>\n\t</div>\n</div>\n\n\t</div>\n\t<div class="group--footer">\n\t\t\n\x3c!-- controls --\x3e\n<div class="group--controls" *if="state.live">\n\t<div class="group--actions">\n\t\t<button type="button" class="btn--call" [title]="'title_disconnect' | label" (click)="disconnect()">\n\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#call"></use></svg>\n\t\t</button>\n\t\t<button type="button" class="btn--cam" [title]="'title_mute_camera' | label" [class]="{ muted: state.cameraMuted, disabled: !local }" (click)="toggleCamera()">\n\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#cam"></use></svg>\n\t\t</button>\n\t\t<button type="button" class="btn--mic" [title]="'title_mute_mic' | label" [class]="{ muted: state.audioMuted, disabled: !local || silenced }" (click)="toggleAudio()">\n\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#mic"></use></svg>\n\t\t</button>\n\t</div>\n</div>\n\n\t</div>\n\t\n\x3c!-- members --\x3e\n<div class="group--members">\n\t<div class="members">\n\t\t<svg class="spy" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#users"></use></svg>\n\t\t<span class="members__count" [innerHTML]="state.membersCount"></span>\n\t</div>\n\t<div class="credits">\n\t\t<a class="btn--credits" href="https://www.websolute.com/" target="_blank" rel="noopener">\n\t\t\t<svg viewBox="0 0 270 98"><use xlink:href="#b-here"></use></svg>\n\t\t</a>\n\t</div>\n</div>\n\n</div>\n\n\t\t${C}\n\t\t${M}\n\t\t<header>\n\t\t\t${f}\n\t\t\t${y}\n\t\t</header>\n\t\t<footer *if="state.status != 'connected'">\n\t\t\t<span class="group--colophon">\n\t\t\t\t${b}\n\t\t\t\t${w}\n\t\t\t</span>\n\t\t\t<a [routerLink]="':lang.editor' | route" class="btn--absolute" *if="('editor' | flag) && !('deployed' | flag) && state.role == 'publisher' && (state.status == 'checklist' || state.status == 'link')">\n\t\t\t\t<span [innerHTML]="'bhere_editor' | label"></span> <svg class="edit" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#edit"></use></svg>\n\t\t\t</a>\n\t\t</footer>\n\t</div>\n\t`};class Ka{static assetCreate$(t){return _s.post$("/api/asset",t).pipe(i.map((t=>an(t))))}static assetUpdate$(t){return _s.put$(`/api/asset/${t.id}`,t).pipe(i.map((t=>an(t))))}static assetDelete$(t){return t&&t.id?_s.delete$(`/api/asset/${t.id}`).pipe(i.map((()=>null))):s.of(null)}static localizedAssetCreate$(t,e){return _s.post$(`/api/${t}/asset`,e).pipe(i.map((t=>an(t))))}static localizedAssetUpdate$(t,e){return _s.put$(`/api/${t}/asset/${e.id}`,e).pipe(i.map((t=>an(t))))}static upload$(t){const e=new FormData;t.forEach((t=>e.append("file",t,t.name)));const n=new XMLHttpRequest,o=s.merge(s.fromEvent(n.upload,"loadstart"),s.fromEvent(n.upload,"progress"),s.fromEvent(n.upload,"load"),s.fromEvent(n,"readystatechange")).pipe(i.map((t=>"readystatechange"===t.type&&4===n.readyState?JSON.parse(n.responseText):null)),i.filter((t=>null!==t)));return n.open("POST","/api/upload/",!0),n.send(e),o}static createOrUpdateAsset$(t,e){const s=t[0],i=on.fromUrl(s.url);return e.value&&e.value.id?(i.id=e.value.id,Ka.assetUpdate$(i)):Ka.assetCreate$(i)}static createOrUpdateLocalizedAsset$(t,e,s){const i=t[0],n=on.fromUrl(i.url);return e.value&&e.value.id?(n.id=e.value.id,Ka.localizedAssetUpdate$(s,n)):Ka.localizedAssetCreate$(s,n)}static assetDidChange(t,e){let s=null,i=null,n=null,o=null;return t&&(s=t.id,i=t.file),e&&(n=e.id,o=e.file),s!==n||i!==o}}class Xa{static data$(){return this.data$_||(this.data$_=_s.get$("/api/view").pipe(i.map((t=>(t.views=t.views.map((t=>_i(t))),t))),i.shareReplay(1))),this.data$_}static viewIdOptions$(){return this.data$().pipe(i.map((t=>{const e=t.views.filter((t=>t.type.name!==bi.WaitingRoom.name)).map((t=>({id:t.id,name:t.name})));return e.unshift({id:null,name:"select"}),e})))}static viewCreate$(t){return _s.post$("/api/view",t).pipe(i.map((t=>_i(t))))}static viewUpdate$(t){return _s.put$(`/api/view/${t.id}`,t.payload).pipe(i.map((t=>_i(t))))}static viewDelete$(t){return _s.delete$(`/api/view/${t.id}`)}static getTile(t){let e;return t.type.name===bi.PanoramaGrid.name&&(e=t.tiles[t.index]),e}static inferItemCreate$(t,e){const s=this.getTile(t);return s?this.tileItemCreate$(t,s,e):this.itemCreate$(t,e)}static inferItemUpdate$(t,e){const s=this.getTile(t);return s?this.tileItemUpdate$(t,s,e):this.itemUpdate$(t,e)}static inferItemDelete$(t,e){const s=this.getTile(t);return s?this.tileItemDelete$(t,s,e):this.itemDelete$(t,e)}static inferItemUpdateResult$(t,e){const s=this.getTile(t);let i;i=s?s.navs.find((t=>t.id===e.id)):t.items.find((t=>t.id===e.id)),i&&Object.assign(i,e)}static inferItemDeleteResult$(t,e){const s=this.getTile(t);let i;if(i=s?s.navs:t.items,i){const n=i.indexOf(e);-1!==n&&i.splice(n,1),s&&t.updateCurrentItems()}}static itemCreate$(t,e){return _s.post$(`/api/view/${t.id}/item`,e).pipe(i.map((t=>Ii(t))))}static itemUpdate$(t,e){return _s.put$(`/api/view/${t.id}/item/${e.id}`,e.payload).pipe(i.map((t=>Ii(t))))}static itemDelete$(t,e){return _s.delete$(`/api/view/${t.id}/item/${e.id}`)}static tileItemCreate$(t,e,s){return _s.post$(`/api/view/${t.id}/tile/${e.id}/item`,s).pipe(i.map((t=>Ii(t))))}static tileItemUpdate$(t,e,s){return _s.put$(`/api/view/${t.id}/tile/${e.id}/item/${s.id}`,s.payload).pipe(i.map((t=>Ii(t))))}static tileItemDelete$(t,e,s){return _s.delete$(`/api/view/${t.id}/tile/${e.id}/item/${s.id}`)}}class Ya extends t.Component{get data(){let e=null;const{parentInstance:s}=t.getContext(this);return s instanceof qi&&(e=s.modal.data),e}get view(){let t=null;const e=this.data;return e&&(t=e.view),t}get object(){const t=new THREE.Object3D,e=this.data;if(e){const s=e.hit.position.clone(),i=e.hit.normal.clone();e.hit.spherical?(s.normalize().multiplyScalar(20),t.position.copy(s),t.lookAt(wn.origin)):(t.lookAt(i),t.position.set(s.x,s.y,s.z),t.position.add(i.multiplyScalar(.01)))}return t}onInit(){const t=this.object,s=this.form=new e.FormGroup({type:wi.CurvedPlane,position:new e.FormControl(t.position.toArray(),e.RequiredValidator()),rotation:new e.FormControl(t.rotation.toArray(),e.RequiredValidator()),scale:new e.FormControl([1,1,1],e.RequiredValidator()),radius:new e.FormControl(35,e.RequiredValidator()),height:new e.FormControl(20,e.RequiredValidator()),arc:new e.FormControl(90,e.RequiredValidator()),asset:null});this.controls=s.controls,s.changes$.subscribe((t=>{this.pushChanges()}))}onSubmit(){if(this.form.valid){const t=Object.assign({},this.form.value);Xa.inferItemCreate$(this.view,t).pipe(i.first()).subscribe((t=>{ei.resolve(t)}),(t=>console.log("CurvedPlaneModalComponent.onSubmit.error",t)))}else this.form.touched=!0}onClose(){ei.reject()}}Ya.meta={selector:"[curved-plane-modal]",template:'\n\t\t<div class="modal__header">\n\t\t\t<button type="button" class="btn--close" (click)="onClose()">\n\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#close"></use></svg>\n\t\t\t</button>\n\t\t</div>\n\t\t<div class="container">\n\t\t\t<div class="form">\n\t\t\t\t<div class="title">Create Curved Plane.</div>\n\t\t\t\t<form [formGroup]="form" (submit)="onSubmit()" name="form" role="form" novalidate autocomplete="off">\n\t\t\t\t\t<div class="form-controls">\n\t\t\t\t\t\t\x3c!-- <div control-text [control]="controls.title" label="Title"></div> --\x3e\n\t\t\t\t\t\t<div control-vector [control]="controls.position" label="Position" [precision]="2" [disabled]="true"></div>\n\t\t\t\t\t\t<div control-vector [control]="controls.rotation" label="Rotation" [precision]="3" [increment]="Math.PI / 360" [disabled]="true"></div>\n\t\t\t\t\t\t\x3c!--\n\t\t\t\t\t\t<div control-vector [control]="controls.scale" label="Scale" [precision]="2" [disabled]="true"></div>\n\t\t\t\t\t\t<div control-number [control]="controls.radius" label="Radius" [precision]="2" [disabled]="true"></div>\n\t\t\t\t\t\t<div control-number [control]="controls.height" label="Height" [precision]="2" [disabled]="true"></div>\n\t\t\t\t\t\t<div control-number [control]="controls.arc" label="Arc" [precision]="0" [disabled]="true"></div>\n\t\t\t\t\t\t--\x3e\n\t\t\t\t\t\t<div control-localized-asset [control]="controls.asset" label="Image or Video" accept="image/jpeg, video/mp4"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="group--cta">\n\t\t\t\t\t\t<button type="submit" class="btn--accept">\n\t\t\t\t\t\t\t<span>Create</span>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</form>\n\t\t\t</div>\n\t\t</div>\n\t'},Ya.chunk=()=>'<div class="curved-plane-modal" curved-plane-modal></div>';class Ja extends t.Component{get data(){let e=null;const{parentInstance:s}=t.getContext(this);return s instanceof qi&&(e=s.modal.data),e}get view(){let t=null;const e=this.data;return e&&(t=e.view),t}get object(){const t=new THREE.Object3D,e=this.data;if(e){const s=e.hit.position.clone(),i=e.hit.normal.clone();e.hit.spherical?(s.normalize().multiplyScalar(4),t.position.copy(s),t.lookAt(wn.origin)):(t.lookAt(i),t.position.set(s.x,s.y,s.z),t.position.add(i.multiplyScalar(.01)))}return t}onInit(){const t=this.object,s=this.form=new e.FormGroup({type:wi.Model,position:new e.FormControl(t.position.toArray(),e.RequiredValidator()),rotation:new e.FormControl([0,0,0],e.RequiredValidator()),scale:new e.FormControl([1,1,1],e.RequiredValidator()),asset:new e.FormControl(null,e.RequiredValidator())});this.controls=s.controls,s.changes$.subscribe((t=>{this.pushChanges()}))}onSubmit(){if(this.form.valid){const t=Object.assign({},this.form.value);Xa.inferItemCreate$(this.view,t).pipe(i.first()).subscribe((t=>{ei.resolve(t)}),(t=>console.log("ItemModelModalComponent.onSubmit.error",t)))}else this.form.touched=!0}onClose(){ei.reject()}}Ja.meta={selector:"[item-model-modal]",template:'\n\t\t<div class="modal__header">\n\t\t\t<button type="button" class="btn--close" (click)="onClose()">\n\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#close"></use></svg>\n\t\t\t</button>\n\t\t</div>\n\t\t<div class="container">\n\t\t\t<div class="form">\n\t\t\t\t<div class="title">Create Model Item.</div>\n\t\t\t\t<form [formGroup]="form" (submit)="onSubmit()" name="form" role="form" novalidate autocomplete="off">\n\t\t\t\t\t<div class="form-controls">\n\t\t\t\t\t\t<div control-vector [control]="controls.position" label="Position" [precision]="2" [disabled]="true"></div>\n\t\t\t\t\t\t<div control-vector [control]="controls.rotation" label="Rotation" [precision]="3" [increment]="Math.PI / 360" [disabled]="true"></div>\n\t\t\t\t\t\t<div control-vector [control]="controls.scale" label="Scale" [precision]="2" [disabled]="true"></div>\n\t\t\t\t\t\t<div control-model [control]="controls.asset" label="Model (.glb)" accept=".glb"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="group--cta">\n\t\t\t\t\t\t<button type="submit" class="btn--accept">\n\t\t\t\t\t\t\t<span>Create</span>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</form>\n\t\t\t</div>\n\t\t</div>\n\t'},Ja.chunk=()=>'<div class="item-model-modal" item-model-modal></div>';class Qa extends t.Component{onInit(){this.error=null;const t=this.form=new e.FormGroup({type:bi.Media,name:new e.FormControl(null,e.RequiredValidator()),asset:new e.FormControl(null,e.RequiredValidator())});this.controls=t.controls,t.changes$.subscribe((t=>{this.pushChanges()}))}onSubmit(){if(this.form.valid){this.form.submitted=!0;const t=this.form.value,e={type:t.type,name:t.name,asset:t.asset,orientation:{latitude:0,longitude:0},zoom:75};return Xa.viewCreate$(e).pipe(i.switchMap((e=>{const s={type:wi.Plane,position:[20,0,0],rotation:[0,-Math.PI/2,0],scale:[12,6.75,1],asset:t.asset};return Xa.itemCreate$(e,s).pipe(i.map((t=>(e.items=[t],e))))})),i.first()).subscribe((t=>{ei.resolve(t)}),(t=>{console.log("MediaModalComponent.onSubmit.error",t),this.error=t,this.form.reset()}))}this.form.touched=!0}onClose(){ei.reject()}}Qa.meta={selector:"[media-modal]",template:'\n\t\t<div class="modal__header">\n\t\t\t<button type="button" class="btn--close" (click)="onClose()">\n\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#close"></use></svg>\n\t\t\t</button>\n\t\t</div>\n\t\t<div class="container">\n\t\t\t<div class="form">\n\t\t\t\t<div class="title">Create Media.</div>\n\t\t\t\t<form [formGroup]="form" (submit)="onSubmit()" name="form" role="form" novalidate autocomplete="off">\n\t\t\t\t\t<div class="form-controls">\n\t\t\t\t\t\t<div control-text [control]="controls.name" label="Name"></div>\n\t\t\t\t\t\t<div control-asset [control]="controls.asset" label="Image or Video" accept="image/jpeg, video/mp4"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="group--cta">\n\t\t\t\t\t\t<button type="submit" class="btn--accept">\n\t\t\t\t\t\t\t<span>Create</span>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</form>\n\t\t\t</div>\n\t\t</div>\n\t'},Qa.chunk=()=>'<div class="media-modal" media-modal></div>';class tr extends t.Component{onInit(){this.error=null;const t=this.form=new e.FormGroup({type:bi.Model,name:new e.FormControl(null,e.RequiredValidator()),asset:new e.FormControl(null,e.RequiredValidator()),model:new e.FormControl(null,e.RequiredValidator())});this.controls=t.controls,t.changes$.subscribe((t=>{this.pushChanges()}))}onSubmit(){if(this.form.valid){this.form.submitted=!0;const t=this.form.value,e={type:t.type,name:t.name,asset:t.asset,orientation:{latitude:0,longitude:0},zoom:75};return Xa.viewCreate$(e).pipe(i.switchMap((e=>{const s={type:wi.Model,asset:t.model};return Xa.itemCreate$(e,s).pipe(i.map((t=>(e.items=[t],e))))})),i.first()).subscribe((t=>{ei.resolve(t)}),(t=>{console.log("ModelModalComponent.onSubmit.error",t),this.error=t,this.form.reset()}))}this.form.touched=!0}onClose(){ei.reject()}}tr.meta={selector:"[model-modal]",template:'\n\t\t<div class="modal__header">\n\t\t\t<button type="button" class="btn--close" (click)="onClose()">\n\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#close"></use></svg>\n\t\t\t</button>\n\t\t</div>\n\t\t<div class="container">\n\t\t\t<div class="form">\n\t\t\t\t<div class="title">Create Model View.</div>\n\t\t\t\t<form [formGroup]="form" (submit)="onSubmit()" name="form" role="form" novalidate autocomplete="off">\n\t\t\t\t\t<div class="form-controls">\n\t\t\t\t\t\t<div control-text [control]="controls.name" label="Name"></div>\n\t\t\t\t\t\t<div control-asset [control]="controls.asset" label="Image" accept="image/jpeg"></div>\n\t\t\t\t\t\t<div control-model [control]="controls.model" label="Model (.glb)" accept=".glb"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="group--cta">\n\t\t\t\t\t\t<button type="submit" class="btn--accept">\n\t\t\t\t\t\t\t<span>Create</span>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</form>\n\t\t\t</div>\n\t\t</div>\n\t'},tr.chunk=()=>'<div class="model-modal" model-modal></div>';class er extends t.Component{get data(){let e=null;const{parentInstance:s}=t.getContext(this);return s instanceof qi&&(e=s.modal.data),e}get view(){let t=null;const e=this.data;return e&&(t=e.view),t}get position(){let t=null;const e=this.data;return e&&(t=e.hit.position),t}get object(){const t=new THREE.Object3D,e=this.data;if(e){const s=e.hit.position.clone(),i=e.hit.normal.clone();e.hit.spherical?(s.normalize().multiplyScalar(Za.RADIUS),t.position.copy(s),t.lookAt(wn.origin)):(t.lookAt(i),t.position.set(s.x,s.y,s.z),t.position.add(i.multiplyScalar(.01)))}return t}onInit(){const t=this.object;this.error=null,this.useHooks=As.enabled;const s=this.form=new e.FormGroup({type:wi.Nav,title:null,abstract:null,viewId:null,hook:null,hookExtra:null,keepOrientation:!1,important:!1,transparent:!1,position:new e.FormControl(t.position.toArray(),e.RequiredValidator()),rotation:new e.FormControl(t.rotation.toArray(),e.RequiredValidator()),scale:new e.FormControl([20,5,1],e.RequiredValidator()),asset:null,link:new e.FormGroup({title:new e.FormControl(null),href:new e.FormControl(null),target:"_blank"})});if(this.controls=s.controls,As.enabled){const t=U.webhook.methods.nav.map((t=>({id:t,name:t})));t.unshift({id:null,name:"select"}),this.controls.hook.options=t}s.changes$.subscribe((t=>{this.pushChanges()})),Xa.viewIdOptions$().pipe(i.first()).subscribe((t=>{this.controls.viewId.options=t,this.pushChanges()}))}onSubmit(){if(this.form.valid){this.form.submitted=!0;const t=Object.assign({},this.form.value);t.viewId=t.viewId?parseInt(t.viewId):this.view.id,!t.link||t.link.title&&t.link.href||(t.link=null),Xa.inferItemCreate$(this.view,t).pipe(i.first()).subscribe((t=>{ei.resolve(t)}),(t=>{console.log("NavModalComponent.onSubmit.error",t),this.error=t,this.form.submitted=!1}))}else this.form.touched=!0}onViewIdDidChange(t){if(null!=t&&U.flags.navAutoUpdateTitle){const e=this.controls.viewId.options,s=e.find((e=>e.id===t));if(null!=s){const t=s.name,i=this.form.value.title;i&&!e.find((t=>t.name===i))||this.form.patch({title:t})}}}onClose(){ei.reject()}}er.meta={selector:"[nav-modal]",template:'\n\t\t<div class="modal__header">\n\t\t\t<button type="button" class="btn--close" (click)="onClose()">\n\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#close"></use></svg>\n\t\t\t</button>\n\t\t</div>\n\t\t<div class="container">\n\t\t\t<div class="form">\n\t\t\t\t<div class="title">Create Nav.</div>\n\t\t\t\t<form [formGroup]="form" (submit)="onSubmit()" name="form" role="form" novalidate autocomplete="off">\n\t\t\t\t\t<div class="form-controls">\n\t\t\t\t\t\t<div control-text [control]="controls.title" label="Title"></div>\n\t\t\t\t\t\t<div control-textarea [control]="controls.abstract" label="Abstract"></div>\n\t\t\t\t\t\t<div control-custom-select [control]="controls.viewId" label="NavToView" (change)="onViewIdDidChange($event)"></div>\n\t\t\t\t\t\t<div control-checkbox [control]="controls.keepOrientation" label="Keep Orientation"></div>\n\t\t\t\t\t\t<div control-checkbox [control]="controls.important" label="Important"></div>\n\t\t\t\t\t\t<div control-checkbox [control]="controls.transparent" label="Transparent"></div>\n\t\t\t\t\t\t<div control-vector [control]="controls.position" label="Position" [precision]="3" [disabled]="true"></div>\n\t\t\t\t\t\t<div *if="controls.transparent.value == true">\n\t\t\t\t\t\t\t<div control-vector [control]="controls.rotation" label="Rotation" [precision]="3" [increment]="Math.PI / 360" [disabled]="true"></div>\n\t\t\t\t\t\t\t<div control-vector [control]="controls.scale" label="Scale" [precision]="2" [disabled]="true"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div control-asset [control]="controls.asset" label="Image" accept="image/png, image/jpeg"></div>\n\t\t\t\t\t\t<div control-text [control]="controls.link.controls.title" label="Link Title"></div>\n\t\t\t\t\t\t<div control-text [control]="controls.link.controls.href" label="Link Url"></div>\n\t\t\t\t\t\t<div control-custom-select [control]="controls.hook" label="Hook" *if="useHooks"></div>\n\t\t\t\t\t\t<div control-text [control]="controls.hookExtra" label="Hook Extra" *if="useHooks"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="group--cta">\n\t\t\t\t\t\t<button type="submit" class="btn--accept">\n\t\t\t\t\t\t\t<span>Create</span>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</form>\n\t\t\t</div>\n\t\t</div>\n\t'},er.chunk=()=>'<div class="nav-modal" nav-modal></div>';class sr extends t.Component{onInit(){this.error=null;const t=this.form=new e.FormGroup({type:bi.PanoramaGrid,name:new e.FormControl(null,e.RequiredValidator()),assets:new e.FormControl(null,e.RequiredValidator())});this.controls=t.controls,t.changes$.subscribe((t=>{this.pushChanges()}))}onSubmit(){if(this.form.valid){this.form.submitted=!0;const t=this.form.value.assets,e=Ci.mapTiles(t.map((t=>({asset:t,navs:[]}))),!1,!0);e.sort(((t,e)=>1e4*t.indices.x+t.indices.y-(1e4*e.indices.x+e.indices.y)));const s=e[0].asset,n={type:this.form.value.type,name:this.form.value.name,asset:s,tiles:e,invertAxes:!0,flipAxes:!1,orientation:{latitude:0,longitude:0},zoom:75};Xa.viewCreate$(n).pipe(i.first()).subscribe((t=>{ei.resolve(t)}),(t=>{console.log("PanoramaGridModalComponent.onSubmit.error",t),this.error=t,this.form.reset()}))}else this.form.touched=!0}onClose(){ei.reject()}}sr.meta={selector:"[panorama-grid-modal]",template:'\n\t\t<div class="modal__header">\n\t\t\t<button type="button" class="btn--close" (click)="onClose()">\n\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#close"></use></svg>\n\t\t\t</button>\n\t\t</div>\n\t\t<div class="container">\n\t\t\t<div class="form">\n\t\t\t\t<div class="title">Create Panorama Grid.</div>\n\t\t\t\t<form [formGroup]="form" (submit)="onSubmit()" name="form" role="form" novalidate autocomplete="off">\n\t\t\t\t\t<div class="form-controls">\n\t\t\t\t\t\t<div control-text [control]="controls.name" label="Name"></div>\n\t\t\t\t\t\t<div control-assets [control]="controls.assets" label="Image" accept="image/jpeg"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="group--cta">\n\t\t\t\t\t\t<button type="submit" class="btn--accept">\n\t\t\t\t\t\t\t<span>Create</span>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</form>\n\t\t\t</div>\n\t\t</div>\n\t'},sr.chunk=()=>'<div class="panorama-grid-modal" panorama-grid-modal></div>';class ir extends t.Component{onInit(){this.error=null;const t=this.form=new e.FormGroup({type:bi.Panorama,name:new e.FormControl(null,e.RequiredValidator()),asset:new e.FormControl(null,e.RequiredValidator())});this.controls=t.controls,t.changes$.subscribe((t=>{this.pushChanges()}))}onSubmit(){if(this.form.valid){this.form.submitted=!0;const t=this.form.value,e={type:t.type,name:t.name,asset:t.asset,orientation:{latitude:0,longitude:0},zoom:75};return Xa.viewCreate$(e).pipe(i.first()).subscribe((t=>{ei.resolve(t)}),(t=>{console.log("PanoramaModalComponent.onSubmit.error",t),this.error=t,this.form.reset()}))}this.form.touched=!0}onClose(){ei.reject()}}ir.meta={selector:"[panorama-modal]",template:'\n\t\t<div class="modal__header">\n\t\t\t<button type="button" class="btn--close" (click)="onClose()">\n\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#close"></use></svg>\n\t\t\t</button>\n\t\t</div>\n\t\t<div class="container">\n\t\t\t<div class="form">\n\t\t\t\t<div class="title">Create Panorama.</div>\n\t\t\t\t<form [formGroup]="form" (submit)="onSubmit()" name="form" role="form" novalidate autocomplete="off">\n\t\t\t\t\t<div class="form-controls">\n\t\t\t\t\t\t<div control-text [control]="controls.name" label="Name"></div>\n\t\t\t\t\t\t<div control-asset [control]="controls.asset" label="Image or Video" accept="image/jpeg, video/mp4"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="group--cta">\n\t\t\t\t\t\t<button type="submit" class="btn--accept">\n\t\t\t\t\t\t\t<span>Create</span>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t\t\x3c!--\n\t\t\t\t\t<div class="group--form group--form--fixed">\n\t\t\t\t\t\t<code [innerHTML]="form.value | json"></code>\n\t\t\t\t\t\t<button type="button" class="btn--test" (click)="test()"><span>test</span></button>\n\t\t\t\t\t</div>\n\t\t\t\t\t--\x3e\n\t\t\t\t</form>\n\t\t\t</div>\n\t\t</div>\n\t'},ir.chunk=()=>'<div class="panorama-modal" panorama-modal></div>';class nr extends t.Component{onInit(){const{parentInstance:s}=t.getContext(this);s instanceof qi&&(this.data=s.modal.data),this.error=null;const i=this.form=new e.FormGroup({name:new e.FormControl(null,e.RequiredValidator())});this.controls=i.controls,i.changes$.subscribe((t=>{this.pushChanges()}))}onSubmit(){if(this.form.valid){this.form.submitted=!0;const t={name:this.form.value.name,items:this.data?this.data.item.items:[]};return pi.pathCreate$(t).pipe(i.first()).subscribe((t=>{ei.resolve(t)}),(t=>{console.log("PathAddModalComponent.onSubmit.error",t),this.error=t,this.form.reset()}))}this.form.touched=!0}onClose(){ei.reject()}}nr.meta={selector:"[path-add-modal]",template:'\n\t\t<div class="modal__header">\n\t\t\t<button type="button" class="btn--close" (click)="onClose()">\n\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#close"></use></svg>\n\t\t\t</button>\n\t\t</div>\n\t\t<div class="container">\n\t\t\t<div class="form">\n\t\t\t\t<div class="title">Add Path.</div>\n\t\t\t\t<div class="description">Aggiungi un percorso</div>\n\t\t\t\t<form [formGroup]="form" (submit)="onSubmit()" name="form" role="form" novalidate autocomplete="off">\n\t\t\t\t\t<div class="form-controls">\n\t\t\t\t\t\t<div control-text [control]="controls.name" label="Name"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="group--cta">\n\t\t\t\t\t\t<button type="submit" class="btn--accept">\n\t\t\t\t\t\t\t<span>Create</span>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</form>\n\t\t\t</div>\n\t\t</div>\n\t'},nr.chunk=()=>'<div class="panorama-modal" path-add-modal></div>';class or extends t.Component{onInit(){this.item=null,this.views=null;const{parentInstance:s}=t.getContext(this);if(s instanceof qi){const t=s.modal.data;t&&(this.item=t.item?t.item:null,this.views=this.parseViews(t.views,this.item))}this.error=null;const i=this.form=new e.FormGroup({name:new e.FormControl(this.item?this.item.name:null,e.RequiredValidator())});this.controls=i.controls,i.changes$.subscribe((t=>{this.pushChanges()}))}parseViews(t,e){return t&&e?t.map((t=>({id:t.id,name:t.name,type:t.type,active:-1===e.items.indexOf(t.id)}))):[]}onToggleView(t){t.active=!t.active,this.pushChanges()}onSubmit(){if(this.form.valid){this.form.submitted=!0;const t=this.form.value,e={id:this.item.id,name:t.name,items:this.views.filter((t=>!t.active)).map((t=>t.id))};return pi.pathUpdate$(e).pipe(i.first()).subscribe((t=>{ei.resolve(t)}),(t=>{console.log("PathEditModalComponent.onSubmit.error",t),this.error=t,this.form.reset()}))}this.form.touched=!0}onSelectAll(){this.views.forEach((t=>t.active=!0)),this.pushChanges()}onSelectNone(){this.views.forEach((t=>t.active=!1)),this.pushChanges()}onClose(){ei.reject()}}or.meta={selector:"[path-edit-modal]",template:'\n\t\t<div class="modal__header">\n\t\t\t<button type="button" class="btn--close" (click)="onClose()">\n\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#close"></use></svg>\n\t\t\t</button>\n\t\t</div>\n\t\t<div class="container">\n\t\t\t<div class="form">\n\t\t\t\t<div class="title">Edit Path <span *if="item">&ldquo;<span [innerHTML]="item.title || item.name"></span>&rdquo;</span>.</div>\n\t\t\t\t<div class="description">Modifica il percorso</div>\n\t\t\t\t<form [formGroup]="form" (submit)="onSubmit()" name="form" role="form" novalidate autocomplete="off">\n\t\t\t\t\t<div class="form-controls">\n\t\t\t\t\t\t<div control-text [control]="controls.name" label="Name"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<ul class="nav--flag" *if="views">\n\t\t\t\t\t\t<li class="nav__item" *for="let view of views">\n\t\t\t\t\t\t\t<button type="button" class="btn--flag" [class]="{ active: view.active }" [title]="view.name" (click)="onToggleView(view)">\n\t\t\t\t\t\t\t\t<div class="icon">\n\t\t\t\t\t\t\t\t\t<svg-icon [name]="view.type.name"></svg-icon>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<span class="name" [innerHTML]="view.name"></span>\n\t\t\t\t\t\t\t\t<span class="flag">\n\t\t\t\t\t\t\t\t\t<svg class="check" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#check"></use></svg>\n\t\t\t\t\t\t\t\t\t<svg class="close" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#close"></use></svg>\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t</ul>\n\t\t\t\t\t<div class="group--cta">\n\t\t\t\t\t\t<div class="group--options">\n\t\t\t\t\t\t\t<button type="button" class="btn--link" (click)="onSelectAll()">\n\t\t\t\t\t\t\t\t<span>Select all</span>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t<button type="button" class="btn--link" (click)="onSelectNone()">\n\t\t\t\t\t\t\t\t<span>Select none</span>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<button type="submit" class="btn--accept">\n\t\t\t\t\t\t\t<span>Save</span>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</form>\n\t\t\t</div>\n\t\t</div>\n\t'},or.chunk=()=>'<div class="path-edit-modal" path-edit-modal></div>';class ar extends t.Component{get data(){let e=null;const{parentInstance:s}=t.getContext(this);return s instanceof qi&&(e=s.modal.data),e}get view(){let t=null;const e=this.data;return e&&(t=e.view),t}get object(){const t=new THREE.Object3D,e=this.data;if(e){const s=e.hit.position.clone(),i=e.hit.normal.clone();e.hit.spherical?(s.normalize().multiplyScalar(20),t.position.copy(s),t.lookAt(wn.origin)):(t.lookAt(i),t.position.set(s.x,s.y,s.z),t.position.add(i.multiplyScalar(.01)))}return t}onInit(){const t=this.object,s=this.form=new e.FormGroup({type:wi.Plane,position:new e.FormControl(t.position.toArray(),e.RequiredValidator()),rotation:new e.FormControl(t.rotation.toArray(),e.RequiredValidator()),scale:new e.FormControl([12,6.75,1],e.RequiredValidator()),asset:null});this.controls=s.controls,s.changes$.subscribe((t=>{this.pushChanges()}))}onSubmit(){if(this.form.valid){const t=Object.assign({},this.form.value);Xa.inferItemCreate$(this.view,t).pipe(i.first()).subscribe((t=>{ei.resolve(t)}),(t=>console.log("PlaneModalComponent.onSubmit.error",t)))}else this.form.touched=!0}onClose(){ei.reject()}}ar.meta={selector:"[plane-modal]",template:'\n\t\t<div class="modal__header">\n\t\t\t<button type="button" class="btn--close" (click)="onClose()">\n\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#close"></use></svg>\n\t\t\t</button>\n\t\t</div>\n\t\t<div class="container">\n\t\t\t<div class="form">\n\t\t\t\t<div class="title">Create Plane.</div>\n\t\t\t\t<form [formGroup]="form" (submit)="onSubmit()" name="form" role="form" novalidate autocomplete="off">\n\t\t\t\t\t<div class="form-controls">\n\t\t\t\t\t\t\x3c!-- <div control-text [control]="controls.title" label="Title"></div> --\x3e\n\t\t\t\t\t\t<div control-vector [control]="controls.position" label="Position" [precision]="2" [disabled]="true"></div>\n\t\t\t\t\t\t<div control-vector [control]="controls.rotation" label="Rotation" [precision]="3" [increment]="Math.PI / 360" [disabled]="true"></div>\n\t\t\t\t\t\t<div control-vector [control]="controls.scale" label="Scale" [precision]="2" [disabled]="true"></div>\n\t\t\t\t\t\t<div control-localized-asset [control]="controls.asset" label="Image or Video" accept="image/jpeg, video/mp4"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="group--cta">\n\t\t\t\t\t\t<button type="submit" class="btn--accept">\n\t\t\t\t\t\t\t<span>Create</span>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</form>\n\t\t\t</div>\n\t\t</div>\n\t'},ar.chunk=()=>'<div class="plane-modal" plane-modal></div>';class rr extends t.Component{get data(){let e=null;const{parentInstance:s}=t.getContext(this);return s instanceof qi&&(e=s.modal.data),e}get item(){let t=null;const e=this.data;return e&&(t=e.item),t}onRemove(){ei.resolve()}onCancel(){ei.reject()}onClose(){ei.reject()}}rr.meta={selector:"[remove-modal]",template:'\n\t\t<div class="modal__header">\n\t\t\t<button type="button" class="btn--close" (click)="onClose()">\n\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#close"></use></svg>\n\t\t\t</button>\n\t\t</div>\n\t\t<div class="container">\n\t\t\t<div class="form">\n\t\t\t\t<div class="title">Remove <span *if="item">&ldquo;<span [innerHTML]="item.title || item.name"></span>&rdquo;</span>.</div>\n\t\t\t\t<div class="abstract">are you sure?</div>\n\t\t\t\t<div class="group--cta">\n\t\t\t\t\t<button type="button" class="btn--remove" (click)="onRemove($event)">\n\t\t\t\t\t\t<span>Remove</span>\n\t\t\t\t\t</button>\n\t\t\t\t\t<button type="button" class="btn--accept" (click)="onCancel($event)">\n\t\t\t\t\t\t<span>Cancel</span>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t'},rr.chunk=()=>'<div class="remove-modal" remove-modal></div>';class lr extends t.Component{onInit(){this.error=null;const t=this.form=new e.FormGroup({type:bi.Room3d,name:new e.FormControl(null,e.RequiredValidator()),asset:new e.FormControl(null,e.RequiredValidator())});this.controls=t.controls,t.changes$.subscribe((t=>{this.pushChanges()}))}onSubmit(){if(this.form.valid){this.form.submitted=!0;const t=this.form.value,e={type:t.type,name:t.name,asset:t.asset,orientation:{latitude:0,longitude:0},zoom:75};return Xa.viewCreate$(e).pipe(i.first()).subscribe((t=>{ei.resolve(t)}),(t=>{console.log("Room3DModalComponent.onSubmit.error",t),this.error=t,this.form.reset()}))}this.form.touched=!0}onClose(){ei.reject()}}lr.meta={selector:"[room-3d-modal]",template:'\n\t\t<div class="modal__header">\n\t\t\t<button type="button" class="btn--close" (click)="onClose()">\n\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#close"></use></svg>\n\t\t\t</button>\n\t\t</div>\n\t\t<div class="container">\n\t\t\t<div class="form">\n\t\t\t\t<div class="title">Create Room 3D View.</div>\n\t\t\t\t<form [formGroup]="form" (submit)="onSubmit()" name="form" role="form" novalidate autocomplete="off">\n\t\t\t\t\t<div class="form-controls">\n\t\t\t\t\t\t<div control-text [control]="controls.name" label="Name"></div>\n\t\t\t\t\t\t\x3c!--\n\t\t\t\t\t\t<div control-asset [control]="controls.asset" label="Image" accept="image/jpeg"></div>\n\t\t\t\t\t\t<div control-model [control]="controls.model" label="Model (.glb)" accept=".glb"></div>\n\t\t\t\t\t\t--\x3e\n\t\t\t\t\t\t<div control-model [control]="controls.asset" label="Model (.glb)" accept=".glb"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="group--cta">\n\t\t\t\t\t\t<button type="submit" class="btn--accept">\n\t\t\t\t\t\t\t<span>Create</span>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</form>\n\t\t\t</div>\n\t\t</div>\n\t'},lr.chunk=()=>'<div class="room-3d-modal" room-3d-modal></div>';const cr={menu:[{id:"menu",title:"editor_menu",active:!0},{id:"navmaps",title:"editor_navmaps",active:!0}],current:null,active:!1};class dr extends t.Component{get dataViews(){return ln.dataViews}get pathViews(){return ln.pathViews}onInit(){const{node:e}=t.getContext(this);e.classList.remove("hidden"),this.settings=this.getSettings(),this.aside=!1,this.state={},this.view=null,this.paths=null,this.path=null,this.form=null,this.local=null,this.remotes=[],this.viewHit=new s.Subject;(this.vrService=xo.getService()).status$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((t=>this.pushChanges())),this.resolveUser()}resolveUser(){Is.me$().pipe(i.takeUntil(this.unsubscribe$)).subscribe((t=>{t&&t.type===ie.Publisher?(this.user=t,this.initState()):ee.setRouterLink(we.transform(":lang.access"))}))}initState(){const t=this.user,e={user:t,role:t.type,name:t.firstName&&t.lastName?`${t.firstName} ${t.lastName}`:null,mode:gs,link:null,channelName:U.channelName,uid:null,status:Ie,connecting:!1,connected:!0,controlling:!1,spying:!1,silencing:!1,hosted:!0,live:!1,navigable:!0,cameraMuted:!1,audioMuted:!1,showNavInfo:!0};se.state=e,se.state$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((t=>{this.state=t,this.hosted=t.hosted,this.pushChanges()})),this.viewObserver$().pipe(i.takeUntil(this.unsubscribe$)).subscribe((t=>{})),Zs.mode=qs}viewObserver$(){return Xa.data$().pipe(i.switchMap((t=>{const e=(new re).pathId;return pi.getCurrentPath$(e).pipe(i.switchMap((e=>(this.paths=pi.paths,this.path=e,ln.editorView$(t,e)))))})),i.tap((t=>{this.view=null,this.pushChanges()})),i.delay(1),i.tap((t=>{this.view=t,this.pushChanges()})))}onAddPath(){ei.open$({template:nr.chunk()}).pipe(i.first()).subscribe((t=>{t instanceof Qs&&pi.addPath(t.data)}))}onEditPath(t){ei.open$({template:or.chunk(),data:{item:t,views:ln.validViews}}).pipe(i.first()).subscribe((t=>{t instanceof Qs&&pi.editPath(t.data)}))}onDuplicatePath(t){ei.open$({template:nr.chunk(),data:{item:t}}).pipe(i.first()).subscribe((t=>{t instanceof Qs&&pi.addPath(t.data)}))}onDeletePath(t){ei.open$({template:rr.chunk(),data:{item:t}}).pipe(i.first()).subscribe((e=>{e instanceof Qs&&pi.pathDelete$(t).pipe(i.first()).subscribe((e=>{pi.deletePath(t)}))}))}onSelectPath(t){pi.path=t}isPathSelected(t){return pi.path.id===t.id}onNavTo(t){const e=t.viewId;ln.pathViews.find((t=>t.id===e))&&(ln.action={viewId:e,keepOrientation:t.keepOrientation,useLastOrientation:t.useLastOrientation})}onNavLink(t){ei.open$({iframe:t.link.href}).pipe(i.first()).subscribe((e=>{Us.send({type:rs,itemId:t.item.id})}))}patchState(t){this.state=Object.assign({},this.state,t),this.pushChanges()}tryInAr(){ei.open$({template:Zi.chunk(),data:this.view}).pipe(i.first()).subscribe((t=>{}))}onToggleAside(){this.aside=!this.aside,this.pushChanges(),window.dispatchEvent(new Event("resize"))}getSettings(){const t=Object.assign({},cr);return t.menu=t.menu.filter((t=>U.flags[t.id])),t.current=t.menu.length?t.menu[0].id:null,t}onToggleSettings(){const t=this.settings;t.active=!t.active,this.pushChanges()}onSelectSetting(t){this.settings.current=t.id,this.pushChanges()}onViewHit(t){this.viewHit.next(t)}onViewHitted(t){this.viewHitSubscription&&(this.viewHitSubscription.unsubscribe(),this.viewHitSubscription=null),"function"==typeof t&&(this.viewHitSubscription=this.viewHit.pipe(i.first()).subscribe((e=>t(e))))}onDragEnd(t){Xa.inferItemUpdate$(this.view,t.item).pipe(i.first()).subscribe((t=>{this.pushChanges()}),(e=>console.log("EditorComponent.onDragEnd.inferItemUpdate$.error",e,this.view,t.item,t.item.payload)))}onResizeEnd(t){}onWorldSelect(t){if(this.view){let e;this.view.items.forEach((t=>t.showPanel=!1)),this.view.items.forEach((s=>{s.selected=s===t.item,e=s.selected?s:e})),this.view.selected=!e,this.pushChanges(),e&&(this.aside=!0,this.pushChanges(),window.dispatchEvent(new Event("resize")))}}onOpenModal(t,e){let s=null;switch(t.type){case"view":switch(t.value){case bi.Panorama.name:s=ir.chunk();break;case bi.PanoramaGrid.name:s=sr.chunk();break;case bi.Model.name:s=tr.chunk();break;case bi.Room3d.name:s=lr.chunk();break;case bi.Media.name:s=Qa.chunk()}break;case"viewItem":switch(t.value){case wi.Nav.name:s=er.chunk();break;case wi.Plane.name:s=ar.chunk();break;case wi.CurvedPlane.name:s=Ya.chunk();break;case wi.Model.name:s=Ja.chunk()}}s&&ei.open$({template:s,data:e}).pipe(i.first()).subscribe((e=>{if(e instanceof Qs)switch(t.type){case"view":switch(t.value){case bi.Panorama.name:case bi.PanoramaGrid.name:case bi.Model.name:case bi.Room3d.name:case bi.Media.name:ln.addView(e.data)}break;case"viewItem":switch(t.value){case wi.Nav.name:case wi.Plane.name:case wi.CurvedPlane.name:case wi.Model.name:const t=e.data,s=Xa.getTile(this.view);if(s){const e=s.navs||[];e.push(t),s.navs=e,this.view.updateCurrentItems()}else{t.path=!0;const e=this.view.items||[];e.push(t),this.view.items=e}this.pushChanges()}}this.pushChanges()}))}onAsideSelect(t){if(t.value)switch(t.value){case wi.Nav.name:case wi.Plane.name:case wi.CurvedPlane.name:this.onViewHitted((e=>{this.onOpenModal(t,{view:this.view,hit:e})})),Gi.open$({message:"Click a point on the view"});break;case wi.Model.name:if("viewItem"===t.type){if(this.view.type.name===bi.Model.name)return;this.onViewHitted((e=>{this.onOpenModal(t,{view:this.view,hit:e})})),Gi.open$({message:"Click a point on the view"})}else this.onOpenModal(t,{view:this.view});break;default:this.onOpenModal(t,{view:this.view})}else if(t.view&&(t.item||null===t.item))t.view.selected=!1,t.view.items.forEach((e=>e.selected=e===t.item)),Us.send({type:vs}),this.pushChanges();else if(t.view&&(t.tile||null===t.tile))t.view.selected=!1,t.view.tiles.forEach((e=>e.selected=e===t.tile)),Us.send({type:vs}),this.pushChanges();else if(t.view||null===t.view){this.view.selected=this.view===t.view,this.view.items.forEach((t=>t.selected=!1));const e=Xa.getTile(this.view);e&&this.view.tiles.forEach((t=>t.selected=t===e)),Us.send({type:vs}),this.pushChanges()}}onAsideUpdate(t){if(t.item&&t.view)this.pushChanges();else if(t.tile&&t.view);else if(t.view)if(ln.viewId!==t.view.id)ln.viewId=t.view.id;else{const e=Ka.assetDidChange(this.view.asset,t.view.asset);Object.assign(this.view,t.view),e&&"function"==typeof this.view.onUpdateAsset&&this.view.onUpdateAsset(),this.pushChanges()}}onAsideDelete(t){t.item&&t.view?Xa.inferItemDelete$(t.view,t.item).pipe(i.first()).subscribe((e=>{Xa.inferItemDeleteResult$(t.view,t.item),this.pushChanges()}),(t=>console.log("EditorComponent.onAsideDelete.inferItemDelete$.error",t))):t.view&&Xa.viewDelete$(t.view).pipe(i.first()).subscribe((e=>{ln.deleteView(t.view)}),(t=>console.log("EditorComponent.onAsideDelete.viewDelete$.error",t)))}}dr.meta={selector:"[editor-component]",hosts:{host:le},template:'\n\t<div class="page page--editor">\n\t\t<div class="ui" [class]="{ open: aside }" *if="dataViews.length">\n\t\t\t<div class="ui__navbar">\n\t\t\t\t<div class="btn--settings" [class]="{ active: settings.active }" (click)="onToggleSettings($event)" *if="settings.menu.length > 0">\n\t\t\t\t\t<svg class="settings" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#settings-full"></use></svg>\n\t\t\t\t</div>\n\t\t\t\t<div class="headline" *if="view">\n\t\t\t\t\t<div class="headline__id" [innerHTML]="view.id"></div>\n\t\t\t\t\t<div class="headline__icon">\n\t\t\t\t\t\t<svg-icon [name]="view.type.name"></svg-icon>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="headline__name" [innerHTML]="view.name"></div>\n\t\t\t\t</div>\n\t\t\t\t<div class="group--path" *if="(\'usePaths\' | flag) && path">\n\t\t\t\t\t<div class="group--path__select">\n\t\t\t\t\t\t<div class="group--form--select" [dropdown]="\'path\'">\n\t\t\t\t\t\t\t<label>Percorso</label>\n\t\t\t\t\t\t\t<span class="control--custom-select" [innerHTML]="path.name"></span>\n\t\t\t\t\t\t\t<svg class="icon--caret-down"><use xlink:href="#caret-down"></use></svg>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="dropdown dropdown-item" [dropdown-item]="\'path\'">\n\t\t\t\t\t\t\t<div class="category">Percorso</div>\n\t\t\t\t\t\t\t<ul class="nav--dropdown">\n\t\t\t\t\t\t\t\t<li [class]="{ active: isPathSelected(item) }" *for="let item of paths">\n\t\t\t\t\t\t\t\t\t<span [innerHTML]="item.name" (click)="onSelectPath(item)"></span>\n\t\t\t\t\t\t\t\t\t<div class="check">\n\t\t\t\t\t\t\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#check"></use></svg>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class="btn--flags" (click)="onEditPath(item)" title="Edit" *if="item.id">\n\t\t\t\t\t\t\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#flags"></use></svg>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class="btn--duplicate" (click)="onDuplicatePath(item)" title="Duplicate" *if="item.id">\n\t\t\t\t\t\t\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#duplicate"></use></svg>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class="btn--trash" (click)="onDeletePath(item)" title="Delete" *if="item.id">\n\t\t\t\t\t\t\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#trash"></use></svg>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t\t<div class="btn--mode" (click)="onAddPath()">Aggiungi un percorso</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="btn--edit" [class]="{ active: aside }" (click)="onToggleAside($event)">\n\t\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#edit"></use></svg>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="ui__body">\n\t\t\t\t<div class="world" world [view]="view" [views]="pathViews" [editor]="true" (navTo)="onNavTo($event)" (viewHit)="onViewHit($event)" (dragEnd)="onDragEnd($event)" (select)="onWorldSelect($event)"></div>\n\t\t\t</div>\n\t\t\t\x3c!-- footer --\x3e\n\t\t\t<div class="group--footer">\n\t\t\t\t<div class="group--ar-vr">\n\t\t\t\t\t<button type="button" class="btn--ar" [href]="view?.ar" (click)="tryInAr()" *if="view?.ar">\n\t\t\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#ar"></use></svg> <span>Try in AR</span>\n\t\t\t\t\t</button>\n\t\t\t\t\t<button type="button" class="btn--vr" [class]="{ disabled: vrService.isDisabled() }" (click)="vrService.toggleVR()">\n\t\t\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#vr"></use></svg> <span [innerHTML]="vrService.getLabel()"></span>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="ui__settings" *if="settings.active">\n\t\t\t\t\x3c!-- settings navs --\x3e\n\t\t\t\t<div class="group--nav">\n\t\t\t\t\t<ul class="nav--menu">\n\t\t\t\t\t\t<li class="nav__item" *for="let item of settings.menu" [class]="{ active: settings.current === item.id }" (click)="onSelectSetting(item)"><span class="title" [innerHTML]="item.title | label"></span></li>\n\t\t\t\t\t</ul>\n\t\t\t\t</div>\n\t\t\t\t\x3c!-- menu --\x3e\n\t\t\t\t<div class="group--content" menu-builder [views]="dataViews" *if="settings.current === \'menu\'"></div>\n\t\t\t\t\x3c!-- navmaps --\x3e\n\t\t\t\t<div class="group--content" navmap-builder [views]="dataViews" *if="settings.current === \'navmaps\'"></div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="aside" [class]="{ active: aside }" aside [view]="view" (select)="onAsideSelect($event)" (update)="onAsideUpdate($event)" (delete)="onAsideDelete($event)" *if="view && aside"></div>\n\t</div>\n\t'};class hr{static currentLanguagePage$(t){return be.lang$.pipe(i.switchMap((e=>this.page$(e,t))))}static page$(t,e){const s=U.flags.production?`/api/${t}/pages/${e}/`:`./api/${t}/pages/${e}.json`;return _s.get$(s)}}class ur extends t.Component{onInit(){this.route=this.host?this.host.route:null,this.state={status:"generic"},this.page=null,hr.currentLanguagePage$(this.route.params.mode).pipe(i.takeUntil(this.unsubscribe$)).subscribe((t=>{this.page=t,this.pushChanges()}))}}ur.meta={selector:"[generic-component]",hosts:{host:le},template:`\n\t\t<div class="page page--generic">\n\t\t\t\x3c!-- generic --\x3e\n\t\t\t<div class="ui ui--generic" *if="page">\n\t\t\t\t<div class="group--generic">\n\t\t\t\t\t<div class="group--generic__content stagger--childs">\n\t\t\t\t\t\t<h1 class="title" [innerHTML]="page.title"></h1>\n\t\t\t\t\t\t<div class="description" [innerHTML]="page.description"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<header>\n\t\t\t\t${f}\n\t\t\t\t${y}\n\t\t\t</header>\n\t\t\t<footer>\n\t\t\t\t<span class="group--colophon" *if="state.status != 'connected'">\n\t\t\t\t\t${b}\n\t\t\t\t\t${w}\n\t\t\t\t</span>\n\t\t\t</footer>\n\t\t</div>\n\t`};class pr extends t.Component{get meetingUrl(){return this.meetingUrl_||(this.meetingUrl_=new re),this.meetingUrl_}get isVirtualTourUser(){return-1!==[ie.Publisher,ie.Attendee,ie.Streamer,ie.Viewer].indexOf(this.state.role)}get isEmbed(){if(this.route)return"embed"===this.route.params.mode}get isSelfServiceTour(){if(this.route)return"selfServiceTour"===this.route.params.mode}get isNavigable(){return null==this.meetingUrl.embedViewId}get isBackButtonVisible(){return this.view&&(this.view.type.name===bi.Media.name||this.view.type.name===bi.Model.name)}get showNavInfoToggler(){return U.flags.hideNavInfo&&this.state.mode!==fs}get uiClass(){const t={};return t[this.state.role]=!0,t.chat=this.state.chat,t.remotes=this.state.mode===fs,t.remoteScreen=null!=this.remoteScreen&&!this.hasScreenViewItem,t.media=!t.remotes&&this.media,t.locked=this.locked,t}get remoteClass(){return`group--remote--${Math.min(9,this.remotes.length)}`}get controlled(){return this.state.controlling&&this.state.controlling!==this.state.uid}get controlling(){return this.state.controlling&&this.state.controlling===this.state.uid}get silencing(){return se.state.silencing}get silenced(){return se.state.silencing&&se.state.role===ie.Streamer}get spyed(){return this.state.spying&&this.state.spying===this.state.uid}get spying(){return this.state.spying&&this.state.spying!==this.state.uid}get locked(){return this.controlled||this.spying}get remoteScreen(){return this.remoteScreen_}set remoteScreen(t){this.remoteScreen_!==t&&(this.remoteScreen_=t,window.dispatchEvent(new Event("resize")))}onInit(){const t=this.meetingUrl.embedViewId;this.state={status:fe.get("status")||Ie,role:fe.get("role")||ie.Publisher,membersCount:3,controlling:!1,spying:!1,silencing:!1,hosted:!0,chat:!1,chatDirty:!0,name:"Jhon Appleseed",uid:"7341614597544882",showNavInfo:!0},this.state.live=this.state.role!==ie.SelfService&&this.state.role!==ie.Embed&&!E,this.state.navigable=null==t,this.state.mode=Is.getMode(this.state.role),this.view={likes:41,type:{id:2,name:"panorama"}},this.local={},this.screen=null,this.remoteScreen_=null,this.media=null,this.hasScreenViewItem=!1,this.media=!0,this.remotes=new Array(8).fill(0).map(((t,e)=>({id:e+1}))),this.languageService=be,this.showLanguages=!1,se.patchState(this.state),this.fullscreen$().pipe(i.takeUntil(this.unsubscribe$)).subscribe(),this.vrService=xo.getService(),console.log("LayoutComponent",this),setTimeout((()=>{const t=Di;switch(t){case Ui:Gi.open$({message:ge.transform("bhere_support_request_sent")}).pipe(i.takeUntil(this.unsubscribe$)).subscribe((t=>{t instanceof Ni&&console.log("ToastResolveEvent",t)}));break;case Bi:Gi.open$({message:ge.transform("bhere_support_request_sent"),type:t,position:Vi}).pipe(i.takeUntil(this.unsubscribe$)).subscribe((t=>{t instanceof Ni?console.log("ToastResolveEvent",t):t instanceof Fi&&console.log("ToastRejectEvent",t)}));break;case Di:Gi.open$({message:ge.transform("bhere_support_request_dialog"),acceptMessage:ge.transform("bhere_support_request_dialog_accept"),rejectMessage:ge.transform("bhere_support_request_dialog_reject"),type:t,position:Vi}).pipe(i.takeUntil(this.unsubscribe$)).subscribe((t=>{t instanceof Ni?console.log("ToastResolveEvent",t):t instanceof Fi&&console.log("ToastRejectEvent",t)}))}}),3e3)}setLanguage(t){this.languageService.setLanguage$(t).pipe(first()).subscribe((t=>{this.showLanguages=!1,this.pushChanges()}))}toggleLanguages(){this.showLanguages=!this.showLanguages,this.pushChanges()}patchState(t){this.state=Object.assign({},this.state,t),this.screen=this.state.screen||null,this.remoteScreen=this.screen,this.pushChanges()}toggleCamera(){this.patchState({cameraMuted:!this.state.cameraMuted})}toggleAudio(){this.patchState({audioMuted:!this.state.audioMuted})}toggleScreen(){this.patchState({screen:!this.state.screen}),window.dispatchEvent(new Event("resize"))}toggleVolume(){this.patchState({volumeMuted:!this.state.volumeMuted})}toggleMode(){const t=this.state.mode===gs?fs:gs;this.patchState({mode:t})}toggleFullScreen(){const{node:e}=t.getContext(this);!this.state.fullScreen?e.requestFullscreen?e.requestFullscreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen():document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()}fullscreen$(){return s.fromEvent(document,"fullscreenchange").pipe(i.tap((t=>{const e=null!=document.fullscreenElement;this.patchState({fullScreen:e})})))}toggleChat(){this.patchState({chat:!this.state.chat,chatDirty:!1}),window.dispatchEvent(new Event("resize"))}toggleNavInfo(){this.patchState({showNavInfo:!this.state.showNavInfo})}onBack(){console.log("LayoutComponent.onBack")}onChatClose(){this.patchState({chat:!1}),window.dispatchEvent(new Event("resize"))}onToggleControl(t){const e=this.state.controlling===t?null:t;this.patchState({controlling:e,spying:!1})}onToggleSilence(){this.patchState({silencing:!this.state.silencing})}onToggleSpy(t){const e=this.state.spying===t?null:t;this.patchState({spying:e,controlling:!1})}addLike(){this.view.liked=!0,this.showLove(this.view)}showLove(t){if(t&&this.view.id===t.id){const e=this.view.showLove;this.view.likes=t.likes,this.view.showLove=!0,this.pushChanges(),e||setTimeout((()=>{this.view.showLove=!1,this.pushChanges()}),3100)}}disconnect(){}}pr.meta={selector:"[layout-component]",hosts:{host:le},template:`\n\t<div class="page page--agora">\n\t\t${g}\n\t\t\x3c!-- Status Checklist --\x3e\n\t\t<div class="ui ui--info ui--info-centered" *if="state.status == 'checklist'" [agora-checklist] (checked)="onChecked($event)"></div>\n\t\t\x3c!-- Status Link --\x3e\n\t\t<div class="ui ui--info ui--info-centered" *if="state.status == 'link'" [agora-link] (link)="onLink($event)"></div>\n\t\t\x3c!-- Status Login --\x3e\n\t\t<div class="ui ui--info ui--info-centered" *if="state.status == 'login'" [agora-login] (login)="onLogin($event)"></div>\n\t\t\x3c!-- Status Name --\x3e\n\t\t<div class="ui ui--info ui--info-centered" *if="state.status == 'name' || (state.status == 'disconnected' && state.role === 'viewer')" [agora-name] (name)="onName($event)"></div>\n\t\t\x3c!-- Status Device --\x3e\n\t\t<div class="ui ui--info" *if="state.status == 'device' || (state.status == 'disconnected' && state.role !== 'viewer')" [agora-device] (enter)="onEnter($event)"></div>\n\t\t\x3c!-- Virtual Tour --\x3e\n\t\t<div class="ui virtual-tour" [class]="uiClass" *if="state.status == 'connected' && isVirtualTourUser">\n\t\t\t\x3c!-- world --\x3e\n\t\t\t<div class="ui__body">\n\t\t\t\t<div class="world"></div>\n\t\t\t</div>\n\t\t\t\x3c!-- remote sidebar --\x3e\n\t\t\t<div class="group--remote" [class]="remoteClass" *if="state.live">\n\t\t\t\t<div class="agora-stream" *for="let remote of remotes">\n\t\t\t\t\t<div class="agora-stream__player"></div>\n\t\t\t\t\t<div class="agora-stream__info" [class]="{ spyed: state.spying == remote.id, controlling: state.controlling == remote.id }">\n\t\t\t\t\t\t<svg class="cam-muted" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#cam-muted"></use></svg>\n\t\t\t\t\t\t<svg class="mic-muted" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#mic-muted"></use></svg>\n\t\t\t\t\t\t<div class="id">name</div>\n\t\t\t\t\t\t<button type="button" class="btn--control" [title]="'title_control' | label" (click)="onToggleControl(remote.id)" *if="state.role === 'publisher'">\n\t\t\t\t\t\t\t<svg class="control" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#control"></use></svg>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t\t<button type="button" class="btn--spy" [title]="'title_spy' | label" (click)="onToggleSpy(remote.id)" *if="state.role === 'publisher'">\n\t\t\t\t\t\t\t<svg class="spy" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#spy"></use></svg>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="group--members" *if="state.mode == 'virtual-tour'">\n\t\t\t\t\t<div class="members">\n\t\t\t\t\t\t<svg class="spy" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#users"></use></svg>\n\t\t\t\t\t\t<span class="members__count" [innerHTML]="state.membersCount"></span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="credits">\n\t\t\t\t\t\t<a class="btn--credits" href="https://www.websolute.com/" target="_blank" rel="noopener">\n\t\t\t\t\t\t\t<svg viewBox="0 0 270 98"><use xlink:href="#b-here"></use></svg>\n\t\t\t\t\t\t</a>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t\x3c!-- remote screen --\x3e\n\t\t\t<div class="group--remote-screen" *if="remoteScreen">\n\t\t\t\t<div class="agora-stream">\n\t\t\t\t\t<div class="agora-stream__player"></div>\n\t\t\t\t\t<div class="agora-stream__info">\n\t\t\t\t\t\t<div class="id">name</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="group--header">\n\t\t\t\t\x3c!-- service --\x3e\n\t\t\t\t<div class="group--service">\n\t\t\t\t\t<button type="button" class="btn--back" [title]="'title_back' | label" (click)="onBack($event)" *if="isBackButtonVisible">\n\t\t\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#arrow-prev"></use></svg>\n\t\t\t\t\t</button>\n\t\t\t\t\t<button type="button" class="btn--view-mode" [title]="'title_view_mode' | label" (click)="toggleMode($event)" *if="state.mode != 'embed'">\n\t\t\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24" *if="state.mode == 'virtual-tour'"><use xlink:href="#live-meeting"></use></svg>\n\t\t\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24" *if="state.mode == 'live-meeting'"><use xlink:href="#virtual-tour"></use></svg>\n\t\t\t\t\t</button>\n\t\t\t\t\t<button type="button" class="btn--volume" [title]="'title_volume' | label" [class]="{ muted: state.volumeMuted }" (click)="toggleVolume($event)">\n\t\t\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24" *if="!state.volumeMuted"><use xlink:href="#volume-on"></use></svg>\n\t\t\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24" *if="state.volumeMuted"><use xlink:href="#volume-off"></use></svg>\n\t\t\t\t\t</button>\n\t\t\t\t\t<button type="button" class="btn--fullscreen" [title]="'title_fullscreen' | label" [class]="{ muted: state.fullScreen }" (click)="toggleFullScreen($event)">\n\t\t\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24" *if="!state.fullScreen"><use xlink:href="#fullscreen-on"></use></svg>\n\t\t\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24" *if="state.fullScreen"><use xlink:href="#fullscreen-off"></use></svg>\n\t\t\t\t\t</button>\n\t\t\t\t\t<button type="button" class="btn--navmap" [title]="'title_navmap' | label" [class]="{ active: state.showNavmap }" (click)="toggleNavmap($event)" *if="navmap && state.mode != 'live-meeting'">\n\t\t\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#navmap"></use></svg>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t\t\x3c!-- local streams --\x3e\n\t\t\t\t<div class="group--local" [class]="{ publisher: state.role == 'publisher', viewer: state.role == 'viewer' }" *if="state.live">\n\t\t\t\t\t<button type="button" class="btn--silence" [title]="'title_silence' | label" [class]="{ active: state.silencing }" (click)="onToggleSilence()" *if="state.role === 'publisher'">\n\t\t\t\t\t\t<svg class="mic-muted" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#mic-muted"></use></svg>\n\t\t\t\t\t</button>\n\t\t\t\t\t<button type="button" class="btn--control" [title]="'title_control' | label" [class]="{ active: state.controlling == state.uid }" (click)="onToggleControl(state.uid)" *if="state.role == 'publisher'">\n\t\t\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#control"></use></svg>\n\t\t\t\t\t</button>\n\t\t\t\t\t<div class="agora-stream" *if="!local"></div>\n\t\t\t\t\t<div class="agora-stream" *if="local">\n\t\t\t\t\t\t<div class="agora-stream__player"></div>\n\t\t\t\t\t\t<div class="agora-stream__info">\n\t\t\t\t\t\t\t<svg class="cam-muted" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#cam-muted"></use></svg>\n\t\t\t\t\t\t\t<svg class="mic-muted" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#mic-muted"></use></svg>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="agora-stream agora-stream--screen" *if="screen">\n\t\t\t\t\t\t<div class="agora-stream__player"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="group--footer">\n\t\t\t\t${c}\n\t\t\t\t${d}\n\t\t\t\t${h}\n\t\t\t\t${u}\n\t\t\t</div>\n\t\t\t\x3c!-- members --\x3e\n\t\t\t<div class="group--members" *if="state.mode == 'live-meeting'">\n\t\t\t\t<div class="members">\n\t\t\t\t\t<svg class="spy" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#users"></use></svg>\n\t\t\t\t\t<span class="members__count" [innerHTML]="state.membersCount"></span>\n\t\t\t\t</div>\n\t\t\t\t<div class="credits">\n\t\t\t\t\t<a class="btn--credits" href="https://www.websolute.com/" target="_blank" rel="noopener">\n\t\t\t\t\t\t<svg viewBox="0 0 270 98"><use xlink:href="#b-here"></use></svg>\n\t\t\t\t\t</a>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t${p}\n\t\t\t${m}\n\t\t\t${v}\n\t\t</div>\n\t\t\x3c!-- Smart Device --\x3e\n\t\t<div class="ui remotes" [class]="uiClass" *if="state.status == 'connected' && state.role == 'smart-device'">\n\t\t\t\x3c!-- world --\x3e\n\t\t\t<div class="ui__body">\n\t\t\t</div>\n\t\t\t\x3c!-- remote sidebar --\x3e\n\t\t\t<div class="group--remote" [class]="remoteClass" *if="state.live">\n\t\t\t\t<div class="agora-stream" *for="let remote of remotes">\n\t\t\t\t\t<div class="agora-stream__player"></div>\n\t\t\t\t\t<div class="agora-stream__info">\n\t\t\t\t\t\t<svg class="cam-muted" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#cam-muted"></use></svg>\n\t\t\t\t\t\t<svg class="mic-muted" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#mic-muted"></use></svg>\n\t\t\t\t\t\t<div class="id">name</div>\n\t\t\t\t\t\t<button type="button" class="btn--spy" [title]="'title_spy' | label" *if="state.role === 'publisher'" (click)="onToggleSpy(remote.id)">\n\t\t\t\t\t\t\t<svg class="spy" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#spy"></use></svg>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t\x3c!-- remote screen --\x3e\n\t\t\t<div class="group--remote-screen" *if="remoteScreen">\n\t\t\t\t<div class="agora-stream">\n\t\t\t\t\t<div class="agora-stream__player"></div>\n\t\t\t\t\t<div class="agora-stream__info">\n\t\t\t\t\t\t<div class="id">name</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t\x3c!-- local streams --\x3e\n\t\t\t<div class="group--local" [class]="{ publisher: state.role == 'publisher', viewer: state.role == 'viewer' }" *if="state.live">\n\t\t\t\t<div class="agora-stream" *if="local">\n\t\t\t\t\t<div class="agora-stream__player"></div>\n\t\t\t\t\t<div class="agora-stream__info">\n\t\t\t\t\t\t<svg class="cam-muted" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#cam-muted"></use></svg>\n\t\t\t\t\t\t<svg class="mic-muted" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#mic-muted"></use></svg>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t\x3c!-- controls --\x3e\n\t\t\t<div class="group--controls" *if="state.live">\n\t\t\t\t<div class="group--actions">\n\t\t\t\t\t<button type="button" class="btn--call" [title]="'title_disconnect' | label" (click)="disconnect()">\n\t\t\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#call"></use></svg>\n\t\t\t\t\t</button>\n\t\t\t\t\t<button type="button" class="btn--cam" [title]="'title_mute_camera' | label" [class]="{ muted: state.cameraMuted, disabled: !local }" (click)="toggleCamera()">\n\t\t\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#cam"></use></svg>\n\t\t\t\t\t</button>\n\t\t\t\t\t<button type="button" class="btn--mic" [title]="'title_mute_mic' | label" [class]="{ muted: state.audioMuted, disabled: !local || silenced }" (click)="toggleAudio()">\n\t\t\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#mic"></use></svg>\n\t\t\t\t\t</button>\n\t\t\t\t\t<button type="button" class="btn--screen" [title]="'title_share_screen' | label" [class]="{ active: screen }" (click)="toggleScreen()" *if="('screenShare' | flag) && (state.role == 'publisher' || state.role == 'attendee' || controlling)">\n\t\t\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#screen"></use></svg>\n\t\t\t\t\t</button>\n\t\t\t\t\t<button type="button" class="btn--chat" [title]="'title_chat' | label" [class]="{ active: state.chatDirty }" (click)="toggleChat()" *if="('chat' | flag)">\n\t\t\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#chat"></use></svg>\n\t\t\t\t\t</button>\n\t\t\t\t\t<button type="button" class="btn--navinfo" [title]="'title_navinfo' | label" [class]="{ active: state.showNavInfo }" (click)="toggleNavInfo()" *if="showNavInfoToggler">\n\t\t\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#navinfo"></use></svg>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t\x3c!-- members --\x3e\n\t\t\t<div class="group--members">\n\t\t\t\t<div class="members">\n\t\t\t\t\t<svg class="spy" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#users"></use></svg>\n\t\t\t\t\t<span class="members__count" [innerHTML]="state.membersCount"></span>\n\t\t\t\t</div>\n\t\t\t\t<div class="credits">\n\t\t\t\t\t<a class="btn--credits" href="https://www.websolute.com/" target="_blank" rel="noopener">\n\t\t\t\t\t\t<svg viewBox="0 0 270 98"><use xlink:href="#b-here"></use></svg>\n\t\t\t\t\t</a>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t\x3c!-- Self Service Tour --\x3e\n\t\t<div class="ui" [class]="uiClass" *if="state.status == 'connected' && state.mode == 'self-service-tour'">\n\t\t\t\x3c!-- world --\x3e\n\t\t\t<div class="ui__body">\n\t\t\t\t<div class="world"></div>\n\t\t\t</div>\n\t\t\t\x3c!-- service --\x3e\n\t\t\t<div class="group--service">\n\t\t\t\t<button type="button" class="btn--volume" [title]="'title_volume' | label" [class]="{ muted: state.volumeMuted }" (click)="toggleVolume($event)">\n\t\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24" *if="!state.volumeMuted"><use xlink:href="#volume-on"></use></svg>\n\t\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24" *if="state.volumeMuted"><use xlink:href="#volume-off"></use></svg>\n\t\t\t\t</button>\n\t\t\t\t<button type="button" class="btn--fullscreen" [title]="'title_fullscreen' | label" [class]="{ muted: state.fullScreen }" (click)="toggleFullScreen($event)">\n\t\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24" *if="!state.fullScreen"><use xlink:href="#fullscreen-on"></use></svg>\n\t\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24" *if="state.fullScreen"><use xlink:href="#fullscreen-off"></use></svg>\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t\t${h}\n\t\t\t${u}\n\t\t</div>\n\t\t\x3c!-- Embed --\x3e\n\t\t<div class="ui" [class]="uiClass" *if="state.status == 'connected' && state.mode == 'embed'">\n\t\t\t\x3c!-- world --\x3e\n\t\t\t<div class="ui__body">\n\t\t\t\t<div class="world"></div>\n\t\t\t</div>\n\t\t\t\x3c!-- service --\x3e\n\t\t\t<div class="group--service">\n\t\t\t\t<button type="button" class="btn--volume" [title]="'title_volume' | label" [class]="{ muted: state.volumeMuted }" (click)="toggleVolume($event)">\n\t\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24" *if="!state.volumeMuted"><use xlink:href="#volume-on"></use></svg>\n\t\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24" *if="state.volumeMuted"><use xlink:href="#volume-off"></use></svg>\n\t\t\t\t</button>\n\t\t\t\t<button type="button" class="btn--fullscreen" [title]="'title_fullscreen' | label" [class]="{ muted: state.fullScreen }" (click)="toggleFullScreen($event)">\n\t\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24" *if="!state.fullScreen"><use xlink:href="#fullscreen-on"></use></svg>\n\t\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24" *if="state.fullScreen"><use xlink:href="#fullscreen-off"></use></svg>\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t\t${h}\n\t\t\t${u}\n\t\t</div>\n\t\t<a class="btn--logo" [routerLink]="':lang.access' | route" *if="state.status != 'connected'">\n\t\t\t<img [src]="'logo' | env" *if="'logo' | env" />\n\t\t\t<svg viewBox="0 0 270 98" *if="!('logo' | env)"><use xlink:href="#b-here"></use></svg>\n\t\t</a>\n\t\t<a class="btn--credits" href="https://www.websolute.com/" target="_blank" rel="noopener" *if="state.status != 'connected'">\n\t\t\t<svg viewBox="0 0 270 98"><use xlink:href="#b-here"></use></svg>\n\t\t</a>\n\t\t<div class="group--language" language *if="state.status != 'connected'"></div>\n\t</div>\n\t`};class mr extends t.Component{get viewId(){if(this.route){const t=this.route.params.viewId;return t?parseInt(t):null}}onInit(){this.platform=Ns.platform,this.route=this.host?this.host.route:null,this.missingAr=!1,this.missingUsdz=!1,this.missingGltf=!1;const e=this.viewId;e&&ln.viewById$(e).pipe(i.first()).subscribe((e=>{if(!e.ar)return this.missingAr=!0,void this.pushChanges();if(this.platform===Ds){const t=this.getUsdzSrc(e);t?window.location.href=t:(this.missingUsdz=!0,this.pushChanges())}else if(null!==this.getGltfSrc(e)){const s=this.getModelViewerNode(e),{node:i}=t.getContext(this);i.appendChild(s),this.addARScripts()}else this.missingGltf=!0,this.pushChanges()}))}addARScripts(){let t=document.createElement("script");t.setAttribute("type","module"),t.setAttribute("src","https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"),document.head.appendChild(t),t=document.createElement("script"),t.setAttribute("nomodule",""),t.setAttribute("src","https://unpkg.com/@google/model-viewer/dist/model-viewer-legacy.js"),document.head.appendChild(t)}getUsdzSrc(t){return t.ar&&t.ar.usdz?U.getPath(t.ar.usdz.folder+t.ar.usdz.file):null}getGltfSrc(t){return t.ar&&t.ar.gltf?U.getPath(t.ar.gltf.folder+t.ar.gltf.file):null}getViewId(){const t=new re;let e=null;return t.viewId&&(e=parseInt(t.viewId)),e}getModelViewerNode(t){const e=U.getPath(t.asset.folder+t.asset.file),s=this.getUsdzSrc(t),i=this.getGltfSrc(t),n=`\n\t\t\t<model-viewer alt="${t.name}" skybox-image="${e}" ios-src="${s}" src="${i}" ar ar-modes="webxr scene-viewer quick-look" ar-scale="auto" camera-controls></model-viewer>\n\t\t`,o=document.createElement("div");o.innerHTML=n;return o.firstElementChild}}mr.meta={selector:"[try-in-ar]",hosts:{host:le},template:'\n\t\t<div class="page page--try-in-ar">\n\t\t\t\x3c!--\n\t\t\t<div *if="platform != \'ios\'">\n\t\t\t\t<script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"><\/script>\n\t\t\t\t<script nomodule src="https://unpkg.com/@google/model-viewer/dist/model-viewer-legacy.js"><\/script>\n\t\t\t</div>\n\t\t\t--\x3e\n\t\t\t<div class="ui" *if="!viewId">\n\t\t\t\t<div class="group--info">\n\t\t\t\t\t<div class="group--info__content">\n\t\t\t\t\t\t<div class="info">Unknown url.</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="ui" *if="missingAr">\n\t\t\t\t<div class="group--info">\n\t\t\t\t\t<div class="group--info__content">\n\t\t\t\t\t\t<div class="info">Missing AR in view.</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="ui" *if="missingUsdz">\n\t\t\t\t<div class="group--info">\n\t\t\t\t\t<div class="group--info__content">\n\t\t\t\t\t\t<div class="info">Missing .usdz in ar.</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="ui" *if="missingGltf">\n\t\t\t\t<div class="group--info">\n\t\t\t\t\t<div class="group--info__content">\n\t\t\t\t\t\t<div class="info">Missing .gltf in ar.</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t'},console.log("environment.defaultLanguage",U.defaultLanguage);class vr extends t.Component{onInit(){const e=[{name:"index",path:"/",forwardTo:U.defaultLanguage||"it"},{name:"it",path:"/it",defaultParams:{lang:"it",mode:"access"},factory:Ps},{name:"it.access",path:"/accesso",defaultParams:{lang:"it",mode:"access"},factory:Ps},{name:"it.accessCode",path:"/codice-di-accesso?:p&:link&:name&:role&:viewId&:pathId&:support",defaultParams:{lang:"it",mode:"accessCode"},factory:ce},{name:"it.guidedTour",path:"/tour-guidato?:p&:link&:name&:role&:viewId&:pathId&:support",defaultParams:{lang:"it",mode:"guidedTour"},factory:Wa},{name:"it.selfServiceTour",path:"/tour-self-service?:p&:viewId&:pathId",defaultParams:{lang:"it",mode:"selfServiceTour"},factory:Wa},{name:"it.embed",path:"/embed",defaultParams:{lang:"it",mode:"embed"},factory:Wa},{name:"it.tryInAr",path:"/prova-in-ar?:p&:viewId",defaultParams:{lang:"it",mode:"tryInAr"},factory:mr},{name:"it.editor",path:"/editor?:p&:viewId",defaultParams:{lang:"it",mode:"editor"},factory:dr},{name:"it.layout",path:"/layout",defaultParams:{lang:"it",mode:"layout"},factory:pr},{name:"it.privacy",path:"/informativa-sulla-privacy",defaultParams:{lang:"it",mode:"privacy_policy"},factory:ur},{name:"it.terms",path:"/termini-di-utilizzo",defaultParams:{lang:"it",mode:"terms"},factory:ur},{name:"en",path:"/en",defaultParams:{lang:"en",mode:"access"},factory:Ps},{name:"en.access",path:"/access",defaultParams:{lang:"en",mode:"access"},factory:Ps},{name:"en.accessCode",path:"/accesso-code?:p&:link&:name&:role&:viewId&:pathId&:support",defaultParams:{lang:"en",mode:"accessCode"},factory:ce},{name:"en.guidedTour",path:"/guided-tour?:p&:link&:name&:role&:viewId&:pathId&:support",defaultParams:{lang:"en",mode:"guidedTour"},factory:Wa},{name:"en.selfServiceTour",path:"/self-service-tour?:p&:viewId&:pathId",defaultParams:{lang:"en",mode:"selfServiceTour"},factory:Wa},{name:"en.embed",path:"/embed",defaultParams:{lang:"en",mode:"embed"},factory:Wa},{name:"en.tryInAr",path:"/try-in-ar?:p&:viewId",defaultParams:{lang:"en",mode:"tryInAr"},factory:mr},{name:"en.editor",path:"/editor?:p&:viewId",defaultParams:{lang:"en",mode:"editor"},factory:dr},{name:"en.layout",path:"/layout",defaultParams:{lang:"en",mode:"layout"},factory:pr},{name:"en.privacy",path:"/privacy-policy",defaultParams:{lang:"en",mode:"privacy_policy"},factory:ur},{name:"en.terms",path:"/terms-of-service",defaultParams:{lang:"en",mode:"terms"},factory:ur}];ee.useBrowser(e),U.flags.editorAssetScreen&&(Ji.PublisherScreen={id:5,name:"PublisherScreen",ids:[6]},Ji.AttendeeScreen={id:6,name:"AttendeeScreen",ids:[7]}),Ji.SmartDevice={id:7,name:"Smart Device",ids:[8]},ee.event$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((t=>{const s=t.route;s&&"embed"===s.params.mode&&(U.flags.like=!1),be.setRoute(s,e)})),be.lang$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((t=>{this.pushChanges()}));const{node:s}=t.getContext(this);s.classList.remove("hidden")}}vr.meta={selector:"[b-here-component]",template:'\n\t\t\x3c!-- svg --\x3e\n\t\t\n\t\t<svg width="0" height="0" class="hidden" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true">\n\t\t\t<symbol id="arrow-down" viewBox="0 0 24 24">\n\t\t\t\t<path d="M0 7.33l2.829-2.83 9.175 9.339 9.167-9.339 2.829 2.83-11.996 12.17z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="arrow-next" viewBox="0 0 24 24">\n\t\t\t\t<path d="M7.33 24l-2.83-2.829 9.339-9.175-9.339-9.167 2.83-2.829 12.17 11.996z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="arrow-prev" viewBox="0 0 24 24">\n\t\t\t\t<path d="M16.67 0l2.83 2.829-9.339 9.175 9.339 9.167-2.83 2.829-12.17-11.996z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="call" viewBox="0 0 24 24">\n\t\t\t\t<path d="M20 22.621l-3.521-6.795c-.008.004-1.974.97-2.064 1.011-2.24 1.086-6.799-7.82-4.609-8.994l2.083-1.026-3.493-6.817-2.106 1.039c-7.202 3.755 4.233 25.982 11.6 22.615.121-.055 2.102-1.029 2.11-1.033z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="heart" viewBox="0 0 24 24">\n\t\t\t\t<path d="M12 4.435c-1.989-5.399-12-4.597-12 3.568 0 4.068 3.06 9.481 12 14.997 8.94-5.516 12-10.929 12-14.997 0-8.118-10-8.999-12-3.568z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="heart-outline" viewBox="0 0 24 24">\n\t\t\t\t<path d="M12 9.229c.234-1.12 1.547-6.229 5.382-6.229 2.22 0 4.618 1.551 4.618 5.003 0 3.907-3.627 8.47-10 12.629-6.373-4.159-10-8.722-10-12.629 0-3.484 2.369-5.005 4.577-5.005 3.923 0 5.145 5.126 5.423 6.231zm-12-1.226c0 4.068 3.06 9.481 12 14.997 8.94-5.516 12-10.929 12-14.997 0-7.962-9.648-9.028-12-3.737-2.338-5.262-12-4.27-12 3.737z"/>\n\t\t\t</symbol>\n\t\t\t<symbol id="cam" viewBox="0 0 24 24">\n\t\t\t\t<path d="M16 18c0 1.104-.896 2-2 2h-12c-1.105 0-2-.896-2-2v-12c0-1.104.895-2 2-2h12c1.104 0 2 .896 2 2v12zm8-14l-6 6.223v3.554l6 6.223v-16z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="cam-muted" viewBox="0 0 24 24">\n\t\t\t\t<path d="M0.7,19.5L15.5,4.7C15.1,4.3,14.6,4,14,4H2C0.9,4,0,4.9,0,6v12C0,18.6,0.3,19.1,0.7,19.5z"></path>\n\t\t\t\t<path d="M18 13.8L24 20 24 4 18 10.2z"></path>\n\t\t\t\t<path d="M7.8,20H14c1.1,0,2-0.9,2-2v-6.2L7.8,20z"></path>\n\t\t\t\t<path d="M-3.4 11.2H27.400000000000002V12.7H-3.4z" transform="rotate(-45.001 12 12)"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="mic" viewBox="0 0 24 24">\n\t\t\t\t<path d="M16 11c0 2.209-1.791 4-4 4s-4-1.791-4-4v-7c0-2.209 1.791-4 4-4s4 1.791 4 4v7zm4-2v2c0 4.418-3.582 8-8 8s-8-3.582-8-8v-2h2v2c0 3.309 2.691 6 6 6s6-2.691 6-6v-2h2zm-7 13v-2h-2v2h-4v2h10v-2h-4z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="mic-muted" viewBox="0 0 24 24">\n\t\t\t\t<path d="M16,11.4L12.4,15C14.3,14.8,15.8,13.3,16,11.4z"></path>\n\t\t\t\t<path d="M16,4.6V4c0-2.2-1.8-4-4-4S8,1.8,8,4v7c0,0.5,0.1,0.9,0.3,1.4L16,4.6z"></path>\n\t\t\t\t<path d="M13 20L11 20 11 22 7 22 7 24 17 24 17 22 13 22z"></path>\n\t\t\t\t<path d="M18,11c0,3.3-2.7,6-6,6c-0.5,0-1-0.1-1.4-0.2L9,18.4c0.9,0.4,2,0.6,3,0.6c4.4,0,8-3.6,8-8V9h-2V11z"></path>\n\t\t\t\t<path d="M6.7,13.9C6.3,13,6,12,6,11V9H4v2c0,1.6,0.5,3.1,1.3,4.3L6.7,13.9z"></path>\n\t\t\t\t<path d="M-3.4 11.2H27.400000000000002V12.7H-3.4z" transform="rotate(-45.001 12 12)"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="gamepad" viewBox="0 0 24 24">\n\t\t\t\t<path d="M17.622 3c-1.913 0-2.558 1.382-5.623 1.382-3.009 0-3.746-1.382-5.623-1.382-5.209 0-6.376 10.375-6.376 14.348 0 2.145.817 3.652 2.469 3.652 3.458 0 2.926-5 6.915-5h5.23c3.989 0 3.457 5 6.915 5 1.652 0 2.471-1.506 2.471-3.651 0-3.973-1.169-14.349-6.378-14.349zm-10.622 10c-1.657 0-3-1.343-3-3s1.343-3 3-3 3 1.343 3 3-1.343 3-3 3zm10-6c.552 0 1 .447 1 1 0 .553-.448 1-1 1s-1-.447-1-1c0-.553.448-1 1-1zm-2 4c-.552 0-1-.447-1-1 0-.553.448-1 1-1s1 .447 1 1c0 .553-.448 1-1 1zm2 2c-.552 0-1-.447-1-1 0-.553.448-1 1-1s1 .447 1 1c0 .553-.448 1-1 1zm2-2c-.552 0-1-.447-1-1 0-.553.448-1 1-1s1 .447 1 1c0 .553-.448 1-1 1zm-10.25-1c0 .965-.785 1.75-1.75 1.75s-1.75-.785-1.75-1.75.785-1.75 1.75-1.75 1.75.785 1.75 1.75z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="ar" viewBox="0 0 24 24">\n\t\t\t\t<path d="M12 0l-11 6v12.131l11 5.869 11-5.869v-12.066l-11-6.065zm7.91 6.646l-7.905 4.218-7.872-4.294 7.862-4.289 7.915 4.365zm-16.91 1.584l8 4.363v8.607l-8-4.268v-8.702zm10 12.97v-8.6l8-4.269v8.6l-8 4.269zm6.678-5.315c.007.332-.256.605-.588.612-.332.007-.604-.256-.611-.588-.006-.331.256-.605.588-.612.331-.007.605.256.611.588zm-2.71-1.677c-.332.006-.595.28-.588.611.006.332.279.595.611.588s.594-.28.588-.612c-.007-.331-.279-.594-.611-.587zm-2.132-1.095c-.332.007-.595.281-.588.612.006.332.279.594.611.588.332-.007.594-.28.588-.612-.007-.331-.279-.594-.611-.588zm-9.902 2.183c.332.007.594.281.588.612-.007.332-.279.595-.611.588-.332-.006-.595-.28-.588-.612.005-.331.279-.594.611-.588zm1.487-.5c-.006.332.256.605.588.612s.605-.257.611-.588c.007-.332-.256-.605-.588-.611-.332-.008-.604.255-.611.587zm2.132-1.094c-.006.332.256.605.588.612.332.006.605-.256.611-.588.007-.332-.256-.605-.588-.612-.332-.007-.604.256-.611.588zm3.447-5.749c-.331 0-.6.269-.6.6s.269.6.6.6.6-.269.6-.6-.269-.6-.6-.6zm0-2.225c-.331 0-.6.269-.6.6s.269.6.6.6.6-.269.6-.6-.269-.6-.6-.6zm0-2.031c-.331 0-.6.269-.6.6s.269.6.6.6.6-.269.6-.6-.269-.6-.6-.6z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="close" viewBox="0 0 24 24">\n\t\t\t\t<path d="M23 20.168l-8.185-8.187 8.185-8.174-2.832-2.807-8.182 8.179-8.176-8.179-2.81 2.81 8.186 8.196-8.186 8.184 2.81 2.81 8.203-8.192 8.18 8.192z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="vr" viewBox="0 0 24 24">\n\t\t\t\t<path d="M22.3,4.3H1.7C0.8,4.3,0,5.1,0,6v12c0,0.9,0.8,1.7,1.7,1.7h5.6c0.7,0,1.4-0.5,1.6-1.2l1.4-4.2c0.5-1.6,2.7-1.6,3.3,0 l1.4,4.2c0.2,0.7,0.9,1.2,1.6,1.2h5.6c0.9,0,1.7-0.8,1.7-1.7V6C24,5.1,23.2,4.3,22.3,4.3z M6,14.6c-1.4,0-2.6-1.2-2.6-2.6 S4.6,9.4,6,9.4s2.6,1.2,2.6,2.6S7.4,14.6,6,14.6z M18,14.6c-1.4,0-2.6-1.2-2.6-2.6s1.2-2.6,2.6-2.6s2.6,1.2,2.6,2.6 S19.4,14.6,18,14.6z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="vr-02" viewBox="0 0 24 24">\n\t\t\t\t<path d="M22.5,8.6c-0.3,0-0.6,0.1-0.8,0.3c-0.3-1.9-1.9-3.4-3.9-3.4H6.2c-2,0-3.6,1.5-3.9,3.4C2,8.7,1.7,8.6,1.4,8.6 C0.6,8.6,0,9.3,0,10.1v3.9c0,0.8,0.6,1.4,1.4,1.4c0.3,0,0.6-0.1,0.8-0.3c0.3,1.9,1.9,3.4,3.9,3.4h11.6c2,0,3.6-1.5,3.9-3.4 c0.2,0.2,0.5,0.3,0.8,0.3c0.8,0,1.4-0.6,1.4-1.4v-3.9C24,9.3,23.3,8.6,22.5,8.6z M20.7,14.6c0,1.6-1.3,2.8-2.8,2.8H6.2 c-1.6,0-2.8-1.3-2.8-2.8V9.4c0-1.6,1.3-2.8,2.8-2.8h11.6c1.6,0,2.8,1.3,2.8,2.8V14.6z"></path><circle cx="5.7" cy="8.7" r=".8"></circle><circle cx="18.3" cy="8.6" r=".8"></circle><circle cx="5.7" cy="15.4" r=".8"></circle><circle cx="18.3" cy="15.3" r=".8"></circle>\n\t\t\t</symbol>\n\t\t\t<symbol id="the-spy" viewBox="0 0 24 24">\n\t\t\t\t<path d="M17,14c-1.8,0-3.3,1.3-3.7,3h-2.5c-0.5-2.1-2.5-3.4-4.6-2.9c-2.1,0.5-3.4,2.5-2.9,4.6s2.5,3.4,4.6,2.9 c1.4-0.3,2.6-1.5,2.9-2.9h2.5c0.5,2.1,2.5,3.4,4.6,2.9s3.4-2.5,2.9-4.6C20.4,15.3,18.8,14,17,14z"></path>\n\t\t\t\t<path d="M23.2,11.5h-2.6V6c0-0.7-0.5-1.4-1.2-1.6l-5.5-1.8c-1.2-0.4-2.6-0.4-3.8,0L4.6,4.4C3.9,4.6,3.4,5.3,3.4,6v5.4H0.8 c-0.5,0-0.8,0.4-0.8,0.8s0.4,0.8,0.8,0.8h22.3c0.5,0,0.8-0.4,0.8-0.8S23.6,11.5,23.2,11.5z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="spy-eye" viewBox="0 0 24 24">\n\t\t\t\t<path d="M12,19.6c-4.6,0-8.9-3.5-11.7-6.8c-0.4-0.5-0.4-1.2,0-1.6C3.1,7.9,7.4,4.4,12,4.4s8.9,3.5,11.7,6.8 c0.4,0.5,0.4,1.2,0,1.6C20.9,16.1,16.6,19.6,12,19.6z M12,7.5c2.5,0,4.4,1.9,4.4,4.4s-1.9,4.4-4.4,4.4s-4.4-1.9-4.4-4.4 S9.5,7.5,12,7.5z" clip-rule="evenodd"></path>\n\t\t\t\t<path d="M12,9.3c1.4,0,2.6,1.2,2.6,2.6s-1.2,2.6-2.6,2.6s-2.6-1.2-2.6-2.6S10.6,9.3,12,9.3z" fill-rule="evenodd" ></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="copy" viewBox="0 0 24 24">\n\t\t\t\t<path d="M7 16h10v1h-10v-1zm0-1h10v-1h-10v1zm15-13v22h-20v-22h3c1.229 0 2.18-1.084 3-2h8c.82.916 1.771 2 3 2h3zm-11 1c0 .552.448 1 1 1s1-.448 1-1-.448-1-1-1-1 .448-1 1zm9 1h-4l-2 2h-3.898l-2.102-2h-4v18h16v-18zm-13 9h10v-1h-10v1zm0-2h10v-1h-10v1z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="menu" viewBox="0 0 24 24">\n\t\t\t\t<path d="M12 18c1.657 0 3 1.343 3 3s-1.343 3-3 3-3-1.343-3-3 1.343-3 3-3zm0-9c1.657 0 3 1.343 3 3s-1.343 3-3 3-3-1.343-3-3 1.343-3 3-3zm0-9c1.657 0 3 1.343 3 3s-1.343 3-3 3-3-1.343-3-3 1.343-3 3-3z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="menu-light" viewBox="0 0 24 24">\n\t\t\t\t<path d="M14 19h-14v-1h14v1zm9.247-8.609l-3.247 4.049-3.263-4.062-.737.622 4 5 4-5-.753-.609zm-9.247 2.609h-14v-1h14v1zm0-6h-14v-1h14v1z"/>\n\t\t\t</symbol>\n\t\t\t<symbol id="settings" viewBox="0 0 24 24">\n\t\t\t\t<path d="M24 14.187v-4.374c-2.148-.766-2.726-.802-3.027-1.529-.303-.729.083-1.169 1.059-3.223l-3.093-3.093c-2.026.963-2.488 1.364-3.224 1.059-.727-.302-.768-.889-1.527-3.027h-4.375c-.764 2.144-.8 2.725-1.529 3.027-.752.313-1.203-.1-3.223-1.059l-3.093 3.093c.977 2.055 1.362 2.493 1.059 3.224-.302.727-.881.764-3.027 1.528v4.375c2.139.76 2.725.8 3.027 1.528.304.734-.081 1.167-1.059 3.223l3.093 3.093c1.999-.95 2.47-1.373 3.223-1.059.728.302.764.88 1.529 3.027h4.374c.758-2.131.799-2.723 1.537-3.031.745-.308 1.186.099 3.215 1.062l3.093-3.093c-.975-2.05-1.362-2.492-1.059-3.223.3-.726.88-.763 3.027-1.528zm-4.875.764c-.577 1.394-.068 2.458.488 3.578l-1.084 1.084c-1.093-.543-2.161-1.076-3.573-.49-1.396.581-1.79 1.693-2.188 2.877h-1.534c-.398-1.185-.791-2.297-2.183-2.875-1.419-.588-2.507-.045-3.579.488l-1.083-1.084c.557-1.118 1.066-2.18.487-3.58-.579-1.391-1.691-1.784-2.876-2.182v-1.533c1.185-.398 2.297-.791 2.875-2.184.578-1.394.068-2.459-.488-3.579l1.084-1.084c1.082.538 2.162 1.077 3.58.488 1.392-.577 1.785-1.69 2.183-2.875h1.534c.398 1.185.792 2.297 2.184 2.875 1.419.588 2.506.045 3.579-.488l1.084 1.084c-.556 1.121-1.065 2.187-.488 3.58.577 1.391 1.689 1.784 2.875 2.183v1.534c-1.188.398-2.302.791-2.877 2.183zm-7.125-5.951c1.654 0 3 1.346 3 3s-1.346 3-3 3-3-1.346-3-3 1.346-3 3-3zm0-2c-2.762 0-5 2.238-5 5s2.238 5 5 5 5-2.238 5-5-2.238-5-5-5z"/>\n\t\t\t</symbol>\n\t\t\t<symbol id="settings-full" viewBox="0 0 24 24">\n\t\t\t\t<path d="M24 13.616v-3.232l-2.869-1.02c-.198-.687-.472-1.342-.811-1.955l1.308-2.751-2.285-2.285-2.751 1.307c-.613-.339-1.269-.613-1.955-.811l-1.021-2.869h-3.232l-1.021 2.869c-.686.198-1.342.471-1.955.811l-2.751-1.308-2.285 2.285 1.308 2.752c-.339.613-.614 1.268-.811 1.955l-2.869 1.02v3.232l2.869 1.02c.197.687.472 1.342.811 1.955l-1.308 2.751 2.285 2.286 2.751-1.308c.613.339 1.269.613 1.955.811l1.021 2.869h3.232l1.021-2.869c.687-.198 1.342-.472 1.955-.811l2.751 1.308 2.285-2.286-1.308-2.751c.339-.613.613-1.268.811-1.955l2.869-1.02zm-12 2.384c-2.209 0-4-1.791-4-4s1.791-4 4-4 4 1.791 4 4-1.791 4-4 4z"/>\n\t\t\t</symbol>\n\t\t\t<symbol id="emoji" viewBox="0 0 24 24">\n\t\t\t\t<path d="M12,2c5.5,0,10,4.5,10,10s-4.5,10-10,10S2,17.5,2,12S6.5,2,12,2z M12,0C5.4,0,0,5.4,0,12s5.4,12,12,12s12-5.4,12-12 S18.6,0,12,0z M18,14H6c0.3,1.5,2.8,4,6,4C15.1,18,17.7,15.5,18,14z M8.5,8C7.7,8,7,8.7,7,9.5S7.7,11,8.5,11S10,10.3,10,9.5 S9.3,8,8.5,8z M15.5,8C14.7,8,14,8.7,14,9.5s0.7,1.5,1.5,1.5c0.8,0,1.5-0.7,1.5-1.5S16.3,8,15.5,8z"/>\n\t\t\t</symbol>\n\t\t\t<symbol id="pencil" viewBox="0 0 24 24">\n\t\t\t\t<path d="M19.769 9.923l-12.642 12.639-7.127 1.438 1.438-7.128 12.641-12.64 5.69 5.691zm1.414-1.414l2.817-2.82-5.691-5.689-2.816 2.817 5.69 5.692z"/>\n\t\t\t</symbol>\n\t\t\t<symbol id="erase" viewBox="0 0 24 24">\n\t\t\t\t<path d="M5.662 23l-5.369-5.365c-.195-.195-.293-.45-.293-.707 0-.256.098-.512.293-.707l14.929-14.928c.195-.194.451-.293.707-.293.255 0 .512.099.707.293l7.071 7.073c.196.195.293.451.293.708 0 .256-.097.511-.293.707l-11.216 11.219h5.514v2h-12.343zm3.657-2l-5.486-5.486-1.419 1.414 4.076 4.072h2.829zm.456-11.429l-4.528 4.528 5.658 5.659 4.527-4.53-5.657-5.657z"/>\n\t\t\t</symbol>\n\t\t\t<symbol id="move" viewBox="0 0 24 24">\n\t\t\t\t<path d="M12 10c1.104 0 2 .896 2 2s-.896 2-2 2-2-.896-2-2 .896-2 2-2zm-3.857 3c-.084-.321-.143-.652-.143-1s.059-.679.143-1h-2.143v-4l-6 5 6 5v-4h2.143zm7.714-2c.084.321.143.652.143 1s-.059.679-.143 1h2.143v4l6-5-6-5v4h-2.143zm-2.857 4.857c-.321.084-.652.143-1 .143s-.679-.059-1-.143v2.143h-4l5 6 5-6h-4v-2.143zm-2-7.714c.321-.084.652-.143 1-.143s.679.059 1 .143v-2.143h4l-5-6-5 6h4v2.143z"/>\n\t\t\t</symbol>\n\t\t\t<symbol id="caret-down" viewBox="0 0 8 5">\n\t\t\t\t<path d="M0 0h8L4 5 0 0z" fill-rule="evenodd" clip-rule="evenodd"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="caret-right" viewBox="0 0 8 12">\n\t\t\t\t<path d="M0 12V0l8 6-8 6z" fill-rule="evenodd" clip-rule="evenodd"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="websolute" viewBox="0 0 20 20">\n\t\t\t\t<path d="M20 10c0 5.5-4.5 10-10 10S0 15.5 0 10 4.5 0 10 0s10 4.5 10 10m-10 2.3c.5.5 1.3.8 2.1.8s1.5-.3 2.1-.8c.5-.5.8-1.2.8-2V7.5h-1.7v2.8c0 .3-.1.6-.4.8-.1.1-.3.2-.4.3-.2.1-.3.1-.5.1s-.3 0-.5-.1c-.1-.1-.3-.2-.4-.3-.2-.2-.4-.5-.4-.8V7.6H9.2v2.8c0 .3-.1.6-.4.9-.2.2-.5.4-.8.4-.3 0-.7-.1-.9-.3-.2-.2-.4-.5-.3-.8V7.5H5v2.8c0 .7.3 1.5.8 2 .6.5 1.3.8 2.1.8.8.1 1.6-.2 2.1-.8z" fill-rule="evenodd" clip-rule="evenodd"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="search" viewBox="0 0 21 23">\n\t\t\t\t<path d="M20.6 20.3l-4.9-5.2c1.2-1.7 1.8-3.7 1.8-5.7 0-5.2-3.9-9.4-8.7-9.4S0 4.2 0 9.4s3.7 7.8 6.3 8.4c1.8.4 3.9.6 7.1-.7l5.1 5.4c.5.6 1.4.6 2 .1l.1-.1c.5-.6.5-1.6 0-2.2zM15 9.4c-.2 3.5-3.2 6.1-6.7 5.8S2.2 12 2.5 8.5c.2-3.3 3-5.8 6.3-5.8 3.5.1 6.3 3.1 6.2 6.7z" fill-rule="evenodd" clip-rule="evenodd"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="result-indicator" viewBox="0 0 24 24">\n\t\t\t\t<path d="M11 21.883l-6.235-7.527-.765.644 7.521 9 7.479-9-.764-.645-6.236 7.529v-21.884h-1v21.883z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="bullet" viewBox="0 0 18 18">\n\t\t\t\t<path d="M9 2c3.9 0 7 3.1 7 7s-3.1 7-7 7-7-3.1-7-7 3.1-7 7-7m0-2C4 0 0 4 0 9s4 9 9 9 9-4 9-9-4-9-9-9z" opacity=".15" fill="#17265a"></path>\n\t\t\t\t<circle cx="9" cy="9" r="4" fill="#17265a"></circle>\n\t\t\t</symbol>\n\t\t\t<symbol id="play" viewBox="0 0 16 20">\n\t\t\t\t<path d="M0,0v19.8l15.4-11L0,0z" fill-rule="evenodd" clip-rule="evenodd" ></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="play-progress" viewBox="0 0 196 196">\n\t\t\t\t<path d="M195.5,98c0,53.8-43.7,97.5-97.5,97.5S0.5,151.8,0.5,98S44.2,0.5,98,0.5S195.5,44.2,195.5,98z" stroke-width="2px" stroke-linecap="square" ></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="pause" viewBox="0 0 16 20">\n\t\t\t\t<path d="M0 0.9H4V18.9H0z"></path>\n\t\t\t\t<path d="M11.4 0.9H15.4V18.9H11.4z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="wishlist-add" viewBox="0 0 25 20">\n\t\t\t\t<path d="M12.5,20.8c-0.3,0-0.5-0.1-0.8-0.3c-0.3-0.2-0.6-0.4-0.9-0.6c-0.7-0.5-1.4-0.9-2.1-1.5 c-1.1-0.8-2.1-1.6-3.1-2.4C4.2,15,3,13.8,1.9,12.4c-0.9-1.1-1.4-2.3-1.7-3.7C0.1,8.5,0.1,8.2,0,7.9l0-0.2l0.1-1.4 c0-0.1,0.1-0.3,0.1-0.4c0.1-0.3,0.1-0.7,0.3-1c0.6-1.7,1.8-3.2,3.4-4c1.5-0.8,3.3-1.1,5-0.8c1.4,0.2,2.6,0.8,3.7,1.7 c2.9-2.4,7.2-2.4,10,0.1c1.1,0.9,1.9,2.2,2.2,3.5c0.1,0.3,0.1,0.6,0.2,0.8L25,6.7l-0.1,1.4c-0.2,1.2-0.6,2.4-1.2,3.4 c-0.5,0.8-1.1,1.6-1.8,2.3c-0.8,0.9-1.7,1.7-2.6,2.5c-0.7,0.6-1.6,1.3-2.6,2c-0.8,0.5-1.5,1.1-2.3,1.6c-0.4,0.3-0.8,0.5-1.2,0.8 C13.1,20.8,12.8,20.8,12.5,20.8z M2.1,7.6c0,0.2,0.1,0.4,0.1,0.6c0.2,1.1,0.7,2,1.4,2.9c1,1.2,2.1,2.3,3.3,3.3c1,0.8,2,1.6,3,2.4 c0.7,0.5,1.4,0.9,2.1,1.4l0.5,0.3c0.2-0.2,0.5-0.3,0.7-0.5c0.8-0.5,1.5-1,2.3-1.6c0.9-0.7,1.8-1.4,2.5-1.9c0.9-0.7,1.7-1.5,2.4-2.3 c0.6-0.6,1.1-1.2,1.5-1.9c0.5-0.8,0.8-1.7,0.9-2.6c0-0.1,0-0.1,0-0.2l0-0.9c0-0.2-0.1-0.4-0.1-0.6c-0.3-1-0.8-1.9-1.6-2.5 c-2.1-1.8-5.2-1.8-7.3,0c-0.1,0.1-0.3,0.2-0.4,0.4l-0.9,1.2l-1-1.3c-0.8-0.8-1.9-1.4-3-1.6C7.2,2,5.9,2.2,4.9,2.8 c-1.1,0.6-2,1.6-2.4,2.8C2.4,5.9,2.3,6.1,2.3,6.4c0,0.1-0.1,0.3-0.1,0.4l0,0L2.1,7.6L2.1,7.6z" clip-rule="evenodd" fill-rule="evenodd" ></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="wishlist-added" viewBox="0 0 25 20">\n\t\t\t\t<path d="M12.5,20.8c-0.3,0-0.5-0.1-0.8-0.3c-0.3-0.2-0.6-0.4-0.9-0.6c-0.7-0.5-1.4-0.9-2.1-1.5 c-1.1-0.8-2.1-1.6-3.1-2.4c-1.4-1-2.6-2.2-3.7-3.6C1,11.3,0.5,10.1,0.2,8.7C0.1,8.5,0.1,8.2,0,7.9V7.7l0.1-1.4 c0-0.1,0.1-0.3,0.1-0.4c0.1-0.3,0.1-0.7,0.3-1c0.6-1.7,1.8-3.2,3.4-4c1.5-0.8,3.3-1.1,5-0.8c1.4,0.2,2.6,0.8,3.7,1.7 c2.9-2.4,7.2-2.4,10,0.1c1.1,0.9,1.9,2.2,2.2,3.5C24.9,5.7,24.9,6,25,6.2v0.5l-0.1,1.4c-0.2,1.2-0.6,2.4-1.2,3.4 c-0.5,0.8-1.1,1.6-1.8,2.3c-0.8,0.9-1.7,1.7-2.6,2.5c-0.7,0.6-1.6,1.3-2.6,2c-0.8,0.5-1.5,1.1-2.3,1.6c-0.4,0.3-0.8,0.5-1.2,0.8 C13.1,20.8,12.8,20.8,12.5,20.8z" clip-rule="evenodd" fill-rule="evenodd" ></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="wishlist" viewBox="0 0 16 14">\n\t\t\t\t<path d="M8,14c-0.2,0-0.3-0.1-0.5-0.2l-0.6-0.4c-0.5-0.3-0.9-0.6-1.4-1c-0.7-0.5-1.4-1.1-2-1.6 c-0.9-0.7-1.6-1.6-2.3-2.5C0.7,7.6,0.3,6.8,0.1,5.9c0-0.2-0.1-0.4-0.1-0.5l0-0.1l0-1c0-0.1,0-0.2,0.1-0.3c0.1-0.2,0.1-0.4,0.2-0.7 c0.4-1.1,1.2-2.1,2.2-2.7c1.8-1,4-0.8,5.5,0.6c1.8-1.6,4.6-1.6,6.4,0.1c0.7,0.6,1.2,1.5,1.4,2.4C15.9,3.8,15.9,4,16,4.2l0,0.3l0,0.9 c-0.1,0.8-0.4,1.6-0.8,2.3c-0.3,0.5-0.7,1-1.1,1.5c-0.5,0.6-1.1,1.1-1.7,1.7c-0.4,0.4-1,0.9-1.7,1.3c-0.5,0.4-1,0.7-1.5,1.1 c-0.2,0.2-0.5,0.3-0.7,0.5C8.4,13.9,8.2,14,8,14z M1.4,5.1c0,0.1,0.1,0.3,0.1,0.4c0.1,0.7,0.4,1.4,0.9,1.9C2.9,8.3,3.6,9,4.4,9.7 c0.6,0.5,1.3,1.1,1.9,1.6c0.4,0.3,0.9,0.6,1.3,0.9c0.1,0.1,0.2,0.2,0.3,0.2c0.2-0.1,0.3-0.2,0.5-0.3c0.5-0.3,1-0.7,1.5-1 c0.6-0.4,1.2-0.9,1.6-1.3c0.5-0.5,1.1-1,1.5-1.5c0.4-0.4,0.7-0.8,1-1.3c0.3-0.5,0.5-1.1,0.6-1.7c0,0,0-0.1,0-0.1l0-0.6 c0-0.1,0-0.3-0.1-0.4c-0.2-0.7-0.5-1.2-1-1.7c-1.3-1.2-3.4-1.2-4.7,0C8.7,2.4,8.6,2.5,8.5,2.6L8,3.4L7.3,2.5 C6.3,1.4,4.5,1.1,3.1,1.9C2.4,2.3,1.8,3,1.6,3.8C1.5,3.9,1.5,4.1,1.4,4.3L1.4,4.6l0,0L1.4,5.1L1.4,5.1z" clip-rule="evenodd" fill-rule="evenodd" ></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="expand" viewBox="0 0 29 30">\n\t\t\t\t<path d="M26 16.3V5.9L2.2 29.7.1 27.6 24 3.3H13v-3h16v16h-3z" fill-rule="evenodd" clip-rule="evenodd"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="download" viewBox="0 0 9 13">\n\t\t\t\t<path d="M8.5 7.9c-.3-.4-.8-.4-1.2-.1l-.1.1-2 2V1.2c0-.2-.1-.4-.2-.6-.2-.3-.7-.3-1 0-.2.2-.3.4-.3.6v8.6l-2-2c-.2-.1-.4-.2-.7-.2-.2 0-.4.1-.6.3-.1.2-.1.4-.1.6 0 .2.1.4.2.5l3.4 3.4c.2.2.4.2.6.2.2 0 .4-.1.6-.2L8.4 9c.2-.1.2-.3.3-.6 0-.1-.1-.4-.2-.5z" fill-rule="evenodd" clip-rule="evenodd"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="upload" viewBox="0 0 24 24">\n\t\t\t\t<path d="M10 9H4l8-9 8 9h-6v11h-4V9zm11 11v2H3v-2H1v4h22v-4h-2z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="user" viewBox="0 0 24 24">\n\t\t\t\t<path d="M20.822 18.096c-3.439-.794-6.64-1.49-5.09-4.418C20.452 4.766 16.983 0 12 0 6.918 0 3.536 4.949 8.268 13.678c1.597 2.945-1.725 3.641-5.09 4.418C.105 18.806-.01 20.332 0 23l.004 1h23.99l.004-.969c.012-2.688-.092-4.222-3.176-4.935z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="back" viewBox="0 0 24 24">\n\t\t\t\t<path d="M2.117 12l7.527 6.235L9 19l-9-7.521L9 4l.645.764L2.116 11H24v1H2.117z" fill-rule="evenodd" clip-rule="evenodd"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="add" viewBox="0 0 24 24">\n\t\t\t\t<path d="M24 10h-10v-10h-4v10h-10v4h10v10h4v-10h10z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="remove" viewBox="0 0 24 24">\n\t\t\t\t<path d="M0 10h24v4h-24z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="link" viewBox="0 0 24 24">\n\t\t\t\t<path d="M6.188 8.719c.439-.439.926-.801 1.444-1.087 2.887-1.591 6.589-.745 8.445 2.069l-2.246 2.245c-.644-1.469-2.243-2.305-3.834-1.949-.599.134-1.168.433-1.633.898l-4.304 4.306c-1.307 1.307-1.307 3.433 0 4.74 1.307 1.307 3.433 1.307 4.74 0l1.327-1.327c1.207.479 2.501.67 3.779.575l-2.929 2.929c-2.511 2.511-6.582 2.511-9.093 0s-2.511-6.582 0-9.093l4.304-4.306zm6.836-6.836l-2.929 2.929c1.277-.096 2.572.096 3.779.574l1.326-1.326c1.307-1.307 3.433-1.307 4.74 0 1.307 1.307 1.307 3.433 0 4.74l-4.305 4.305c-1.311 1.311-3.44 1.3-4.74 0-.303-.303-.564-.68-.727-1.051l-2.246 2.245c.236.358.481.667.796.982.812.812 1.846 1.417 3.036 1.704 1.542.371 3.194.166 4.613-.617.518-.286 1.005-.648 1.444-1.087l4.304-4.305c2.512-2.511 2.512-6.582.001-9.093-2.511-2.51-6.581-2.51-9.092 0z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="up" viewBox="0 0 24 24">\n\t\t\t\t<path d="M7 11h-6l11-11 11 11h-6v13h-10z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="down" viewBox="0 0 24 24">\n\t\t\t\t<path d="M17,13h6L12,24L1,13h6V0h10V13z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="waiting-room" viewBox="0 0 24 24">\n\t\t\t\t<path d="M2,6c0-2.2,1.8-4,4-4h12c2.2,0,4,1.8,4,4v12c0,2.2-1.8,4-4,4H6c-2.2,0-4-1.8-4-4V6z" opacity=".2"></path>\n\t\t\t\t<path d="M17.8,10.7c0.7,0,1.3,0.6,1.3,1.3s-0.6,1.3-1.3,1.3H6.2c-0.7,0-1.3-0.6-1.3-1.3s0.6-1.3,1.3-1.3H17.8z M19.7,12 c0-1.1-0.9-1.9-1.9-1.9H6.2c-1.1,0-1.9,0.9-1.9,1.9s0.9,1.9,1.9,1.9h11.6C18.9,13.9,19.7,13.1,19.7,12z M13.9,11.4H6.2 c-0.4,0-0.6,0.3-0.6,0.6s0.3,0.6,0.6,0.6h7.7c0.4,0,0.6-0.3,0.6-0.6S14.3,11.4,13.9,11.4z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="panorama" viewBox="0 0 24 24">\n\t\t\t\t<path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path>\n\t\t\t\t<path d="M 9 15 C 9 14.448 9.448 14 10 14 L 14 14 C 14.552 14 15 14.448 15 15 L 15 16 C 15 16.552 14.552 17 14 17 L 10 17 C 9.448 17 9 16.552 9 16 Z" fill="var(--svg-icon-tint)" opacity="0.4"></path>\n\t\t\t\t<path d="M 7 8 C 7 7.448 7.448 7 8 7 L 16 7 C 16.552 7 17 7.448 17 8 L 17 12 C 17 12.552 16.552 13 16 13 L 8 13 C 7.448 13 7 12.552 7 12 Z" fill="var(--svg-icon-tint)"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="panorama-grid" viewBox="0 0 24 24">\n\t\t\t\t<path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path>\n\t\t\t\t<path d="M 7.333 8.333 C 7.333 7.781 7.781 7.333 8.333 7.333 L 10.333 7.333 C 10.886 7.333 11.333 7.781 11.333 8.333 L 11.333 10.333 C 11.333 10.886 10.886 11.333 10.333 11.333 L 8.333 11.333 C 7.781 11.333 7.333 10.886 7.333 10.333 Z" fill="var(--svg-icon-tint)" opacity="0.4"></path>\n\t\t\t\t<path d="M 12.333 8.333 C 12.333 7.781 12.781 7.333 13.333 7.333 L 15.333 7.333 C 15.886 7.333 16.333 7.781 16.333 8.333 L 16.333 10.333 C 16.333 10.886 15.886 11.333 15.333 11.333 L 13.333 11.333 C 12.781 11.333 12.333 10.886 12.333 10.333 Z" fill="var(--svg-icon-tint)" opacity="0.4"></path>\n\t\t\t\t<path d="M 7.333 13.667 C 7.333 13.114 7.781 12.667 8.333 12.667 L 10.333 12.667 C 10.886 12.667 11.333 13.114 11.333 13.667 L 11.333 15.667 C 11.333 16.219 10.886 16.667 10.333 16.667 L 8.333 16.667 C 7.781 16.667 7.333 16.219 7.333 15.667 Z" fill="var(--svg-icon-tint)"></path>\n\t\t\t\t<path d="M 12.333 13.667 C 12.333 13.114 12.781 12.667 13.333 12.667 L 15.333 12.667 C 15.886 12.667 16.333 13.114 16.333 13.667 L 16.333 15.667 C 16.333 16.219 15.886 16.667 15.333 16.667 L 13.333 16.667 C 12.781 16.667 12.333 16.219 12.333 15.667 Z" fill="var(--svg-icon-tint)" opacity="0.4"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="room-3d" viewBox="0 0 24 24">\n\t\t\t\t<path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path>\n\t\t\t\t<path d="M 6.6 9.056 C 6.6 8.533 6.905 8.059 7.381 7.842 L 8.995 7.108 C 9.436 6.907 9.938 7.23 9.938 7.715 L 9.938 16.272 C 9.938 16.757 9.436 17.08 8.995 16.879 L 7.381 16.145 C 6.905 15.928 6.6 15.454 6.6 14.931 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path>\n\t\t\t\t<path d="M 10.754 7.453 C 10.754 6.795 11.378 6.316 12.014 6.487 L 16.32 7.647 C 17.193 7.882 17.8 8.674 17.8 9.578 L 17.8 14.105 C 17.8 15.009 17.193 15.801 16.32 16.036 L 12.014 17.196 C 11.378 17.367 10.754 16.889 10.754 16.231 Z" fill="var(--svg-icon-tint)"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="model" viewBox="0 0 24 24">\n\t\t\t\t<path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.3"></path>\n\t\t\t\t<path d="M 11.298 7.283 C 11.602 6.729 12.398 6.729 12.702 7.283 L 14.009 9.673 C 14.082 9.807 14.193 9.918 14.327 9.991 L 16.717 11.298 C 17.271 11.602 17.271 12.398 16.717 12.702 L 14.327 14.009 C 14.193 14.082 14.082 14.193 14.009 14.327 L 12.702 16.717 C 12.398 17.271 11.602 17.271 11.298 16.717 L 9.991 14.327 C 9.918 14.193 9.807 14.082 9.673 14.009 L 7.283 12.702 C 6.729 12.398 6.729 11.602 7.283 11.298 L 9.673 9.991 C 9.807 9.918 9.918 9.807 9.991 9.673 Z" fill="var(--svg-icon-tint)"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="media" viewBox="0 0 24 24">\n\t\t\t\t<path d="M2,6c0-2.2,1.8-4,4-4h12c2.2,0,4,1.8,4,4v12c0,2.2-1.8,4-4,4H6c-2.2,0-4-1.8-4-4V6z" fill="var(--svg-icon-tint)" opacity="0.3"></path>\n\t\t\t\t<path d="M12,19c-2.2,0-4.3-1-5.6-2.7L7,15.9c1.2,1.5,3,2.4,5,2.4c1.9,0,3.8-0.9,5-2.4l0.6,0.4C16.3,18,14.2,19,12,19z M5.5,14.7C5.2,13.8,5,12.8,5,12c0-3.5,2.7-6.5,6.2-7v0.6C8,6.1,5.7,8.8,5.7,12c0,0.8,0.1,1.5,0.4,2.4L5.5,14.7z M18,14.4 c0.3-0.8,0.4-1.6,0.4-2.4c0-3.2-2.3-5.9-5.5-6.4c0-0.2,0-0.5,0-0.6c3.5,0.4,6.2,3.4,6.2,7c0,0.8-0.2,1.8-0.5,2.7L18,14.4z" fill="var(--svg-icon-tint)" opacity="0.3"></path>\n\t\t\t\t<path d="M10.2,15V8.9l5.5,3.1L10.2,15z" fill="var(--svg-icon-tint)"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="nav" viewBox="0 0 24 24">\n\t\t\t\t<path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path>\n\t\t\t\t<path d="M 6.5 8.667 C 6.5 8.114 6.948 7.667 7.5 7.667 L 16.5 7.667 C 17.052 7.667 17.5 8.114 17.5 8.667 L 17.5 14.495 C 17.5 15.046 17.053 15.494 16.502 15.495 L 14.189 15.499 C 13.959 15.5 13.736 15.58 13.558 15.725 L 12.211 16.827 C 12.088 16.928 11.912 16.928 11.789 16.827 L 10.442 15.725 C 10.264 15.58 10.041 15.5 9.811 15.499 L 7.498 15.495 C 6.947 15.494 6.5 15.046 6.5 14.495 Z" fill="var(--svg-icon-tint)"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="plane" viewBox="0 0 24 24">\n\t\t\t\t<path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path>\n\t\t\t\t<path d="M 2 1 L 1 0 L 0 1" transform="translate(4.667 11.5) rotate(-90 1 0.5)" fill="transparent" opacity="0.4" stroke="var(--svg-icon-tint)" stroke-linecap="round" stroke-linejoin="round"></path>\n\t\t\t\t<path d="M 2 1 L 1 0 L 0 1" transform="translate(17.333 11.5) rotate(90 1 0.5)" fill="transparent" opacity="0.4" stroke="var(--svg-icon-tint)" stroke-linecap="round" stroke-linejoin="round"></path>\n\t\t\t\t<path d="M 8 9 C 8 8.448 8.448 8 9 8 L 15 8 C 15.552 8 16 8.448 16 9 L 16 15 C 16 15.552 15.552 16 15 16 L 9 16 C 8.448 16 8 15.552 8 15 Z" fill="var(--svg-icon-tint)"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="curved-plane" viewBox="0 0 24 24">\n\t\t\t\t<path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path>\n\t\t\t\t<path d="M 2 1 L 1 0 L 0 1" transform="translate(4.667 11.5) rotate(-90 1 0.5)" fill="transparent" opacity="0.4" stroke="var(--svg-icon-tint)" stroke-linecap="round" stroke-linejoin="round"></path>\n\t\t\t\t<path d="M 2 1 L 1 0 L 0 1" transform="translate(17.333 11.5) rotate(90 1 0.5)" fill="transparent" opacity="0.4" stroke="var(--svg-icon-tint)" stroke-linecap="round" stroke-linejoin="round"></path>\n\t\t\t\t<path d="M 8 9 C 8 8.448 8.448 8 9 8 L 15 8 C 15.552 8 16 8.448 16 9 L 16 15 C 16 15.552 15.552 16 15 16 L 9 16 C 8.448 16 8 15.552 8 15 Z" fill="var(--svg-icon-tint)"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="texture" viewBox="0 0 24 24">\n\t\t\t\t<path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path>\n\t\t\t\t<path d="M 7.333 8.95 C 7.333 8.274 7.839 7.705 8.511 7.626 L 14.805 6.886 C 15.796 6.769 16.667 7.543 16.667 8.541 L 16.667 15.49 C 16.667 16.477 15.814 17.247 14.833 17.148 L 8.533 16.513 C 7.852 16.444 7.333 15.871 7.333 15.187 Z" fill="var(--svg-icon-tint)"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="gltf" viewBox="0 0 24 24">\n\t\t\t\t<path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.3"></path>\n\t\t\t\t<path d="M 11.298 7.283 C 11.602 6.729 12.398 6.729 12.702 7.283 L 14.009 9.673 C 14.082 9.807 14.193 9.918 14.327 9.991 L 16.717 11.298 C 17.271 11.602 17.271 12.398 16.717 12.702 L 14.327 14.009 C 14.193 14.082 14.082 14.193 14.009 14.327 L 12.702 16.717 C 12.398 17.271 11.602 17.271 11.298 16.717 L 9.991 14.327 C 9.918 14.193 9.807 14.082 9.673 14.009 L 7.283 12.702 C 6.729 12.398 6.729 11.602 7.283 11.298 L 9.673 9.991 C 9.807 9.918 9.918 9.807 9.991 9.673 Z" fill="var(--svg-icon-tint)"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="tile" viewBox="0 0 24 24">\n\t\t\t\t<path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path>\n\t\t\t\t<path d="M 15.667 13 C 17.139 13 18.333 14.194 18.333 15.667 C 18.333 17.139 17.139 18.333 15.667 18.333 C 14.194 18.333 13 17.139 13 15.667 C 13 14.194 14.194 13 15.667 13 Z" fill="var(--svg-icon-tint)"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="image" viewBox="0 0 24 24">\n\t\t\t\t<path d="M5 8.5c0-.828.672-1.5 1.5-1.5s1.5.672 1.5 1.5c0 .829-.672 1.5-1.5 1.5s-1.5-.671-1.5-1.5zm9 .5l-2.519 4-2.481-1.96-4 5.96h14l-5-8zm8-4v14h-20v-14h20zm2-2h-24v18h24v-18z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="video" viewBox="0 0 24 24">\n\t\t\t\t<path d="M2.184 7.874l-2.184-.918 2.967-2.956.933 2.164-1.716 1.71zm21.816 2.126l-3 2v4l3 2v-8zm-7-2h-7.018l.79.787c.356.355.629.769.831 1.213h4.897c.276 0 .5.224.5.5v7c0 .276-.224.5-.5.5h-11c-.276 0-.5-.224-.5-.5v-2.909l-.018-.014-1.982-1.975v5.398c0 1.104.896 2 2 2h12c1.104 0 2-.896 2-2v-8c0-1.104-.896-2-2-2zm-14.65 1.13l2.967-2.956 4.044 4.029c.819.816.819 2.14 0 2.956-.819.816-2.147.815-2.967 0l-4.044-4.029z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="stream" viewBox="0 0 24 24">\n\t\t\t\t<path d="M6.613 18.581m9.387-9.581c0 2.209-1.791 4-4 4s-4-1.791-4-4 1.791-4 4-4 4 1.791 4 4zm-2 0c0-1.103-.896-2-2-2s-2 .897-2 2 .896 2 2 2 2-.897 2-2zm-9 0c0 3.86 3.141 7 7 7s7-3.14 7-7-3.141-7-7-7-7 3.14-7 7zm16 0c0 4.97-4.029 9-9 9s-9-4.03-9-9 4.029-9 9-9 9 4.03 9 9zm-.404 12.501c1.007 1.142-.014 2.679-1.448 2.481-1.795-.245-3.236-1.702-7.147-1.702-3.91 0-5.352 1.458-7.146 1.702-1.436.198-2.456-1.34-1.449-2.481l2.898-3.289c.559.388 1.156.725 1.79.994l-2.025 2.298c1.295-.524 3.065-1.225 5.933-1.225s4.638.7 5.933 1.224l-2.025-2.298c.634-.27 1.231-.606 1.79-.994l2.896 3.29z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="spinner" viewBox="0 0 24 24">\n\t\t\t\t<path d="M8.175 7.377l-3.042-5.27 1.732-1 3.045 5.273c-.635.238-1.222.573-1.735.997zm-.799.8l-5.27-3.042-1 1.732 5.274 3.045c.237-.635.572-1.223.996-1.735zm-1.376 3.823c0-.341.035-.673.09-.999h-6.09v1.999h6.09c-.055-.326-.09-.659-.09-1zm11.351-2.705l5.208-3.007-.333-.577-5.206 3.007c.121.185.23.379.331.577zm-5.351-3.295c.341 0 .673.035.999.09v-6.09h-1.999v6.09c.326-.055.659-.09 1-.09zm3.14.894l3.004-5.204-.288-.166-3 5.197.284.173zm1.685 8.662l5.234 3.022.666-1.154-5.229-3.019c-.181.41-.408.794-.671 1.151zm-10.444-1.467l-5.274 3.046 1 1.732 5.27-3.042c-.424-.513-.759-1.1-.996-1.736zm11.594-2.589l.025.5-.025.5h6.025v-1h-6.025zm-3.727 6.061l3.03 5.249 1.442-.833-3.031-5.25c-.437.34-.92.623-1.441.834zm-2.248.439c-.341 0-.674-.035-1-.09v6.09h1.999v-6.09c-.326.055-.658.09-.999.09zm-3.824-1.376l-3.042 5.27 1.732 1 3.045-5.274c-.635-.237-1.222-.572-1.735-.996z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="update" viewBox="0 0 24 24">\n\t\t\t\t<path d="M23 12c0 1.042-.154 2.045-.425 3h-2.101c.335-.94.526-1.947.526-3 0-4.962-4.037-9-9-9-1.706 0-3.296.484-4.655 1.314l1.858 2.686h-6.994l2.152-7 1.849 2.673c1.684-1.049 3.659-1.673 5.79-1.673 6.074 0 11 4.925 11 11zm-6.354 7.692c-1.357.826-2.944 1.308-4.646 1.308-4.962 0-9-4.038-9-9 0-1.053.191-2.06.525-3h-2.1c-.271.955-.425 1.958-.425 3 0 6.075 4.925 11 11 11 2.127 0 4.099-.621 5.78-1.667l1.853 2.667 2.152-6.989h-6.994l1.855 2.681z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="edit" viewBox="0 0 24 24">\n\t\t\t\t<path d="M0 1h24v2h-24v-2zm11 7h13v-2h-13v2zm0 5h13v-2h-13v2zm0 5h13v-2h-13v2zm-11 5h24v-2h-24v2zm8-17l-8 6 8 6v-12z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="lock" viewBox="0 0 24 24">\n\t\t\t\t<path d="M18 10v-4c0-3.313-2.687-6-6-6s-6 2.687-6 6v4h-3v14h18v-14h-3zm-10 0v-4c0-2.206 1.794-4 4-4s4 1.794 4 4v4h-8z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="volume-off" viewBox="0 0 24 24">\n\t\t\t\t<path d="M5 17h-5v-10h5v10zm2-10v10l9 5v-20l-9 5zm15.324 4.993l1.646-1.659-1.324-1.324-1.651 1.67-1.665-1.648-1.316 1.318 1.67 1.657-1.65 1.669 1.318 1.317 1.658-1.672 1.666 1.653 1.324-1.325-1.676-1.656z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="volume-on" viewBox="0 0 24 24">\n\t\t\t\t<path d="M5 17h-5v-10h5v10zm2-10v10l9 5v-20l-9 5zm11.008 2.093c.742.743 1.2 1.77 1.198 2.903-.002 1.133-.462 2.158-1.205 2.9l1.219 1.223c1.057-1.053 1.712-2.511 1.715-4.121.002-1.611-.648-3.068-1.702-4.125l-1.225 1.22zm2.142-2.135c1.288 1.292 2.082 3.073 2.079 5.041s-.804 3.75-2.096 5.039l1.25 1.254c1.612-1.608 2.613-3.834 2.616-6.291.005-2.457-.986-4.681-2.595-6.293l-1.254 1.25z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="fullscreen-off" viewBox="0 0 24 24">\n\t\t\t\t<path d="M15 2h2v5h7v2h-9v-7zm9 13v2h-7v5h-2v-7h9zm-15 7h-2v-5h-7v-2h9v7zm-9-13v-2h7v-5h2v7h-9z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="fullscreen-on" viewBox="0 0 24 24">\n\t\t\t\t<path d="M24 9h-2v-7h-7v-2h9v9zm-9 15v-2h7v-7h2v9h-9zm-15-9h2v7h7v2h-9v-9zm9-15v2h-7v7h-2v-9h9z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="navmap" viewBox="0 0 24 24">\n\t\t\t\t<path d="M24 22.586l-2.823-2.823c.526-.792.836-1.74.836-2.763 0-2.762-2.238-5-5-5s-5 2.238-5 5 2.238 5 5 5c1.016 0 1.957-.307 2.746-.827l2.827 2.827 1.414-1.414zm-9.987-5.586c0-1.654 1.346-3 3-3s3 1.346 3 3-1.346 3-3 3-3-1.346-3-3zm-4 0l.002-.034-3.015 2.175v-13.068l4-2.886v10.247c.508-.854 1.189-1.591 2-2.161v-8.086l4 2.886v3.927h.013c.336 0 .664.032.987.078v-4.007l4-2.479v8.504c1.188 1.208 1.936 2.844 2 4.653v-16.749l-6.455 4-5.545-4-5.545 4-6.455-4v18l6.455 4 3.91-2.82c-.226-.687-.352-1.419-.352-2.18zm-4.013 2.365l-4-2.479v-13.294l4 2.479v13.294z"/>\n\t\t\t</symbol>\n\t\t\t<symbol id="screen" viewBox="0 0 24 24">\n\t\t\t\t<path d="M0 0v19h24v-19h-24zm22 14h-20v-12h20v12zm-6.599 7l2.599 3h-12l2.599-3h6.802z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="chat" viewBox="0 0 24 24">\n\t\t\t\t<path d="M22 3v13h-11.643l-4.357 3.105v-3.105h-4v-13h20zm2-2h-24v16.981h4v5.019l7-5.019h13v-16.981z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="send" viewBox="0 0 24 24">\n\t\t\t\t<path d="M22 12l-20 12 5-12-5-12z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="users" viewBox="0 0 24 24">\n\t\t\t\t<path d="M10.644 17.08c2.866-.662 4.539-1.241 3.246-3.682-3.932-7.427-1.042-11.398 3.111-11.398 4.235 0 7.054 4.124 3.11 11.398-1.332 2.455.437 3.034 3.242 3.682 2.483.574 2.647 1.787 2.647 3.889v1.031h-18c0-2.745-.22-4.258 2.644-4.92zm-12.644 4.92h7.809c-.035-8.177 3.436-5.313 3.436-11.127 0-2.511-1.639-3.873-3.748-3.873-3.115 0-5.282 2.979-2.333 8.549.969 1.83-1.031 2.265-3.181 2.761-1.862.43-1.983 1.34-1.983 2.917v.773z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="virtual-tour" viewBox="0 0 24 24">\n\t\t\t\t<path d="M17 17h-10v-10h10v10zm7 3l-5-3v-10l5-3v16zm-24-16l5 3v10l-5 3v-16z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="live-meeting" viewBox="0 0 24 24">\n\t\t\t\t<path d="M18 18h6v6h-6v-6zm-9 6h6v-6h-6v6zm-9 0h6v-6h-6v6zm0-8h24v-16h-24v16z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="control" viewBox="0 0 24 24">\n\t\t\t\t<circle cx="7" cy="10" r="1"></circle>\n\t\t\t\t<path d="M17,3H7c-3.9,0-7,3.1-7,7v6c0,2.8,2.2,5,5,5c2.4,0,4.4-1.7,4.9-4h4.2c0.5,2.7,3.2,4.5,5.9,3.9c2.3-0.5,4-2.5,4-4.9v-6 C24,6.1,20.9,3,17,3z M17,7c0.6,0,1,0.4,1,1s-0.4,1-1,1s-1-0.4-1-1S16.4,7,17,7z M7,13c-1.7,0-3-1.3-3-3s1.3-3,3-3s3,1.3,3,3 S8.7,13,7,13z M15,11c-0.6,0-1-0.4-1-1s0.4-1,1-1s1,0.4,1,1S15.6,11,15,11z M17,13c-0.6,0-1-0.4-1-1c0-0.6,0.4-1,1-1s1,0.4,1,1 C18,12.5,17.6,13,17,13z M19,11c-0.6,0-1-0.4-1-1s0.4-1,1-1s1,0.4,1,1S19.6,11,19,11z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="spy" viewBox="0 0 24 24">\n\t\t\t\t<path fill-rule="evenodd" d="M0.2,11.4c5.2-8.6,18.3-8.5,23.6,0c0.2,0.3,0.2,0.8,0,1.2c-5.3,8.4-18.4,8.6-23.6,0 C-0.1,12.2-0.1,11.7,0.2,11.4z M12,7.8c2.3,0,4.2,1.9,4.2,4.3s-1.9,4.2-4.2,4.2S7.8,14.3,7.8,12S9.7,7.8,12,7.8z" clip-rule="evenodd"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="joystick" viewBox="0 0 24 24">\n\t\t\t\t<path d="M10.7,10.5V16H9.3C8.6,16,8,16.6,8,17.3h8c0-0.7-0.6-1.3-1.3-1.3h-1.3v-5.5c2.8-0.7,4.5-3.6,3.8-6.5 c-0.7-2.8-3.6-4.5-6.5-3.8S6.1,3.9,6.9,6.7C7.3,8.6,8.8,10,10.7,10.5z"></path>\n\t\t\t\t<path d="M1.4,18.6h21.2c0.7,0,1.3,0.6,1.3,1.3v2.7c0,0.7-0.6,1.3-1.3,1.3H1.4c-0.7,0-1.3-0.6-1.3-1.3V20 C0.1,19.2,0.7,18.6,1.4,18.6z"></path>\n\t\t\t</symbol>\n\t\t\t<symbol id="navinfo" viewBox="0 0 24 24">\n\t\t\t\t<path d="M12,2c5.5,0,10,4.5,10,10s-4.5,10-10,10S2,17.5,2,12S6.5,2,12,2z M12,0C5.4,0,0,5.4,0,12s5.4,12,12,12s12-5.4,12-12 S18.6,0,12,0z"/>\n\t\t\t\t<path d="M13,18h-2v-8h2V18z M12,5.8c0.7,0,1.2,0.6,1.2,1.2S12.7,8.2,12,8.2S10.8,7.7,10.8,7S11.3,5.8,12,5.8z"/>\n\t\t\t</symbol>\n\t\t\t<symbol id="check" viewBox="0 0 24 24">\n\t\t\t\t<path d="M9,21l-9-8.6l2.8-2.9l6.2,5.9L21.2,3L24,5.8L9,21z"/>\n\t\t\t</symbol>\n\t\t\t<symbol id="duplicate" viewBox="0 0 24 24">\n\t\t\t\t<path d="M18,6V0H0v18h6v6h18V6H18z M6,16H2V2h14v4H6V16z M22,22H8V8h14V22z M19,14h-3v-3h-2v3h-3v2h3v3h2v-3h3V14z"/>\n\t\t\t</symbol>\n\t\t\t<symbol id="trash" viewBox="0 0 24 24">\n\t\t\t\t<path fill-rule="evenodd" d="M19,24H5c-1.1,0-2-0.9-2-2V5H2V3h6V1.5C8,0.7,8.7,0,9.5,0h5C15.3,0,16,0.7,16,1.5V3h6v2h-1v17 C21,23.1,20.1,24,19,24z M19,5H5v16.5C5,21.8,5.2,22,5.5,22h13c0.3,0,0.5-0.2,0.5-0.5V5z M10,9c0-0.6-0.4-1-1-1S8,8.4,8,9v9 c0,0.6,0.4,1,1,1s1-0.4,1-1V9z M16,9c0-0.6-0.4-1-1-1s-1,0.4-1,1v9c0,0.6,0.4,1,1,1s1-0.4,1-1V9z M14,2h-4v1h4V2z" clip-rule="evenodd"/>\n\t\t\t</symbol>\n\t\t\t<symbol id="flags" viewBox="0 0 24 24">\n\t\t\t\t<path d="M19,18c0,1.1-0.9,2-2,2s-2-0.9-2-2s0.9-2,2-2S19,16.9,19,18z M5,15c-1.7,0-3,1.3-3,3s1.3,3,3,3h14c1.7,0,3-1.3,3-3 s-1.3-3-3-3H5z M24,18c0,2.8-2.2,5-5,5H5c-2.8,0-5-2.2-5-5s2.2-5,5-5h14C21.8,13,24,15.2,24,18z M7,4C5.9,4,5,4.9,5,6s0.9,2,2,2 s2-0.9,2-2S8.1,4,7,4z M5,3C3.3,3,2,4.3,2,6s1.3,3,3,3h14c1.7,0,3-1.3,3-3s-1.3-3-3-3H5z M24,6c0,2.8-2.2,5-5,5H5c-2.8,0-5-2.2-5-5 s2.2-5,5-5h14C21.8,1,24,3.2,24,6z"/>\n\t\t\t</symbol>\n\t\t\t<symbol id="b-here" viewBox="0 0 270 98">\n\t\t\t\t<path d="M61.5,87.9c0-2.7,0.9-5,2.8-6.9c1.9-1.9,4.2-2.8,7-2.8c1.4,0,2.7,0.2,3.9,0.8c1.2,0.5,2.2,1.2,3.2,2 c0.9,0.9,1.6,1.9,2.1,3.1s0.8,2.5,0.8,3.8s-0.2,2.6-0.8,3.8c-0.5,1.2-1.2,2.2-2.1,3.1s-1.9,1.6-3.2,2.1c-1.2,0.5-2.5,0.8-3.9,0.8 s-2.7-0.2-3.9-0.8c-1.2-0.5-2.2-1.2-3.1-2.1s-1.6-1.9-2.1-3.1S61.5,89.2,61.5,87.9z"></path>\n\t\t\t\t<path d="M16,70.2H0.7v-70H16V29c0.6-1.1,1.4-2.1,2.4-3.1s2.2-1.9,3.5-2.6s2.8-1.3,4.2-1.8c1.5-0.4,3-0.6,4.6-0.6 c3.5,0,6.7,0.6,9.6,1.9s5.4,3.1,7.4,5.3c2.1,2.2,3.7,4.9,4.8,8s1.7,6.4,1.7,10.1c0,3.6-0.6,6.9-1.7,10c-1.1,3.1-2.7,5.8-4.8,8 c-2.1,2.2-4.5,4-7.4,5.3s-6.1,2-9.6,2c-1.6,0-3.1-0.2-4.6-0.7c-1.5-0.4-2.9-1-4.2-1.7c-1.3-0.7-2.5-1.5-3.5-2.5s-1.8-2-2.4-3.1 C16,63.5,16,70.2,16,70.2z M27.6,58.5c1.7,0,3.2-0.3,4.6-1c1.4-0.7,2.6-1.5,3.6-2.7c1-1.1,1.8-2.4,2.4-3.9c0.6-1.5,0.8-3.1,0.8-4.8 s-0.3-3.2-0.8-4.7c-0.6-1.5-1.4-2.8-2.4-3.9c-1-1.1-2.2-2-3.6-2.7c-1.4-0.7-2.9-1-4.6-1s-3.3,0.3-4.8,1c-1.4,0.7-2.7,1.6-3.7,2.7 c-1,1.1-1.8,2.4-2.3,3.9c-0.6,1.5-0.8,3-0.8,4.7s0.3,3.2,0.8,4.8s1.3,2.8,2.3,3.9c1,1.1,2.2,2,3.7,2.7 C24.3,58.2,25.9,58.5,27.6,58.5z"></path>\n\t\t\t\t<path d="M64.1,0.2h14.8V29c1.3-2.5,3.3-4.5,6-6s5.9-2.2,9.6-2.2c3.1,0,5.8,0.5,7.9,1.4c2.1,1,3.9,2.3,5.2,4.1 c1.5,1.9,2.6,4,3.1,6.5s0.8,5.4,0.8,8.9v28.5H96.7V45.5c0-3.5-0.6-6.3-1.8-8.5c-1.2-2.2-3.5-3.2-6.7-3.2c-3.1,0-5.5,1.1-7,3.3 s-2.3,5.2-2.3,8.9v24.2H64.1V0.2z"></path>\n\t\t\t\t<path d="M135.9,49.8c0.1,1.5,0.3,2.9,0.7,4.2s1,2.4,1.8,3.4s1.9,1.7,3.2,2.3s3,0.8,5,0.8c2.7,0,4.7-0.5,6-1.6 c1.4-1.1,2.3-2.4,2.9-3.9h15c-0.3,2.3-1.1,4.4-2.4,6.4c-1.2,2-2.9,3.8-4.9,5.2c-2,1.5-4.4,2.7-7.2,3.5c-2.8,0.9-5.9,1.3-9.3,1.3 c-4.2,0-7.9-0.6-11.2-1.8c-3.2-1.2-6-3-8.2-5.2c-2.2-2.3-3.9-5-5-8c-1.1-3.1-1.7-6.5-1.7-10.2c0-3.5,0.5-6.8,1.6-9.9s2.7-5.8,4.9-8 c2.2-2.3,4.8-4.1,8-5.5c3.2-1.3,6.8-2,11-2c3.8,0,7.2,0.6,10.2,1.8c3,1.2,5.6,2.8,7.8,4.8s3.8,4.3,5,7s1.8,5.5,1.8,8.4 c0,1,0,2.1,0,3.2c0,1.1-0.2,2.4-0.5,3.9h-34.5V49.8z M146.2,31c-3,0-5.5,0.9-7.4,2.6c-1.9,1.7-2.9,4.2-2.9,7.5h20.2 c0-3.1-0.9-5.6-2.8-7.4C151.5,31.9,149.1,31,146.2,31z"></path>\n\t\t\t\t<path d="M216.1,36c-1.1-0.3-2-0.5-2.7-0.6c-0.7-0.1-1.6-0.1-2.7-0.1c-4.2,0-7.6,1.2-10.1,3.7s-3.8,6.6-3.8,12.5v18.8h-15.3V22h15.3 v7.8c1.1-2.3,3-4.3,5.7-6c2.6-1.7,5.6-2.6,9-2.6c1.8,0,3.3,0.3,4.6,0.8V36z"></path>\n\t\t\t\t<path d="M234.3,49.8c0.1,1.5,0.3,2.9,0.7,4.2s1,2.4,1.8,3.4s1.9,1.7,3.2,2.3s3,0.8,5,0.8c2.7,0,4.7-0.5,6-1.6 c1.4-1.1,2.3-2.4,2.9-3.9h15c-0.3,2.3-1.1,4.4-2.4,6.4c-1.2,2-2.9,3.8-4.9,5.2c-2,1.5-4.4,2.7-7.2,3.5c-2.8,0.9-5.9,1.3-9.3,1.3 c-4.2,0-7.9-0.6-11.2-1.8c-3.2-1.2-6-3-8.2-5.2c-2.2-2.3-3.9-5-5-8c-1.1-3.1-1.7-6.5-1.7-10.2c0-3.5,0.5-6.8,1.6-9.9s2.7-5.8,4.9-8 c2.2-2.3,4.8-4.1,8-5.5c3.2-1.3,6.8-2,11-2c3.8,0,7.2,0.6,10.2,1.8c3,1.2,5.6,2.8,7.8,4.8c2.2,2,3.8,4.3,5,7s1.8,5.5,1.8,8.4 c0,1,0,2.1,0,3.2c0,1.1-0.2,2.4-0.5,3.9h-34.5V49.8z M244.6,31c-3,0-5.5,0.9-7.4,2.6c-1.9,1.7-2.9,4.2-2.9,7.5h20.2 c0-3.1-0.9-5.6-2.8-7.4C249.9,31.9,247.5,31,244.6,31z"></path>\n\t\t\t</symbol>\n\t\t</svg>\n\t\n\t\t\x3c!-- header --\x3e\n\t\t<router-outlet></router-outlet>\n\t\t\x3c!-- footer --\x3e\n\t\t<div class="toast-outlet" toast-outlet></div>\n\t\t<div class="modal-outlet" modal-outlet></div>\n\t'};const gr=["bmp","gif","ico","jpeg","jpg","png","svg","tif","tiff","webp","hdr"],fr=["mp4","avi","mpeg","ogv","ts","webm","3gp","3g2"],br=["fbx","gltf","glb","obj","usdz"],wr=["publisherStream","nextAttendeeStream","publisherScreen","attendeeScreen"];class yr extends t.Pipe{static transform(t,e){if(void 0===e&&(e=null),null!=e&&(t=t.type.name===e?t:null),t){if("string"==typeof t)return U.getPath(t);switch(t.type.name){case Yi.Image.name:case Yi.Video.name:case Yi.Model.name:t=t.folder+t.file,t=U.getPath(t);break;case Yi.PublisherStream.name:case Yi.AttendeeStream.name:case Yi.PublisherScreen.name:case Yi.AttendeeScreen.name:case Yi.SmartDeviceStream.name:t=U.getPath(t.file);break;default:s=t.file,new RegExp(`/.(${gr.join("|")})$/i`).test(s)||function(t){return new RegExp(`/.(${fr.join("|")})$/i`).test(t)}(t.file)?(t=t.folder+t.file,t=U.getPath(t)):!function(t){return new RegExp(`/.(${br.join("|")})$/i`).test(t)}(t.file)?function(t){return-1!==wr.indexOf(t)}(t.file)&&(t=t.file):(t=t.folder+t.file,t=U.getPath(t))}t=t}else t=null;var s;return t}}yr.meta={name:"asset"};class xr extends t.Component{onInit(){super.onInit();const{parentInstance:e}=t.getContext(this);e instanceof qi&&(this.data=e.modal.data)}onAccept(t){ei.resolve()}onReject(t){ei.reject()}onClose(){ei.reject()}}xr.meta={selector:"[control-request-modal]",template:'\n\t\t<div class="modal__header">\n\t\t\t<button type="button" class="btn--close" (click)="onClose()">\n\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#close"></use></svg>\n\t\t\t</button>\n\t\t</div>\n\t\t<div class="container">\n\t\t\t<div class="form">\n\t\t\t\t<div class="title">L\'utente ha richiesto il controllo della navigazione. Accetti?</div>\n\t\t\t\t<div class="group--cta">\n\t\t\t\t\t<button type="button" class="btn--cancel" (click)="onReject()">\n\t\t\t\t\t\t<span>Rifiuta</span>\n\t\t\t\t\t</button>\n\t\t\t\t\t<button type="button" class="btn--accept" (click)="onAccept()">\n\t\t\t\t\t\t<span>Accetta</span>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t'},xr.chunk=()=>'<div class="control-request-modal" control-request-modal></div>';class Cr extends t.Directive{onInit(){const{module:e,node:n,parentInstance:o,selector:a}=t.getContext(this),r="drop",l=s.fromEvent(n,r).pipe(i.shareReplay(1)),c=n.getAttribute("(drop)");if(c){const t=e.makeFunction(c,["$event"]);l.pipe(i.takeUntil(this.unsubscribe$)).subscribe((s=>{e.resolve(t,o,s)})),s.fromEvent(n,"dragover").pipe(i.takeUntil(this.unsubscribe$)).subscribe((t=>t.preventDefault()))}else o.drop$=l}}Cr.meta={selector:"[(drop)]"};let Mr=1e6;class kr extends t.Directive{get id(){return this.dropdown||this.id_||(this.id_=kr.nextId())}onInit(){const{node:e}=t.getContext(this),s=e.getAttribute("dropdown-trigger");this.trigger=s?e.querySelector(s):e,this.opened=null,this.onClick=this.onClick.bind(this),this.onDocumentClick=this.onDocumentClick.bind(this),this.openDropdown=this.openDropdown.bind(this),this.closeDropdown=this.closeDropdown.bind(this),this.addListeners(),kr.dropdown$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((t=>{this.id===t?e.classList.add("dropped"):e.classList.remove("dropped")}))}onClick(e){const{node:s}=t.getContext(this);if(null===this.opened)this.openDropdown();else{s.querySelector("[dropdown-item]")||this.closeDropdown()}}onDocumentClick(e){const{node:s}=t.getContext(this);s===e.target||s.contains(e.target)||this.closeDropdown()}openDropdown(){null===this.opened&&(this.opened=!0,this.addDocumentListeners(),kr.dropdown$.next(this.id),this.dropped.next(this.id))}closeDropdown(){null!==this.opened&&(this.removeDocumentListeners(),this.opened=null,kr.dropdown$.getValue()===this.id&&(kr.dropdown$.next(null),this.dropped.next(null)))}addListeners(){this.trigger.addEventListener("click",this.onClick)}addDocumentListeners(){document.addEventListener("click",this.onDocumentClick)}removeListeners(){this.trigger.removeEventListener("click",this.onClick)}removeDocumentListeners(){document.removeEventListener("click",this.onDocumentClick)}onDestroy(){this.removeListeners(),this.removeDocumentListeners()}static nextId(){return Mr++}}kr.meta={selector:"[dropdown]",inputs:["dropdown","dropdown-trigger"],outputs:["dropped"]},kr.dropdown$=new s.BehaviorSubject(null);class Sr extends t.Directive{get id(){return this["dropdown-item"]}onInit(){const{node:e}=t.getContext(this);e.classList.add("dropdown-item"),kr.dropdown$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((t=>{this.id===t?e.classList.add("dropped"):e.classList.remove("dropped")}))}}Sr.meta={selector:"[dropdown-item], [[dropdown-item]]",inputs:["dropdown-item"]};class Tr extends t.Component{onInit(){this.toast=null,this.lastToast=null,Gi.toast$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((t=>{t&&(this.lastToast=t),this.toast=t,this.pushChanges()}))}getClass(){const t={};return this.toast&&(t.active=!0),this.lastToast&&(t[this.lastToast.type]=!0,t[this.lastToast.position]=!0),t}onClose(){Gi.reject(this.toast)}onAccept(){Gi.resolve(this.toast)}onReject(){Gi.reject(this.toast)}}Tr.meta={selector:"[toast-outlet]",template:'\n\t<div class="toast-outlet__container" [class]="getClass()">\n\t\t<div class="toast-outlet__toast" *if="lastToast">\n\t\t\t<span class="toast-outlet__message" [innerHTML]="lastToast.message"></span>\n\t\t\t<div class="group--cta" *if="lastToast.type != \'info\'">\n\t\t\t\t<button type="button" class="btn--accept" (click)="onAccept()">\n\t\t\t\t\t<span [innerHTML]="lastToast.acceptMessage"></span>\n\t\t\t\t</button>\n\t\t\t\t<button type="button" class="btn--cancel" (click)="onReject()" *if="lastToast.type == \'dialog\'">\n\t\t\t\t\t<span [innerHTML]="lastToast.rejectMessage"></span>\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t\t<button type="button" class="btn--close" (click)="onClose()" *if="lastToast.type != \'info\'">\n\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#close"></use></svg>\n\t\t\t</button>\n\t\t</div>\n\t</div>\n\t'};class Er extends t.Component{onInit(){this.mode=1,this.viewTypes=Object.keys(bi).map((t=>{const e=bi[t];return{type:e,name:ge.getKeys("editor",e.name),disabled:-1!==U.editor.disabledViewTypes.indexOf(e.name)}})),this.viewItemTypes=Object.keys(wi).map((t=>{const e=wi[t];return{type:e,name:ge.getKeys("editor",e.name),disabled:-1!==U.editor.disabledViewItemTypes.indexOf(e.name)}})),this.setSupportedViewTypes(),this.setSupportedViewItemTypes()}onChanges(){this.setSupportedViewTypes(),this.setSupportedViewItemTypes()}setSupportedViewTypes(){this.supportedViewTypes=this.viewTypes.filter((t=>this.supportedViewType(t.type.name))).sort(((t,e)=>t.disabled===e.disabled?0:t.disabled?1:-1))}setSupportedViewItemTypes(){this.view?this.supportedViewItemTypes=this.viewItemTypes.filter((t=>this.supportedViewItemType(this.view.type.name,t.type.name))).sort(((t,e)=>t.disabled===e.disabled?0:t.disabled?1:-1)):this.supportedViewItemTypes=[]}setMode(t){this.mode!==t&&(this.mode=t,this.pushChanges())}supportedViewType(t){return-1!==[bi.Panorama.name,bi.PanoramaGrid.name,bi.Room3d.name,bi.Model.name,bi.Media.name].indexOf(t)}supportedViewItemType(t,e){let s;switch(t){case bi.WaitingRoom.name:s=!1;break;case bi.Panorama.name:case bi.PanoramaGrid.name:s=-1!==[wi.Nav.name,wi.Model.name,wi.Plane.name,wi.CurvedPlane.name].indexOf(e);break;case bi.Room3d.name:s=-1!==[wi.Nav.name,wi.Model.name,wi.Plane.name,wi.Texture.name].indexOf(e);break;case bi.Model.name:s=-1!==[wi.Nav.name,wi.Model.name,wi.Plane.name,wi.CurvedPlane.name].indexOf(e);break;case bi.Media.name:s=-1!==[].indexOf(e)}return s}onSelect(t){this.select.next(t)}onUpdate(t){this.update.next(t)}onDelete(t){this.delete.next(t)}}Er.meta={selector:"[aside]",outputs:["select","update","delete"],inputs:["view"],template:'\n\t<div class="headline">\n\t\t<ul class="nav--tab">\n\t\t\t<li [class]="{ active: mode === 1 }" (click)="setMode(1)" [innerHTML]="\'editor_properties\' | label"></li>\n\t\t\t<li [class]="{ active: mode === 2 }" (click)="setMode(2)" [innerHTML]="\'editor_views\' | label"></li>\n\t\t\t<li [class]="{ active: mode === 3 }" (click)="setMode(3)" [innerHTML]="\'editor_view_items\' | label"></li>\n\t\t</ul>\n\t\t\x3c!--\n\t\t<div class="btn--mode" [class]="{ active: mode === 1 }" (click)="setMode(1)" [innerHTML]="\'editor_properties\' | label"></div>\n\t\t<div class="btn--mode" [class]="{ active: mode === 2 }" (click)="setMode(2)" [innerHTML]="\'editor_views\' | label"></div>\n\t\t<div class="btn--mode" [class]="{ active: mode === 3 }" (click)="setMode(3)" [innerHTML]="\'editor_view_items\' | label"></div>\n\t\t--\x3e\n\t</div>\n\t<div class="scrollable">\n\t\t<ul class="nav--editor" *if="mode === 1">\n\t\t\t<li>\n\t\t\t\t<div class="title" [innerHTML]="\'editor_properties\' | label"></div>\n\t\t\t\t<update-view [view]="view" (select)="onSelect($event)" (update)="onUpdate($event)" (delete)="onDelete($event)"></update-view>\n\t\t\t</li>\n\t\t\t<li *if="view.type.name != \'panorama-grid\'">\n\t\t\t\t<div class="title" [innerHTML]="\'editor_items\' | label"></div>\n\t\t\t\t<update-view-item [view]="view" [item]="item" (select)="onSelect($event)" (update)="onUpdate($event)" (delete)="onDelete($event)" *for="let item of view.pathItems"></update-view-item>\n\t\t\t\t<div class="abstract" *if="view.pathItems.length == 0" [innerHTML]="\'editor_no_items\' | label"></div>\n\t\t\t\t<div class="btn--mode" (click)="setMode(3)" [innerHTML]="\'editor_add_item\' | label"></div>\n\t\t\t</li>\n\t\t\t<li *if="view.type.name == \'panorama-grid\'">\n\t\t\t\t<div class="title" [innerHTML]="\'editor_tiles\' | label"></div>\n\t\t\t\t<div *for="let tile of view.tiles">\n\t\t\t\t\t<div *if="tile.selected">\n\t\t\t\t\t\t<update-view-tile [view]="view" [tile]="tile" (update)="onUpdate($event)" (delete)="onDelete($event)"></update-view-tile>\n\t\t\t\t\t\t<ul class="nav--editor">\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t<update-view-item [view]="view" [item]="item" (select)="onSelect($event)" (update)="onUpdate($event)" (delete)="onDelete($event)" *for="let item of tile.navs"></update-view-item>\n\t\t\t\t\t\t\t\t<div class="abstract" *if="tile.navs.length == 0" [innerHTML]="\'editor_no_navs\' | label"></div>\n\t\t\t\t\t\t\t\t<div class="btn--mode" (click)="onSelect({ type:\'viewItem\', value: \'nav\', tile: tile })" [innerHTML]="\'editor_add_nav\' | label"></div>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\x3c!--\n\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t<div class="btn" (click)="onSelect({ type:\'viewItem\', value: \'nav\', tile: tile })">\n\t\t\t\t\t\t\t\t\t<div class="icon">\n\t\t\t\t\t\t\t\t\t\t<svg-icon name="nav"></svg-icon>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class="title" [innerHTML]="\'editor_add_nav\' | label"></div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t--\x3e\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="abstract" *if="view.tiles.length == 0" [innerHTML]="\'editor_no_tiles\' | label"></div>\n\t\t\t\t\x3c!-- <div class="btn--mode" (click)="setMode(3)">Add Tile</div> --\x3e\n\t\t\t</li>\n\t\t\t\x3c!--\n\t\t\t<li *if="false">\n\t\t\t\t<div class="title">Icons</div>\n\t\t\t\t<ul class="nav--editor">\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'animated-tabs\')">\n\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.3"></path><path d="M 2 8.4 L 12 8.4 L 12 2 L 6 2 C 3.791 2 2 3.791 2 6 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 12 8.4 L 22 8.4 L 22 6 C 22 3.791 20.209 2 18 2 L 12 2 Z" fill="var(--svg-icon-tint)"></path></svg></div>\n\t\t\t\t\t\t\t<div class="title">Animated Tabs</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'card-list\')">\n\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.3"></path><path d="M 6.8 13.6 C 6.8 13.158 7.158 12.8 7.6 12.8 L 16.8 12.8 C 17.242 12.8 17.6 13.158 17.6 13.6 L 17.6 16.8 C 17.6 17.242 17.242 17.6 16.8 17.6 L 7.6 17.6 C 7.158 17.6 6.8 17.242 6.8 16.8 Z" fill="var(--svg-icon-tint)"></path><path d="M 6.8 7.2 C 6.8 6.758 7.158 6.4 7.6 6.4 L 16.8 6.4 C 17.242 6.4 17.6 6.758 17.6 7.2 L 17.6 10.4 C 17.6 10.842 17.242 11.2 16.8 11.2 L 7.6 11.2 C 7.158 11.2 6.8 10.842 6.8 10.4 Z" fill="var(--svg-icon-tint)"></path></svg></div>\n\t\t\t\t\t\t\t<div class="title">Card List</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'container-transitions\')">\n\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 15.667 13 C 17.139 13 18.333 14.194 18.333 15.667 C 18.333 17.139 17.139 18.333 15.667 18.333 C 14.194 18.333 13 17.139 13 15.667 C 13 14.194 14.194 13 15.667 13 Z" fill="var(--svg-icon-tint)"></path></svg></svg></div>\n\t\t\t\t\t\t\t<div class="title">Container Transitions</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'dynamic-grid\')">\n\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.3"></path><g transform="translate(6.6 6.6)"><path d="M 6.048 0.8 C 6.048 0.358 6.406 0 6.848 0 L 10 0 C 10.442 0 10.8 0.358 10.8 0.8 L 10.8 3.952 C 10.8 4.394 10.442 4.752 10 4.752 L 6.848 4.752 C 6.406 4.752 6.048 4.394 6.048 3.952 Z" fill="var(--svg-icon-tint)" opacity="0.5"></path><path d="M 6.048 6.848 C 6.048 6.406 6.406 6.048 6.848 6.048 L 10 6.048 C 10.442 6.048 10.8 6.406 10.8 6.848 L 10.8 10 C 10.8 10.442 10.442 10.8 10 10.8 L 6.848 10.8 C 6.406 10.8 6.048 10.442 6.048 10 Z" fill="var(--svg-icon-tint)"></path><path d="M 0 0.8 C 0 0.358 0.358 0 0.8 0 L 3.952 0 C 4.394 0 4.752 0.358 4.752 0.8 L 4.752 3.952 C 4.752 4.394 4.394 4.752 3.952 4.752 L 0.8 4.752 C 0.358 4.752 0 4.394 0 3.952 Z" fill="var(--svg-icon-tint)"></path><path d="M 0 6.848 C 0 6.406 0.358 6.048 0.8 6.048 L 3.952 6.048 C 4.394 6.048 4.752 6.406 4.752 6.848 L 4.752 10 C 4.752 10.442 4.394 10.8 3.952 10.8 L 0.8 10.8 C 0.358 10.8 0 10.442 0 10 Z" fill="var(--svg-icon-tint)" opacity="0.5"></path></g></svg></div>\n\t\t\t\t\t\t\t<div class="title">Dynamic Grid</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'expand-on-tap\')">\n\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 0 0 L 7.833 0" transform="translate(8.583 11.583) rotate(270 3.917 0.5)" fill="transparent" stroke-width="1.67" stroke="var(--svg-icon-tint)" stroke-linecap="round" stroke-linejoin="round"></path><path d="M 14.667 9.333 L 12 6.667 L 9.333 9.333" stroke="var(--svg-icon-tint)" fill="transparent" stroke-width="1.67" stroke-linecap="round" stroke-linejoin="round"></path><path d="M 14.667 14.667 L 12 17.333 L 9.333 14.667" stroke="var(--svg-icon-tint)" fill="transparent" stroke-width="1.67" stroke-linecap="round" stroke-linejoin="round"></path> </svg></div>\n\t\t\t\t\t\t\t<div class="title">Expand on Tap</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'image-gallery-2\')">\n\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 7.333 8.333 C 7.333 7.781 7.781 7.333 8.333 7.333 L 10.333 7.333 C 10.886 7.333 11.333 7.781 11.333 8.333 L 11.333 10.333 C 11.333 10.886 10.886 11.333 10.333 11.333 L 8.333 11.333 C 7.781 11.333 7.333 10.886 7.333 10.333 Z" fill="var(--svg-icon-tint)" opacity="0.4"></path><path d="M 12.333 8.333 C 12.333 7.781 12.781 7.333 13.333 7.333 L 15.333 7.333 C 15.886 7.333 16.333 7.781 16.333 8.333 L 16.333 10.333 C 16.333 10.886 15.886 11.333 15.333 11.333 L 13.333 11.333 C 12.781 11.333 12.333 10.886 12.333 10.333 Z" fill="var(--svg-icon-tint)" opacity="0.4"></path><path d="M 7.333 13.667 C 7.333 13.114 7.781 12.667 8.333 12.667 L 15.333 12.667 C 15.886 12.667 16.333 13.114 16.333 13.667 L 16.333 15.667 C 16.333 16.219 15.886 16.667 15.333 16.667 L 8.333 16.667 C 7.781 16.667 7.333 16.219 7.333 15.667 Z" fill="var(--svg-icon-tint)"></path></svg></div>\n\t\t\t\t\t\t\t<div class="title">Image Gallery 2</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'stories-ui\')">\n\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.3"></path><path d="M 6.8 4.8 C 7.905 4.8 8.8 5.695 8.8 6.8 C 8.8 7.905 7.905 8.8 6.8 8.8 C 5.695 8.8 4.8 7.905 4.8 6.8 C 4.8 5.695 5.695 4.8 6.8 4.8 Z" fill="var(--svg-icon-tint)"></path><path d="M 12 4.8 C 13.105 4.8 14 5.695 14 6.8 C 14 7.905 13.105 8.8 12 8.8 C 10.895 8.8 10 7.905 10 6.8 C 10 5.695 10.895 4.8 12 4.8 Z" fill="var(--svg-icon-tint)"></path><path d="M 17.2 4.8 C 18.305 4.8 19.2 5.695 19.2 6.8 C 19.2 7.905 18.305 8.8 17.2 8.8 C 16.095 8.8 15.2 7.905 15.2 6.8 C 15.2 5.695 16.095 4.8 17.2 4.8 Z" fill="var(--svg-icon-tint)"></path></svg></div>\n\t\t\t\t\t\t\t<div class="title">Stories UI</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'todo-list\')">\n\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 8 12.333 L 10.5 14.833 L 16 9.333" stroke="var(--svg-icon-tint)" fill="transparent" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg></div>\n\t\t\t\t\t\t\t<div class="title">To-Do List</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'toggle-menu\')">\n\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 17.333 15.333 C 18.438 15.333 19.333 16.229 19.333 17.333 C 19.333 18.438 18.438 19.333 17.333 19.333 C 16.229 19.333 15.333 18.438 15.333 17.333 C 15.333 16.229 16.229 15.333 17.333 15.333 Z" fill="var(--svg-icon-tint)"></path><path d="M 17.333 10 C 18.438 10 19.333 10.895 19.333 12 C 19.333 13.105 18.438 14 17.333 14 C 16.229 14 15.333 13.105 15.333 12 C 15.333 10.895 16.229 10 17.333 10 Z" fill="var(--svg-icon-tint)" opacity="0.4"></path><path d="M 17.333 4.667 C 18.438 4.667 19.333 5.562 19.333 6.667 C 19.333 7.771 18.438 8.667 17.333 8.667 C 16.229 8.667 15.333 7.771 15.333 6.667 C 15.333 5.562 16.229 4.667 17.333 4.667 Z" fill="var(--svg-icon-tint)" opacity="0.4"></path></svg></div>\n\t\t\t\t\t\t\t<div class="title">Toggle Menu</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'bottom-sheet\')">\n\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 10.333 C 22 10.886 21.552 11.333 21 11.333 L 3 11.333 C 2.448 11.333 2 10.886 2 10.333 Z" fill="var(--svg-icon-tint)" opacity="0.4"></path><path d="M 2 13.333 C 2 12.781 2.448 12.333 3 12.333 L 21 12.333 C 21.552 12.333 22 12.781 22 13.333 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)"></path></svg></div>\n\t\t\t\t\t\t\t<div class="title">Bottom Sheet</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'draggable-sheet\')">\n\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 2 14 C 2 12.895 2.895 12 4 12 L 20 12 C 21.105 12 22 12.895 22 14 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z M 10.667 15.333 L 13.333 15.333 C 13.702 15.333 14 15.035 14 14.667 C 14 14.298 13.702 14 13.333 14 L 10.667 14 C 10.298 14 10 14.298 10 14.667 C 10 15.035 10.298 15.333 10.667 15.333 Z" fill="var(--svg-icon-tint)"></path></svg></div>\n\t\t\t\t\t\t\t<div class="title">Draggable Sheet</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'modal-box\')">\n\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 7.333 9.333 C 7.333 8.229 8.229 7.333 9.333 7.333 L 14.667 7.333 C 15.771 7.333 16.667 8.229 16.667 9.333 L 16.667 14.667 C 16.667 15.771 15.771 16.667 14.667 16.667 L 9.333 16.667 C 8.229 16.667 7.333 15.771 7.333 14.667 Z" fill="var(--svg-icon-tint)"></path></svg></div>\n\t\t\t\t\t\t\t<div class="title">Modal Box</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'side-menu\')">\n\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 11 2 C 11.552 2 12 2.448 12 3 L 12 21 C 12 21.552 11.552 22 11 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)"></path></svg></div>\n\t\t\t\t\t\t\t<div class="title">Side Menu</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'input-form\')">\n\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 7.333 8.333 C 7.333 7.781 7.781 7.333 8.333 7.333 L 11.667 7.333 C 11.667 7.333 11.667 7.333 11.667 7.333 L 15.667 7.333 C 16.219 7.333 16.667 7.781 16.667 8.333 L 16.667 9 C 16.667 9.552 16.219 10 15.667 10 L 13.333 10 L 13.333 15.667 C 13.333 16.219 12.886 16.667 12.333 16.667 L 11.667 16.667 C 11.114 16.667 10.667 16.219 10.667 15.667 L 10.667 10 L 8.333 10 C 7.781 10 7.333 9.552 7.333 9 Z" fill="var(--svg-icon-tint)"></path></svg></div>\n\t\t\t\t\t\t\t<div class="title">Input Form</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'loading-indicator\')">\n\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.3"></path><path d="M 16.4 10.4 C 17.284 10.4 18 11.116 18 12 C 18 12.884 17.284 13.6 16.4 13.6 C 15.516 13.6 14.8 12.884 14.8 12 C 14.8 11.116 15.516 10.4 16.4 10.4 Z" fill="var(--svg-icon-tint)"></path><path d="M 12 10.4 C 12.884 10.4 13.6 11.116 13.6 12 C 13.6 12.884 12.884 13.6 12 13.6 C 11.116 13.6 10.4 12.884 10.4 12 C 10.4 11.116 11.116 10.4 12 10.4 Z" fill="var(--svg-icon-tint)"></path><path d="M 7.6 10.4 C 8.484 10.4 9.2 11.116 9.2 12 C 9.2 12.884 8.484 13.6 7.6 13.6 C 6.716 13.6 6 12.884 6 12 C 6 11.116 6.716 10.4 7.6 10.4 Z" fill="var(--svg-icon-tint)"></path></svg></div>\n\t\t\t\t\t\t\t<div class="title">Loading Indicator</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'radio-button-form\')">\n\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 9.833 8.167 L 14.167 8.167 C 16.284 8.167 18 9.883 18 12 C 18 14.117 16.284 15.833 14.167 15.833 L 9.833 15.833 C 7.716 15.833 6 14.117 6 12 C 6 9.883 7.716 8.167 9.833 8.167 Z M 11.333 12 C 11.333 13.473 12.527 14.667 14 14.667 C 15.473 14.667 16.667 13.473 16.667 12 C 16.667 10.527 15.473 9.333 14 9.333 C 12.527 9.333 11.333 10.527 11.333 12 Z" fill="var(--svg-icon-tint)"></path></svg></div>\n\t\t\t\t\t\t\t<div class="title">Radio Button Form</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'checkbox-form\')">\n\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 8.651 6.931 C 7.911 6.738 7.238 7.411 7.431 8.151 L 9.363 15.558 C 9.592 16.435 10.775 16.58 11.208 15.784 L 13 12.5 L 16.284 10.708 C 17.08 10.275 16.935 9.092 16.058 8.863 Z" fill="var(--svg-icon-tint)"></path><path d="M 16 15.5 L 11 10.5" fill="transparent" stroke-width="1.67" stroke="var(--svg-icon-tint)" stroke-linecap="round"></path></svg></div>\n\t\t\t\t\t\t\t<div class="title">Checkbox Form</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'splash-screen\')">\n\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 7.757 13.414 C 6.976 12.633 6.976 11.367 7.757 10.586 L 10.586 7.757 C 11.367 6.976 12.633 6.976 13.414 7.757 L 16.243 10.586 C 17.024 11.367 17.024 12.633 16.243 13.414 L 13.414 16.243 C 12.633 17.024 11.367 17.024 10.586 16.243 Z" fill="var(--svg-icon-tint)"></path></svg></div>\n\t\t\t\t\t\t\t<div class="title">Splash Screen</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'timeout-transition\')">\n\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 1 5.8 C 1 3.149 3.149 1 5.8 1 L 18.2 1 C 20.851 1 23 3.149 23 5.8 L 23 18.2 C 23 20.851 20.851 23 18.2 23 L 5.8 23 C 3.149 23 1 20.851 1 18.2 Z" fill="var(--svg-icon-tint)" opacity="0.3"></path><path d="M 12 6.72 C 14.916 6.72 17.28 9.084 17.28 12 C 17.28 14.916 14.916 17.28 12 17.28 C 9.084 17.28 6.72 14.916 6.72 12 C 6.72 9.084 9.084 6.72 12 6.72 Z M 11.34 12 C 11.34 12.365 11.635 12.66 12 12.66 L 14.2 12.66 C 14.565 12.66 14.86 12.365 14.86 12 C 14.86 11.635 14.565 11.34 14.2 11.34 L 12.66 11.34 L 12.66 9.8 C 12.66 9.435 12.365 9.14 12 9.14 C 11.635 9.14 11.34 9.435 11.34 9.8 Z" fill="var(--svg-icon-tint)"></path></svg></div>\n\t\t\t\t\t\t\t<div class="title">Timeout Transition</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'accordion-menu\')">\n\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 16 10.667 L 12 14.667 L 8 10.667" fill="transparent" stroke-width="2" stroke="var(--svg-icon-tint)" stroke-linecap="round" stroke-linejoin="round"></path></svg></div>\n\t\t\t\t\t\t\t<div class="title">Accordion Menu</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'drop-on-scroll\')">\n\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 0 0 L 8 0" transform="translate(8.5 11.5) rotate(270 4 0.5)" fill="transparent" stroke-width="1.67" stroke="var(--svg-icon-tint)" stroke-linecap="round" stroke-linejoin="round"></path><path d="M 15.333 11.333 L 12 8 L 8.667 11.333" fill="transparent" stroke-width="1.67" stroke="var(--svg-icon-tint)" stroke-linecap="round" stroke-linejoin="round"></path></svg></div>\n\t\t\t\t\t\t\t<div class="title">Drop on Scroll</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'nested-scroll\')">\n\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 1.82 6 C 1.82 3.791 3.61 2 5.82 2 L 17.82 2 C 20.029 2 21.82 3.791 21.82 6 L 21.82 7 C 21.82 7.552 21.372 8 20.82 8 L 2.82 8 C 2.267 8 1.82 7.552 1.82 7 Z" fill="var(--svg-icon-tint)" opacity="0.4"></path><path d="M 1.82 17 C 1.82 16.448 2.267 16 2.82 16 L 20.82 16 C 21.372 16 21.82 16.448 21.82 17 L 21.82 18 C 21.82 20.209 20.029 22 17.82 22 L 5.82 22 C 3.61 22 1.82 20.209 1.82 18 Z" fill="var(--svg-icon-tint)" opacity="0.4"></path><path d="M 8.82 10 C 8.82 9.448 9.267 9 9.82 9 L 20.82 9 C 21.372 9 21.82 9.448 21.82 10 L 21.82 14 C 21.82 14.552 21.372 15 20.82 15 L 9.82 15 C 9.267 15 8.82 14.552 8.82 14 Z" fill="var(--svg-icon-tint)"></path><path d="M 1.82 10 C 1.82 9.448 2.267 9 2.82 9 L 6.82 9 C 7.372 9 7.82 9.448 7.82 10 L 7.82 14 C 7.82 14.552 7.372 15 6.82 15 L 2.82 15 C 2.267 15 1.82 14.552 1.82 14 Z" fill="var(--svg-icon-tint)"></path></svg></div>\n\t\t\t\t\t\t\t<div class="title">Nested Scroll</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'star-rating\')">\n\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 11.399 6.884 C 11.645 6.386 12.355 6.386 12.601 6.884 L 13.705 9.122 C 13.803 9.32 13.992 9.457 14.21 9.489 L 16.68 9.848 C 17.229 9.928 17.449 10.603 17.051 10.99 L 15.264 12.733 C 15.106 12.887 15.034 13.108 15.071 13.326 L 15.493 15.786 C 15.587 16.333 15.013 16.75 14.521 16.492 L 12.312 15.331 C 12.117 15.228 11.883 15.228 11.688 15.331 L 9.479 16.492 C 8.987 16.75 8.413 16.333 8.507 15.786 L 8.929 13.326 C 8.966 13.108 8.894 12.887 8.736 12.733 L 6.949 10.99 C 6.551 10.603 6.771 9.928 7.32 9.848 L 9.79 9.489 C 10.008 9.457 10.197 9.32 10.295 9.122 Z" fill="var(--svg-icon-tint)"></path></svg></div>\n\t\t\t\t\t\t\t<div class="title">Star Rating</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'swipe-menu\')">\n\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 17.33 C 2 16.595 2.595 16 3.33 16 L 21 16 C 21.552 16 22 16.448 22 17 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.4"></path><path d="M 2 10 C 2 9.448 2.448 9 3 9 L 14 9 C 14.552 9 15 9.448 15 10 L 15 14 C 15 14.552 14.552 15 14 15 L 3 15 C 2.448 15 2 14.552 2 14 Z M 19 9 C 20.657 9 22 10.343 22 12 C 22 13.657 20.657 15 19 15 C 17.343 15 16 13.657 16 12 C 16 10.343 17.343 9 19 9 Z" fill="var(--svg-icon-tint)"></path><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 7 C 22 7.552 21.552 8 21 8 L 3 8 C 2.448 8 2 7.552 2 7 Z" fill="var(--svg-icon-tint)" opacity="0.4"></path></svg></div>\n\t\t\t\t\t\t\t<div class="title">Swipe Menu</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'switch-sheet\')">\n\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 15.667 13.333 C 17.139 13.333 18.333 14.527 18.333 16 C 18.333 17.473 17.139 18.667 15.667 18.667 C 14.194 18.667 13 17.473 13 16 C 13 14.527 14.194 13.333 15.667 13.333 Z" fill="var(--svg-icon-tint)"></path><path d="M 8.333 13.333 C 9.806 13.333 11 14.527 11 16 C 11 17.473 9.806 18.667 8.333 18.667 C 6.861 18.667 5.667 17.473 5.667 16 C 5.667 14.527 6.861 13.333 8.333 13.333 Z" fill="var(--svg-icon-tint)" opacity="0.4"></path></svg></div>\n\t\t\t\t\t\t\t<div class="title">Switch Sheet</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'tab-menu\')">\n\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 10 15.333 L 14 15.333 L 14 18.667 L 10 18.667 Z" fill="var(--svg-icon-tint)" opacity="0.4"></path><path d="M 5.333 16.333 C 5.333 15.781 5.781 15.333 6.333 15.333 L 9.333 15.333 L 9.333 18.667 L 6.333 18.667 C 5.781 18.667 5.333 18.219 5.333 17.667 Z" fill="var(--svg-icon-tint)"></path><path d="M 18.667 16.333 C 18.667 15.781 18.219 15.333 17.667 15.333 L 14.667 15.333 L 14.667 18.667 L 17.667 18.667 C 18.219 18.667 18.667 18.219 18.667 17.667 Z" fill="var(--svg-icon-tint)" opacity="0.4"></path></svg></div>\n\t\t\t\t\t\t\t<div class="title">Tab Menu</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'wheel-picker\')">\n\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 3.667 6 C 3.667 3.791 5.458 2 7.667 2 L 16.333 2 C 18.542 2 20.333 3.791 20.333 6 L 20.333 7 C 20.333 7.552 19.886 8 19.333 8 L 4.667 8 C 4.114 8 3.667 7.552 3.667 7 Z" fill="var(--svg-icon-tint)" opacity="0.4"></path><path d="M 2 11 C 2 9.895 2.895 9 4 9 L 20 9 C 21.105 9 22 9.895 22 11 L 22 13 C 22 14.105 21.105 15 20 15 L 4 15 C 2.895 15 2 14.105 2 13 Z" fill="var(--svg-icon-tint)"></path><path d="M 3.667 17 C 3.667 16.448 4.114 16 4.667 16 L 19.333 16 C 19.886 16 20.333 16.448 20.333 17 L 20.333 18 C 20.333 20.209 18.542 22 16.333 22 L 7.667 22 C 5.458 22 3.667 20.209 3.667 18 Z" fill="var(--svg-icon-tint)" opacity="0.4"></path></svg></div>\n\t\t\t\t\t\t\t<div class="title">Wheel Picker</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'cover-flow\')">\n\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 11.333 17.962 C 11.333 18.385 11.068 18.762 10.67 18.904 L 4.673 21.045 C 3.37 21.511 2 20.545 2 19.162 L 2 4.838 C 2 3.455 3.37 2.489 4.673 2.955 L 10.67 5.096 C 11.068 5.238 11.333 5.615 11.333 6.038 Z" fill="var(--svg-icon-tint)"></path><path d="M 22 4.838 C 22 3.455 20.63 2.489 19.327 2.955 L 13.33 5.096 C 12.932 5.238 12.667 5.615 12.667 6.038 L 12.667 17.962 C 12.667 18.385 12.932 18.762 13.33 18.904 L 19.327 21.045 C 20.63 21.511 22 20.545 22 19.162 Z" fill="var(--svg-icon-tint)" opacity="0.4"></path></svg></div>\n\t\t\t\t\t\t\t<div class="title">Cover Flow</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'cube-effect\')">\n\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6.743 C 2 5.898 2.531 5.144 3.327 4.859 L 9.997 2.477 C 10.648 2.245 11.333 2.727 11.333 3.419 L 11.333 20.581 C 11.333 21.273 10.648 21.755 9.997 21.523 L 3.327 19.141 C 2.531 18.856 2 18.102 2 17.257 Z" fill="var(--svg-icon-tint)" opacity="0.4"></path><path d="M 12.667 3.419 C 12.667 2.727 13.352 2.245 14.003 2.477 L 20.673 4.859 C 21.469 5.144 22 5.898 22 6.743 L 22 17.257 C 22 18.102 21.469 18.856 20.673 19.141 L 14.003 21.523 C 13.352 21.755 12.667 21.273 12.667 20.581 Z" fill="var(--svg-icon-tint)"></path></svg></div>\n\t\t\t\t\t\t\t<div class="title">Cube Effect</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'flip-effect\')">\n\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 11.333 4.667 C 11.333 4.114 10.886 3.667 10.333 3.667 L 4 3.667 C 2.895 3.667 2 4.562 2 5.667 L 2 18.333 C 2 19.438 2.895 20.333 4 20.333 L 10.333 20.333 C 10.886 20.333 11.333 19.886 11.333 19.333 Z" fill="var(--svg-icon-tint)" opacity="0.4"></path><path d="M 20 4.167 C 20 3.891 20.224 3.667 20.5 3.667 L 20.5 3.667 C 21.328 3.667 22 4.338 22 5.167 L 22 18.833 C 22 19.662 21.328 20.333 20.5 20.333 L 20.5 20.333 C 20.224 20.333 20 20.109 20 19.833 Z" fill="var(--svg-icon-tint)" opacity="0.4"></path><path d="M 18.667 4.631 C 18.667 3.309 17.406 2.35 16.131 2.704 L 13.399 3.463 C 12.966 3.583 12.667 3.978 12.667 4.427 L 12.667 19.573 C 12.667 20.022 12.966 20.417 13.399 20.537 L 16.131 21.296 C 17.406 21.65 18.667 20.691 18.667 19.369 Z" fill="var(--svg-icon-tint)"></path></svg></div>\n\t\t\t\t\t\t\t<div class="title">Flip Effect</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'parallax-scroll\')">\n\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 12 6.667 C 12 5.562 12.895 4.667 14 4.667 L 17.333 4.667 C 18.438 4.667 19.333 5.562 19.333 6.667 L 19.333 10 C 19.333 11.105 18.438 12 17.333 12 L 14 12 C 12.895 12 12 11.105 12 10 Z" fill="var(--svg-icon-tint)"></path><path d="M 4.667 14 C 4.667 12.895 5.562 12 6.667 12 L 10 12 C 11.105 12 12 12.895 12 14 L 12 17.333 C 12 18.438 11.105 19.333 10 19.333 L 6.667 19.333 C 5.562 19.333 4.667 18.438 4.667 17.333 Z" fill="var(--svg-icon-tint)"></path></svg></div>\n\t\t\t\t\t\t\t<div class="title">Parallax Scroll</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'pile-effect\')">\n\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 6.5 4 C 6.224 4 6 3.776 6 3.5 L 6 3.5 C 6 2.672 6.672 2 7.5 2 L 16.5 2 C 17.328 2 18 2.672 18 3.5 L 18 3.5 C 18 3.776 17.776 4 17.5 4 Z" fill="var(--svg-icon-tint)" opacity="0.4"></path><path d="M 4.5 7 C 4.224 7 4 6.776 4 6.5 L 4 6.5 C 4 5.672 4.672 5 5.5 5 L 18.5 5 C 19.328 5 20 5.672 20 6.5 L 20 6.5 C 20 6.776 19.776 7 19.5 7 Z" fill="var(--svg-icon-tint)" opacity="0.7"></path><path d="M 0 2.67 C 0 1.195 1.195 0 2.67 0 L 11.33 0 C 12.805 0 14 1.195 14 2.67 L 14 17.33 C 14 18.805 12.805 20 11.33 20 L 2.67 20 C 1.195 20 0 18.805 0 17.33 Z" transform="translate(5 5) rotate(-90 7 10)" fill="var(--svg-icon-tint)"></path></svg></div>\n\t\t\t\t\t\t\t<div class="title">Pile Effect</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'shuffle\')">\n\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 15.174 10.452 L 16.708 9.06 L 15.174 7.667" fill="transparent" stroke-width="1.33" stroke="var(--svg-icon-tint)" stroke-linecap="round" stroke-linejoin="round"></path><path d="M 15.174 16.333 L 16.708 14.94 L 15.174 13.548" fill="transparent" stroke-width="1.33" stroke="var(--svg-icon-tint)" stroke-linecap="round" stroke-linejoin="round"></path><path d="M 16.145 9.06 C 16.145 9.06 13.982 8.542 12.617 9.679 C 11.252 10.815 11.829 12.213 10.776 13.548 C 9.724 14.882 7.708 14.94 7.708 14.94" fill="transparent" stroke-width="1.33" stroke="var(--svg-icon-tint)" stroke-linecap="round" stroke-linejoin="round"></path><path d="M 16.145 14.823 C 16.145 14.823 13.982 15.34 12.617 14.204 C 11.252 13.068 11.829 11.669 10.776 10.335 C 9.724 9.001 7.708 8.942 7.708 8.942" fill="transparent" stroke-width="1.33" stroke="var(--svg-icon-tint)" stroke-linecap="round" stroke-linejoin="round"></path></svg></div>\n\t\t\t\t\t\t\t<div class="title">Shuffle</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'svg-animation\')">\n\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 8 12.333 L 10.5 14.833 L 16 9.333" stroke="var(--svg-icon-tint)" fill="transparent" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg></div>\n\t\t\t\t\t\t\t<div class="title">SVG Animation</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'google-sheets\')">\n\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 7 8.667 C 7 8.206 7.373 7.833 7.833 7.833 L 7.833 7.833 C 8.294 7.833 8.667 8.206 8.667 8.667 L 8.667 8.667 C 8.667 9.127 8.294 9.5 7.833 9.5 L 7.833 9.5 C 7.373 9.5 7 9.127 7 8.667 Z" fill="var(--svg-icon-tint)"></path><path d="M 7 12 C 7 11.54 7.373 11.167 7.833 11.167 L 7.833 11.167 C 8.294 11.167 8.667 11.54 8.667 12 L 8.667 12 C 8.667 12.46 8.294 12.833 7.833 12.833 L 7.833 12.833 C 7.373 12.833 7 12.46 7 12 Z" fill="var(--svg-icon-tint)"></path><path d="M 7 15.333 C 7 14.873 7.373 14.5 7.833 14.5 L 7.833 14.5 C 8.294 14.5 8.667 14.873 8.667 15.333 L 8.667 15.333 C 8.667 15.794 8.294 16.167 7.833 16.167 L 7.833 16.167 C 7.373 16.167 7 15.794 7 15.333 Z" fill="var(--svg-icon-tint)"></path><path d="M 9.778 8.667 C 9.778 8.206 10.151 7.833 10.611 7.833 L 16.167 7.833 C 16.627 7.833 17 8.206 17 8.667 L 17 8.667 C 17 9.127 16.627 9.5 16.167 9.5 L 10.611 9.5 C 10.151 9.5 9.778 9.127 9.778 8.667 Z" fill="var(--svg-icon-tint)"></path><path d="M 9.778 12 C 9.778 11.54 10.151 11.167 10.611 11.167 L 16.167 11.167 C 16.627 11.167 17 11.54 17 12 L 17 12 C 17 12.46 16.627 12.833 16.167 12.833 L 10.611 12.833 C 10.151 12.833 9.778 12.46 9.778 12 Z" fill="var(--svg-icon-tint)"></path><path d="M 9.778 15.333 C 9.778 14.873 10.151 14.5 10.611 14.5 L 16.167 14.5 C 16.627 14.5 17 14.873 17 15.333 L 17 15.333 C 17 15.794 16.627 16.167 16.167 16.167 L 10.611 16.167 C 10.151 16.167 9.778 15.794 9.778 15.333 Z" fill="var(--svg-icon-tint)"></path></svg></div>\n\t\t\t\t\t\t\t<div class="title">Google Sheets</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'map\')">\n\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 1.82 6 C 1.82 3.791 3.61 2 5.82 2 L 17.82 2 C 20.029 2 21.82 3.791 21.82 6 L 21.82 18 C 21.82 20.209 20.029 22 17.82 22 L 5.82 22 C 3.61 22 1.82 20.209 1.82 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 11.82 6.504 C 14.029 6.504 15.82 8.282 15.82 10.476 C 15.82 10.698 15.801 10.915 15.766 11.127 C 15.359 14.488 13.033 16.581 12.155 17.261 C 12.051 17.341 11.976 17.437 11.82 17.437 C 11.663 17.437 11.586 17.34 11.481 17.258 C 10.6 16.576 8.28 14.483 7.873 11.127 C 7.838 10.915 7.82 10.698 7.82 10.476 C 7.82 8.282 9.61 6.504 11.82 6.504 Z M 9.486 10.644 C 9.486 11.933 10.531 12.977 11.82 12.977 C 13.108 12.977 14.153 11.933 14.153 10.644 C 14.153 9.355 13.108 8.311 11.82 8.311 C 10.531 8.311 9.486 9.355 9.486 10.644 Z" fill="var(--svg-icon-tint)"></path></svg></div>\n\t\t\t\t\t\t\t<div class="title">Map</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'signature-pad\')">\n\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 8.82 13.068 C 8.56 12.807 8.56 12.385 8.82 12.125 L 13.733 7.212 C 13.993 6.952 14.415 6.952 14.676 7.212 L 16.788 9.324 C 17.048 9.585 17.048 10.007 16.788 10.267 L 11.875 15.18 C 11.615 15.44 11.193 15.44 10.932 15.18 Z" fill="var(--svg-icon-tint)"></path><path d="M 3.096 0.303 C 3.318 0.17 3.6 0.33 3.6 0.589 L 3.6 3.732 C 3.6 3.991 3.318 4.151 3.096 4.018 L 0.953 2.732 C 0.521 2.473 0.521 1.848 0.953 1.589 Z" transform="translate(6.24 13.8) rotate(-45 1.8 2.16)" fill="var(--svg-icon-tint)"></path></svg></div>\n\t\t\t\t\t\t\t<div class="title">Signature Pad</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'sound-effects\')">\n\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 14.225 10.793 C 14.471 11.102 14.623 11.529 14.623 12 C 14.623 12.471 14.471 12.898 14.225 13.207" fill="transparent" stroke-width="1.33" stroke="var(--svg-icon-tint)" stroke-linecap="round" stroke-linejoin="round"></path><path d="M 16.224 9.185 C 16.96 9.911 17.417 10.905 17.417 12 C 17.417 13.095 16.96 14.09 16.224 14.816" fill="transparent" stroke-width="1.33" stroke="var(--svg-icon-tint)" stroke-linecap="round" stroke-linejoin="round"></path><path d="M 6.083 10.656 C 6.083 10.288 6.382 9.989 6.75 9.989 L 7.674 9.989 L 11.021 7.835 C 11.464 7.549 12.048 7.868 12.048 8.396 L 12.048 15.604 C 12.048 16.132 11.464 16.451 11.021 16.165 L 7.674 14.011 L 6.75 14.011 C 6.382 14.011 6.083 13.712 6.083 13.344 Z" fill="var(--svg-icon-tint)"></path></svg></div>\n\t\t\t\t\t\t\t<div class="title">Sound Effects</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'card-swipe\')">\n\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 3.423 7.423 C 3.423 5.214 5.214 3.423 7.423 3.423 L 16.756 3.423 C 18.965 3.423 20.756 5.214 20.756 7.423 L 20.756 16.756 C 20.756 18.965 18.965 20.756 16.756 20.756 L 7.423 20.756 C 5.214 20.756 3.423 18.965 3.423 16.756 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 9.172 3.377 C 10.734 1.815 13.266 1.815 14.828 3.377 L 20.721 9.269 C 22.283 10.831 22.283 13.364 20.721 14.926 L 14.828 20.819 C 13.266 22.381 10.734 22.381 9.172 20.819 L 3.279 14.926 C 1.717 13.364 1.717 10.831 3.279 9.269 Z" fill="var(--svg-icon-tint)"></path></svg></div>\n\t\t\t\t\t\t\t<div class="title">Card Swipe</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'custom-effect\')">\n\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6.2 C 2 5.673 2.31 5.195 2.792 4.981 L 7.063 3.083 C 7.503 2.887 8 3.21 8 3.693 L 8 20.307 C 8 20.79 7.503 21.113 7.063 20.917 L 2.792 19.019 C 2.31 18.805 2 18.327 2 17.8 Z" fill="var(--svg-icon-tint)" opacity="0.4"></path><path d="M 9.333 3.297 C 9.333 2.642 9.954 2.163 10.588 2.33 L 20.509 4.941 C 21.388 5.172 22 5.967 22 6.875 L 22 17.125 C 22 18.033 21.388 18.828 20.509 19.059 L 10.588 21.67 C 9.954 21.837 9.333 21.358 9.333 20.703 Z" fill="var(--svg-icon-tint)"></path></svg></div>\n\t\t\t\t\t\t\t<div class="title">Custom Effect</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'drag-handle\')">\n\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 5.333 2.667 L 2.667 0 L 0 2.667" transform="translate(5.667 10.667) rotate(-90 2.667 1.333)" fill="transparent" stroke-width="1.67" stroke="var(--svg-icon-tint)" stroke-linecap="round" stroke-linejoin="round"></path><path d="M 5.333 0 L 2.667 2.667 L 0 0" transform="translate(13 10.667) rotate(-90 2.667 1.333)" fill="transparent" stroke-width="1.67" stroke="var(--svg-icon-tint)" stroke-linecap="round" stroke-linejoin="round"></path></svg></div>\n\t\t\t\t\t\t\t<div class="title">Drag Handle</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'dynamic-header\')">\n\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 8 L 2 8 Z" fill="var(--svg-icon-tint)"></path></svg></div>\n\t\t\t\t\t\t\t<div class="title">Dynamic Header</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'image-panning\')">\n\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 12 14 C 12 12.895 12.895 12 14 12 L 20 12 C 21.105 12 22 12.895 22 14 L 22 18 C 22 20.209 20.209 22 18 22 L 14 22 C 12.895 22 12 21.105 12 20 Z" fill="var(--svg-icon-tint)"></path></svg></div>\n\t\t\t\t\t\t\t<div class="title">Image Panning</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'input-data\')">\n\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 7.333 8.333 C 7.333 7.781 7.781 7.333 8.333 7.333 L 15.667 7.333 C 16.219 7.333 16.667 7.781 16.667 8.333 L 16.667 10.333 C 16.667 10.886 16.219 11.333 15.667 11.333 L 8.333 11.333 C 7.781 11.333 7.333 10.886 7.333 10.333 Z" fill="var(--svg-icon-tint)"></path><path d="M 7.333 13.667 C 7.333 13.114 7.781 12.667 8.333 12.667 L 15.667 12.667 C 16.219 12.667 16.667 13.114 16.667 13.667 L 16.667 15.667 C 16.667 16.219 16.219 16.667 15.667 16.667 L 8.333 16.667 C 7.781 16.667 7.333 16.219 7.333 15.667 Z" fill="var(--svg-icon-tint)" opacity="0.4"></path></svg></div>\n\t\t\t\t\t\t\t<div class="title">Input Data</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'input-validation\')">\n\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 7.333 8.333 C 7.333 7.781 7.781 7.333 8.333 7.333 L 15.667 7.333 C 16.219 7.333 16.667 7.781 16.667 8.333 L 16.667 10.333 C 16.667 10.886 16.219 11.333 15.667 11.333 L 8.333 11.333 C 7.781 11.333 7.333 10.886 7.333 10.333 Z" fill="var(--svg-icon-tint)" opacity="0.4"></path><path d="M 7.333 13.667 C 7.333 13.114 7.781 12.667 8.333 12.667 L 15.667 12.667 C 16.219 12.667 16.667 13.114 16.667 13.667 L 16.667 15.667 C 16.667 16.219 16.219 16.667 15.667 16.667 L 8.333 16.667 C 7.781 16.667 7.333 16.219 7.333 15.667 Z" fill="var(--svg-icon-tint)"></path></svg></div>\n\t\t\t\t\t\t\t<div class="title">Input Validation</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'like-animation\')">\n\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 5.28 0 C 7.017 0 7.747 2.366 6.357 3.755 C 4.968 5.144 3.543 5.905 3.543 5.905 C 3.543 5.905 2.118 5.144 0.728 3.755 C -0.661 2.365 0.069 -0 1.806 0 C 3.543 0 3.543 1.701 3.543 1.701 C 3.543 1.701 3.543 0 5.28 0 Z" transform="translate(11.213 11.787) rotate(15 3.543 2.953)" fill="var(--svg-icon-tint)"></path><path d="M 5.28 0 C 7.017 -0 7.747 2.365 6.357 3.755 C 4.968 5.144 3.543 5.905 3.543 5.905 C 3.543 5.905 2.118 5.144 0.728 3.755 C -0.661 2.366 0.069 0 1.806 0 C 3.543 0 3.543 1.701 3.543 1.701 C 3.543 1.701 3.543 0 5.28 0 Z" transform="translate(5.701 6.669) rotate(-15 3.543 2.953)" fill="var(--svg-icon-tint)" opacity="0.4"></path></svg></div>\n\t\t\t\t\t\t\t<div class="title">Like Animation</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'like-counter\')">\n\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 14.778 7.333 C 17.556 7.333 18.724 11.072 16.502 13.268 C 14.279 15.464 12 16.667 12 16.667 C 12 16.667 9.721 15.464 7.498 13.268 C 5.276 11.072 6.444 7.333 9.222 7.333 C 12 7.333 12 10.022 12 10.022 C 12 10.022 12 7.333 14.778 7.333 Z" fill="var(--svg-icon-tint)"></path></svg></div>\n\t\t\t\t\t\t\t<div class="title">Like Counter</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'lock-screen\')">\n\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 7.333 11 C 7.333 10.448 7.781 10 8.333 10 L 15.667 10 C 16.219 10 16.667 10.448 16.667 11 L 16.667 15.667 C 16.667 16.219 16.219 16.667 15.667 16.667 L 8.333 16.667 C 7.781 16.667 7.333 16.219 7.333 15.667 Z" fill="var(--svg-icon-tint)"></path><path d="M 12 7.333 C 13.289 7.333 14.333 8.378 14.333 9.667 C 14.333 10.955 13.289 12 12 12 C 10.711 12 9.667 10.955 9.667 9.667 C 9.667 8.378 10.711 7.333 12 7.333 Z" fill="transparent" stroke-width="1.67" stroke="var(--svg-icon-tint)"></path></svg></div>\n\t\t\t\t\t\t\t<div class="title">Lock Screen</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'long-press-menu\')">\n\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 16.667 10.667 C 17.771 10.667 18.667 11.562 18.667 12.667 C 18.667 13.771 17.771 14.667 16.667 14.667 C 15.562 14.667 14.667 13.771 14.667 12.667 C 14.667 11.562 15.562 10.667 16.667 10.667 Z" fill="var(--svg-icon-tint)" opacity="0.4"></path><path d="M 12 8 C 13.105 8 14 8.895 14 10 C 14 11.105 13.105 12 12 12 C 10.895 12 10 11.105 10 10 C 10 8.895 10.895 8 12 8 Z" fill="var(--svg-icon-tint)"></path><path d="M 7.333 10.667 C 8.438 10.667 9.333 11.562 9.333 12.667 C 9.333 13.771 8.438 14.667 7.333 14.667 C 6.229 14.667 5.333 13.771 5.333 12.667 C 5.333 11.562 6.229 10.667 7.333 10.667 Z" fill="var(--svg-icon-tint)" opacity="0.4"></path></svg></div>\n\t\t\t\t\t\t\t<div class="title">Long Press Menu</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'perspective-3d\')">\n\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 6.913 22 C 5.987 22 5.182 21.364 4.967 20.463 L 2.586 10.463 C 2.287 9.206 3.24 8 4.532 8 L 19.468 8 C 20.76 8 21.713 9.206 21.414 10.463 L 19.033 20.463 C 18.818 21.364 18.013 22 17.087 22 Z" fill="var(--svg-icon-tint)"></path><path d="M 3.833 7 C 3.557 7 3.333 6.776 3.333 6.5 L 3.333 6.5 C 3.333 5.672 4.005 5 4.833 5 L 19.167 5 C 19.995 5 20.667 5.672 20.667 6.5 L 20.667 6.5 C 20.667 6.776 20.443 7 20.167 7 Z" fill="var(--svg-icon-tint)" opacity="0.7"></path><path d="M 5.167 4 C 4.891 4 4.667 3.776 4.667 3.5 L 4.667 3.5 C 4.667 2.672 5.338 2 6.167 2 L 17.833 2 C 18.662 2 19.333 2.672 19.333 3.5 L 19.333 3.5 C 19.333 3.776 19.109 4 18.833 4 Z" fill="var(--svg-icon-tint)" opacity="0.4"></path></svg></div>\n\t\t\t\t\t\t\t<div class="title">Perspective 3D</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'progress-bar\')">\n\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 1.82 6 C 1.82 3.791 3.61 2 5.82 2 L 17.82 2 C 20.029 2 21.82 3.791 21.82 6 L 21.82 18 C 21.82 20.209 20.029 22 17.82 22 L 5.82 22 C 3.61 22 1.82 20.209 1.82 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 5.153 17 C 5.153 16.08 5.899 15.333 6.82 15.333 L 16.82 15.333 C 17.74 15.333 18.486 16.08 18.486 17 L 18.486 17 C 18.486 17.92 17.74 18.667 16.82 18.667 L 6.82 18.667 C 5.899 18.667 5.153 17.92 5.153 17 Z" fill="var(--svg-icon-tint)" opacity="0.4"></path><path d="M 5.153 17 C 5.153 16.08 5.899 15.333 6.82 15.333 L 11.486 15.333 C 12.407 15.333 13.153 16.08 13.153 17 L 13.153 17 C 13.153 17.92 12.407 18.667 11.486 18.667 L 6.82 18.667 C 5.899 18.667 5.153 17.92 5.153 17 Z" fill="var(--svg-icon-tint)"></path></svg></div>\n\t\t\t\t\t\t\t<div class="title">Progress Bar</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'scroll-progress\')">\n\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 7.333 10.333 C 7.333 9.781 7.781 9.333 8.333 9.333 L 15.667 9.333 C 16.219 9.333 16.667 9.781 16.667 10.333 L 16.667 11.667 C 16.667 12.219 16.219 12.667 15.667 12.667 L 8.333 12.667 C 7.781 12.667 7.333 12.219 7.333 11.667 Z" fill="var(--svg-icon-tint)" opacity="0.4"></path><path d="M 7.333 14.667 C 7.333 14.114 7.781 13.667 8.333 13.667 L 15.667 13.667 C 16.219 13.667 16.667 14.114 16.667 14.667 L 16.667 16 C 16.667 16.552 16.219 17 15.667 17 L 8.333 17 C 7.781 17 7.333 16.552 7.333 16 Z" fill="var(--svg-icon-tint)" opacity="0.4"></path><path d="M 7.333 7.667 C 7.333 7.298 7.632 7 8 7 L 16 7 C 16.368 7 16.667 7.298 16.667 7.667 L 16.667 7.667 C 16.667 8.035 16.368 8.333 16 8.333 L 8 8.333 C 7.632 8.333 7.333 8.035 7.333 7.667 Z" fill="var(--svg-icon-tint)" opacity="0.4"></path><path d="M 7.333 7.667 C 7.333 7.298 7.632 7 8 7 L 12.667 7 C 13.035 7 13.333 7.298 13.333 7.667 L 13.333 7.667 C 13.333 8.035 13.035 8.333 12.667 8.333 L 8 8.333 C 7.632 8.333 7.333 8.035 7.333 7.667 Z" fill="var(--svg-icon-tint)"></path></svg></div>\n\t\t\t\t\t\t\t<div class="title">Scroll Progress</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'show-password\')">\n\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 10.6 12 C 10.6 11.227 11.227 10.6 12 10.6 L 12 10.6 C 12.773 10.6 13.4 11.227 13.4 12 L 13.4 12 C 13.4 12.773 12.773 13.4 12 13.4 L 12 13.4 C 11.227 13.4 10.6 12.773 10.6 12 Z" fill="var(--svg-icon-tint)"></path><path d="M 12.166 7.833 C 14.892 7.833 17.161 9.42 17.811 12 C 17.161 14.58 14.892 16.167 12.166 16.167 C 9.44 16.167 7.127 14.58 6.478 12 C 7.127 9.42 9.44 7.833 12.166 7.833 Z M 9.333 12 C 9.333 13.473 10.527 14.667 12 14.667 C 13.473 14.667 14.667 13.473 14.667 12 C 14.667 10.527 13.473 9.333 12 9.333 C 10.527 9.333 9.333 10.527 9.333 12 Z" fill="var(--svg-icon-tint)"></path></svg></div>\n\t\t\t\t\t\t\t<div class="title">Show Password</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'slider\')">\n\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 5.667 12 L 18.333 12" stroke="var(--svg-icon-tint)" fill="transparent" opacity="0.4" stroke-width="2.67" stroke-linecap="round" stroke-linejoin="round"></path><path d="M 12 8.333 C 14.025 8.333 15.667 9.975 15.667 12 C 15.667 14.025 14.025 15.667 12 15.667 C 9.975 15.667 8.333 14.025 8.333 12 C 8.333 9.975 9.975 8.333 12 8.333 Z" fill="var(--svg-icon-tint)"></path></svg></div>\n\t\t\t\t\t\t\t<div class="title">Slider</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'stories-drag\')">\n\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 5.333 6.667 C 5.333 5.93 5.93 5.333 6.667 5.333 L 10 5.333 C 10.736 5.333 11.333 5.93 11.333 6.667 L 11.333 6.667 C 11.333 7.403 10.736 8 10 8 L 6.667 8 C 5.93 8 5.333 7.403 5.333 6.667 Z" fill="var(--svg-icon-tint)" opacity="0.4"></path><path d="M 12.667 6.667 C 12.667 5.93 13.264 5.333 14 5.333 L 17.333 5.333 C 18.07 5.333 18.667 5.93 18.667 6.667 L 18.667 6.667 C 18.667 7.403 18.07 8 17.333 8 L 14 8 C 13.264 8 12.667 7.403 12.667 6.667 Z" fill="var(--svg-icon-tint)"></path></svg></div>\n\t\t\t\t\t\t\t<div class="title">Stories: Drag</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'stories-tap\')">\n\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18 C 22 20.209 20.209 22 18 22 L 6 22 C 3.791 22 2 20.209 2 18 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 5.333 6.667 C 5.333 5.93 5.93 5.333 6.667 5.333 L 10 5.333 C 10.736 5.333 11.333 5.93 11.333 6.667 L 11.333 6.667 C 11.333 7.403 10.736 8 10 8 L 6.667 8 C 5.93 8 5.333 7.403 5.333 6.667 Z" fill="var(--svg-icon-tint)"></path><path d="M 12.667 6.667 C 12.667 5.93 13.264 5.333 14 5.333 L 17.333 5.333 C 18.07 5.333 18.667 5.93 18.667 6.667 L 18.667 6.667 C 18.667 7.403 18.07 8 17.333 8 L 14 8 C 13.264 8 12.667 7.403 12.667 6.667 Z" fill="var(--svg-icon-tint)" opacity="0.4"></path></svg></div>\n\t\t\t\t\t\t\t<div class="title">Stories: Tap</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<div class="btn" (click)="onSelect(\'toast-prompt\')">\n\t\t\t\t\t\t\t<div class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M 2 6 C 2 3.791 3.791 2 6 2 L 18 2 C 20.209 2 22 3.791 22 6 L 22 18.333 C 22 20.542 20.209 22.333 18 22.333 L 6 22.333 C 3.791 22.333 2 20.542 2 18.333 Z" fill="var(--svg-icon-tint)" opacity="0.2"></path><path d="M 12 6.333 C 15.13 6.333 17.667 8.87 17.667 12 C 17.667 15.13 15.13 17.667 12 17.667 C 8.87 17.667 6.333 15.13 6.333 12 C 6.333 8.87 8.87 6.333 12 6.333 Z" fill="transparent" stroke-width="1.33" stroke="var(--svg-icon-tint)"></path><path d="M 12 13 C 12.552 13 13 13.448 13 14 C 13 14.552 12.552 15 12 15 C 11.448 15 11 14.552 11 14 C 11 13.448 11.448 13 12 13 Z" fill="var(--svg-icon-tint)"></path><path d="M 11.06 9.998 C 11.027 9.457 11.458 9 12 9 L 12 9 C 12.542 9 12.973 9.457 12.94 9.998 L 12.848 11.535 C 12.821 11.983 12.449 12.333 12 12.333 L 12 12.333 C 11.551 12.333 11.179 11.983 11.152 11.535 Z" fill="var(--svg-icon-tint)"></path></svg></div>\n\t\t\t\t\t\t\t<div class="title">Toast Prompt</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</li>\n\t\t\t\t</ul>\n\t\t\t</li>\n\t\t\t--\x3e\n\t\t</ul>\n\t\t<ul class="nav--editor" *if="mode === 2">\n\t\t\t<li>\n\t\t\t\t<div class="title" [innerHTML]="\'editor_views\' | label"></div>\n\t\t\t\t<ul class="nav--editor">\n\t\t\t\t\t<li *for="let item of supportedViewTypes">\n\t\t\t\t\t\t<div class="btn" [class]="{ disabled: item.disabled }" (click)="onSelect({ type:\'view\', value: item.type.name })">\n\t\t\t\t\t\t\t<div class="icon">\n\t\t\t\t\t\t\t\t<svg-icon [name]="item.type.name"></svg-icon>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="title" [innerHTML]="item.name"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</li>\n\t\t\t\t</ul>\n\t\t\t</li>\n\t\t</ul>\n\t\t<ul class="nav--editor" *if="mode === 3">\n\t\t\t<li>\n\t\t\t\t<div class="title" [innerHTML]="\'editor_view_items\' | label"></div>\n\t\t\t\t<ul class="nav--editor">\n\t\t\t\t\t<li *for="let item of supportedViewItemTypes">\n\t\t\t\t\t\t<div class="btn" [class]="{ disabled: item.disabled }" (click)="onSelect({ type:\'viewItem\', value: item.type.name })" [title]="item.id">\n\t\t\t\t\t\t\t<div class="icon">\n\t\t\t\t\t\t\t\t<svg-icon [name]="item.type.name"></svg-icon>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="title" [innerHTML]="item.name"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</li>\n\t\t\t\t</ul>\n\t\t\t\t<div class="abstract" *if="supportedViewItemTypes.length == 0" [innerHTML]="\'editor_type_no_items\' | label"></div>\n\t\t\t</li>\n\t\t</ul>\n\t</div>\n\t'};let Lr=0;class _r{static set active(t){this.active$.next(t)}static get active(){return this.active$.getValue()}static menu$(){return this.getMenu$().pipe(i.switchMap((t=>(this.menu$_.next(t),this.menu$_))))}static getMenu$(){return _s.get$("/api/menu").pipe(i.map((t=>(t.menu.sort(((t,e)=>t.order-e.order)),t.menu))))}static updateMenu$(t){return _s.put$("/api/menu",t)}static createMenuItem$(t,e){void 0===t&&(t=null),void 0===e&&(e=0);const s={parentId:t,viewId:null,order:10*e,name:"Folder "+ ++Lr};return _s.post$("/api/menu",s)}static updateMenuItem$(t){return _s.put$(`/api/menu/${t.id}`,t)}static deleteMenuItem$(t){return _s.delete$(`/api/menu/${t.id}`)}static getModelMenu$(t,e){return void 0===e&&(e=!1),this.menu$().pipe(i.map((s=>{if(s&&s.length)return s=s.filter((e=>null==e.viewId||0==e.viewId||null!=t.find((t=>t.id===e.viewId)))),this.mapMenuItems(s);{const s={};t.forEach((t=>{if(t.type.name!==bi.WaitingRoom.name&&(!t.hidden||e)){let e=s[t.type.name];e||(e=s[t.type.name]=[]),e.push(t)}}));return Object.keys(s).map((s=>{let i="Button";switch(s){case bi.WaitingRoom.name:i="Waiting Room";break;case bi.Panorama.name:i="Experience";break;case bi.PanoramaGrid.name:i="Virtual Tour";break;case bi.Room3d.name:i="Stanze 3D";break;case bi.Model.name:i="Modelli 3D";break;case bi.Media.name:i="Media"}return{name:i,type:{name:"menu-group"},items:t.filter((t=>t.type.name===s&&(!t.hidden||e)))}}))}})))}static mapMenuItem(t,e){return t.viewId?{id:t.viewId,name:t.name,type:{name:"panorama"}}:{name:t.name,type:{name:"menu-group"},items:this.mapMenuItems(e,t.id)}}static mapMenuItems(t,e){return void 0===e&&(e=null),t.filter((t=>(t.parentId||null)===e)).map((e=>this.mapMenuItem(e,t))).filter((t=>null!=t.id||t.items.length>0))}}_r.active$=new s.BehaviorSubject(!1),_r.menu$_=new s.BehaviorSubject([]);class Ir{static drop$(e){if(t.isPlatformBrowser&&e){const t=document.querySelector("body");return s.merge(s.fromEvent(t,"drop"),s.fromEvent(t,"dragover")).pipe(i.map((t=>{t.preventDefault(),t.target===e&&(e.files=t.dataTransfer.files)})))}return s.EMPTY}static change$(e){return t.isPlatformBrowser&&e?s.fromEvent(e,"change").pipe(i.filter((t=>e.files&&e.files.length)),i.map((t=>Array.from(e.files)))):s.EMPTY}static asset$(t,e){return void 0===e&&(e=[]),this.change$(t).pipe(i.switchMap((t=>{e.length=t.length,e.fill(null);const n=t.map(((t,s)=>this.read$(t,s,e).pipe(i.map((()=>t)),i.switchMap((t=>Ka.upload$([t]))),i.switchMap((t=>{const e=t[0],s=on.fromUrl(e.url);return Ka.assetCreate$(s)})))));return s.combineLatest(n)})))}static read$(t,e,n){void 0===n&&(n=[]);const o=new FileReader,a=s.fromEvent(o,"load").pipe(i.switchMap((t=>{const e=t.target.result;return this.resize$(e)})),i.tap((t=>{n[e]=t})));return o.readAsDataURL(t),a}static resize$(t){return s.from(this.resize_(t))}static resize_(t){return new Promise(((e,s)=>{const i=document.createElement("img");i.onload=function(){const t=document.createElement("canvas"),s=t.getContext("2d");let n=i.width,o=i.height;n>o?n>320&&(o*=320/n,n=320):o>240&&(n*=240/o,o=240),t.width=n,t.height=o,s.drawImage(i,0,0,n,o);const a=t.toDataURL("image/jpeg",.9);e(a)},i.onerror=function(){s(t)},i.src=t}))}}class Rr extends t.Component{onChanges(){const{node:e}=t.getContext(this),s=this.control.flags;Object.keys(s).forEach((t=>{s[t]?e.classList.add(t):e.classList.remove(t)}))}}Rr.meta={selector:"[control]",inputs:["control"]};class $r extends Rr{onInit(){this.label=this.label||"label",this.disabled=this.disabled||!1,this.accept=this.accept||"image/png, image/jpeg";const{node:e}=t.getContext(this),n=e.querySelector("input");n.setAttribute("accept",this.accept),Ir.drop$(n).pipe(i.takeUntil(this.unsubscribe$)).subscribe(),Ir.change$(n).pipe(i.switchMap((t=>{const e=t.map(((t,e)=>Ka.upload$([t]).pipe(i.switchMap((t=>Ka.createOrUpdateAsset$(t,this.control))))));return s.combineLatest(e)})),i.takeUntil(this.unsubscribe$)).subscribe((t=>{this.control.value=t[0]}))}}$r.meta={selector:"[control-asset]",inputs:["control","label","disabled","accept"],template:'\n\t\t<div class="group--form" [class]="{ required: control.validators.length, disabled: disabled }">\n\t\t\t<div class="control--head">\n\t\t\t\t<label [innerHTML]="label"></label>\n\t\t\t\t<span class="required__badge" [innerHTML]="\'required\' | label"></span>\n\t\t\t</div>\n\t\t\t<div class="group--picture">\n\t\t\t\t<div class="group--picture__info">\n\t\t\t\t\t<span [innerHTML]="\'browse\' | label"></span>\n\t\t\t\t</div>\n\t\t\t\t<img [lazy]="control.value | asset" [size]="{ width: 320, height: 240 }" *if="control.value && control.value.type.name === \'image\'" />\n\t\t\t\t<video [src]="control.value | asset" *if="control.value && control.value.type.name === \'video\'"></video>\n\t\t\t\t<input type="file">\n\t\t\t</div>\n\t\t\t<div class="file-name" *if="control.value" [innerHTML]="control.value.file"></div>\n\t\t</div>\n\t\t<errors-component [control]="control"></errors-component>\n\t'};class Ar extends $r{static itemToFormGroup(t){return new e.FormGroup({id:t.id,parentId:t.parentId,viewId:t.viewId,name:t.name,items:new e.FormArray})}onInit(){this.dropdownId=kr.nextId(),this.controls=this.control.controls,Xa.viewIdOptions$().pipe(i.first()).subscribe((t=>{this.controls.viewId.options=t}))}onAddItem(){_r.createMenuItem$(this.controls.id.value,this.controls.items.length).pipe(i.first()).subscribe((t=>{this.controls.items.push(Ar.itemToFormGroup(t))}))}onRemoveItem(){this.remove.next(this.control)}onRemoveControl(t){_r.deleteMenuItem$(t.value).pipe(i.first()).subscribe((()=>{this.controls.items.remove(t)}))}onLinkItem(){this.link.next(this.control)}onLinkControl(t){this.link.next(t)}onItemUp(){this.up.next(this.control)}onItemDown(){this.down.next(this.control)}onUpControl(t){const e=this.controls.items,s=e.controls.length;let i=e.controls.indexOf(t);e.controls.splice(i,1),i>0?i--:i=s-1,e.insert(t,i)}onDownControl(t){const e=this.controls.items,s=e.controls.length;let i=e.controls.indexOf(t);e.controls.splice(i,1),i<s-1?i++:i=0,e.insert(t,i)}setView(t){const e=Object.assign({},this.control.value);e.viewId=t.id,t.id&&(e.name=t.name),_r.updateMenuItem$(e).pipe(i.first()).subscribe((()=>{this.controls.viewId.value=t.id,t.id&&(this.controls.name.value=t.name,this.controls.items.controls=[],this.controls.items.switchSubjects_())}))}onTextDidChange(t){_r.updateMenuItem$(this.control.value).pipe(i.first()).subscribe()}hasOption(t){return this.controls.viewId.value===t.id}onDropped(t){}}Ar.meta={selector:"[control-menu]",outputs:["remove","link","up","down"],inputs:["control"],template:'\n\t\t<div class="group--form">\n\t\t\t<button type="button" class="control-menu__link" [class]="{ active: control.controls.viewId.value }" (click)="onLinkItem($event)" [dropdown]="dropdownId" (dropped)="onDropped($event)">\n\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#link"></use></svg>\n\t\t\t\t<div class="dropdown" [dropdown-item]="dropdownId">\n\t\t\t\t\t<div class="category">View</div>\n\t\t\t\t\t<ul class="nav--dropdown">\n\t\t\t\t\t\t<li (click)="setView(item)" [class]="{ empty: item.id == null }" *for="let item of control.controls.viewId.options">\n\t\t\t\t\t\t\t<span [class]="{ active: hasOption(item) }" [innerHTML]="item.name"></span>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t</ul>\n\t\t\t\t</div>\n\t\t\t</button>\n\t\t\t<input type="text" class="control--text" [formControl]="control.controls.name" placeholder="Name" (change)="onTextDidChange($event)" />\n\t\t\t\x3c!--\n\t\t\t<button type="button" class="control-menu__add" (click)="onAddItem($event)">\n\t\t\t\t<span [innerHTML]="control.controls.viewId.value"></span>\n\t\t\t</button>\n\t\t\t--\x3e\n\t\t\t\x3c!--\n\t\t\t<select class="control--select" [formControl]="control.controls.viewId">\n\t\t\t\t<option [value]="item.id" *for="let item of control.controls.viewId.options" [innerHTML]="item.name"></option>\n\t\t\t</select>\n\t\t\t--\x3e\n\t\t\t<button type="button" class="control-menu__up" (click)="onItemUp($event)">\n\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#up"></use></svg>\n\t\t\t</button>\n\t\t\t<button type="button" class="control-menu__down" (click)="onItemDown($event)">\n\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#down"></use></svg>\n\t\t\t</button>\n\t\t\t<button type="button" class="control-menu__add" (click)="onAddItem($event)" *if="!control.controls.viewId.value">\n\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#add"></use></svg>\n\t\t\t</button>\n\t\t\t<button type="button" class="control-menu__remove" (click)="onRemoveItem($event)">\n\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#remove"></use></svg>\n\t\t\t</button>\n\t\t</div>\n\t\t<div class="group--items">\n\t\t\t<div control-menu *for="let sub of control.controls.items.controls" [control]="sub" (remove)="onRemoveControl($event)" (link)="onLinkControl($event)" (up)="onUpControl($event)" (down)="onDownControl($event)"></div>\n\t\t</div>\n\t'};class Pr extends t.Component{onInit(){this.changes=0,this.form=null,_r.getMenu$().pipe(i.first()).subscribe((t=>this.initForm(t)))}initForm(t){void 0===t&&(t=[]);const s=this.menuToControls(t),n=this.form=new e.FormGroup({items:s});this.controls=n.controls,n.changes$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((t=>{this.changes++,this.pushChanges()}))}onLinkControl(t){}onUpControl(t){const e=this.controls.items,s=e.controls.length;let i=e.controls.indexOf(t);e.controls.splice(i,1),i>0?i--:i=s-1,e.insert(t,i)}onDownControl(t){const e=this.controls.items,s=e.controls.length;let i=e.controls.indexOf(t);e.controls.splice(i,1),i<s-1?i++:i=0,e.insert(t,i)}onAddItem(){_r.createMenuItem$(null,this.controls.items.length).pipe(i.first()).subscribe((t=>{this.controls.items.push(Ar.itemToFormGroup(t))}))}onRemoveControl(t){_r.deleteMenuItem$(t.value).pipe(i.first()).subscribe((()=>{this.controls.items.remove(t)}))}isValid(){return this.form.valid}onSubmit(t){if(this.form.valid){const t=this.form.value,e=this.controlsToMenu(t);_r.updateMenu$(e)}else this.form.touched=!0}menuToControls(t,s){void 0===s&&(s=null);return new e.FormArray(t.filter((t=>(t.parentId||null)===s)).map((s=>{const i=this.menuToControls(t,s.id);return new e.FormGroup({id:s.id,parentId:s.parentId,viewId:s.viewId,name:s.name,items:i})})))}controlsToMenu(t){const e=[],s=t=>{t&&t.forEach(((t,i)=>{const n=Object.assign({},t);n.order=10*i,delete n.items,e.push(n),s(t.items)}))};return s(t.items),e}}Pr.meta={selector:"[menu-builder]",inputs:["views"],template:'\n\t<div class="group--head">\n\t\t<div class="title" [innerHTML]="\'editor_menu\' | label"></div>\n\t</div>\n\t<div class="group--main">\n\t\t<div class="nav--tree" *if="form">\n\t\t\t<form class="form" [formGroup]="form" (submit)="isValid() && onSubmit()" name="form" role="form" novalidate autocomplete="off">\n\t\t\t\t<div class="abstract" *if="controls.items.controls.length == 0" [innerHTML]="\'editor_add_item\' | label"></div>\n\t\t\t\t<div *for="let control of controls.items.controls">\n\t\t\t\t\t<div control-menu [control]="control" (remove)="onRemoveControl($event)" (link)="onLinkControl($event)" (up)="onUpControl($event)" (down)="onDownControl($event)"></div>\n\t\t\t\t</div>\n\t\t\t</form>\n\t\t</div>\n\t</div>\n\t<div class="group--foot">\n\t\t<button type="button" class="btn--mode" (click)="onAddItem($event)" [innerHTML]="\'editor_add\' | label"></button>\n\t\t<button type="button" class="btn--mode" (click)="isValid() && onSubmit()" *if="changes > 1" [innerHTML]="\'editor_save\' | label"></button>\n\t</div>\n\t'};class Hr extends t.Component{get data(){let e=null;const{parentInstance:s}=t.getContext(this);return s instanceof qi&&(e=s.modal.data),e}get navmap(){let t=null;const e=this.data;return e&&(t=e.navmap),t}get position(){let t=[0,0,0];const e=this.data;return e&&(t=[e.hit.x,e.hit.y,0]),t}onInit(){const t=this.position;this.error=null;const s=this.form=new e.FormGroup({type:wi.Nav,title:null,abstract:null,viewId:new e.FormControl(null,e.RequiredValidator()),keepOrientation:!1,important:!1,transparent:!1,position:new e.FormControl(t,e.RequiredValidator()),asset:null});this.controls=s.controls,s.changes$.subscribe((t=>{this.pushChanges()})),Xa.viewIdOptions$().pipe(i.first()).subscribe((t=>{this.controls.viewId.options=t,this.pushChanges()}))}onSubmit(){if(this.form.valid){this.form.submitted=!0;const t=Object.assign({},this.form.value);t.viewId=parseInt(t.viewId),Hi.itemCreate$(this.navmap,t).pipe(i.first()).subscribe((t=>{ei.resolve(t)}),(t=>{console.log("NavmapItemModalComponent.onSubmit.error",t),this.error=t,this.form.submitted=!1}))}else this.form.touched=!0}onClose(){ei.reject()}}Hr.meta={selector:"[navmap-item-modal]",template:'\n\t\t<div class="modal__header">\n\t\t\t<button type="button" class="btn--close" (click)="onClose()">\n\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#close"></use></svg>\n\t\t\t</button>\n\t\t</div>\n\t\t<div class="container">\n\t\t\t<div class="form">\n\t\t\t\t<div class="title">Create Map Nav.</div>\n\t\t\t\t<form [formGroup]="form" (submit)="onSubmit()" name="form" role="form" novalidate autocomplete="off">\n\t\t\t\t\t<div class="form-controls">\n\t\t\t\t\t\t<div control-text [control]="controls.title" label="Title"></div>\n\t\t\t\t\t\t<div control-textarea [control]="controls.abstract" label="Abstract"></div>\n\t\t\t\t\t\t<div control-custom-select [control]="controls.viewId" label="NavToView"></div>\n\t\t\t\t\t\t<div control-vector [control]="controls.position" label="Position" [precision]="3" [disabled]="true"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="group--cta">\n\t\t\t\t\t\t<button type="submit" class="btn--accept">\n\t\t\t\t\t\t\t<span>Create</span>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</form>\n\t\t\t</div>\n\t\t</div>\n\t'},Hr.chunk=()=>'<div class="nav-modal" navmap-item-modal></div>';class Or extends t.Component{onInit(){this.error=null;const t=this.form=new e.FormGroup({name:new e.FormControl(null,e.RequiredValidator()),asset:new e.FormControl(null,e.RequiredValidator())});this.controls=t.controls,t.changes$.subscribe((t=>{this.pushChanges()}))}onSubmit(){if(this.form.valid){this.form.submitted=!0;const t=this.form.value,e={name:t.name,asset:t.asset};return Hi.navmapCreate$(e).pipe(i.first()).subscribe((t=>{ei.resolve(t)}),(t=>{console.log("NavmapModalComponent.onSubmit.error",t),this.error=t,this.form.reset()}))}this.form.touched=!0}onClose(){ei.reject()}}Or.meta={selector:"[navmap-modal]",template:'\n\t\t<div class="modal__header">\n\t\t\t<button type="button" class="btn--close" (click)="onClose()">\n\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#close"></use></svg>\n\t\t\t</button>\n\t\t</div>\n\t\t<div class="container">\n\t\t\t<div class="form">\n\t\t\t\t<div class="title">Create Map.</div>\n\t\t\t\t<form [formGroup]="form" (submit)="onSubmit()" name="form" role="form" novalidate autocomplete="off">\n\t\t\t\t\t<div class="form-controls">\n\t\t\t\t\t\t<div control-text [control]="controls.name" label="Name"></div>\n\t\t\t\t\t\t<div control-asset [control]="controls.asset" label="Image" accept="image/png"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="description">Formato immagine .png con trasparenza (2048x1024 o 1024x512)</div>\n\t\t\t\t\t<div class="group--cta">\n\t\t\t\t\t\t<button type="submit" class="btn--accept">\n\t\t\t\t\t\t\t<span>Create</span>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</form>\n\t\t\t</div>\n\t\t</div>\n\t'},Or.chunk=()=>'<div class="panorama-modal" navmap-modal></div>';class Ur extends t.Component{onInit(){this.navmap=null,this.navmaps=[],Hi.navmapGet$().pipe(i.first()).subscribe((t=>{this.navmaps=t,this.pushChanges()}))}onBack(t){this.navmap=null,this.pushChanges()}onAdd(){ei.open$({template:Or.chunk()}).pipe(i.first()).subscribe((t=>{t instanceof Qs&&(this.navmaps.push(t.data),this.navmap=t.data,this.pushChanges())}))}onSet(t){this.navmap=this.navmaps.find((e=>e.id===t.id)),this.pushChanges()}onAddItem(t,e){ei.open$({template:Hr.chunk(),data:{navmap:t,hit:e}}).pipe(i.first()).subscribe((e=>{if(e instanceof Qs){const s=t.items||[];s.push(e.data),Object.assign(t,{items:s}),this.pushChanges()}}))}onDelete(t){const e=this.navmaps.indexOf(t);-1!==e&&this.navmaps.splice(e,1),this.navmap=null,this.pushChanges()}}Ur.meta={selector:"[navmap-builder]",inputs:["views"],template:'\n\t<div class="group--head">\n\t\t<div class="title" [innerHTML]="\'editor_navmaps\' | label"></div>\n\t</div>\n\t<div class="group--main">\n\t\t\x3c!-- listing navmaps --\x3e\n\t\t<div class="listing--navmaps" *if="!navmap">\n\t\t\t<div class="abstract" *if="navmaps.length == 0" [innerHTML]="\'editor_add_item\' | label"></div>\n\t\t\t<div class="listing__item" *for="let item of navmaps">\n\t\t\t\t<div class="card--navmap" (click)="onSet(item)">\n\t\t\t\t\t<div class="card__picture">\n\t\t\t\t\t\t<img [src]="item.asset | asset" *if="item.asset" />\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="card__content">\n\t\t\t\t\t\t<div class="card__name" [innerHTML]="item.name"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t\x3c!-- navmap edit --\x3e\n\t\t<div class="navmap" navmap-edit [navmap]="navmap" (delete)="onDelete($event)" *if="navmap">\n\t\t\t<form class="form" [formGroup]="form" (submit)="onSubmit()" name="form" role="form" novalidate autocomplete="off">\n\t\t\t\t<div class="title"><span [innerHTML]="navmap.name"></span> <span [innerHTML]="navmap.id"></span></div>\n\t\t\t\t<div class="form-controls">\n\t\t\t\t\t<div control-text [control]="controls.name" label="Name"></div>\n\t\t\t\t\t\x3c!--\n\t\t\t\t\t<div control-asset [control]="controls.asset" label="Image" accept="image/png"></div>\n\t\t\t\t\t--\x3e\n\t\t\t\t</div>\n\t\t\t\t<div class="group--cta">\n\t\t\t\t\t<button type="submit" class="btn--accept">\n\t\t\t\t\t\t<span [innerHTML]="\'editor_save\' | label"></span>\n\t\t\t\t\t</button>\n\t\t\t\t\t<button type="button" class="btn--remove" (click)="onRemove($event)">\n\t\t\t\t\t\t<span [innerHTML]="\'editor_remove\' | label"></span>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t\t<div class="navmap-control" [class]="mode">\n\t\t\t\t\t<div class="navmap-control__image">\n\t\t\t\t\t\t<img draggable="false" [src]="navmap.asset | asset" *if="navmap.asset" />\n\t\t\t\t\t\t<div class="navmap__item" [style]="{ left: item.position[0] * 100 + \'%\', top: item.position[1] * 100 + \'%\' }" (mousedown)="onMoveItem($event, item)" (click)="onRemoveItem(item)" *for="let item of navmap.items">\n\t\t\t\t\t\t\t<img draggable="false" [src]="\'textures/ui/nav-point.png\' | asset" />\n\t\t\t\t\t\t\t<div class="title" [innerHTML]="item.title" *if="item.title"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<ul class="navmap-control__toolbar">\n\t\t\t\t\t\t<li class="nav__item"><span [class]="{ active: mode === \'insert\' }" (click)="onToggleMode(\'insert\')"><svg class="pencil" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#pencil"></use></svg></span></li>\n\t\t\t\t\t\t<li class="nav__item"><span [class]="{ active: mode === \'move\' }" (click)="onToggleMode(\'move\')"><svg class="move" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#move"></use></svg></span></li>\n\t\t\t\t\t\t<li class="nav__item"><span [class]="{ active: mode === \'remove\' }" (click)="onToggleMode(\'remove\')"><svg class="erase" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#erase"></use></svg></span></li>\n\t\t\t\t\t</ul>\n\t\t\t\t</div>\n\t\t\t</form>\n\t\t</div>\n\t</div>\n\t<div class="group--foot">\n\t\t<button type="button" class="btn--mode" (click)="onAdd($event)" [innerHTML]="\'editor_add\' | label" *if="!navmap"></button>\n\t\t<button type="button" class="btn--mode" (click)="onBack($event)" [innerHTML]="\'editor_back\' | label" *if="navmap"></button>\n\t</div>\n\t'};const Br="idle",Dr="insert",zr="remove",Vr="move";class jr{constructor(t,e){const s=t.getBoundingClientRect();this.x=(e.clientX-s.x)/s.width,this.y=(e.clientY-s.y)/s.height}}class Nr extends jr{}class Fr extends jr{}class Gr extends jr{}class qr extends t.Component{onInit(){this.mode=Br,this.error=null;const t=this.navmap,s=this.form=new e.FormGroup({name:new e.FormControl(t.name,e.RequiredValidator()),asset:new e.FormControl(t.asset,e.RequiredValidator())});this.controls=s.controls,s.changes$.subscribe((t=>{this.pushChanges()})),this.insert$().pipe(i.takeUntil(this.unsubscribe$)).subscribe((e=>{const s=e;ei.open$({template:Hr.chunk(),data:{navmap:t,hit:s}}).pipe(i.first()).subscribe((e=>{if(e instanceof Qs){const s=t.items||[];s.push(e.data),Object.assign(t,{items:s}),this.pushChanges()}}))}))}insert$(){const{node:e}=t.getContext(this),n=e.querySelector(".navmap-control__image");return s.fromEvent(n,"pointerdown").pipe(i.filter((t=>this.mode===Dr)),i.map((t=>new Nr(n,t))))}onToggleMode(t){this.mode=this.mode===t?Br:t,this.pushChanges()}onMoveItem(e,n){const o=this.navmap;if(this.mode===Vr){const{node:a}=t.getContext(this),r=a.querySelector(".navmap-control__image"),l=n.position.slice(),c=new Nr(r,e),d=s.fromEvent(r,"mousemove").pipe(i.map((t=>new Fr(r,t))),i.tap((t=>{const e=t.x-c.x,s=t.y-c.y;n.position=[Math.max(0,Math.min(1,l[0]+e)),Math.max(0,Math.min(1,l[1]+s)),0],this.pushChanges()}))),h=s.fromEvent(r,"mouseup").pipe(i.map((t=>new Gr(r,t))),i.tap((t=>{const e=t.x-c.x,s=t.y-c.y;n.position=[Math.max(0,Math.min(1,l[0]+e)),Math.max(0,Math.min(1,l[1]+s)),0],Hi.itemUpdate$(o,n).pipe(i.first()).subscribe((t=>{Object.assign(n,t),this.pushChanges()}))})));d.pipe(i.takeUntil(h)).subscribe()}}onRemoveItem(t){const e=this.navmap;if(this.mode===zr)Hi.itemDelete$(e,t).pipe(i.first()).subscribe((s=>{const i=e.items||[],n=i.indexOf(t);-1!==n&&i.splice(n,1),Object.assign(e,{items:i}),this.pushChanges()}))}onSubmit(){if(this.form.valid){this.form.submitted=!0;const t=this.form.value,e=Object.assign({items:[]},this.navmap,{name:t.name});Hi.navmapUpdate$(e).pipe(i.first()).subscribe((t=>{Object.assign(this.navmap,t),this.pushChanges()}),(t=>{this.error=t,this.form.reset()}))}else this.form.touched=!0}onRemove(){const t=this.navmap;ei.open$({template:rr.chunk(),data:{item:t}}).pipe(i.first()).subscribe((e=>{e instanceof Qs&&Hi.navmapDelete$(t).pipe(i.first()).subscribe((e=>{this.delete.next(t)}))}))}}qr.meta={selector:"[navmap-edit]",outputs:["delete"],inputs:["navmap"]};class Zr extends t.Component{onInit(){this.busy=!1,this.active=!1,this.useHooks=As.enabled;const t=this.form=new e.FormGroup;this.controls=t.controls;const s=this.item;this.originalItem=Object.assign({},s),s.hasChromaKeyColor=!(!s.asset||!s.asset.chromaKeyColor),s.autoplay=s.asset&&s.asset.type.name===Yi.Video.name?s.asset.autoplay:void 0,s.loop=s.asset&&s.asset.type.name===Yi.Video.name?s.asset.loop:void 0,s.assetType=en(s).id,this.doUpdateForm(),t.changes$.subscribe((t=>{this.doUpdateItem(t),this.pushChanges()}))}getFlagsDidChange(t,e){return["hasChromaKeyColor","autoplay","loop"].reduce(((s,i)=>{const n=e[i]||!1,o=t[i]||!1;return s||n!==o}),!1)}getAssetDidChange(t,e){return Ka.assetDidChange(t.asset,e.asset)}doUpdateItem(t){const e=this.item,n=this.getAssetDidChange(e,t),o=this.getFlagsDidChange(e,t);if(Object.assign(e,t),e.asset&&(e.asset.chromaKeyColor=e.hasChromaKeyColor?[0,1,0]:null,e.asset.autoplay=e.autoplay,e.asset.loop=e.loop),n||o){(e.asset?Ka.assetUpdate$(e.asset):s.of(null)).pipe(i.switchMap((()=>Xa.inferItemUpdate$(this.view,e))),i.first()).subscribe(),this.view.updateIndices(this.view.items),"function"==typeof e.onUpdateAsset&&e.onUpdateAsset()}"function"==typeof e.onUpdate&&e.onUpdate()}doUpdateForm(){const t=this.item,s=this.form;if(this.type&&this.type.name===t.type.name)Object.keys(this.controls).forEach((s=>{switch(s){case"link":break;case"links":const i=t.links.map((t=>({title:t.title||null,href:t.href||null,target:"_blank"}))),n=this.controls[s];for(;n.controls.length>i.length;)n.remove(n.controls[n.controls.length-1]);for(;n.controls.length<i.length;)n.push(new e.FormGroup({title:new e.FormControl(null),href:new e.FormControl(null),target:"_blank"}));n.patch(i);break;case"hasChromaKeyColor":this.controls[s].value=!(!t.asset||!t.asset.chromaKeyColor);break;case"autoplay":this.controls[s].value=!(!t.asset||!t.asset.autoplay);break;case"loop":this.controls[s].value=!(!t.asset||!t.asset.loop);break;case"assetType":this.controls[s].value=en(t).id;break;default:this.controls[s].value=null!=t[s]?t[s]:null}}));else{let n;switch(this.type=t.type,Object.keys(this.controls).forEach((t=>{s.removeKey(t)})),t.type.name){case wi.Nav.name:n=this.useHooks?["id","type","title?","abstract?","viewId?","hook?","hookExtra?","keepOrientation?","important?","transparent?","position","rotation","scale","asset?","link?","links?"]:["id","type","title?","abstract?","viewId?","keepOrientation?","important?","transparent?","position","rotation","scale","asset?","link?","links?"];break;case wi.Plane.name:n=["id","type","position","rotation","scale","assetType?","asset?","hasChromaKeyColor?","autoplay?","loop?"];break;case wi.CurvedPlane.name:n=["id","type","position","rotation","scale","radius","height","arc","assetType?","asset?","hasChromaKeyColor?","autoplay?","loop?"];break;case wi.Texture.name:n=["id","type","assetType?","asset?","hasChromaKeyColor?","autoplay?","loop?"];break;case wi.Model.name:n=this.view.type.name===bi.Model?["id","type","asset?"]:["id","type","position","rotation","asset?"];break;default:n=["id","type"]}n.forEach((n=>{const o=-1!==n.indexOf("?");n=n.replace("?","");const a=null!=t[n]?t[n]:null;let r;switch(n){case"viewId":r=new e.FormControl(a,o?void 0:e.RequiredValidator()),Xa.viewIdOptions$().pipe(i.first()).subscribe((t=>{r.options=t,r.value=r.value||null,this.pushChanges()}));break;case"hook":if(r=new e.FormControl(a,o?void 0:e.RequiredValidator()),As.enabled){const t=U.webhook.methods.nav.map((t=>({id:t,name:t})));t.unshift({id:null,name:"select"}),r.options=t}r.value=r.value||null,this.pushChanges();break;case"assetType":r=new e.FormControl(a,o?void 0:e.RequiredValidator()),r.options=Object.keys(Ji).map((t=>Ji[t]));break;case"link":break;case"links":const s=t.links;r=new e.FormArray(s.map((t=>new e.FormGroup({title:new e.FormControl(t.title),href:new e.FormControl(t.href),target:"_blank"}))));break;default:r=new e.FormControl(a,o?void 0:e.RequiredValidator())}s.add(r,n)})),this.controls=s.controls}}onAssetTypeDidChange(t){const e=this.item,n=en(e).id;if(t!==n){e.assetType=t;let n=s.of(null);t!==Ji.ImageOrVideo.id&&(n=n.pipe(i.switchMap((()=>{const e=sn(t);return Ka.assetCreate$(e)})))),n.pipe(i.first()).subscribe((t=>{this.controls.asset.value=t}))}}onChanges(t){this.doUpdateForm()}onSubmit(){if(!this.busy&&this.form.valid){this.busy=!0,this.pushChanges();const t=this.form.value,e=Object.assign({},t);this.item.type.name===wi.Nav.name&&(e.viewId=e.viewId||this.view.id);const s=this.view,n=new Ti(e);Xa.inferItemUpdate$(s,n).pipe(i.first()).subscribe((t=>{Xa.inferItemUpdateResult$(s,n),this.update.next({view:s,item:n}),this.setTimeout((()=>{this.busy=!1,this.pushChanges()}))}),(t=>console.log("UpdateViewItemComponent.onSubmit.inferItemUpdate$.error",t)))}else this.form.touched=!0}onRemove(t){ei.open$({template:rr.chunk(),data:{item:this.item}}).pipe(i.first()).subscribe((t=>{t instanceof Qs&&this.delete.next({view:this.view,item:this.item})}))}onSelect(t){this.select.next({view:this.view,item:this.item.selected?null:this.item})}getTitle(t){return ge.getKeys("editor",t.type.name)}onAddLink(t){this.controls.links.push(new e.FormGroup({title:new e.FormControl(null),href:new e.FormControl(null),target:"_blank"}))}onRemoveLink(t){this.controls.links.remove(t)}clearTimeout(){this.to&&clearTimeout(this.to)}setTimeout(t,e){void 0===e&&(e=300),this.clearTimeout(),"function"==typeof t&&(this.to=setTimeout(t,e))}onDestroy(){this.clearTimeout()}}Zr.meta={selector:"update-view-item",outputs:["select","update","delete"],inputs:["view","item"],template:'\n\t\t<div class="group--headline" [class]="{ active: item.selected }" (click)="onSelect($event)">\n\t\t\t\x3c!-- <div class="id" [innerHTML]="item.id"></div> --\x3e\n\t\t\t<div class="icon">\n\t\t\t\t<svg-icon [name]="item.type.name"></svg-icon>\n\t\t\t</div>\n\t\t\t<div class="title" [innerHTML]="getTitle(item)"></div>\n\t\t\t<svg class="icon--caret-down"><use xlink:href="#caret-down"></use></svg>\n\t\t</div>\n\t\t<form [formGroup]="form" (submit)="onSubmit()" name="form" role="form" novalidate autocomplete="off" *if="item.selected">\n\t\t\t<div class="form-controls">\n\t\t\t\t<div control-text [control]="controls.id" label="Id" [disabled]="true"></div>\n\t\t\t\t\x3c!-- <div control-text [control]="controls.type" label="Type" [disabled]="true"></div> --\x3e\n\t\t\t</div>\n\t\t\t<div class="form-controls" *if="item.type.name == \'nav\'">\n\t\t\t\t<div control-text [control]="controls.title" label="Title"></div>\n\t\t\t\t<div control-textarea [control]="controls.abstract" label="Abstract"></div>\n\t\t\t\t<div control-custom-select [control]="controls.viewId" label="NavToView"></div>\n\t\t\t\t<div control-checkbox [control]="controls.keepOrientation" label="Keep Orientation"></div>\n\t\t\t\t<div control-checkbox [control]="controls.important" label="Important"></div>\n\t\t\t\t<div control-checkbox [control]="controls.transparent" label="Transparent"></div>\n\t\t\t\t<div control-vector [control]="controls.position" label="Position" [precision]="3"></div>\n\t\t\t\t<div *if="controls.transparent.value == true">\n\t\t\t\t\t<div control-vector [control]="controls.rotation" label="Rotation" [precision]="3" [increment]="Math.PI / 360"></div>\n\t\t\t\t\t<div control-vector [control]="controls.scale" label="Scale" [precision]="2"></div>\n\t\t\t\t</div>\n\t\t\t\t<div control-localized-asset [control]="controls.asset" label="Image" accept="image/jpeg, image/png"></div>\n\n\t\t\t\t<div class="group--link" *for="let link of controls.links.controls">\n\t\t\t\t\t<div class="group--controls">\n\t\t\t\t\t\t<div control-text [control]="link.controls.title" label="Link Title"></div>\n\t\t\t\t\t\t<div control-text [control]="link.controls.href" label="Link Url"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<button type="button" class="btn--remove" (click)="onRemoveLink(link)"><svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#remove"></use></svg></button>\n\t\t\t\t</div>\n\n\t\t\t\t<div class="group--cta">\n\t\t\t\t\t<button type="button" class="btn--update" (click)="onAddLink($event)">\n\t\t\t\t\t\t<span>Add Link</span>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\n\t\t\t\t<div *if="useHooks">\n\t\t\t\t\t<div control-custom-select [control]="controls.hook" label="Hook"></div>\n\t\t\t\t\t<div control-text [control]="controls.hookExtra" label="Hook Extra"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="form-controls" *if="item.type.name == \'plane\' && view.type.name != \'media\'">\n\t\t\t\t<div control-vector [control]="controls.position" label="Position" [precision]="2"></div>\n\t\t\t\t<div control-vector [control]="controls.rotation" label="Rotation" [precision]="3" [increment]="Math.PI / 360"></div>\n\t\t\t\t<div control-vector [control]="controls.scale" label="Scale" [precision]="2"></div>\n\t\t\t\t<div control-custom-select [control]="controls.assetType" label="Asset" (change)="onAssetTypeDidChange($event)"></div>\n\t\t\t\t<div control-localized-asset [control]="controls.asset" label="Localized Image or Video" accept="image/jpeg, video/mp4" *if="controls.assetType.value == 1"></div>\n\t\t\t\t<div control-checkbox [control]="controls.hasChromaKeyColor" label="Use Green Screen" *if="item.asset"></div>\n\t\t\t\t<div control-checkbox [control]="controls.autoplay" label="Autoplay" *if="item.asset && item.asset.type.name === \'video\'"></div>\n\t\t\t\t<div control-checkbox [control]="controls.loop" label="Loop" *if="item.asset && item.asset.type.name === \'video\'"></div>\n\t\t\t</div>\n\t\t\t<div class="form-controls" *if="item.type.name == \'plane\' && view.type.name == \'media\'">\n\t\t\t\t<div control-vector [control]="controls.scale" label="Scale" [precision]="2"></div>\n\t\t\t\t<div control-localized-asset [control]="controls.asset" label="Localized Image or Video" accept="image/jpeg, video/mp4"></div>\n\t\t\t\t<div control-checkbox [control]="controls.autoplay" label="Autoplay" *if="item.asset && item.asset.type.name === \'video\'"></div>\n\t\t\t\t<div control-checkbox [control]="controls.loop" label="Loop" *if="item.asset && item.asset.type.name === \'video\'"></div>\n\t\t\t</div>\n\t\t\t<div class="form-controls" *if="item.type.name == \'curved-plane\'">\n\t\t\t\t<div control-vector [control]="controls.position" label="Position" [precision]="2"></div>\n\t\t\t\t<div control-vector [control]="controls.rotation" label="Rotation" [precision]="3" [increment]="Math.PI / 360"></div>\n\t\t\t\t\x3c!-- <div control-vector [control]="controls.scale" label="Scale" [precision]="2" [disabled]="true"></div> --\x3e\n\t\t\t\t<div control-number [control]="controls.radius" label="Radius" [precision]="2"></div>\n\t\t\t\t<div control-number [control]="controls.height" label="Height" [precision]="2"></div>\n\t\t\t\t<div control-number [control]="controls.arc" label="Arc" [precision]="0"></div>\n\t\t\t\t<div control-custom-select [control]="controls.assetType" label="Asset" (change)="onAssetTypeDidChange($event)"></div>\n\t\t\t\t<div control-localized-asset [control]="controls.asset" label="Image or Video" accept="image/jpeg, video/mp4" *if="controls.assetType.value == 1"></div>\n\t\t\t\t<div control-checkbox [control]="controls.hasChromaKeyColor" label="Use Green Screen" *if="item.asset"></div>\n\t\t\t\t<div control-checkbox [control]="controls.autoplay" label="Autoplay" *if="item.asset && item.asset.type.name === \'video\'"></div>\n\t\t\t\t<div control-checkbox [control]="controls.loop" label="Loop" *if="item.asset && item.asset.type.name === \'video\'"></div>\n\t\t\t</div>\n\t\t\t<div class="form-controls" *if="item.type.name == \'texture\'">\n\t\t\t\t<div control-custom-select [control]="controls.assetType" label="Asset" (change)="onAssetTypeDidChange($event)"></div>\n\t\t\t\t<div control-localized-asset [control]="controls.asset" label="Image or Video" accept="image/jpeg, video/mp4" *if="controls.assetType.value == 1"></div>\n\t\t\t\t<div control-checkbox [control]="controls.hasChromaKeyColor" label="Use Green Screen" *if="item.asset"></div>\n\t\t\t\t<div control-checkbox [control]="controls.autoplay" label="Autoplay" *if="item.asset && item.asset.type.name === \'video\'"></div>\n\t\t\t\t<div control-checkbox [control]="controls.loop" label="Loop" *if="item.asset && item.asset.type.name === \'video\'"></div>\n\t\t\t</div>\n\t\t\t<div class="form-controls" *if="item.type.name == \'model\'">\n\t\t\t\t<div control-vector [control]="controls.position" label="Position" [precision]="2" *if="view.type.name !== \'model\'"></div>\n\t\t\t\t<div control-vector [control]="controls.rotation" label="Rotation" [precision]="3" [increment]="Math.PI / 360" *if="view.type.name !== \'model\'"></div>\n\t\t\t\t<div control-model [control]="controls.asset" label="Model (.glb)" accept=".glb"></div>\n\t\t\t</div>\n\t\t\t<div class="group--cta">\n\t\t\t\t<button type="submit" class="btn--update" [class]="{ busy: busy }">\n\t\t\t\t\t<span [innerHTML]="\'update\' | label"></span>\n\t\t\t\t</button>\n\t\t\t\t<button type="button" class="btn--remove" (click)="onRemove($event)">\n\t\t\t\t\t<span [innerHTML]="\'remove\' | label"></span>\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t</form>\n\t'};class Wr extends t.Component{onInit(){this.busy=!1,this.active=!1;const t=this.form=new e.FormGroup({id:new e.FormControl(this.tile.id,e.RequiredValidator()),asset:new e.FormControl(this.tile.asset,e.RequiredValidator()),navs:new e.FormControl(this.tile.navs,e.RequiredValidator())});this.controls=t.controls,t.changes$.subscribe((t=>{const e=this.tile;Object.assign(e,t),"function"==typeof e.onUpdate&&e.onUpdate(),this.pushChanges()}))}onSubmit(){if(!this.busy&&this.form.valid){this.busy=!0,this.pushChanges();const t=Object.assign({},this.form.value),e=this.view,s=t;this.update.next({view:e,tile:s}),this.setTimeout((()=>{this.busy=!1,this.pushChanges()}))}else this.form.touched=!0}onRemove(t){ei.open$({template:rr.chunk(),data:{tile:this.tile}}).pipe(i.first()).subscribe((t=>{t instanceof Qs&&this.delete.next({view:this.view,tile:this.tile})}))}onSelect(t){this.select.next({view:this.view,tile:this.tile.selected?null:this.tile})}clearTimeout(){this.to&&clearTimeout(this.to)}setTimeout(t,e){void 0===e&&(e=300),this.clearTimeout(),"function"==typeof t&&(this.to=setTimeout(t,e))}onDestroy(){this.clearTimeout()}}Wr.meta={selector:"update-view-tile",outputs:["select","update","delete"],inputs:["view","tile"],template:'\n\t\t<div class="group--headline" [class]="{ active: tile.selected }" (click)="onSelect($event)">\n\t\t\t<div class="icon">\n\t\t\t\t<svg-icon name="tile"></svg-icon>\n\t\t\t</div>\n\t\t\t<div class="title">Tile {{tile.id}}</div>\n\t\t\t<svg class="icon--caret-down"><use xlink:href="#caret-down"></use></svg>\n\t\t</div>\n\t\t<form [formGroup]="form" (submit)="onSubmit()" name="form" role="form" novalidate autocomplete="off" *if="tile.selected">\n\t\t\t<div class="form-controls">\n\t\t\t\t<div control-text [control]="controls.id" label="Id" [disabled]="true"></div>\n\t\t\t\t<div control-asset [control]="controls.asset" label="Image" accept="image/jpeg, image/png"></div>\n\t\t\t</div>\n\t\t\t<div class="group--cta">\n\t\t\t\t<button type="submit" class="btn--update" [class]="{ busy: busy }">\n\t\t\t\t\t<span [innerHTML]="\'update\' | label"></span>\n\t\t\t\t</button>\n\t\t\t\t\x3c!--\n\t\t\t\t<button type="button" class="btn--remove" (click)="onRemove($event)">\n\t\t\t\t\t<span [innerHTML]="\'remove\' | label"></span>\n\t\t\t\t</button>\n\t\t\t\t--\x3e\n\t\t\t</div>\n\t\t</form>\n\t'};class Kr extends t.Component{onInit(){this.busy=!1;const t=this.form=new e.FormGroup;this.controls=t.controls,this.doUpdateForm(),t.changes$.subscribe((t=>{this.doUpdateView(t),this.pushChanges()})),this.orbit$().pipe(i.takeUntil(this.unsubscribe$)).subscribe((t=>{switch(this.view.type.name){case bi.WaitingRoom.name:case bi.Panorama.name:case bi.PanoramaGrid.name:case bi.Room3d.name:case bi.Model.name:case bi.Media.name:this.form.patch({latitude:t.orientation.latitude,longitude:t.orientation.longitude,zoom:t.zoom})}}))}orbit$(){let t,e,s=null;return Us.in$.pipe(i.filter((t=>t.type===Ke)),i.auditTime(65),i.distinctUntilChanged(((i,n)=>{const o=t!==n.orientation.latitude||e!==n.orientation.longitude||s!==n.zoom;return t=n.orientation.latitude,e=n.orientation.longitude,s=n.zoom,!o})))}getAssetDidChange(t){const e=this.view;if(e.type.name===bi.PanoramaGrid.name)return!1;const s=Ka.assetDidChange(e.asset,t.asset),i=Ka.assetDidChange(e.ar?e.ar.usdz:null,t.usdz),n=Ka.assetDidChange(e.ar?e.ar.gltf:null,t.gltf);return!!(s||i||n)}doUpdateView(t){this.getAssetDidChange(t)&&this.onSubmit()}doUpdateForm(){const t=this.view;if(!this.type||this.type.name!==t.type.name){this.type=t.type;const s=this.form;let i;switch(Object.keys(this.controls).forEach((t=>{s.removeKey(t)})),t.type.name){case bi.WaitingRoom.name:i=["id","type","name","latitude","longitude","zoom","asset"];break;case bi.Panorama.name:i=["id","type","name","hidden?","latitude","longitude","zoom","asset"];break;case bi.PanoramaGrid.name:i=["id","type","name","hidden?","latitude","longitude","zoom"];break;case bi.Room3d.name:case bi.Model.name:i=["id","type","name","hidden?","latitude","longitude","zoom","asset"];break;case bi.Media.name:i=["id","type","name","hidden?","asset"];break;default:i=["id","type","name"]}t.type.name!==bi.WaitingRoom.name&&U.flags.ar&&(i.push("usdz?"),i.push("gltf?")),i.forEach((i=>{const n=-1!==i.indexOf("?");switch(i=i.replace("?","")){case"latitude":case"longitude":const o=t.orientation||{latitude:0,longitude:0};s.add(new e.FormControl(o[i],e.RequiredValidator()),i);break;case"usdz":case"gltf":s.add(new e.FormControl(t.ar&&t.ar[i]||null,n?void 0:e.RequiredValidator()),i);break;default:s.add(new e.FormControl(null!=t[i]?t[i]:null,n?void 0:e.RequiredValidator()),i)}})),this.controls=s.controls}}onChanges(t){this.doUpdateForm()}onSubmit(){if(!this.busy&&this.form.valid){this.busy=!0,this.pushChanges();const t=Object.assign({},this.form.value);null!=t.latitude&&(t.orientation={latitude:t.latitude,longitude:t.longitude},delete t.latitude,delete t.longitude);const e=t.usdz||null,s=t.gltf||null;delete t.usdz,delete t.gltf,t.ar=e||s?{usdz:e,gltf:s}:null;const n=new yi(Object.assign({},this.view,t));Xa.viewUpdate$(n).pipe(i.first()).subscribe((t=>{this.update.next({view:n}),this.setTimeout((()=>{this.busy=!1,this.pushChanges()}))}),(t=>console.log("UpdateViewComponent.onSubmit.viewUpdate$.error",t)))}else this.form.touched=!0}onRemove(t){ei.open$({template:rr.chunk(),data:{item:this.item}}).pipe(i.first()).subscribe((t=>{t instanceof Qs&&this.delete.next({view:this.view})}))}onSelect(t){this.select.next({view:this.view.selected?null:this.view})}getTitle(t){return ge.getKeys("editor",t.type.name)}clearTimeout(){this.to&&clearTimeout(this.to)}setTimeout(t,e){void 0===e&&(e=300),this.clearTimeout(),"function"==typeof t&&(this.to=setTimeout(t,e))}onDestroy(){this.clearTimeout()}}Kr.meta={selector:"update-view",outputs:["select","update","delete"],inputs:["view"],template:'\n\t\t<div class="group--headline" [class]="{ active: view.selected }" (click)="onSelect($event)">\n\t\t\t\x3c!-- <div class="id" [innerHTML]="view.id"></div> --\x3e\n\t\t\t<div class="icon">\n\t\t\t\t<svg-icon [name]="view.type.name"></svg-icon>\n\t\t\t</div>\n\t\t\t<div class="title" [innerHTML]="getTitle(view)"></div>\n\t\t\t<svg class="icon--caret-down"><use xlink:href="#caret-down"></use></svg>\n\t\t</div>\n\t\t<form [formGroup]="form" (submit)="onSubmit()" name="form" role="form" novalidate autocomplete="off" *if="view.selected">\n\t\t\t<div class="form-controls">\n\t\t\t\t<div control-text [control]="controls.id" label="Id" [disabled]="true"></div>\n\t\t\t\t\x3c!-- <div control-text [control]="controls.type" label="Type" [disabled]="true"></div> --\x3e\n\t\t\t\t<div control-text [control]="controls.name" label="Name"></div>\n\t\t\t</div>\n\t\t\t<div class="form-controls" *if="view.type.name == \'waiting-room\'">\n\t\t\t\t<div control-localized-asset [control]="controls.asset" label="Image" accept="image/jpeg"></div>\n\t\t\t\t<div control-text [control]="controls.latitude" label="Latitude" [disabled]="true"></div>\n\t\t\t\t<div control-text [control]="controls.longitude" label="Longitude" [disabled]="true"></div>\n\t\t\t\t<div control-text [control]="controls.zoom" label="Zoom" [disabled]="true"></div>\n\t\t\t</div>\n\t\t\t<div class="form-controls" *if="view.type.name == \'panorama\'">\n\t\t\t\t<div control-checkbox [control]="controls.hidden" label="Hide from menu"></div>\n\t\t\t\t<div control-localized-asset [control]="controls.asset" label="Image or Video" accept="image/jpeg, video/mp4"></div>\n\t\t\t\t<div control-text [control]="controls.latitude" label="Latitude" [disabled]="true"></div>\n\t\t\t\t<div control-text [control]="controls.longitude" label="Longitude" [disabled]="true"></div>\n\t\t\t\t<div control-text [control]="controls.zoom" label="Zoom" [disabled]="true"></div>\n\t\t\t</div>\n\t\t\t<div class="form-controls" *if="view.type.name == \'panorama-grid\'">\n\t\t\t\t<div control-checkbox [control]="controls.hidden" label="Hide from menu"></div>\n\t\t\t\t<div control-text [control]="controls.latitude" label="Latitude" [disabled]="true"></div>\n\t\t\t\t<div control-text [control]="controls.longitude" label="Longitude" [disabled]="true"></div>\n\t\t\t\t<div control-text [control]="controls.zoom" label="Zoom" [disabled]="true"></div>\n\t\t\t</div>\n\t\t\t<div class="form-controls" *if="view.type.name == \'room-3d\'">\n\t\t\t\t<div control-checkbox [control]="controls.hidden" label="Hide from menu"></div>\n\t\t\t\t<div control-model [control]="controls.asset" label="Model (.glb)" accept=".glb"></div>\n\t\t\t\t<div control-text [control]="controls.latitude" label="Latitude" [disabled]="true"></div>\n\t\t\t\t<div control-text [control]="controls.longitude" label="Longitude" [disabled]="true"></div>\n\t\t\t\t<div control-text [control]="controls.zoom" label="Zoom" [disabled]="true"></div>\n\t\t\t</div>\n\t\t\t<div class="form-controls" *if="view.type.name == \'model\'">\n\t\t\t\t<div control-checkbox [control]="controls.hidden" label="Hide from menu"></div>\n\t\t\t\t<div control-localized-asset [control]="controls.asset" label="Image" accept="image/jpeg"></div>\n\t\t\t\t<div control-text [control]="controls.latitude" label="Latitude" [disabled]="true"></div>\n\t\t\t\t<div control-text [control]="controls.longitude" label="Longitude" [disabled]="true"></div>\n\t\t\t\t<div control-text [control]="controls.zoom" label="Zoom" [disabled]="true"></div>\n\t\t\t</div>\n\t\t\t<div class="form-controls" *if="view.type.name != \'waiting-room\' && (\'ar\' | flag)">\n\t\t\t\t<div control-model [control]="controls.usdz" label="AR IOS (.usdz)" accept=".usdz"></div>\n\t\t\t\t<div control-model [control]="controls.gltf" label="AR Android (.glb)" accept=".glb"></div>\n\t\t\t</div>\n\t\t\t<div class="group--cta">\n\t\t\t\t<button type="submit" class="btn--update" [class]="{ busy: busy }">\n\t\t\t\t\t<span [innerHTML]="\'update\' | label"></span>\n\t\t\t\t</button>\n\t\t\t\t<button type="button" class="btn--remove" *if="view.type.name != \'waiting-room\'" (click)="onRemove($event)">\n\t\t\t\t\t<span [innerHTML]="\'remove\' | label"></span>\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t</form>\n\t'};const Xr=[Er,Ya,dr,Ja,Ur,qr,Or,Hr,Qa,Pr,tr,er,ir,sr,nr,or,ar,rr,lr,Tr,Zr,Wr,Kr],Yr=[];class Jr extends t.Module{}Jr.meta={imports:[],declarations:[...Xr,...Yr],exports:[...Xr,...Yr]};class Qr extends t.Component{onClose(){ei.reject()}}Qr.meta={selector:"[iframe-modal]",inputs:["src"],template:'\n\t\t<div class="modal__header">\n\t\t\t<button type="button" class="btn--close" (click)="onClose()">\n\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#close"></use></svg>\n\t\t\t</button>\n\t\t</div>\n\t\t<div class="modal__content">\n\t\t\t<iframe [src]="src"></iframe>\n\t\t</div>\n\t'},Qr.chunk=t=>`<div class="iframe-modal" iframe-modal src="${t}"></div>`;class tl extends t.Pipe{static transform(t){let e=U;const s=t.split(".");let i=s.shift();for(;s.length>0&&e[i];)e=e[i],i=s.shift();return e[i]||null}}tl.meta={name:"env"};class el extends t.Pipe{static transform(t){return U.flags[t]||!1}}el.meta={name:"flag"};class sl{constructor(t){this.file=t,this.name=t.name,this.type=nn(t.name),this.progress=0,this.size=t.size,this.uploading=!1,this.paused=!1,this.success=!1,this.complete=!1,this.error=null,this.preview=null}}class il{constructor(t){t&&Object.assign(this,t)}}class nl extends il{}class ol extends il{}class al extends il{}class rl{constructor(){this.concurrent$=new s.BehaviorSubject(0),this.items$=new s.BehaviorSubject([]),this.events$=new s.ReplaySubject(1)}upload$(){const t=this.items$.getValue().filter((t=>!t.uploading));return s.combineLatest(t.map((t=>this.uploadItem$(t))))}uploadItem$(t){t.uploading=!0,this.events$.next(new nl({item:t}));const e=[t.file];return s.of(e).pipe(i.delayWhen((()=>this.concurrent$.pipe(i.filter((t=>t<4))))),i.tap((()=>this.concurrent$.next(this.concurrent$.getValue()+1))),i.first(),i.switchMap((t=>Ka.upload$(t))),i.switchMap((e=>{const s=e[0];t.uploading=!1,t.complete=!0;const n=on.fromUrl(s.url);return this.events$.next(new ol({item:t,asset:n})),Ka.assetCreate$(n).pipe(i.tap((e=>{this.remove(t),this.events$.next(new al({item:t,asset:e})),this.concurrent$.next(this.concurrent$.getValue()-1)})))})))}addItems(t){if(t&&t.length){const e=this.items$.getValue(),s=Array.from(t).map((t=>new sl(t)));e.push(...s),this.items$.next(e)}}remove(t){const e=this.items$.getValue(),s=e.indexOf(t);-1!==s&&e.splice(s,1),this.items$.next(e)}removeAll(){this.items$.next([])}drop$(e,n){if(t.isPlatformBrowser&&e){n=n||e;const t=document.querySelector("body");return s.merge(s.fromEvent(t,"drop"),s.fromEvent(t,"dragover")).pipe(i.map((t=>(t.preventDefault(),t.target===n&&this.addItems(t.dataTransfer.files),this.items$))))}return s.EMPTY}change$(e){return t.isPlatformBrowser&&e?s.fromEvent(e,"change").pipe(i.switchMap((t=>(e.files.length&&(this.addItems(e.files),e.value=""),this.items$)))):s.EMPTY}files$(t){return s.combineLatest(Array.from(t).map(((t,e)=>this.file$(t,e))))}file$(t,e){return this.read$(t,e).pipe(i.switchMap((()=>this.uploadFile$(t))))}read$(t,e){const n=new FileReader,o=s.fromEvent(n,"load").pipe(i.tap((t=>{const s=t.target.result;this.resize(s,(t=>{this.previews[e]=t,this.pushChanges()}))})));return n.readAsDataURL(t),o}uploadFile$(t){return Ka.upload$([t]).pipe(i.switchMap((t=>{const e=t[0],s=on.fromUrl(e.url);return Ka.assetCreate$(s)})))}resize(t,e){if("function"==typeof e){const s=document.createElement("img");s.onload=function(){const t=document.createElement("canvas"),i=t.getContext("2d");let n=s.width,o=s.height;n>o?n>320&&(o*=320/n,n=320):o>240&&(n*=240/o,o=240),t.width=n,t.height=o,i.drawImage(s,0,0,n,o);const a=t.toDataURL("image/jpeg",.9);e(a)},s.src=t}}supported(){return(e=document.createElement("input")).type="file","files"in e&&!!((t=new XMLHttpRequest)&&"upload"in t&&"onprogress"in t.upload)&&!!window.FormData;var t,e}}class ll extends Rr{get items(){return this.items_}set items(t){this.items_=t,this.uploadCount=t.reduce(((t,e)=>t+(e.uploading||e.completed?0:1)),0)}onInit(){this.label=this.label||"label",this.accept=this.accept||"image/png, image/jpeg",this.multiple=!1!==this.multiple,this.items=[],this.assets=this.control.value||[],this.hasFiles=!1;const{node:e}=t.getContext(this),s=e.querySelector("input");s.setAttribute("accept",this.accept);const n=e.querySelector(".upload-drop"),o=this.service=new rl;o.drop$(s,n).pipe(i.takeUntil(this.unsubscribe$)).subscribe((t=>{this.items=t,this.pushChanges()})),o.change$(s).pipe(i.takeUntil(this.unsubscribe$)).subscribe((t=>{this.items=t,this.pushChanges()})),o.events$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((t=>{t instanceof al&&(this.assets.push(t.asset),this.control.value=this.assets),this.items=this.items,this.pushChanges()}))}onUpload(){this.service.upload$().pipe(i.first()).subscribe()}onCancel(){this.service.removeAll()}onItemPause(t){}onItemResume(t){}onItemCancel(t){}onItemRemove(t){this.service.remove(t)}}ll.meta={selector:"[control-assets]",inputs:["control","label","multiple"],template:'\n\t\t<div class="group--form" [class]="{ required: control.validators.length }">\n\t\t\t<div class="control--head">\n\t\t\t\t<label [innerHTML]="label"></label>\n\t\t\t\t<span class="required__badge" [innerHTML]="\'required\' | label"></span>\n\t\t\t</div>\n\t\t\t<div class="listing--assets">\n\t\t\t\t<div class="listing__item" *for="let item of assets">\n\t\t\t\t\t<div class="upload-item">\n\t\t\t\t\t\t<div class="picture">\n\t\t\t\t\t\t\t<img [lazy]="item | asset" [size]="{ width: 320, height: 240 }" *if="item.type.name === \'image\'" />\n\t\t\t\t\t\t\t<video [src]="item | asset" *if="item.type.name === \'video\'"></video>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="name" [innerHTML]="item.file"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="listing__item" *for="let item of items">\n\t\t\t\t\t<div upload-item [item]="item" (pause)="onItemPause($event)" (resume)="onItemResume($event)" (cancel)="onItemCancel($event)" (remove)="onItemRemove($event)"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="group--cta">\n\t\t\t\t<div class="btn--browse">\n\t\t\t\t\t<span [innerHTML]="\'browse\' | label"></span>\n\t\t\t\t\t<input type="file" accept="image/jpeg" multiple />\n\t\t\t\t</div>\n\t\t\t\t<div class="btn--upload" (click)="onUpload()" *if="uploadCount > 0" [innerHTML]="\'upload\' | label"></div>\n\t\t\t\t<div class="btn--cancel" (click)="onCancel()" *if="uploadCount > 0" [innerHTML]="\'cancel\' | label"></div>\n\t\t\t</div>\n\t\t\t<div class="upload-drop">\n    \t\t\t<span [innerHTML]="\'drag_and_drop_images\' | label"></span>\n\t\t\t</div>\n\t\t</div>\n\t\t<errors-component [control]="control"></errors-component>\n\t'};class cl extends t.Component{get data(){let e=null;const{parentInstance:s}=t.getContext(this);return s instanceof qi&&(e=s.modal.data),e}onInit(){console.log(this.data),this.page=null,hr.currentLanguagePage$(this.data.mode).pipe(i.takeUntil(this.unsubscribe$)).subscribe((t=>{this.page=t,this.pushChanges()}))}onClose(){ei.reject()}}cl.meta={selector:"[generic-modal]",template:'\n\t\t<div class="modal__header">\n\t\t\t<button type="button" class="btn--close" (click)="onClose()">\n\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#close"></use></svg>\n\t\t\t</button>\n\t\t</div>\n\t\t<div class="container" *if="page">\n\t\t\t<h1 class="title" [innerHTML]="page.title"></h1>\n\t\t\t<div class="description" [innerHTML]="page.description"></div>\n\t\t</div>\n\t\t<div class="modal__footer">\n\t\t\t<button type="button" class="btn--accept" (click)="onClose()">\n\t\t\t\t<span [innerHTML]="\'title_close\' | label"></span>\n\t\t\t</button>\n\t\t</div>\n\t'},cl.chunk=()=>'<div class="generic-modal" generic-modal></div>';class dl extends Rr{onInit(){this.label=this.label||"label",this.linksSubject=new s.ReplaySubject,this.links$().pipe(i.takeUntil(this.unsubscribe$)).subscribe()}onChanges(){const{node:e}=t.getContext(this),i=Array.prototype.slice.call(e.querySelectorAll("a"));this.linksSubject.next(i.length?s.fromEvent(i,"click"):s.EMPTY)}links$(){return this.linksSubject.pipe(i.switchAll(),i.tap((t=>{if(U.flags.gdprRoutes){const e=cl.chunk();ei.open$({template:e,data:{mode:"privacy_policy"}}).pipe(i.first()).subscribe(),t.preventDefault()}})))}}dl.meta={selector:"[control-checkbox]",inputs:["control","label"],template:'\n\t\t<div class="group--form--checkbox" [class]="{ required: control.validators.length }">\n\t\t\t<label>\n\t\t\t\t<input type="checkbox" class="control--checkbox" [formControl]="control" [value]="true" />\n\t\t\t\t<span [innerHTML]="label | html"></span>\n\t\t\t</label>\n\t\t\t<span class="required__badge" [innerHTML]="\'required\' | label"></span>\n\t\t</div>\n\t\t<errors-component [control]="control"></errors-component>\n\t'};class hl extends Rr{onInit(){this.label=this.label||"label",this.dropped=!1,this.dropdownId=kr.nextId(),Sn.typing$().pipe(i.takeUntil(this.unsubscribe$)).subscribe((t=>{this.scrollToWord(t)}))}scrollToWord(e){const s=this.control.options||[];let i=-1;for(let t=0;t<s.length;t++){if(0===s[t].name.toLowerCase().indexOf(e.toLowerCase())){i=t;break}}if(-1!==i){const{node:e}=t.getContext(this),s=e.querySelector(".dropdown"),n=e.querySelector(".nav--dropdown").children[i];n&&s.scrollTo(0,n.offsetTop)}}setOption(t){let e;if(this.isMultiple){const e=this.control.value||[],s=e.indexOf(t.id);-1!==s?e.splice(s,1):e.push(t.id),e=e.length?e.slice():null}else e=t.id;this.control.value=e,this.change.next(e)}hasOption(t){if(this.isMultiple){return-1!==(this.control.value||[]).indexOf(t.id)}return this.control.value===t.id}getLabel(){let t=this.control.value;const e=this.control.options||[];if(this.isMultiple)return t=t||[],t.length?t.map((t=>{const s=e.find((e=>e.id===t||e.name===t));return s?s.name:""})).join(", "):"select";{const s=e.find((e=>e.id===t||e.name===t));return s?s.name:"select"}}onDropped(t){this.dropped&&null===t&&(this.control.touched=!0),this.dropped=t===this.dropdownId}get isMultiple(){return this.multiple&&!1!==this.multiple&&"false"!==this.multiple}}hl.meta={selector:"[control-custom-select]",outputs:["change"],inputs:["control","label","multiple"],template:'\n\t\t<div class="group--form--select" [class]="{ required: control.validators.length, multiple: isMultiple }" [dropdown]="dropdownId" (dropped)="onDropped($event)">\n\t\t\t<label [innerHTML]="label"></label>\n\t\t\t<span class="control--custom-select" [innerHTML]="getLabel() | label"></span>\n\t\t\t<svg class="icon--caret-down"><use xlink:href="#caret-down"></use></svg>\n\t\t\t<span class="required__badge" [innerHTML]="\'required\' | label"></span>\n\t\t</div>\n\t\t<errors-component [control]="control"></errors-component>\n\t\t<div class="dropdown" [dropdown-item]="dropdownId">\n\t\t\t<div class="category" [innerHTML]="label"></div>\n\t\t\t<ul class="nav--dropdown" [class]="{ multiple: isMultiple }">\n\t\t\t\t<li (click)="setOption(item)" [class]="{ empty: item.id == null }" *for="let item of control.options">\n\t\t\t\t\t<span [class]="{ active: hasOption(item) }" [innerHTML]="item.name | label"></span>\n\t\t\t\t</li>\n\t\t\t</ul>\n\t\t</div>\n\t'};class ul extends Rr{onInit(){this.label=this.label||"label",this.disabled=this.disabled||!1;const{node:t}=getContext(this),e=this.input=t.querySelector("input");merge(fromEvent(e,"input")).pipe(takeUntil(this.unsubscribe$)).subscribe((t=>this.onInputDidChange(t))),fromEvent(e,"blur").pipe(takeUntil(this.unsubscribe$)).subscribe((t=>this.onInputDidBlur(t)))}onInputDidChange(t){}onInputDidBlur(t){this.control.touched=!0,this.value=this.input.value}}ul.meta={selector:"[control-link]",inputs:["control","label","disabled"],template:'\n\t\t<div class="group--form" [class]="{ required: control.validators.length, disabled: disabled }">\n\t\t\t<label [innerHTML]="label"></label>\n\t\t\t<input type="text" class="control--text" [formControl]="control" [placeholder]="label" [disabled]="disabled" />\n\t\t\t<span class="required__badge" [innerHTML]="\'required\' | label"></span>\n\t\t</div>\n\t\t<errors-component [control]="control"></errors-component>\n\t'};class pl extends Rr{get localizedValue(){let t=this.control.value;if(t&&t.locale){const e=t.locale[this.currentLanguage];e&&(t=e)}return t}onInit(){this.label=this.label||"label",this.disabled=this.disabled||!1,this.accept=this.accept||"image/png, image/jpeg",this.languages=U.languages,this.currentLanguage=be.lang;const{node:e}=t.getContext(this),n=e.querySelector("input");n.setAttribute("accept",this.accept),Ir.drop$(n).pipe(i.takeUntil(this.unsubscribe$)).subscribe(),Ir.change$(n).pipe(i.switchMap((t=>{const e=t.map(((t,e)=>Ka.upload$([t]).pipe(i.switchMap((t=>(this.languages.length>1?Ka.createOrUpdateLocalizedAsset$:Ka.createOrUpdateAsset$)(t,this.control,this.currentLanguage))))));return s.combineLatest(e)})),i.takeUntil(this.unsubscribe$)).subscribe((t=>{this.control.value=t[0]}))}setLanguage(t){be.setLanguage$(t).pipe(i.first()).subscribe((e=>{this.currentLanguage=t,this.pushChanges()}))}}pl.meta={selector:"[control-localized-asset]",inputs:["control","label","disabled","accept"],template:'\n\t\t<div class="group--form" [class]="{ required: control.validators.length, disabled: disabled }">\n\t\t\t<div class="control--head">\n\t\t\t\t<label [innerHTML]="label"></label>\n\t\t\t\t<span class="required__badge" [innerHTML]="\'required\' | label"></span>\n\t\t\t</div>\n\t\t\t<div class="group--picture">\n\t\t\t\t<div class="group--picture__info">\n\t\t\t\t\t<span [innerHTML]="\'browse\' | label"></span>\n\t\t\t\t</div>\n\t\t\t\t<img [lazy]="localizedValue | asset" [size]="{ width: 320, height: 240 }" *if="localizedValue && localizedValue.type.name === \'image\'" />\n\t\t\t\t<video [src]="localizedValue | asset" *if="localizedValue && localizedValue.type.name === \'video\'"></video>\n\t\t\t\t<input type="file">\n\t\t\t</div>\n\t\t\t<div class="file-name" *if="localizedValue" [innerHTML]="localizedValue.file"></div>\n\t\t\t<ul class="nav--languages" *if="languages.length > 1">\n\t\t\t\t<li class="nav__item" [class]="{ active: lang == currentLanguage }" (click)="setLanguage(lang)" [innerHTML]="lang" *for="let lang of languages"></li>\n\t\t\t</ul>\n\t\t</div>\n\t\t<errors-component [control]="control"></errors-component>\n\t'};class ml extends $r{onInit(){this.label=this.label||"label",this.disabled=this.disabled||!1,this.accept=this.accept||".glb";const{node:e}=t.getContext(this),n=this.input=e.querySelector("input");n.setAttribute("accept",this.accept),Ir.change$(n).pipe(i.switchMap((t=>{const e=t.map(((t,e)=>Ka.upload$([t]).pipe(i.switchMap((t=>Ka.createOrUpdateAsset$(t,this.control))))));return s.combineLatest(e)})),i.takeUntil(this.unsubscribe$)).subscribe((t=>{this.control.value=t[0]}))}onRemove(t){Ka.assetDelete$(this.control.value).pipe(i.first()).subscribe((()=>{this.control.value=null,this.input.value=null,this.control.touched=!0}))}read$(t,e){return s.of(t)}}ml.meta={selector:"[control-model]",inputs:["control","label","disabled","accept"],template:'\n\t\t<div class="group--form" [class]="{ required: control.validators.length, disabled: disabled }">\n\t\t\t<div class="control--head">\n\t\t\t\t<label [innerHTML]="label"></label>\n\t\t\t\t<span class="required__badge" [innerHTML]="\'required\' | label"></span>\n\t\t\t</div>\n\t\t\t<div class="group--model">\n\t\t\t\t<div class="file-name" *if="!control.value" [innerHTML]="\'select_file\' | label"></div>\n\t\t\t\t<div class="file-name" *if="control.value" [innerHTML]="control.value.file"></div>\n\t\t\t\t<div class="btn--upload"><input type="file"><span [innerHTML]="\'browse\' | label"></span></div>\n\t\t\t\t<div class="btn--remove" *if="control.value" (click)="onRemove($event)"><span [innerHTML]="\'remove\' | label"></span></div>\n\t\t\t</div>\n\t\t</div>\n\t\t<errors-component [control]="control"></errors-component>\n\t'};class vl extends Rr{onInit(){this.label=this.label||"label",this.precision=this.precision||3,this.increment=this.increment||1/Math.pow(10,this.precision),this.disabled=this.disabled||!1}updateValue(t){this.control.value=t}}vl.meta={selector:"[control-number]",inputs:["control","label","precision","increment","disabled"],template:'\n\t\t<div class="group--form" [class]="{ required: control.validators.length }">\n\t\t\t<div class="control--head">\n\t\t\t\t<label [innerHTML]="label"></label>\n\t\t\t\t<span class="required__badge" [innerHTML]="\'required\' | label"></span>\n\t\t\t</div>\n\t\t\t<div class="control--content control--number">\n\t\t\t\t<input-value label="" [precision]="precision" [increment]="increment" [disabled]="disabled" [value]="control.value" (update)="updateValue($event)"></input-value>\n\t\t\t</div>\n\t\t</div>\n\t\t<errors-component [control]="control"></errors-component>\n\t'};class gl extends Rr{onInit(){this.label=this.label||"label"}}gl.meta={selector:"[control-password]",inputs:["control","label"],template:'\n\t\t<div class="group--form" [class]="{ required: control.validators.length }">\n\t\t\t<label [innerHTML]="label"></label>\n\t\t\t<input type="password" class="control--text" [formControl]="control" [placeholder]="label" />\n\t\t\t<span class="required__badge" [innerHTML]="\'required\' | label"></span>\n\t\t</div>\n\t\t<errors-component [control]="control"></errors-component>\n\t'};class fl extends Rr{onInit(){this.label=this.label||"label"}}fl.meta={selector:"[control-select]",inputs:["control","label"],template:'\n\t\t<div class="group--form--select" [class]="{ required: control.validators.length }">\n\t\t\t<label [innerHTML]="label"></label>\n\t\t\t<select class="control--select" [formControl]="control" required>\n\t\t\t\t<option [value]="null" [innerHTML]="\'select\' | label"></option>\n\t\t\t\t<option [value]="item.id" *for="let item of control.options" [innerHTML]="item.name"></option>\n\t\t\t</select>\n\t\t\t<span class="required__badge" [innerHTML]="\'required\' | label"></span>\n\t\t\t<svg class="icon--caret-down"><use xlink:href="#caret-down"></use></svg>\n\t\t</div>\n\t\t<errors-component [control]="control"></errors-component>\n\t'};class bl extends Rr{onInit(){this.label=this.label||"label",this.disabled=this.disabled||!1}}bl.meta={selector:"[control-text]",inputs:["control","label","disabled"],template:'\n\t\t<div class="group--form" [class]="{ required: control.validators.length, disabled: disabled }">\n\t\t\t<label [innerHTML]="label"></label>\n\t\t\t<span class="required__badge" [innerHTML]="\'required\' | label"></span>\n\t\t\t<input type="text" class="control--text" [formControl]="control" [placeholder]="label" [disabled]="disabled" />\n\t\t</div>\n\t\t<errors-component [control]="control"></errors-component>\n\t'};class wl extends Rr{onInit(){this.label=this.label||"label",this.disabled=this.disabled||!1}}wl.meta={selector:"[control-textarea]",inputs:["control","label","disabled"],template:'\n\t\t<div class="group--form--textarea" [class]="{ required: control.validators.length, disabled: disabled }">\n\t\t\t<label [innerHTML]="label"></label>\n\t\t\t<textarea class="control--text" [formControl]="control" [placeholder]="label" [innerHTML]="label" rows="4" [disabled]="disabled"></textarea>\n\t\t\t<span class="required__badge" [innerHTML]="\'required\' | label"></span>\n\t\t</div>\n\t\t<errors-component [control]="control"></errors-component>\n\t'};class yl extends Rr{onInit(){this.label=this.label||"label",this.precision=this.precision||3,this.increment=this.increment||1/Math.pow(10,this.precision),this.disabled=this.disabled||!1}updateValue(t,e){const s=this.control.value;s[t]=e,this.control.value=s.slice()}}yl.meta={selector:"[control-vector]",inputs:["control","label","precision","increment","disabled"],template:'\n\t\t<div class="group--form" [class]="{ required: control.validators.length }">\n\t\t\t<div class="control--head">\n\t\t\t\t<label [innerHTML]="label"></label>\n\t\t\t\t<span class="required__badge" [innerHTML]="\'required\' | label"></span>\n\t\t\t</div>\n\t\t\t<div class="control--content control--vector">\n\t\t\t\t<input-value label="x" [precision]="precision" [increment]="increment" [disabled]="disabled" [value]="control.value[0]" (update)="updateValue(0, $event)"></input-value>\n\t\t\t\t<input-value label="y" [precision]="precision" [increment]="increment" [disabled]="disabled" [value]="control.value[1]" (update)="updateValue(1, $event)"></input-value>\n\t\t\t\t<input-value label="z" [precision]="precision" [increment]="increment" [disabled]="disabled" [value]="control.value[2]" (update)="updateValue(2, $event)"></input-value>\n\t\t\t</div>\n\t\t</div>\n\t\t<errors-component [control]="control"></errors-component>\n\t'};class xl extends t.Directive{onChanges(){const{node:e}=t.getContext(this);!0===this.disabled?(e.disabled=this.disabled,e.setAttribute("disabled",this.disabled)):(delete e.disabled,e.removeAttribute("disabled"))}}xl.meta={selector:"input[disabled],textarea[disabled]",inputs:["disabled"]};class Cl extends Rr{getLabel(t,e){return ge.transform(`error_${t}`)}}Cl.meta={selector:"errors-component",inputs:["control"],template:'\n\t<div class="inner" [style]="{ display: control.invalid && control.touched ? \'block\' : \'none\' }">\n\t\t<div class="error" *for="let [key, value] of control.errors">\n\t\t\t<span [innerHTML]="getLabel(key, value)"></span>\n\t\t\t\x3c!-- <span class="key" [innerHTML]="key"></span> <span class="value" [innerHTML]="value | json"></span> --\x3e\n\t\t</div>\n\t</div>\n\t'};class Ml extends t.Component{onInit(){this.label=this.label||"label",this.value=this.value||0,this.precision=this.precision||3,this.increment=this.increment||1/Math.pow(10,this.precision),this.disabled=this.disabled||!1,this.increment$(".btn--more",1).pipe(i.takeUntil(this.unsubscribe$)).subscribe((t=>{this.value+=t,this.update.next(this.value),this.pushChanges()})),this.increment$(".btn--less",-1).pipe(i.takeUntil(this.unsubscribe$)).subscribe((t=>{this.value+=t,this.update.next(this.value),this.pushChanges()}));const{node:e}=t.getContext(this),n=this.input=e.querySelector("input");s.merge(s.fromEvent(n,"input")).pipe(i.takeUntil(this.unsubscribe$)).subscribe((t=>this.onInputDidChange(t))),s.merge(s.fromEvent(n,"blur"),s.fromEvent(n,"keydown").pipe(i.filter((t=>"Enter"===t.key||13===t.keyCode)))).pipe(i.takeUntil(this.unsubscribe$)).subscribe((t=>this.onInputDidBlur(t)))}onInputDidChange(t){t.target.value=t.target.value.replace(/[^\d|\.|-]/g,"")}onInputDidBlur(t){const e=parseFloat(this.input.value);this.value!==e&&(NaN!==e?(this.value=e,this.update.next(this.value)):this.input.value=this.getValue())}increment$(e,n){const{node:o}=t.getContext(this),a=o.querySelector(e);let r,l;return s.race(s.fromEvent(a,"mousedown"),s.fromEvent(a,"touchstart")).pipe(i.tap((()=>{l=this.increment,r=16})),i.switchMap((t=>s.interval(30).pipe(i.filter((t=>t%r==0)),i.map((()=>{const t=l*n;return r=Math.max(1,Math.floor(.85*r)),t})),i.takeUntil(s.race(s.fromEvent(a,"mouseup"),s.fromEvent(a,"touchend")))))))}getValue(){return this.value.toFixed(this.precision)}setValue(t){this.value+=this.increment*t,this.update.next(this.value),this.pushChanges()}}Ml.meta={selector:"input-value",outputs:["update"],inputs:["value","label","precision","increment","disabled"],template:'\n\t\t<div class="group--control" [class]="{ disabled: disabled }">\n\t\t\t<input type="text" class="control--text" [placeholder]="label" [value]="getValue()" [disabled]="disabled" />\n\t\t\t<div class="control--trigger">\n\t\t\t\t<div class="btn--more" (click)="setValue(1)">+</div>\n\t\t\t\t<div class="btn--less" (click)="setValue(-1)">-</div>\n\t\t\t</div>\n\t\t</div>\n\t'};class kl extends t.Component{onInit(){this.env=A}onTest(t){this.test.next(t)}onReset(t){this.reset.next(t)}}kl.meta={selector:"test-component",inputs:["form"],outputs:["test","reset"],template:'\n\t<div class="group--form--results" *if="env.DEVELOPMENT">\n\t\t<code [innerHTML]="form.value | json"></code>\n\t\t<button type="button" class="btn--mode" (click)="onReset($event)"><span>reset</span></button>\n\t\t<button type="button" class="btn--mode" (click)="onTest($event)"><span>test</span></button>\n\t</div>\n\t'};class Sl extends t.Directive{onChanges(e){const{node:s}=t.getContext(this);s.value=this.value,s.setAttribute("value",this.value)}}Sl.meta={selector:"[value]",inputs:["value"]};class Tl extends t.Pipe{static transform(t){if(t){t=t.replace(/&#(\d+);/g,(function(t,e){return String.fromCharCode(parseInt(e))}));const e=['"',"&","'","<",">"," ","¡","¢","£","¤","¥","¦","§","¨","©","ª","«","¬","­","®","¯","°","±","²","³","´","µ","¶","·","¸","¹","º","»","¼","½","¾","¿","À","Á","Â","Ã","Ä","Å","Æ","Ç","È","É","Ê","Ë","Ì","Í","Î","Ï","Ð","Ñ","Ò","Ó","Ô","Õ","Ö","×","Ø","Ù","Ú","Û","Ü","Ý","Þ","ß","à","á","ã","ä","å","æ","ç","è","é","ê","ë","ì","í","î","ï","ð","ñ","ò","ó","ô","õ","ö","÷","ø","ù","ú","û","ü","ý","þ","ÿ","&","•","°","∞","‰","⋅","±","†","—","¬","µ","⊥","∥","€","£","¥","¢","©","®","™","α","β","γ","δ","ε","ζ","η","θ","ι","κ","λ","μ","ν","ξ","ο","π","ρ","σ","τ","υ","φ","χ","ψ","ω","Α","Β","Γ","Δ","Ε","Ζ","Η","Θ","Ι","Κ","Λ","Μ","Ν","Ξ","Ο","Π","Ρ","Σ","Τ","Υ","Φ","Χ","Ψ","Ω"],s=new RegExp(`(&${["quot","amp","apos","lt","gt","nbsp","iexcl","cent","pound","curren","yen","brvbar","sect","uml","copy","ordf","laquo","not","shy","reg","macr","deg","plusmn","sup2","sup3","acute","micro","para","middot","cedil","sup1","ordm","raquo","frac14","frac12","frac34","iquest","Agrave","Aacute","Acirc","Atilde","Auml","Aring","AElig","Ccedil","Egrave","Eacute","Ecirc","Euml","Igrave","Iacute","Icirc","Iuml","ETH","Ntilde","Ograve","Oacute","Ocirc","Otilde","Ouml","times","Oslash","Ugrave","Uacute","Ucirc","Uuml","Yacute","THORN","szlig","agrave","aacute","atilde","auml","aring","aelig","ccedil","egrave","eacute","ecirc","euml","igrave","iacute","icirc","iuml","eth","ntilde","ograve","oacute","ocirc","otilde","ouml","divide","oslash","ugrave","uacute","ucirc","uuml","yacute","thorn","yuml","amp","bull","deg","infin","permil","sdot","plusmn","dagger","mdash","not","micro","perp","par","euro","pound","yen","cent","copy","reg","trade","alpha","beta","gamma","delta","epsilon","zeta","eta","theta","iota","kappa","lambda","mu","nu","xi","omicron","pi","rho","sigma","tau","upsilon","phi","chi","psi","omega","Alpha","Beta","Gamma","Delta","Epsilon","Zeta","Eta","Theta","Iota","Kappa","Lambda","Mu","Nu","Xi","Omicron","Pi","Rho","Sigma","Tau","Upsilon","Phi","Chi","Psi","Omega"].join(";)|(&")};)`,"g");return t=t.replace(s,(function(){for(let t=1;t<arguments.length;t++)if(arguments[t])return e[t-1]})),t}}}Tl.meta={name:"html"};class El extends t.Directive{onChanges(){const{node:e}=t.getContext(this);e.setAttribute("id",this.id)}}El.meta={selector:"[id]",inputs:["id"]};class Ll extends t.Component{onInit(){this.showLanguages=!1,this.languageService=be}setLanguage(t){this.languageService.setLanguage$(t).pipe(i.first()).subscribe((t=>{this.showLanguages=!1,this.pushChanges(),this.set.next()}))}toggleLanguages(){this.showLanguages=!this.showLanguages,this.pushChanges()}}Ll.meta={selector:"[language]",outputs:["set"],template:'\n\t\t<button type="button" class="btn--language" (click)="toggleLanguages()" *if="languageService.hasLanguages"><span [innerHTML]="languageService.activeLanguage.title"></span> <svg viewBox="0 0 8 5"><use xlink:href="#caret-down"></use></svg></button>\n\t\t<ul class="nav--language" *if="showLanguages">\n\t\t\t<li (click)="setLanguage(language)" *for="let language of languageService.languages"><span [innerHTML]="language.title"></span></li>\n\t\t</ul>\n\t'};class _l{static get cache(){return this.cache_||(this.cache_={}),this.cache_}static get(t){return this.cache[t]}static set(t,e){this.cache[t]=e;const s=Object.keys(this.cache);s.length>100&&this.remove(s[0])}static remove(t){delete this.cache[t]}}class Il extends t.Directive{onInit(){const{node:e}=t.getContext(this);e.classList.add("lazy"),this.input$=(new s.Subject).pipe(i.distinctUntilChanged(),i.switchMap((t=>{const i=_l.get(t);return i?s.of(i):(e.classList.remove("lazyed"),this.lazy$(t))})),i.takeUntil(this.unsubscribe$)),this.input$.subscribe((t=>{_l.set(this.lazy,t),e.setAttribute("src",t),e.classList.add("lazyed")}))}onChanges(){this.input$.next(this.lazy)}lazy$(e){const{node:n}=t.getContext(this);return class{static observer(){return this.observer_||(this.readySubject_=new s.BehaviorSubject(!1),this.observerSubject_=new s.Subject,this.observer_=new IntersectionObserver((t=>{this.observerSubject_.next(t)}))),this.observer_}static intersection$(t){if("IntersectionObserver"in window){const e=this.observer();return e.observe(t),this.observerSubject_.pipe(i.map((e=>e.find((e=>e.target===t)))),i.filter((t=>void 0!==t&&t.isIntersecting)),i.first(),i.finalize((()=>e.unobserve(t))))}return s.of({target:t})}}.intersection$(n).pipe(i.switchMap((()=>no.load$(e,this.size))),i.first())}}Il.meta={selector:"[lazy],[[lazy]]",inputs:["lazy","size"]};class Rl extends t.Pipe{static transform(t){let e=Rl.urlify(t);return e=Rl.breakLines(e),e}static urlify(t){return t.replace(/(?:(?:https?|ftp):\/\/|\b(?:[a-z\d]+\.))(?:(?:[^\s()<>]+|\((?:[^\s()<>]+|(?:\([^\s()<>]+\)))?\))+(?:\((?:[^\s()<>]+|(?:\(?:[^\s()<>]+\)))?\)|[^\s`!()\[\]{};:'".,<>?«»“”‘’]))?/gim,(t=>`<a href="${t}" target="_blank">${t}</a>`))}static breakLines(t){return t.replace(/\n/gm,(t=>"<br>"))}}Rl.meta={name:"message"};class $l extends t.Component{onInit(){const{parentInstance:e}=t.getContext(this);e instanceof qi&&(this.data=e.modal.data)}onClose(){ei.reject()}}$l.meta={selector:"[modal]"};class Al extends t.Directive{constructor(){super(...arguments),this.path=void 0,this.segments=void 0,this.routerLink_=void 0}get routerLink(){return this.routerLink_}set routerLink(t){this.routerLink_=Array.isArray(t)?t:[t]}onInit(){this.routerLink$().pipe(i.takeUntil(this.unsubscribe$)).subscribe()}onChanges(){const{node:e}=t.getContext(this),s=this.routerLink;if(s.length){const t=ee.buildUrl(...s);e.setAttribute("href",t)}else e.setAttribute("href","")}routerLink$(){const{node:e}=t.getContext(this);return s.fromEvent(e,"click").pipe(i.map((t=>(ee.setRouterLink(...this.routerLink),t.preventDefault(),!1))))}getSegments(t){const e=[];return t.forEach((t=>{if("string"==typeof t){const e=/([^:]+)|\:([^\/]+)/g,s=t.matchAll(e);for(let t of s){const e=t[1],s=t[2];if(e);else if(s){({})[s]=null}}}else e.push(new RouteSegment("",{}))})),e}}Al.meta={selector:"[routerLink]",inputs:["routerLink"]};class Pl extends t.Component{onInit(){super.onInit();const{parentInstance:e}=t.getContext(this);e instanceof qi&&(this.data=e.modal.data)}onAccept(t){ei.resolve()}onReject(t){ei.reject()}onClose(){ei.reject()}}Pl.meta={selector:"[support-request-modal]",template:'\n\t\t<div class="modal__header">\n\t\t\t<button type="button" class="btn--close" (click)="onClose()">\n\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#close"></use></svg>\n\t\t\t</button>\n\t\t</div>\n\t\t<div class="container">\n\t\t\t<div class="form">\n\t\t\t\t<div class="title">Un operatore è disponibile per un tour guidato.<br>Desideri Accettare?</div>\n\t\t\t\t<div class="group--cta">\n\t\t\t\t\t<button type="button" class="btn--accept" (click)="onAccept()">\n\t\t\t\t\t\t<span>Accetta</span>\n\t\t\t\t\t</button>\n\t\t\t\t\t<button type="button" class="btn--cancel" (click)="onReject()">\n\t\t\t\t\t\t<span>Rifiuta</span>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t'},Pl.chunk=()=>'<div class="support-request-modal" support-request-modal></div>';class Hl extends t.Structure{onInit(){this.update()}onChanges(){this.update()}update(){if(this.name_!==this.name){this.name_=this.name;const{node:e}=t.getContext(this);if(e.parentNode){const t="http://www.w3.org/2000/svg",s=document.createElementNS(t,"svg"),i=this.width||24,n=this.height||24;s.setAttribute("class",`icon--${this.name}`),s.setAttributeNS(null,"viewBox",`0 0 ${i} ${n}`),s.innerHTML=`<use xlink:href="#${this.name}"></use>`,s.rxcompId=e.rxcompId,s.classList.add(...e.classList),e.parentNode.replaceChild(s,e)}}}}Hl.meta={selector:"svg-icon",inputs:["name","width","height"]};class Ol extends t.Directive{set title(e){if(this.title_!==e){this.title_=e;const{node:s}=t.getContext(this);e?s.setAttribute("title",e):s.removeAttribute("title")}}get title(){return this.title_}}Ol.meta={selector:"[[title]]",inputs:["title"]};class Ul extends t.Component{onInit(){null===this.item.preview&&this.read$(this.item.file).pipe(i.takeUntil(this.unsubscribe$)).subscribe((t=>{this.item.preview=t,this.pushChanges()}))}read$(t){const e=new FileReader,n=s.fromEvent(e,"load").pipe(i.switchMap((t=>{const e=t.target.result;return this.item.type.name===Yi.Image.name?this.resize$(e):s.of(e)})));return e.readAsDataURL(t),n}resize$(t){return new Promise(((e,s)=>{const i=document.createElement("img");i.onload=function(){const t=document.createElement("canvas"),s=t.getContext("2d");let n=i.width,o=i.height;n>o?n>320&&(o*=320/n,n=320):o>240&&(n*=240/o,o=240),t.width=n,t.height=o,s.drawImage(i,0,0,n,o);const a=t.toDataURL("image/jpeg",.9);e(a)},i.onerror=function(t){s(t)},i.src=t}))}onPause(){this.pause.next(this.item)}onResume(){this.resume.next(this.item)}onCancel(){this.cancel.next(this.item)}onRemove(){this.remove.next(this.item)}}Ul.meta={selector:"[upload-item]",outputs:["pause","resume","cancel","remove"],inputs:["item"],template:'\n\t<div class="upload-item" [class]="{ \'error\': item.error, \'success\': item.success }">\n\t\t<div class="picture">\n\t\t\t<img [lazy]="item.preview" [size]="{ width: 320, height: 240 }" *if="item.preview && item.type.name === \'image\'" />\n\t\t\t<video [src]="item.preview" *if="item.preview && item.type.name === \'video\'"></video>\n\t\t\t<svg class="spinner" width="24" height="24" viewBox="0 0 24 24" [class]="{ uploading: item.uploading }" *if="item.uploading"><use xlink:href="#spinner"></use></svg>\n\t\t</div>\n\t\t<div class="name">{{item.name}}</div>\n\t\t\x3c!--\n\t\t<div class="group--info">\n\t\t\t<div>progress: {{item.progress}}</div>\n\t\t\t<div>size: {{item.size}} bytes</div>\n\t\t\t<div>current speed: {{item.currentSpeed}} bytes/s</div>\n\t\t\t<div>average speed: {{item.averageSpeed}} bytes/s</div>\n\t\t\t<div>time ramining: {{item.timeRemaining}}s</div>\n\t\t\t<div>paused: {{item.paused}}</div>\n\t\t\t<div>success: {{item.success}}</div>\n\t\t\t<div>complete: {{item.complete}}</div>\n\t\t\t<div>error: {{item.error}}</div>\n\t\t</div>\n\t\t--\x3e\n\t\t\x3c!--\n\t\t<div class="group--cta" *if="!item.complete && item.uploading">\n\t\t\t<div class="btn--pause" (click)="onPause()">pause</div>\n\t\t\t<div class="btn--resume" (click)="onResume()">resume</div>\n\t\t\t<div class="btn--cancel" (click)="onCancel()">cancel</div>\n\t\t</div>\n\t\t--\x3e\n\t\t<div class="group--cta">\n\t\t\t<div class="btn--remove" (click)="onRemove()" *if="!item.complete">remove</div>\n\t\t</div>\n\t</div>\n\t'};class Bl extends t.Directive{set hls(t){this.hls_!==t&&(this.hls_=t,this.play(t))}get hls(){return this.hls_}play(e){const{node:s}=t.getContext(this);if(Hls.isSupported()){var i=new Hls;i.attachMedia(s),i.on(Hls.Events.MEDIA_ATTACHED,(()=>{i.loadSource(e),i.on(Hls.Events.MANIFEST_PARSED,((t,e)=>{s.play()}))}))}}}Bl.meta={selector:"[[hls]]",inputs:["hls"]};class Dl extends t.Context{constructor(t,e,s,i,n,o,a){super(a),this[t]=e,this[s]=i,this.index=n,this.count=o}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}const zl=1,Vl=2,jl=3;class Nl extends t.Structure{onInit(){const{module:e,node:n}=t.getContext(this),o=n.firstElementChild,a=n.getAttribute("*virtual");n.removeAttribute("*virtual"),n.removeChild(o);const r=this.tokens=this.getExpressionTokens(a);this.virtualFunction=e.makeFunction(r.iterable),this.container=n,this.template=o,this.mode=this.mode||1,this.width=this.width||250,this.gutter=void 0!==this.gutter?this.gutter:20,this.reverse=!0===this.reverse,this.options={width:this.width,gutter:this.gutter,reverse:this.reverse,containerWidth:0,containerHeight:0,top:0,cols:[0]},this.cachedRects={},this.cachedInstances=[],this.cacheNodes=[],this.items$=new s.BehaviorSubject([]),this.update$().pipe(i.takeUntil(this.unsubscribe$)).subscribe((t=>{}))}onChanges(e){const s=t.getContext(this),i=s.module.resolve(this.virtualFunction,s.parentInstance,this)||[];this.mode=this.mode||1,this.width=this.width||250,this.gutter=void 0!==this.gutter?this.gutter:20,this.options.width=this.width,this.updateView(!0),this.items$.next(i)}update$(){return this.updateView(!0),s.merge(this.scroll$(),this.resize$(),this.items$.pipe(i.distinctUntilChanged())).pipe(i.map((t=>this.updateForward())))}updateForward(){const t=this.options,e=this.items$.getValue(),s=e.length;this.container.position="relative";let i=0;const n=this.getWidth(),o=this.getGutter(n),a=[];for(let r=0,l=e.length;r<l;r++){const l=e[r];let c,d,h,u,p,m=this.cachedRects[r];if(m?(c=m.col,d=m.height,u=m.left):(c=this.getCol(),d=this.getHeight(n,l)),h=t.cols[c],this.intersect(h+t.top,h+d+t.top,0,t.containerHeight)){m||(u=this.getLeft(c,n,o));const e=this.cachedNode(r,r,l,s);e.style.position="absolute",e.style.top=h+"px",e.style.left=u+"px",e.style.width=n+"px",d!==e.offsetHeight&&(d=e.offsetHeight),p=h+d+t.gutter,i=Math.max(i,p),t.cols[c]=p,m?(m.height=d,m.bottom=p):this.cachedRects[r]={col:c,width:n,height:d,left:u,top:h,bottom:p},a.push(l)}else this.removeNode(r),p=h+d+t.gutter,t.cols[c]=p,i=Math.max(i,p)}let r=e.length;for(;r<this.cacheNodes.length;)this.removeNode(r),r++;this.cacheNodes.length=e.length;const l=this.container.parentNode;if(this.reverse&&i<l.offsetHeight-1){const t=l.offsetHeight-1-i;e.forEach(((e,i)=>{if(-1!==a.indexOf(e)){const n=this.cachedRects[i];this.cachedNode(i,i,e,s).style.top=n.top+t+"px"}})),this.container.style.height=l.offsetHeight-1+"px"}else this.container.style.height=`${i}px`;return a}getCols(){const t=this.options,e=Math.floor((t.containerWidth+t.gutter)/(t.width+t.gutter))||1;return new Array(e).fill(0)}getCol(){const t=this.options;let e;switch(this.mode){case Vl:case jl:case zl:e=t.cols.reduce(((t,e,s,i)=>e<i[t]?s:t),0);break;default:e=0}return e}getWidth(){const t=this.options;let e;switch(this.mode){case Vl:case jl:e=t.width;break;case zl:e=(t.containerWidth-(t.cols.length-1)*t.gutter)/t.cols.length;break;default:e=t.containerWidth}return e}getHeight(t,e){const s=this.options;let i;switch(this.mode){case Vl:case jl:case zl:i=s.width;break;default:i=80}return i}getGutter(t){const e=this.options;let s;switch(this.mode){case Vl:case jl:s=e.gutter;break;case zl:s=(e.containerWidth-e.cols.length*t)/(e.cols.length-1);break;default:s=0}return s}getLeft(t,e,s){const i=this.options;let n;switch(this.mode){case Vl:case zl:n=t*(e+s);break;case jl:n=(i.containerWidth-i.cols.length*(e+s)+s)/2+t*(e+s);break;default:n=0}return n}cachedNode(t,e,s,i){return this.cacheNodes[t]?this.updateNode(t,e,s):this.createNode(t,e,s,i)}createNode(e,s,i,n){const o=this.template.cloneNode(!0);delete o.rxcompId,this.container.appendChild(o),this.cacheNodes[e]=o;const a=t.getContext(this),r=a.module,l=this.tokens,c=[l.key,s,l.value,i,s,n,a.parentInstance],d=r.makeInstance(o,Dl,a.selector,a.parentInstance,c),h=t.getContext(d);return r.compile(o,h.instance),this.cachedInstances[e]=d,o}updateNode(t,e,s){const i=this.cachedInstances[t],n=this.tokens;return i[n.key]!==e&&(i[n.key]=e,i[n.value]=s,i.pushChanges()),this.cacheNodes[t]}removeNode(e){this.cachedInstances[e]=void 0;const s=this.cacheNodes[e];if(s){const e=t.getContext(this).module;s.parentNode.removeChild(s),e.remove(s)}return this.cacheNodes[e]=void 0,s}intersect(t,e,s,i){return s<e&&i>t}resize$(){return s.fromEvent(window,"resize").pipe(i.startWith((t=>null)),i.auditTime(100),i.tap((()=>this.updateView(!0))))}scroll$(){const{node:e}=t.getContext(this);return e.parentNode&&"auto"===getComputedStyle(e.parentNode).overflowY?s.fromEvent(e.parentNode,"scroll").pipe(i.tap((()=>{this.updateView()}))):s.fromEvent(window,"scroll").pipe(i.tap((()=>this.updateView())))}updateView(t){const e=this.container.getBoundingClientRect(),s=this.options;s.top=e.top,s.containerWidth=e.width,s.containerHeight=this.container.parentNode.offsetHeight,s.cols=this.getCols(),t&&(this.cachedRects={})}getExpressionTokens(t){if(null===t)throw new Error("invalid virtual");if(-1===t.trim().indexOf("let ")||-1===t.trim().indexOf(" of "))throw new Error("invalid virtual");const e=t.split(";").map((t=>t.trim())).filter((t=>""!==t)),s=e[0].split(" of ").map((t=>t.trim()));let i=s[0].replace(/\s*let\s*/,"");const n=s[1];let o="index";const a=i.match(/\[(.+)\s*,\s*(.+)\]/);if(a&&(o=a[1],i=a[2]),e.length>1){const t=e[1].split(/\s*let\s*|\s*=\s*index/).map((t=>t.trim()));3===t.length&&(o=t[1])}return{key:o,value:i,iterable:n}}}Nl.meta={selector:"[*virtual]",inputs:["mode","width","gutter","reverse"]};class Fl extends t.Component{onInit(){this.playing=!1,this.progress=0,this.media$().pipe(i.takeUntil(this.unsubscribe$)).subscribe(),this.drag$().pipe(i.takeUntil(this.unsubscribe$)).subscribe()}media$(){const{node:e}=t.getContext(this),s=document.querySelector(".page");return fn.events$.pipe(i.tap((t=>{t instanceof un?(this.media=t.loader,this.playing=!0,e.classList.add("active"),s.classList.add("media-player-active"),this.pushChanges()):this.media===t.loader&&(t instanceof pn?(this.playing=!1,this.pushChanges()):t instanceof vn?this.dragging||(this.progress=this.media.progress,this.pushChanges()):t instanceof mn&&(this.media=null,e.classList.remove("active"),s.classList.remove("media-player-active"),this.pushChanges()))})))}drag$(){const{node:e}=t.getContext(this),s=e.querySelector(".track");let n;return qn.observe$(s).pipe(i.filter((t=>this.media)),i.tap((t=>{if(t instanceof jn){const e=s.getBoundingClientRect();n=Math.max(0,Math.min(1,(t.down.x-e.left)/e.width)),this.dragging=!0}else if(t instanceof Nn){const e=s.getBoundingClientRect(),i=Math.max(0,Math.min(1,n+t.distance.x/e.width));this.progress=i,this.pushChanges()}else t instanceof Fn&&(this.media.progress=this.progress,this.dragging=!1)})))}onPlay(){this.media.play()}onPause(){this.media.pause()}onTrack(t){const e=t.currentTarget.getBoundingClientRect(),s=(t.screenX-e.left)/e.width;this.media.progress=s}}Fl.meta={selector:"[media-player]"};const Gl=100.99;class ql extends Ba{get title(){return this.title_}set title(t){if(this.title_!==t){const e=null!=this.title_;this.title_=t,e?this.updateBanner():this.createBanner()}}onChanges(){this.title=this.item.title}createBanner(){this.getCanvasTexture().then((t=>{const e=t.texture;e.wrapS=e.wrapY=THREE.RepeatWrapping,e.repeat.x=24,e.encoding=THREE.sRGBEncoding;const s=24*t.width/t.height,i=Math.PI/180*360,n=Gl*i/s,o=new THREE.CylinderBufferGeometry(Gl,Gl,n,80,2,!0,0,i);o.scale(-1,1,1);const a=new THREE.MeshBasicMaterial({map:e,transparent:!0,opacity:0,toneMapped:!1}),r=this.mesh;(this.banners=new Array(1).fill(0).map((t=>new THREE.Mesh(o,a)))).forEach(((t,e)=>{t.rotation.y=Math.PI/2*e}));const l={value:0};gsap.to(l,{duration:.5,value:1,delay:0,ease:Power2.easeInOut,onUpdate:()=>{a.opacity=l.value,a.needsUpdate=!0}}),r.userData={render:()=>{r.rotation.y+=Math.PI/180*.02,a.needsUpdate=!0}}}))}updateBanner(){this.getCanvasTexture().then((t=>{}))}onCreate(t,e){const s=new THREE.Group;"function"==typeof t&&t(s)}getCanvasTexture(){return new Promise(((t,e)=>{let s=512,i=128;const n=Math.floor(102.4),o=Math.floor(9.6);let a;a=this.canvas?this.canvas:this.canvas=document.createElement("canvas"),a.width=s,a.height=i;const r=this.item.title,l=a.getContext("2d");l.imageSmoothingEnabled=!0,l.imageSmoothingQuality="high",l.font=`${n}px ${U.fontFamily}`;let c;s=l.measureText(r).width+8,s=Math.max(512,Math.pow(2,Math.ceil(Math.log(s)/Math.log(2)))),a.width=s,l.clearRect(0,0,s,i),l.fillStyle="#0000005A",l.fillRect(0,0,s,i),l.font=`${n}px ${U.fontFamily}`,l.textAlign="center",l.textBaseline="middle",l.strokeStyle="rgba(0, 0, 0, 0.5)",l.lineWidth=o,l.lineJoin="round",l.miterLimit=2,l.strokeText(r,s/2,64),l.fillStyle="white",l.fillText(r,s/2,64,s),this.texture?(c=this.texture,c.needsUpdate=!0):c=this.texture=new THREE.CanvasTexture(a),t({texture:c,width:s,height:i})}))}}ql.meta={selector:"[model-banner]",hosts:{host:Ua},inputs:["item"]};class Zl extends Da{onInit(){super.onInit()}onChanges(){const t=this.item.selected;this.editing=t,this.mesh&&(this.mesh.editing=t)}onCreate(t,e){const s=this.item,n=this.view;n.items;const o=this.getCurvedPanelGeometry(s);let a,r;this.onMeshDown=this.onMeshDown.bind(this),this.onMeshPlaying=this.onMeshPlaying.bind(this),this.onMeshZoomed=this.onMeshZoomed.bind(this),this.onMeshCurrentTime=this.onMeshCurrentTime.bind(this),Dn.getStreamId$(s).pipe(i.takeUntil(this.unsubscribe$)).subscribe((l=>{this.streamId!==l&&(this.streamId=l,r&&(r.unsubscribe(),r=null),l||!s.asset?(s.streamId=l,a=this.disposableMesh=new Dn(s,n,o,this.host),a.updateFromItem(s),a.name="curved-plane",a.load((()=>{this.disposableMesh=null,"function"==typeof t&&t(a,s),r=a.events$().pipe(i.takeUntil(this.unsubscribe$)).subscribe((()=>{}))})),this.addMeshListeners(a)):this.mesh&&e(this.mesh,s))}))}addMeshListeners(t){t.on("down",this.onMeshDown),t.on("playing",this.onMeshPlaying),t.on("zoomed",this.onMeshZoomed),t.on("currentTime",this.onMeshCurrentTime)}removeMeshListeners(t){t.off("down",this.onMeshDown),t.off("playing",this.onMeshPlaying),t.off("zoomed",this.onMeshZoomed),t.off("currentTime",this.onMeshCurrentTime)}onMeshDown(){this.down.next(this)}onMeshPlaying(t){this.play.next({itemId:this.item.id,playing:t})}onMeshZoomed(t){this.zoom.next({itemId:this.item.id,zoomed:t})}onMeshCurrentTime(t){this.currentTime.next({itemId:this.item.id,currentTime:t})}onDestroy(){super.onDestroy(),this.disposableMesh&&(this.removeMeshListeners(this.disposableMesh),this.disposableMesh.dispose()),this.mesh&&(this.removeMeshListeners(this.mesh),this.mesh.dispose())}onUpdate(t,e){if(t.radius!==this.radius_||t.height!==this.height_||t.arc!==this.arc_){e.geometry.dispose();const s=this.getCurvedPanelGeometry(t);e.geometry=s}e.updateFromItem(t),this.updateHelper()}onUpdateAsset(t,e){e.updateByItem(t),Dn.getStreamId$(t).pipe(i.filter((t=>null!==t)),i.take(1)).subscribe((s=>{t.streamId=s,e.load((()=>{}))}))}onDragMove(t,e,s){const i=this.item,n=this.mesh;i.showPanel=!1,this.editing=!0,n.position.set(t.x,t.y,t.z),s?(t.normalize().multiplyScalar(20),n.lookAt(wn.origin)):(n.position.set(0,0,0),n.lookAt(e),n.position.set(t.x,t.y,t.z),n.position.add(e.multiplyScalar(.01))),this.updateHelper()}onDragEnd(){const t=this.item,e=this.mesh;t.position=e.position.toArray(),t.rotation=e.rotation.toArray(),t.scale=e.scale.toArray(),e.updateFromItem(t),this.editing=!1}getCurvedPanelGeometry(t){this.radius_=t.radius,this.height_=t.height,this.arc_=t.arc;const e=Math.PI/180*t.arc,s=new THREE.CylinderBufferGeometry(t.radius,t.radius,t.height,36,2,!0,0,e);return s.rotateY(-Math.PI-e/2),s.scale(-1,1,1),s}}Zl.textures={},Zl.meta={selector:"[model-curved-plane]",hosts:{host:Ua},outputs:["down","play","zoom","currentTime"],inputs:["item","view"]};class Wl{static getService(){return this.service_||(this.service_=new Wl),this.service_}get message(){return this.message$.getValue()}constructor(){if(Wl.service_)throw"DebugService is a singleton class!";this.message$=new s.BehaviorSubject(null)}setMessage(t){this.message!==t&&this.message$.next(t)}}class Kl extends Ba{static getLoader(){return Kl.loader||(Kl.loader=new THREE.FontLoader)}static getFontLoader(t){return Kl.fontLoader||(Kl.fontLoader=Kl.getLoader().load(U.getPath("fonts/helvetiker/helvetiker_regular.typeface.json"),t))}get message(){return this.message_}set message(t){t=t&&""!==t?t:null,this.message_!==t&&(this.message_=t,this.setText(t))}onInit(){super.onInit();(this.vrService=xo.getService()).session$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((t=>{t?this.text&&this.textGroup.add(this.text):this.text&&this.text.parent.remove(this.text)}));(this.debugService=Wl.getService()).message$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((t=>this.message=t))}createText(){const t=document.createElement("canvas");t.width=Kl.W,t.height=Kl.H;const e=new THREE.CanvasTexture(t);e.encoding=THREE.sRGBEncoding,e.minFilter=THREE.LinearFilter,e.magFilter=THREE.LinearFilter,e.mapping=THREE.UVMapping,e.needsUpdate=!0;const s=new THREE.PlaneBufferGeometry(4,1,2,2),i=new THREE.MeshBasicMaterial({depthTest:!1,depthWrite:!1,map:e,color:16777215,transparent:!0,opacity:1,toneMapped:!1}),n=new THREE.Mesh(s,i);return n.renderOrder=U.renderOrder.debug,n.position.y=0,n}loadFont(){this.fontLoader=Kl.getFontLoader((t=>{this.font=t,this.message_&&this.setText(this.message_)}))}onCreate(t,e){const s=this.textGroup=new THREE.Group;this.material=new THREE.MeshBasicMaterial({depthTest:!1,color:16777215,transparent:!0,opacity:1,side:THREE.DoubleSide}),this.text=this.createText(),"function"==typeof t&&t(s)}render(t,e){const s=this.group;let i=this.host.camera;const n=this.position;this.host.renderer.xr.isPresenting&&(i=this.host.renderer.xr.getCamera(i)),i.getWorldDirection(n),n.multiplyScalar(3),s.position.copy(n),s.lookAt(wn.origin)}setText(t){const e=this.text;if(e)if(this.host.renderer.xr.isPresenting&&null!=t){const s=e.material.map.image.getContext("2d");s.clearRect(0,0,Kl.W,Kl.H),s.font=`30px ${U.fontFamily}`,s.textBaseline="middle",s.textAlign="center",s.fillStyle="#FFFFFF",s.strokeStyle="#000000",s.lineWidth=5,s.fillText(t,Kl.W/2,Kl.H/2,Kl.W-20),e.material.map.needsUpdate=!0,this.textGroup.add(e)}else e.parent&&e.parent.remove(e)}}Kl.W=1024,Kl.H=256,Kl.meta={selector:"[model-debug]",hosts:{host:Ua}};class Xl extends Ba{static getLoader(){return Xl.loader||(Xl.loader=new THREE.TextureLoader)}static getTexture(){return Xl.texture||(Xl.texture=Xl.getLoader().load(U.getPath("textures/ui/floor-nav.png")))}static getOverTexture(){return Xl.textureOver||(Xl.textureOver=Xl.getLoader().load(U.getPath("textures/ui/floor-nav-over.png")))}set coords(t){if(!t&&this.coords_!==t||!this.coords_||t.x!==this.coords_.x||t.y!==this.coords_.y){const e=this.tileMap;if(this.coords_){const t=e[`${this.coords_.x}_${this.coords_.y}`],s=t.uniforms;gsap.to(s,{tween:0,duration:.4,delay:0,ease:Power2.easeInOut,onUpdate:()=>{t.material.uniforms.tween.value=s.tween,t.material.needsUpdate=!0}})}if(t){const s=this.currentTile=e[`${t.x}_${t.y}`],i=s.uniforms;gsap.to(i,{tween:1,duration:.4,delay:0,ease:Power2.easeInOut,onUpdate:()=>{s.material.uniforms.tween.value=i.tween,s.material.needsUpdate=!0}})}this.coords_=t}}set coords__(t){if(!t&&this.coords_!==t||!this.coords_||t.x!==this.coords_.x||t.y!==this.coords_.y){const e=this.tileMap;if(this.coords_){const t=e[`${this.coords_.x}_${this.coords_.y}`],s={tween:1};gsap.to(s,{duration:.4,tween:0,delay:0,ease:Power2.easeInOut,onUpdate:()=>{t.material.opacity=s.tween}})}if(t){const s=this.currentTile=e[`${t.x}_${t.y}`],i={tween:0};gsap.to(i,{duration:.4,tween:1,delay:0,ease:Power2.easeInOut,onUpdate:()=>{s.material.opacity=i.tween}})}this.coords_=t}}getCoords(t){const e=Xl.RADIUS/10,s=Math.ceil((t.x+e/2)/e)-1,i=Math.ceil((t.z+e/2)/e)-1,n=Math.floor(Xl.COLS/2),o=Math.floor(Xl.ROWS/2),a=Math.min(n,Math.abs(s))*(s?Math.abs(s)/s:1),r=Math.min(o,Math.abs(i))*(i?Math.abs(i)/i:1);if(this.view.hasTile(this.indices.x+a,this.indices.y+r))return new THREE.Vector2(a,r)}onInit(){super.onInit(),this.indices=new THREE.Vector2,this.view.index$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((t=>{this.moveToIndex(t)}))}addTiles(t){const e=Xl.RADIUS/10,s=.9*e,i=new THREE.PlaneBufferGeometry(s,s,2,2);i.rotateX(-Math.PI/2);const n=Xl.getTexture();n.disposable=!1,n.encoding=THREE.sRGBEncoding;const o=Xl.getOverTexture();o.disposable=!1,o.encoding=THREE.sRGBEncoding;const a=this.tileMap={};this.tiles=new Array(Xl.COLS*Xl.ROWS).fill(0).map(((s,r)=>{const l=new THREE.ShaderMaterial({depthTest:!1,depthWrite:!1,transparent:!0,toneMapped:!1,vertexShader:"\nvarying vec2 vUv;\nvoid main() {\n\tvUv = uv;\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n",fragmentShader:"\nvarying vec2 vUv;\nuniform sampler2D textureA;\nuniform sampler2D textureB;\nuniform float opacity;\nuniform float tween;\n\nvoid main() {\n\tvec4 colorA = texture2D(textureA, vUv);\n\tvec4 colorB = texture2D(textureB, vUv);\n\tvec4 color = mix(colorA, colorB, tween);\n\tcolor.a = clamp(color.a * opacity, 0.0, 1.0);\n\tcolor.rgb /= color.a;\n\tgl_FragColor = color;\n}\n",uniforms:{textureA:{type:"t",value:n},textureB:{type:"t",value:o},tween:{value:0},opacity:{value:0}},extensions:{fragDepth:!0}}),c=new THREE.Mesh(i,l),d=Math.floor(Xl.COLS/2),h=Math.floor(Xl.ROWS/2),u=Math.floor(r/Xl.COLS),p=-d+r%Xl.COLS,m=-h+u;return c.position.set(p*e,.15*-Xl.RADIUS,m*e),c.name=this.getName(`tile_${p}_${m}`),c.uniforms={tween:0,opacity:0,ci:p,ri:m},a[`${p}_${m}`]=c,t.add(c),c})),this.showTiles()}showTiles(){this.tiles.forEach(((t,e)=>{const s=this.indices?this.indices.x:0,i=this.indices?this.indices.y:0,n=this.view.hasTile(s+t.uniforms.ci,i+t.uniforms.ri),o=t.uniforms;gsap.to(o,{opacity:n?1:0,duration:.4,ease:Power2.easeInOut,onUpdate:()=>{t.material.uniforms.opacity.value=o.opacity,t.material.needsUpdate=!0}})}))}addHitArea(t){this.onGroundOver=this.onGroundOver.bind(this),this.onGroundMove=this.onGroundMove.bind(this),this.onGroundDown=this.onGroundDown.bind(this),this.onGroundOut=this.onGroundOut.bind(this),Xl.RADIUS;const e=new THREE.PlaneBufferGeometry(Xl.RADIUS,Xl.RADIUS,8,8);e.rotateX(-Math.PI/2);const s=new THREE.MeshBasicMaterial({depthTest:!1,depthWrite:!1,transparent:!0,toneMapped:!1,opacity:0}),i=this.ground=new Mn(e,s);i.name=this.getName("ground"),i.position.set(0,.15*-Xl.RADIUS,0),i.on("over",this.onGroundOver),i.on("move",this.onGroundMove),i.on("out",this.onGroundOut),i.on("down",this.onGroundDown),t.add(i)}onGroundOver(){const t=this.ground,e=this.getCoords(t.intersection.point);this.coords=e}onGroundMove(){const t=this.ground,e=this.getCoords(t.intersection.point);this.coords=e}onGroundDown(){const t=this.ground,e=this.getCoords(t.intersection.point);if(this.coords=e,e){const t=this.view.getTileIndex(this.indices.x+e.x,this.indices.y+e.y);this.view.index=t,this.nav.next(t)}}onGroundOut(){this.coords=null}moveToIndex(t){this.coords=null;const e=this.view.tiles[t],s=new THREE.Vector2(e.indices.x-this.indices.x,e.indices.y-this.indices.y);this.indices.x=e.indices.x,this.indices.y=e.indices.y,this.showTiles();const i=Xl.RADIUS/10;this.move.next({indices:this.indices,coords:s,position:s.clone().multiplyScalar(i)})}onCreate(t,e){const s=new THREE.Group;this.addTiles(s),this.addHitArea(s),"function"==typeof t&&t(s)}onDestroy(){super.onDestroy();const t=this.ground;t.off("over",this.onGroundOver),t.off("move",this.onGroundMove),t.off("down",this.onGroundDown),t.off("out",this.onGroundOut)}}Xl.RADIUS=101,Xl.COLS=11,Xl.ROWS=11,Xl.meta={selector:"[model-grid]",hosts:{host:Ua},outputs:["move","nav"],inputs:["view"]};class Yl extends Mn{static getGrid(t){const e=Math.ceil(t/Yl.ROWS);return[Math.ceil(t/e),e]}static getX(t,e){const s=Math.ceil(e/Yl.ROWS),i=t%s,n=1/Yl.W*(Yl.W+Yl.G);return n/2-s*n/2+i*n}static getY(t,e){const s=Math.ceil(e/Yl.ROWS),i=Math.ceil(e/s),n=Math.floor(t/s),o=1/Yl.W*(Yl.H+Yl.G);return i*o/2-o/2+n*-o}static get geometry(){if(this.geometry_)return this.geometry_;const t=new THREE.PlaneBufferGeometry(1,1/Yl.W*Yl.H,2,2);return this.geometry_=t,t}static get material(){return new THREE.ShaderMaterial({depthTest:!1,transparent:!0,toneMapped:!1,vertexShader:Ql.VERTEX_SHADER,fragmentShader:Ql.FRAGMENT_SHADER,uniforms:{textureA:{type:"t",value:null},textureB:{type:"t",value:null},resolutionA:{value:new THREE.Vector2},resolutionB:{value:new THREE.Vector2},tween:{value:0},opacity:{value:0}},extensions:{fragDepth:!0}})}constructor(t,e,s){const i=Yl.geometry,n=Yl.material;super(i,n),this.renderOrder=U.renderOrder.menu,this.name=t.name,this.item=t,this.index=e,this.total=s,this.tween=0,this.opacity=0;const o=this.textureA=this.getTextureA(t.name);n.uniforms.textureA.value=o,n.uniforms.resolutionA.value=new THREE.Vector2(o.width,o.height);const a=this.textureB=this.getTextureB(t.name);n.uniforms.textureB.value=a,n.uniforms.resolutionA.value=new THREE.Vector2(a.width,a.height),n.uniforms.tween.value=this.tween,n.uniforms.opacity.value=this.opacity,n.needsUpdate=!0,this.position.set(Yl.getX(e,s),Yl.getY(e,s),0),this.onOver=this.onOver.bind(this),this.onOut=this.onOut.bind(this)}getTextureA(t){const e=Yl.W,s=Yl.H,i=document.createElement("canvas");i.width=e,i.height=s;const n=i.getContext("2d");n.fillStyle=U.colors.menuBackground,n.fillRect(0,0,e,s),n.fillStyle=U.colors.menuForeground,this.writeText(n,t,e,s);const o=new THREE.CanvasTexture(i);return o.minFilter=THREE.LinearFilter,o.magFilter=THREE.LinearFilter,o.mapping=THREE.UVMapping,o.needsUpdate=!0,o}getTextureB(t){const e=Yl.W,s=Yl.H,i=document.createElement("canvas");i.width=e,i.height=s;const n=i.getContext("2d");n.fillStyle=U.colors.menuOverBackground,n.fillRect(0,0,e,s),n.fillStyle=U.colors.menuOverForeground,this.writeText(n,t,e,s);const o=new THREE.CanvasTexture(i);return o.magFilter=THREE.LinearFilter,o.needsUpdate=!0,o}writeText(t,e,s,i){this.setFont(t);const n=Yl.FONT_SIZE*Yl.LINE_HEIGHT,o=this.getLines(t,e,s),a=o.length;this.setFont(t,a-1),o.forEach(((e,o)=>{t.fillText(e,10,.5*(i-a*n)+(.5+o)*n,s-20)}))}setFont(t,e){void 0===e&&(e=0),t.textBaseline="middle",t.font=`${Yl.FONT_SIZE-2*e}px ${U.fontFamily}`}getLines(t,e,s){const i=e.split(" "),n=[];let o=i[0];for(let e=1;e<i.length;e++){const a=i[e];t.measureText(o+" "+a).width<s?o+=" "+a:(n.push(o),o=a)}return n.push(o),n}onOver(){gsap.to(this,{duration:.4,tween:1,ease:Power2.easeOut,onUpdate:()=>{this.position.z=.1*this.tween,this.material.uniforms.tween.value=this.tween,this.material.needsUpdate=!0}})}onOut(){gsap.to(this,{duration:.4,tween:0,ease:Power2.easeOut,onUpdate:()=>{this.position.z=.1*this.tween,this.material.uniforms.tween.value=this.tween,this.material.needsUpdate=!0}})}dispose(){yn.dispose(this),this.textureA.dispose(),this.textureB.dispose(),this.material.dispose(),this.geometry.dispose()}}Yl.FONT_SIZE=19,Yl.LINE_HEIGHT=.9,Yl.W=256,Yl.H=64,Yl.G=2,Yl.ROWS=6;class Jl extends Yl{constructor(t,e,s){super(t,e,s)}getTextureA(t){const e=Yl.W,s=Yl.H,i=document.createElement("canvas");i.width=e,i.height=s;const n=i.getContext("2d");n.fillStyle=U.colors.menuBackBackground,n.fillRect(0,0,e,s),n.fillStyle=U.colors.menuBackForeground,n.font=`${Yl.FONT_SIZE}px ${U.fontFamily}`,n.fillText(t,10,50,e-20);const o=new THREE.CanvasTexture(i);return o.minFilter=THREE.LinearFilter,o.magFilter=THREE.LinearFilter,o.mapping=THREE.UVMapping,o.needsUpdate=!0,o}getTextureB(t){const e=Yl.W,s=Yl.H,i=document.createElement("canvas");i.width=e,i.height=s;const n=i.getContext("2d");n.fillStyle=U.colors.menuBackOverBackground,n.fillRect(0,0,e,s),n.fillStyle=U.colors.menuBackOverForeground,n.font=`${Yl.FONT_SIZE}px ${U.fontFamily}`,n.fillText(t,10,50,e-20);const o=new THREE.CanvasTexture(i);return o.magFilter=THREE.LinearFilter,o.needsUpdate=!0,o}}class Ql extends Ba{get controlled(){return se.state.controlling&&se.state.controlling!==se.state.uid}get controlling(){return se.state.controlling&&se.state.controlling===se.state.uid}get silencing(){return se.state.silencing}get silenced(){return se.state.silencing&&se.state.role===ie.Streamer}get spyed(){return se.state.spying&&se.state.spying===se.state.uid}get spying(){return se.state.spying&&se.state.spying!==se.state.uid}get locked(){return this.controlled||this.spying}get loading(){return this.loading_}set loading(e){if(this.loading_!==e){this.loading_=e;const{node:s}=t.getContext(this);s.querySelector(".btn--menu").classList.toggle("loading",e)}}onInit(){super.onInit(),this.onDown=this.onDown.bind(this),this.onToggle=this.onToggle.bind(this);const{node:e}=t.getContext(this);this.progressIndicator=e.querySelector(".progress circle"),En.progress$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((t=>{this.loading=t.count>0;let e=144.51;t.count&&(e=144.51*(1-t.value)),gsap.set(this.progressIndicator,{strokeDashoffset:e})})),Us.in$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((t=>{if(t.type===hs)this.onToggle()}))}onDestroy(){this.buttons&&this.buttons.forEach((t=>yn.dispose(t))),super.onDestroy()}getContainer(){return this.host.cameraGroup}onCreate(t,e){const s=this.menuGroup=new THREE.Group;"function"==typeof t&&t(s)}render(t,e){const s=this.group;this.host.cameraGroup;let i=this.host.camera;const n=this.position;if(this.host.renderer.xr.isPresenting)i=this.host.renderer.xr.getCamera(i),i.getWorldDirection(n),n.y+=.5,n.multiplyScalar(3),this.host.cameraGroup.worldToLocal(n),n.y+=this.host.cameraGroup.position.y,s.position.copy(n),s.scale.set(1,1,1),s.lookAt(wn.origin);else{i.getWorldDirection(n),to.mode===Wn?n.multiplyScalar(.01):n.multiplyScalar(3),s.position.copy(n);const t=1/i.zoom;s.scale.set(t,t,t),s.lookAt(wn.origin)}}items$(t){return void 0===t&&(t=null),t?s.of(t.items):this.rootItems?s.of(this.rootItems):_r.getModelMenu$(this.views,this.host.editor).pipe(i.first(),i.tap((t=>{this.host.editor||(this.rootItems=t)})))}addMenu(t){void 0===t&&(t=null),this.removeMenu(),t&&"menu-group"!==t.type.name?this.nav.next(t):(_r.active=!0,this.items$(t).pipe(i.first()).subscribe((e=>{if(e){e=e.slice();const s={type:{name:"back"},name:t?"Back":"Close",backItem:t};e.push(s);const i=this.buttons=e.map(((e,s,i)=>(e.backItem=t,"back"===e.type.name?new Jl(e,s,i.length):new Yl(e,s,i.length))));i.forEach((t=>{t.depthTest=!1,t.on("over",t.onOver),t.on("out",t.onOut),t.on("down",this.onDown),this.menuGroup.add(t)})),gsap.to(i,{duration:.3,opacity:.8,ease:Power2.easeOut,stagger:{grid:Yl.getGrid(i.length),from:0,amount:.02*i.length},onUpdate:()=>{i.forEach((t=>{t.material.uniforms.opacity.value=t.opacity*(t.item.hidden?.5:1)}))}})}})))}removeMenu(){_r.active=!1,this.removeButtons(),this.removeToggler()}removeButtons(){const t=this.buttons;t&&t.forEach((t=>{this.menuGroup.remove(t),t.off("over",t.onOver),t.off("out",t.onOut),t.off("down",this.onDown),t.dispose()})),this.buttons=null}addToggler(){this.removeMenu();const t=this.toggler=new Yl({type:{name:"menu"},name:"Menu"},0,1);t.opacity=.8,t.material.uniforms.opacity.value=t.opacity,t.material.needsUpdate=!0,t.on("over",t.onOver),t.on("out",t.onOut),t.on("down",this.onToggle),this.menuGroup.add(t)}removeToggler(){const t=this.toggler;t&&(this.menuGroup.remove(t),t.off("over",t.onOver),t.off("out",t.onOut),t.off("down",this.onToggle),t.dispose()),this.toggler=null}onDown(t){t.item&&"back"===t.item.type.name?(this.removeMenu(),t.item.backItem?this.addMenu(t.item.backItem.backItem):this.toggle.next()):this.addMenu(t.item)}onToggle(t){t&&(t.preventDefault(),t.stopImmediatePropagation()),this.locked||(_r.active?(this.removeMenu(),this.toggle.next()):(this.addMenu(),this.toggle.next(this)))}}Ql.VERTEX_SHADER="\nvarying vec2 vUv;\nvoid main() {\n\tvUv = uv;\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n",Ql.FRAGMENT_SHADER="\nvarying vec2 vUv;\nuniform float opacity;\nuniform float tween;\nuniform sampler2D textureA;\nuniform sampler2D textureB;\nuniform vec2 resolutionA;\nuniform vec2 resolutionB;\n\nvoid main() {\n\tvec4 colorA = texture2D(textureA, vUv);\n\tvec4 colorB = texture2D(textureB, vUv);\n\tvec4 color = vec4(mix(colorA.rgb, colorB.rgb, tween), opacity);\n\tgl_FragColor = color;\n}\n",Ql.meta={selector:"[model-menu]",hosts:{host:Ua},outputs:["nav","toggle"],inputs:["views"],template:'\n\t<div class="btn--menu" (mousedown)="onToggle($event)">\n\t\t<svg class="menu-light" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#menu-light"></use></svg>\n\t\t<div class="btn--menu__spinner"></div>\n\t\t<svg class="bullets" width="24" height="24" viewBox="0 0 24 24"><use xlink:href="#menu"></use></svg>\n\t\t<svg class="progress" width="50" height="50" viewBox="0 0 50 50">\n\t\t\t<circle id="circle" r="23" cx="25" cy="25" fill="transparent"></circle>\n\t\t</svg>\n\t</div>\n\t'};const tc=new WeakMap;class ec extends n.Loader{constructor(t){super(t),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(t){return this.decoderPath=t,this}setDecoderConfig(t){return this.decoderConfig=t,this}setWorkerLimit(t){return this.workerLimit=t,this}load(t,e,s,i){const o=new n.FileLoader(this.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(t,(t=>{const s={attributeIDs:this.defaultAttributeIDs,attributeTypes:this.defaultAttributeTypes,useUniqueIDs:!1};this.decodeGeometry(t,s).then(e).catch(i)}),s,i)}decodeDracoFile(t,e,s,i){const n={attributeIDs:s||this.defaultAttributeIDs,attributeTypes:i||this.defaultAttributeTypes,useUniqueIDs:!!s};this.decodeGeometry(t,n).then(e)}decodeGeometry(t,e){for(const t in e.attributeTypes){const s=e.attributeTypes[t];void 0!==s.BYTES_PER_ELEMENT&&(e.attributeTypes[t]=s.name)}const s=JSON.stringify(e);if(tc.has(t)){const e=tc.get(t);if(e.key===s)return e.promise;if(0===t.byteLength)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let i;const n=this.workerNextTaskID++,o=t.byteLength,a=this._getWorker(n,o).then((s=>(i=s,new Promise(((s,o)=>{i._callbacks[n]={resolve:s,reject:o},i.postMessage({type:"decode",id:n,taskConfig:e,buffer:t},[t])}))))).then((t=>this._createGeometry(t.geometry)));return a.catch((()=>!0)).then((()=>{i&&n&&this._releaseTask(i,n)})),tc.set(t,{key:s,promise:a}),a}_createGeometry(t){const e=new n.BufferGeometry;t.index&&e.setIndex(new n.BufferAttribute(t.index.array,1));for(let s=0;s<t.attributes.length;s++){const i=t.attributes[s],o=i.name,a=i.array,r=i.itemSize;e.setAttribute(o,new n.BufferAttribute(a,r))}return e}_loadLibrary(t,e){const s=new n.FileLoader(this.manager);return s.setPath(this.decoderPath),s.setResponseType(e),s.setWithCredentials(this.withCredentials),new Promise(((e,i)=>{s.load(t,e,void 0,i)}))}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const t="object"!=typeof WebAssembly||"js"===this.decoderConfig.type,e=[];return t?e.push(this._loadLibrary("draco_decoder.js","text")):(e.push(this._loadLibrary("draco_wasm_wrapper.js","text")),e.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(e).then((e=>{const s=e[0];t||(this.decoderConfig.wasmBinary=e[1]);const i=sc.toString(),n=["/* draco decoder */",s,"","/* worker */",i.substring(i.indexOf("{")+1,i.lastIndexOf("}"))].join("\n");this.workerSourceURL=URL.createObjectURL(new Blob([n]))})),this.decoderPending}_getWorker(t,e){return this._initDecoder().then((()=>{if(this.workerPool.length<this.workerLimit){const t=new Worker(this.workerSourceURL);t._callbacks={},t._taskCosts={},t._taskLoad=0,t.postMessage({type:"init",decoderConfig:this.decoderConfig}),t.onmessage=function(e){const s=e.data;switch(s.type){case"decode":t._callbacks[s.id].resolve(s);break;case"error":t._callbacks[s.id].reject(s);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+s.type+'"')}},this.workerPool.push(t)}else this.workerPool.sort((function(t,e){return t._taskLoad>e._taskLoad?-1:1}));const s=this.workerPool[this.workerPool.length-1];return s._taskCosts[t]=e,s._taskLoad+=e,s}))}_releaseTask(t,e){t._taskLoad-=t._taskCosts[e],delete t._callbacks[e],delete t._taskCosts[e]}debug(){console.log("Task load: ",this.workerPool.map((t=>t._taskLoad)))}dispose(){for(let t=0;t<this.workerPool.length;++t)this.workerPool[t].terminate();return this.workerPool.length=0,this}}function sc(){let t,e;function s(t,e,s,i,n,o){const a=o.num_components(),r=s.num_points()*a,l=r*n.BYTES_PER_ELEMENT,c=function(t,e){switch(e){case Float32Array:return t.DT_FLOAT32;case Int8Array:return t.DT_INT8;case Int16Array:return t.DT_INT16;case Int32Array:return t.DT_INT32;case Uint8Array:return t.DT_UINT8;case Uint16Array:return t.DT_UINT16;case Uint32Array:return t.DT_UINT32}}(t,n),d=t._malloc(l);e.GetAttributeDataArrayForAllPoints(s,o,c,l,d);const h=new n(t.HEAPF32.buffer,d,r).slice();return t._free(d),{name:i,array:h,itemSize:a}}onmessage=function(i){const n=i.data;switch(n.type){case"init":t=n.decoderConfig,e=new Promise((function(e){t.onModuleLoaded=function(t){e({draco:t})},DracoDecoderModule(t)}));break;case"decode":const i=n.buffer,o=n.taskConfig;e.then((t=>{const e=t.draco,a=new e.Decoder,r=new e.DecoderBuffer;r.Init(new Int8Array(i),i.byteLength);try{const t=function(t,e,i,n){const o=n.attributeIDs,a=n.attributeTypes;let r,l;const c=e.GetEncodedGeometryType(i);if(c===t.TRIANGULAR_MESH)r=new t.Mesh,l=e.DecodeBufferToMesh(i,r);else{if(c!==t.POINT_CLOUD)throw new Error("THREE.DRACOLoader: Unexpected geometry type.");r=new t.PointCloud,l=e.DecodeBufferToPointCloud(i,r)}if(!l.ok()||0===r.ptr)throw new Error("THREE.DRACOLoader: Decoding failed: "+l.error_msg());const d={index:null,attributes:[]};for(const i in o){const l=self[a[i]];let c,h;if(n.useUniqueIDs)h=o[i],c=e.GetAttributeByUniqueId(r,h);else{if(h=e.GetAttributeId(r,t[o[i]]),-1===h)continue;c=e.GetAttribute(r,h)}d.attributes.push(s(t,e,r,i,l,c))}c===t.TRIANGULAR_MESH&&(d.index=function(t,e,s){const i=3*s.num_faces(),n=4*i,o=t._malloc(n);e.GetTrianglesUInt32Array(s,n,o);const a=new Uint32Array(t.HEAPF32.buffer,o,i).slice();return t._free(o),{array:a,itemSize:1}}(t,e,r));return t.destroy(r),d}(e,a,r,o),i=t.attributes.map((t=>t.array.buffer));t.index&&i.push(t.index.array.buffer),self.postMessage({type:"decode",id:n.id,geometry:t},i)}catch(t){console.error(t),self.postMessage({type:"error",id:n.id,error:t.message})}finally{e.destroy(r),e.destroy(a)}}))}}}class ic extends Da{get freezed(){return this.freezed_}set freezed(t){if(this.freezed_!==t){this.freezed_=t;const e=this.mesh;e&&e.traverse((e=>{e.isInteractiveMesh&&(e.freezed=t)}))}}onInit(){super.onInit(),this.isPresenting=!1,_r.active$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((t=>this.freezed=t))}onChanges(){this.editing=this.item.selected}onCreate(t,e){this.loadGlb(U.getPath(this.item.asset.folder),this.item.asset.file,((s,i)=>{this.onGlbLoaded(s,i,t,e)}))}loadGlb(t,e,s){this.host.renderer;const i=En.getRef(),n=(new So).setPath(t),o=`${U.dist}js/draco/`,a=new ec;a.setDecoderPath(o),n.setDRACOLoader(a),n.load(e,(t=>{"function"==typeof s&&s(t.scene,t.animations),En.setProgress(i,1)}),(t=>{En.setProgress(i,t.loaded,t.total)}))}onGlbLoaded(t,e,s,i){this.parseAnimations(t,e);const n=(new THREE.Box3).setFromObject(t),o=n.max.clone().sub(n.min),a=1.7/Math.max(o.x,o.y,o.z);let r;t.scale.set(a,a,a);const l=this.view,c=this.item;if(l.type.name===bi.Model.name){r=new THREE.Group,r.add(t),n.setFromObject(r);const e=n.getCenter(new THREE.Vector3);r.position.set(t.position.x-e.x,t.position.y-e.y,t.position.z-e.z+(this.host.renderer.xr.isPresenting?-2:0));const s=r.position.y,i={tween:1},o=()=>{r.position.y=s+3*i.tween,r.rotation.y=0+Math.PI*i.tween};o(),this.makeInteractive(t),gsap.to(i,{duration:1.5,tween:0,delay:.1,ease:Power2.easeInOut,onUpdate:o,onComplete:()=>{this.updateHelper()}})}else{n.setFromObject(t);const e=n.getCenter(new THREE.Vector3);t.position.set(-e.x,-e.y,-e.z),r=new THREE.Group,r.add(t),c.position&&r.position.fromArray(c.position),c.rotation&&r.rotation.fromArray(c.rotation),c.scale&&r.scale.fromArray(c.scale),this.makeInteractive(t),this.updateHelper()}"function"==typeof s&&(s(r,this.item),this.freezed=_r.active)}parseAnimations(t,e){this.actionIndex=-1;const s=this.actions=[];if(e&&e.length){this.clock=new THREE.Clock;const i=this.mixer=new THREE.AnimationMixer(t);i.timeScale=1,e.forEach((t=>{const e=i.clipAction(t);e.enabled=!0,e.setEffectiveTimeScale(1),e.setEffectiveWeight(1),e.setLoop(THREE.LoopRepeat),s.push(e)}))}}onClipToggle(){let t;const e=this.actions;1===e.length?(t=-1===this.actionIndex?0:-1,this.setSingleAction(t)):e.length>1&&(t=this.actionIndex+1,t===e.length&&(t=-1),this.setMultiAction(t)),this.play.next({itemId:this.item.id,actionIndex:t})}setSingleAction(t){if(this.actionIndex!==t){this.actionIndex=t;const e=this.actions[0];0===t?e.paused||0===e.timeScale?e.paused=!1:e.play():-1===t&&e.halt(.3)}}setMultiAction(t){if(this.actionIndex!==t){const e=this.actions,s=this.actionIndex>-1?e[this.actionIndex]:null;if(this.actionIndex=t,s&&s.halt(.3),t>-1){const s=e[t];s.paused&&(s.paused=!1),0===s.timeScale&&(s.timeScale=1),s.play()}}}onMessage(t){if(t.type===es){const e=this.actions;1===e.length?this.setSingleAction(t.actionIndex):e.length>1&&this.setMultiAction(t.actionIndex)}}render(t,e){const s=this.view;this.item;const i=this.mesh,n=this.host.renderer.xr.isPresenting;this.group,i&&(s.type.name===bi.Model.name?(this.isPresenting!==n&&(this.isPresenting=n,n?(i.position.x=0,i.position.y=0,i.position.z=-2,i.rotation.y=0):(i.position.x=0,i.position.y=0,i.position.z=0,i.rotation.y=0)),n&&(i.rotation.y-=Math.PI/180/60*5)):n&&(i.rotation.y-=Math.PI/180/60*5));const o=this.mixer,a=this.clock;if(o){const t=a.getDelta();o.update(t)}}onUpdate(t,e){this.view.type.name!==bi.Model.name&&(t.position&&e.position.fromArray(t.position),t.rotation&&e.rotation.fromArray(t.rotation),t.scale&&e.scale.fromArray(t.scale)),this.updateHelper()}onUpdateAsset(t,e){this.loadGlb(U.getPath(t.asset.folder),t.asset.file,((t,e)=>{this.onGlbLoaded(t,e,((t,e)=>this.onMount(t,e)),((t,e)=>this.onDismount(t,e)))}))}onDragMove(t,e,s){s&&t.normalize().multiplyScalar(4),this.editing=!0;this.view.type.name!==bi.Model.name&&this.mesh.position.set(t.x,t.y,t.z),this.updateHelper()}onDragEnd(){this.view.type.name!==bi.Model.name&&(this.item.position=this.mesh.position.toArray(),this.item.rotation=this.mesh.rotation.toArray(),this.item.scale=this.mesh.scale.toArray()),this.editing=!1}static getInteractiveDescriptors(){let t=ic.interactiveDescriptors;if(!t){const e=Object.getOwnPropertyDescriptors(xn.prototype),s=Object.getOwnPropertyDescriptors(Cn.prototype),i=Object.getOwnPropertyDescriptors(Mn.prototype);t=Object.assign({},e,s,i),ic.interactiveDescriptors=t}return t}makeInteractive(t){const e=ic.getInteractiveDescriptors();t.traverse((t=>{t.isMesh&&(Object.keys(e).forEach((s=>{"constructor"!==s&&Object.defineProperty(t,s,e[s])})),t.freezed=!1,t.events={},t.depthTest=!0,t.over_=!1,t.down_=!1,yn.items.push(t),t.on("down",(()=>{this.onClipToggle(),this.down.next(this)})))}))}}ic.meta={selector:"[model-model]",hosts:{host:Ua},outputs:["down","play"],inputs:["item","view"]};class nc extends THREE.Sprite{get freezed(){return this.freezed_}set freezed(t){this.freezed_=t,this.children.filter((t=>t.__lookupGetter__("freezed"))).forEach((e=>e.freezed=t))}constructor(t){super(t=t||new THREE.SpriteMaterial({color:16711935})),this.freezed=!1}freeze(){this.freezed=!0}unfreeze(){this.freezed=!1}}class oc extends nc{constructor(t){super(t=t||new THREE.SpriteMaterial({color:16711935})),this.events={}}on(t,e){const s=this.events[t]=this.events[t]||[];return s.push(e),()=>{this.events[t]=s.filter((t=>t!==e))}}off(t,e){const s=this.events[t];s&&(this.events[t]=s.filter((t=>t!==e)))}emit(t,e){const s=this.events[t];s&&s.forEach((t=>{t(e)}));const i=this.events.broadcast;i&&i.forEach((s=>{s(t,e)}))}}class ac extends oc{constructor(t){super(t),this.depthTest=!0,this.over_=!1,this.down_=!1,yn.items.push(this)}get isInteractiveSprite(){return!0}get over(){return this.over_}set over(t){this.over_!=t&&(this.over_=t,t?this.emit("over",this):this.emit("out",this))}get down(){return this.down_}set down(t){t=t&&this.over,this.down_!=t&&(this.down_=t,t?this.emit("down",this):this.emit("up",this))}}class rc extends Ba{constructor(){super(...arguments),this.isMobile_=void 0}get isMobile(){return this.isMobile_}set isMobile(t){this.isMobile_!==t&&(this.isMobile_=t,this.setScale())}render(t,e){this.isMobile=this.host.worldRect.width<768}setScale(t){void 0===t&&(t=0);const e=this.textureWidth,s=this.textureHeight,i=this.item,n=this.panel;if(n){const o=.2*(i.asset?1.5:1)*(this.isMobile?1.6:1),a=e/s,r=rc.PANEL_RADIUS*o,l=rc.PANEL_RADIUS*o/a,c=.25*r,d=i.mesh.position.normalize().multiplyScalar(rc.PANEL_RADIUS);n.position.set(d.x,d.y+(l+2*c)-c*(1-t),d.z),n.scale.set(.02*r,.02*l,1)}}onInit(){super.onInit(),this.textureWidth=0,this.textureHeight=0}onView(){if(this.viewed)return;this.viewed=!0;const{node:e}=t.getContext(this);this.getCanvasTexture(e).then((t=>{if(this.textureWidth=t.width,this.textureHeight=t.height,this.mesh&&this.item){const s=new THREE.SpriteMaterial({depthTest:!1,transparent:!0,opacity:0,map:t.map,sizeAttenuation:!1,toneMapped:!1}),i=this.item,n=this.panel=new ac(s);n.renderOrder=U.renderOrder.panel,this.setScale(1),n.on("down",(t=>{const s={x:parseInt(t.intersection.uv.x*e.offsetWidth),y:parseInt((1-t.intersection.uv.y)*e.offsetHeight)},n=Array.prototype.slice.call(e.querySelectorAll(".panel__link")),o=n.find((t=>s.x>=t.offsetLeft&&s.y>=t.offsetTop&&s.x<=t.offsetLeft+t.offsetWidth&&s.y<=t.offsetTop+t.offsetHeight));if(o){const t=n.indexOf(o),a=i.links[t];this.down.next({item:i,link:a,linkIndex:t});const r=e.getBoundingClientRect(),l={button:0,buttons:0,clientX:s.x+r.left,clientY:s.y+r.top,movementX:0,movementY:0,relatedTarget:o,screenX:s.x,screenY:s.y},c=new MouseEvent("mouseup",l);o.dispatchEvent(c),setTimeout((()=>{qn.dismissEvent(c,qn.events$,qn.dismiss$,qn.downEvent)}),1)}})),this.mesh.add(n);const o={value:0};gsap.to(o,{duration:.5,value:1,delay:0,ease:Power2.easeInOut,onUpdate:()=>{this.setScale(1-o.value),n.lookAt(wn.origin),n.material.opacity=o.value,n.material.needsUpdate=!0}})}}),(t=>{console.log("ModelPanelComponent.getCanvasTexture.error",t)}))}onCreate(t,e){const s=new THREE.Group;"function"==typeof t&&t(s)}onDestroy(){super.onDestroy()}imagesLoaded(){const{node:e}=t.getContext(this);if(e){const t=Array.prototype.slice.call(e.querySelectorAll("img")).map((t=>new Promise((function(e,s){const i=t.src&&-1===t.src.indexOf(location.origin);if(t.complete)return setTimeout((()=>{e(i)}),10);const n=()=>{t.removeEventListener("load",o),t.removeEventListener("error",a)},o=()=>{n(),setTimeout((()=>{e(i)}),10)},a=()=>{n(),e(!1)};t.addEventListener("load",o),t.addEventListener("error",a)}))));return t.length?Promise.all(t):Promise.resolve()}}getCanvasTexture(e){return new Promise(((s,i)=>{setTimeout((()=>{this.item.panelTexture?s(this.item.panelTexture):this.imagesLoaded().then((n=>{const o=t.getContext(this);if(o&&o.node){e=o.node;const t=n&&null!=n.find((t=>!0===t));r.default(e,{backgroundColor:"#ffffff00",scale:1,useCORS:t}).then((t=>{const e=new THREE.CanvasTexture(t);this.item.panelTexture={map:e,width:t.width,height:t.height},s(this.item.panelTexture)}),(t=>{i(t)}))}}))}),1)}))}}rc.PANEL_RADIUS=99,rc.meta={selector:"[model-panel]",hosts:{host:Ua},outputs:["over","out","down"],inputs:["item"],template:'\n\t\t<div class="panel__title"><span [innerHTML]="item.title"></span></div>\n\t\t<div class="panel__abstract"><span [innerHTML]="item.abstract"></span></div>\n\t\t<img class="panel__picture" [src]="item.asset | asset" *if="item.asset">\n\t\t<a class="panel__link" [href]="link.href" target="_blank" rel="noopener" *for="let link of item.links">\n\t\t\t<span [innerHTML]="link.title"></span>\n\t\t</a>\n\t'};class lc extends Ba{onInit(){super.onInit()}onCreate(t,e){const s=new THREE.Group;"function"==typeof t&&t(s)}}lc.meta={selector:"[model-picture]",hosts:{host:Ua},inputs:["item"]};class cc extends Da{onInit(){super.onInit()}onChanges(){const t=this.item.selected;this.editing=t,this.mesh&&(this.mesh.editing=t)}onCreate(t,e){const s=this.item,n=this.view;n.items;const o=bn.planeGeometry;let a,r;this.onMeshDown=this.onMeshDown.bind(this),this.onMeshPlaying=this.onMeshPlaying.bind(this),this.onMeshZoomed=this.onMeshZoomed.bind(this),this.onMeshCurrentTime=this.onMeshCurrentTime.bind(this),Dn.getStreamId$(s).pipe(i.takeUntil(this.unsubscribe$)).subscribe((l=>{this.streamId!==l&&(this.streamId=l,r&&(r.unsubscribe(),r=null),l||!s.asset?(s.streamId=l,a=this.disposableMesh=new Dn(s,n,o,this.host),a.updateFromItem(s),a.name="plane",a.load((()=>{this.disposableMesh=null,"function"==typeof t&&t(a,s),r=a.events$().pipe(i.takeUntil(this.unsubscribe$)).subscribe((()=>{}))})),this.addMeshListeners(a)):this.mesh&&e(this.mesh,s))}))}addMeshListeners(t){t.on("down",this.onMeshDown),t.on("playing",this.onMeshPlaying),t.on("zoomed",this.onMeshZoomed),t.on("currentTime",this.onMeshCurrentTime)}removeMeshListeners(t){t.off("down",this.onMeshDown),t.off("playing",this.onMeshPlaying),t.off("zoomed",this.onMeshZoomed),t.off("currentTime",this.onMeshCurrentTime)}onMeshDown(){this.down.next(this)}onMeshPlaying(t){this.play.next({itemId:this.item.id,playing:t})}onMeshZoomed(t){this.zoom.next({itemId:this.item.id,zoomed:t})}onMeshCurrentTime(t){this.currentTime.next({itemId:this.item.id,currentTime:t})}onDestroy(){super.onDestroy(),this.disposableMesh&&(this.removeMeshListeners(this.disposableMesh),this.disposableMesh.dispose()),this.mesh&&(this.removeMeshListeners(this.mesh),this.mesh.dispose())}onUpdate(t,e){e.updateFromItem(t),this.updateHelper()}onUpdateAsset(t,e){e.updateByItem(t),Dn.getStreamId$(t).pipe(i.filter((t=>null!==t)),i.take(1)).subscribe((s=>{t.streamId=s,e.load((()=>{}))}))}onDragMove(t,e,s){const i=this.item,n=this.mesh;i.showPanel=!1,this.editing=!0,s?(t.normalize().multiplyScalar(20),n.position.set(t.x,t.y,t.z),n.lookAt(wn.origin)):(n.position.set(0,0,0),n.lookAt(e),n.position.set(t.x,t.y,t.z),n.position.add(e.multiplyScalar(.01))),this.updateHelper()}onDragEnd(){const t=this.item,e=this.mesh;t.position=e.position.toArray(),t.rotation=e.rotation.toArray(),t.scale=e.scale.toArray(),e.updateFromItem(t),this.editing=!1}}cc.textures={},cc.meta={selector:"[model-plane]",hosts:{host:Ua},outputs:["down","play","zoom","currentTime"],inputs:["item","view"]};const dc=100.99;class hc extends Ba{get title(){return this.title_}set title(t){this.title_!==t&&(this.title_=t,t===ge.transform("waiting_host")||""!==t&&this.visible_?(this.updateProgress(),this.show()):this.hide())}get visible(){return this.visible_}set visible(t){this.visible_!==t&&(this.visible_=t,t&&""!==this.title_?(this.updateProgress(),this.show()):this.hide())}onInit(){this.title_="",this.visible_=this.host.renderer.xr.isPresenting,super.onInit();(this.vrService=xo.getService()).session$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((t=>this.visible=null!=t))}onCreate(e,s){const{node:n}=t.getContext(this),o=n.querySelector(".inner");this.getCanvasTexture().then((t=>{const s=this.createMesh(t);"function"==typeof e&&e(s),En.progress$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((t=>{t.count>0?n.classList.add("active"):n.classList.remove("active"),o.style.width=100*t.value+"%",t.count?this.title=0===t.value?ge.transform("loading"):t.title:this.title=this.getTitle()}))}))}getTitle(){return this.view&&this.view.type.name===bi.WaitingRoom.name?ge.transform("waiting_host"):""}show(){this.mesh.add(this.banner),this.material.opacity=1,this.material.needsUpdate=!0}hide(){this.mesh.remove(this.banner),this.material.opacity=0,this.material.needsUpdate=!0}createMesh(t){const e=new THREE.Group,s=Math.PI/180*360,i=dc*s,n=i/360*2.4,o=i/(t.width*n/t.height),a=new THREE.CylinderBufferGeometry(dc,dc,n,80,2,!0,0,s);a.scale(-1,1,1);const r=t.texture;r.wrapS=r.wrapY=THREE.RepeatWrapping,r.repeat.x=o,r.encoding=THREE.sRGBEncoding;const l=this.material=new THREE.MeshBasicMaterial({map:r,transparent:!0,opacity:0,toneMapped:!1});return this.banner=new THREE.Mesh(a,l),e.userData={render:()=>{e.rotation.y+=Math.PI/180*.02}},e}updateProgress(){this.getCanvasTexture().then((t=>{const e=Math.PI/180*360,s=dc*e,i=s/360*2.4,n=s/(t.width*i/t.height);this.texture.repeat.x=n}))}getCanvasTexture(){return new Promise(((t,e)=>{let s=512,i=64;const n=Math.floor(48),o=Math.floor(3.2);let a;a=this.canvas?this.canvas:this.canvas=document.createElement("canvas"),a.width=s,a.height=i;const r=this.title_,l=a.getContext("2d");l.imageSmoothingEnabled=!0,l.imageSmoothingQuality="high",l.font=`300 ${n}px ${U.fontFamily}`;let c;s=l.measureText(r).width+8,s=Math.max(512,Math.pow(2,Math.ceil(Math.log(s)/Math.log(2)))),a.width=s,l.clearRect(0,0,s,i),l.fillStyle="#0000005A",l.fillRect(0,0,s,i),l.font=`300 ${n}px ${U.fontFamily}`,l.textAlign="center",l.textBaseline="middle",l.strokeStyle="rgba(0, 0, 0, 0.35)",l.lineWidth=o,l.lineJoin="round",l.miterLimit=2,l.strokeText(r,s/2,32),l.fillStyle="white",l.fillText(r,s/2,32,s),this.texture?(c=this.texture,c.needsUpdate=!0):c=this.texture=new THREE.CanvasTexture(a),t({texture:c,width:s,height:i})}))}}hc.meta={selector:"[model-progress]",hosts:{host:Ua},inputs:["view"]};class uc extends Ba{static get transparentMaterial(){return this.transparentMaterial_||(this.transparentMaterial_=new THREE.MeshBasicMaterial({color:16711680,transparent:!0,opacity:0})),this.transparentMaterial_}get freezed(){return this.freezed_}set freezed(t){if(this.freezed_!==t){this.freezed_=t;const e=this.mesh;e&&e.traverse((e=>{e.isInteractiveMesh&&(e.freezed=t)}))}}onInit(){super.onInit(),this.isPresenting=!1,_r.active$.pipe(i.takeUntil(this.unsubscribe$)).subscribe((t=>this.freezed=t))}onChanges(){this.editing=this.view.selected}onCreate(t,e){this.loadGlb(U.getPath(this.view.asset.folder),this.view.asset.file,((s,i)=>{this.onGlbLoaded(s,i,t,e)}))}loadGlb(t,e,s){this.host.renderer;const i=En.getRef(),n=(new So).setPath(t),o=`${U.dist}js/draco/`,a=new ec;a.setDecoderPath(o),n.setDRACOLoader(a),n.load(e,(t=>{"function"==typeof s&&s(t.scene,t.animations),En.setProgress(i,1)}),(t=>{En.setProgress(i,t.loaded,t.total)}))}onGlbLoaded(t,e,s,i){const n=this.view;t.position.set(0,-1.76,0);const o=[];let a;t.traverse((t=>{t.isMesh&&o.push(t),"nav"===t.name&&(n.navIntersectObjects=[t],this.makeTransparent(t))})),n.intersectObjects=o,a=new THREE.Group,a.add(t),"function"==typeof s&&s(a,this.view)}makeTransparent(t){t.isMesh&&(t.material=uc.transparentMaterial),t.traverse((t=>{t.isMesh&&(t.material=uc.transparentMaterial)}))}onUpdateAsset(t,e){this.loadGlb(U.getPath(t.asset.folder),t.asset.file,((t,e)=>{this.onGlbLoaded(t,e,((t,e)=>this.onMount(t,e)),((t,e)=>this.onDismount(t,e)))}))}}uc.meta={selector:"[model-room]",hosts:{host:Ua},inputs:["view"]};class pc extends Ba{onInit(){super.onInit()}onCreate(t,e){const s=new THREE.Group;"function"==typeof t&&t(s)}}pc.meta={selector:"[model-text]",hosts:{host:Ua},inputs:["item"]};class mc extends t.Module{}mc.meta={imports:[t.CoreModule,e.FormModule,Jr],declarations:[ce,Ps,Xs,Os,Ys,ai,Wa,oi,ci,li,mi,vi,gi,fi,yr,$r,ll,dl,hl,ul,pl,Ar,ml,vl,gl,xr,pe,fl,wl,bl,yl,xl,Cr,kr,Sr,tl,Cl,el,ur,cl,Bl,Tl,Qr,El,Ml,ge,Ll,pr,Il,Fl,Rl,$l,qi,ql,Ba,Zl,Kl,Xl,Ql,ic,Za,rc,lc,cc,hc,uc,pc,we,Pl,Hl,kl,Ol,mr,Zi,Ul,Sl,Nl,Ua,le,Al],bootstrap:vr},t.Browser.bootstrap(mc)}));
//# sourceMappingURL=main.min.js.map