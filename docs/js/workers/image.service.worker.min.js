/**
 * @license beta-bhere-development v1.0.25
 * (c) 2023 Luca Zampetti <lzampetti@gmail.com>
 * License: MIT
 */
!function(e){"function"==typeof define&&define.amd?define(e):e()}((function(){"use strict";const e={Progress:"progress",Complete:"complete"},t={};function n(t,n,s){if(!self.createImageBitmap||!self.OffscreenCanvas)return o(e.Complete,t,n);self.createImageBitmap(n).then((function(n){let s=n.width,r=n.height;s>r?s>320&&(r*=320/s,s=320):r>240&&(s*=240/r,r=240);const i=new OffscreenCanvas(s,r),a=i.getContext("2d");i.width=s,i.height=r,a.drawImage(n,0,0,s,r),i.convertToBlob().then((function(n){o(e.Complete,t,n)}))}))}function o(e,t,n){self.postMessage({type:e,src:t,data:n})}self.addEventListener("message",(function(r){const i=r.data.id,a=r.data.src,l=r.data.size;if(i&&!a){const e=t[i];return void(e&&e.abort())}const c={mode:"cors"};if("function"==typeof fetch){if(self.AbortController){const e=new AbortController;c.signal=e.signal,t[i]=e}fetch(a,c).then(function(e){let{defaultSize:t=0,emitDelay:n=10,onProgress:o=(()=>null),onComplete:r=(()=>null),onError:i=(()=>null)}=e;return function(e){if("undefined"==typeof Response||"undefined"==typeof ReadableStream)return e;const{body:a,headers:l,status:c}=e,f=l.get("content-length")||t,d=new s(f,n),u=a.getReader(),h=new ReadableStream({start(e){function t(){u.read().then((n=>{let{done:s,value:i}=n;if(s)return r({}),void e.close();i&&d.next(i,o),e.enqueue(i),t()})).catch((e=>{i(e)}))}t()}});return new Response(h,{headers:l,status:c})}}({onProgress(t){o(e.Progress,a,t)}})).then((function(e){return e.blob()}),(function(e){console.log("ImageServiceWorker.error",e)})).then((function(s){delete t[i],"object"==typeof l?n(a,s):o(e.Complete,a,s)}),(function(e){console.log("ImageServiceWorker.error",e)}))}else{const t=new XMLHttpRequest;t.open("GET",a,!0),t.responseType="blob",t.withCredentials=!0,t.onload=function(){t.status<300&&("object"==typeof l?n(a,this.response):o(e.Complete,a,this.response))},t.onprogress=function(t){o(e.Progress,a,t)},t.onerror=function(){},t.send()}}));class s{constructor(e,t){void 0===t&&(t=1e3),this.eventStart=0,this.loaded=0,this.length=parseInt(e,10)||0,this.emitDelay=t}next(e,t){const n=e.length;if(this.loaded+=n,this.eventStart=this.eventStart||Date.now(),this.length>=this.loaded||Date.now()-this.eventStart>this.emitDelay){this.eventStart=Date.now();t({total:this.length,loaded:this.loaded})}}}}));
//# sourceMappingURL=image.service.worker.min.js.map